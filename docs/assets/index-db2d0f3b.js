function bk(t,n){for(var l=0;l<n.length;l++){const h=n[l];if(typeof h!="string"&&!Array.isArray(h)){for(const m in h)if(m!=="default"&&!(m in t)){const x=Object.getOwnPropertyDescriptor(h,m);x&&Object.defineProperty(t,m,x.get?x:{enumerable:!0,get:()=>h[m]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))h(m);new MutationObserver(m=>{for(const x of m)if(x.type==="childList")for(const b of x.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&h(b)}).observe(document,{childList:!0,subtree:!0});function l(m){const x={};return m.integrity&&(x.integrity=m.integrity),m.referrerPolicy&&(x.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?x.credentials="include":m.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function h(m){if(m.ep)return;m.ep=!0;const x=l(m);fetch(m.href,x)}})();var $t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function e1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function KT(t){if(t.__esModule)return t;var n=t.default;if(typeof n=="function"){var l=function h(){return this instanceof h?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};l.prototype=n.prototype}else l={};return Object.defineProperty(l,"__esModule",{value:!0}),Object.keys(t).forEach(function(h){var m=Object.getOwnPropertyDescriptor(t,h);Object.defineProperty(l,h,m.get?m:{enumerable:!0,get:function(){return t[h]}})}),l}var YT={exports:{}},dn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gp=Symbol.for("react.element"),Ek=Symbol.for("react.portal"),Tk=Symbol.for("react.fragment"),Sk=Symbol.for("react.strict_mode"),Ck=Symbol.for("react.profiler"),Ak=Symbol.for("react.provider"),Ik=Symbol.for("react.context"),kk=Symbol.for("react.forward_ref"),Mk=Symbol.for("react.suspense"),Dk=Symbol.for("react.memo"),Pk=Symbol.for("react.lazy"),Zb=Symbol.iterator;function zk(t){return t===null||typeof t!="object"?null:(t=Zb&&t[Zb]||t["@@iterator"],typeof t=="function"?t:null)}var JT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QT=Object.assign,eS={};function Nu(t,n,l){this.props=t,this.context=n,this.refs=eS,this.updater=l||JT}Nu.prototype.isReactComponent={};Nu.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")};Nu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tS(){}tS.prototype=Nu.prototype;function t1(t,n,l){this.props=t,this.context=n,this.refs=eS,this.updater=l||JT}var n1=t1.prototype=new tS;n1.constructor=t1;QT(n1,Nu.prototype);n1.isPureReactComponent=!0;var Xb=Array.isArray,nS=Object.prototype.hasOwnProperty,r1={current:null},rS={key:!0,ref:!0,__self:!0,__source:!0};function iS(t,n,l){var h,m={},x=null,b=null;if(n!=null)for(h in n.ref!==void 0&&(b=n.ref),n.key!==void 0&&(x=""+n.key),n)nS.call(n,h)&&!rS.hasOwnProperty(h)&&(m[h]=n[h]);var s=arguments.length-2;if(s===1)m.children=l;else if(1<s){for(var C=Array(s),k=0;k<s;k++)C[k]=arguments[k+2];m.children=C}if(t&&t.defaultProps)for(h in s=t.defaultProps,s)m[h]===void 0&&(m[h]=s[h]);return{$$typeof:gp,type:t,key:x,ref:b,props:m,_owner:r1.current}}function Bk(t,n){return{$$typeof:gp,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function i1(t){return typeof t=="object"&&t!==null&&t.$$typeof===gp}function Lk(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(l){return n[l]})}var Kb=/\/+/g;function A_(t,n){return typeof t=="object"&&t!==null&&t.key!=null?Lk(""+t.key):n.toString(36)}function x0(t,n,l,h,m){var x=typeof t;(x==="undefined"||x==="boolean")&&(t=null);var b=!1;if(t===null)b=!0;else switch(x){case"string":case"number":b=!0;break;case"object":switch(t.$$typeof){case gp:case Ek:b=!0}}if(b)return b=t,m=m(b),t=h===""?"."+A_(b,0):h,Xb(m)?(l="",t!=null&&(l=t.replace(Kb,"$&/")+"/"),x0(m,n,l,"",function(k){return k})):m!=null&&(i1(m)&&(m=Bk(m,l+(!m.key||b&&b.key===m.key?"":(""+m.key).replace(Kb,"$&/")+"/")+t)),n.push(m)),1;if(b=0,h=h===""?".":h+":",Xb(t))for(var s=0;s<t.length;s++){x=t[s];var C=h+A_(x,s);b+=x0(x,n,l,C,m)}else if(C=zk(t),typeof C=="function")for(t=C.call(t),s=0;!(x=t.next()).done;)x=x.value,C=h+A_(x,s++),b+=x0(x,n,l,C,m);else if(x==="object")throw n=String(t),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return b}function Xf(t,n,l){if(t==null)return t;var h=[],m=0;return x0(t,h,"","",function(x){return n.call(l,x,m++)}),h}function Rk(t){if(t._status===-1){var n=t._result;n=n(),n.then(function(l){(t._status===0||t._status===-1)&&(t._status=1,t._result=l)},function(l){(t._status===0||t._status===-1)&&(t._status=2,t._result=l)}),t._status===-1&&(t._status=0,t._result=n)}if(t._status===1)return t._result.default;throw t._result}var yi={current:null},v0={transition:null},Fk={ReactCurrentDispatcher:yi,ReactCurrentBatchConfig:v0,ReactCurrentOwner:r1};function oS(){throw Error("act(...) is not supported in production builds of React.")}dn.Children={map:Xf,forEach:function(t,n,l){Xf(t,function(){n.apply(this,arguments)},l)},count:function(t){var n=0;return Xf(t,function(){n++}),n},toArray:function(t){return Xf(t,function(n){return n})||[]},only:function(t){if(!i1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};dn.Component=Nu;dn.Fragment=Tk;dn.Profiler=Ck;dn.PureComponent=t1;dn.StrictMode=Sk;dn.Suspense=Mk;dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fk;dn.act=oS;dn.cloneElement=function(t,n,l){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var h=QT({},t.props),m=t.key,x=t.ref,b=t._owner;if(n!=null){if(n.ref!==void 0&&(x=n.ref,b=r1.current),n.key!==void 0&&(m=""+n.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(C in n)nS.call(n,C)&&!rS.hasOwnProperty(C)&&(h[C]=n[C]===void 0&&s!==void 0?s[C]:n[C])}var C=arguments.length-2;if(C===1)h.children=l;else if(1<C){s=Array(C);for(var k=0;k<C;k++)s[k]=arguments[k+2];h.children=s}return{$$typeof:gp,type:t.type,key:m,ref:x,props:h,_owner:b}};dn.createContext=function(t){return t={$$typeof:Ik,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Ak,_context:t},t.Consumer=t};dn.createElement=iS;dn.createFactory=function(t){var n=iS.bind(null,t);return n.type=t,n};dn.createRef=function(){return{current:null}};dn.forwardRef=function(t){return{$$typeof:kk,render:t}};dn.isValidElement=i1;dn.lazy=function(t){return{$$typeof:Pk,_payload:{_status:-1,_result:t},_init:Rk}};dn.memo=function(t,n){return{$$typeof:Dk,type:t,compare:n===void 0?null:n}};dn.startTransition=function(t){var n=v0.transition;v0.transition={};try{t()}finally{v0.transition=n}};dn.unstable_act=oS;dn.useCallback=function(t,n){return yi.current.useCallback(t,n)};dn.useContext=function(t){return yi.current.useContext(t)};dn.useDebugValue=function(){};dn.useDeferredValue=function(t){return yi.current.useDeferredValue(t)};dn.useEffect=function(t,n){return yi.current.useEffect(t,n)};dn.useId=function(){return yi.current.useId()};dn.useImperativeHandle=function(t,n,l){return yi.current.useImperativeHandle(t,n,l)};dn.useInsertionEffect=function(t,n){return yi.current.useInsertionEffect(t,n)};dn.useLayoutEffect=function(t,n){return yi.current.useLayoutEffect(t,n)};dn.useMemo=function(t,n){return yi.current.useMemo(t,n)};dn.useReducer=function(t,n,l){return yi.current.useReducer(t,n,l)};dn.useRef=function(t){return yi.current.useRef(t)};dn.useState=function(t){return yi.current.useState(t)};dn.useSyncExternalStore=function(t,n,l){return yi.current.useSyncExternalStore(t,n,l)};dn.useTransition=function(){return yi.current.useTransition()};dn.version="18.3.1";YT.exports=dn;var xt=YT.exports;const I_=e1(xt);var sS={exports:{}},Qi={},aS={exports:{}},lS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function n(We,bt){var ft=We.length;We.push(bt);e:for(;0<ft;){var je=ft-1>>>1,Je=We[je];if(0<m(Je,bt))We[je]=bt,We[ft]=Je,ft=je;else break e}}function l(We){return We.length===0?null:We[0]}function h(We){if(We.length===0)return null;var bt=We[0],ft=We.pop();if(ft!==bt){We[0]=ft;e:for(var je=0,Je=We.length,et=Je>>>1;je<et;){var tt=2*(je+1)-1,nn=We[tt],Wt=tt+1,yn=We[Wt];if(0>m(nn,ft))Wt<Je&&0>m(yn,nn)?(We[je]=yn,We[Wt]=ft,je=Wt):(We[je]=nn,We[tt]=ft,je=tt);else if(Wt<Je&&0>m(yn,ft))We[je]=yn,We[Wt]=ft,je=Wt;else break e}}return bt}function m(We,bt){var ft=We.sortIndex-bt.sortIndex;return ft!==0?ft:We.id-bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;t.unstable_now=function(){return x.now()}}else{var b=Date,s=b.now();t.unstable_now=function(){return b.now()-s}}var C=[],k=[],B=1,U=null,F=3,Z=!1,q=!1,K=!1,Y=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function V(We){for(var bt=l(k);bt!==null;){if(bt.callback===null)h(k);else if(bt.startTime<=We)h(k),bt.sortIndex=bt.expirationTime,n(C,bt);else break;bt=l(k)}}function Q(We){if(K=!1,V(We),!q)if(l(C)!==null)q=!0,Ot(ue);else{var bt=l(k);bt!==null&&on(Q,bt.startTime-We)}}function ue(We,bt){q=!1,K&&(K=!1,W(Ce),Ce=-1),Z=!0;var ft=F;try{for(V(bt),U=l(C);U!==null&&(!(U.expirationTime>bt)||We&&!Ne());){var je=U.callback;if(typeof je=="function"){U.callback=null,F=U.priorityLevel;var Je=je(U.expirationTime<=bt);bt=t.unstable_now(),typeof Je=="function"?U.callback=Je:U===l(C)&&h(C),V(bt)}else h(C);U=l(C)}if(U!==null)var et=!0;else{var tt=l(k);tt!==null&&on(Q,tt.startTime-bt),et=!1}return et}finally{U=null,F=ft,Z=!1}}var fe=!1,we=null,Ce=-1,Te=5,Se=-1;function Ne(){return!(t.unstable_now()-Se<Te)}function Ue(){if(we!==null){var We=t.unstable_now();Se=We;var bt=!0;try{bt=we(!0,We)}finally{bt?Ve():(fe=!1,we=null)}}else fe=!1}var Ve;if(typeof O=="function")Ve=function(){O(Ue)};else if(typeof MessageChannel<"u"){var St=new MessageChannel,kt=St.port2;St.port1.onmessage=Ue,Ve=function(){kt.postMessage(null)}}else Ve=function(){Y(Ue,0)};function Ot(We){we=We,fe||(fe=!0,Ve())}function on(We,bt){Ce=Y(function(){We(t.unstable_now())},bt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(We){We.callback=null},t.unstable_continueExecution=function(){q||Z||(q=!0,Ot(ue))},t.unstable_forceFrameRate=function(We){0>We||125<We?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Te=0<We?Math.floor(1e3/We):5},t.unstable_getCurrentPriorityLevel=function(){return F},t.unstable_getFirstCallbackNode=function(){return l(C)},t.unstable_next=function(We){switch(F){case 1:case 2:case 3:var bt=3;break;default:bt=F}var ft=F;F=bt;try{return We()}finally{F=ft}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(We,bt){switch(We){case 1:case 2:case 3:case 4:case 5:break;default:We=3}var ft=F;F=We;try{return bt()}finally{F=ft}},t.unstable_scheduleCallback=function(We,bt,ft){var je=t.unstable_now();switch(typeof ft=="object"&&ft!==null?(ft=ft.delay,ft=typeof ft=="number"&&0<ft?je+ft:je):ft=je,We){case 1:var Je=-1;break;case 2:Je=250;break;case 5:Je=1073741823;break;case 4:Je=1e4;break;default:Je=5e3}return Je=ft+Je,We={id:B++,callback:bt,priorityLevel:We,startTime:ft,expirationTime:Je,sortIndex:-1},ft>je?(We.sortIndex=ft,n(k,We),l(C)===null&&We===l(k)&&(K?(W(Ce),Ce=-1):K=!0,on(Q,ft-je))):(We.sortIndex=Je,n(C,We),q||Z||(q=!0,Ot(ue))),We},t.unstable_shouldYield=Ne,t.unstable_wrapCallback=function(We){var bt=F;return function(){var ft=F;F=bt;try{return We.apply(this,arguments)}finally{F=ft}}}})(lS);aS.exports=lS;var Ok=aS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nk=xt,Ji=Ok;function pt(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,l=1;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cS=new Set,Xd={};function sc(t,n){Mu(t,n),Mu(t+"Capture",n)}function Mu(t,n){for(Xd[t]=n,t=0;t<n.length;t++)cS.add(n[t])}var Ks=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ky=Object.prototype.hasOwnProperty,Uk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yb={},Jb={};function jk(t){return Ky.call(Jb,t)?!0:Ky.call(Yb,t)?!1:Uk.test(t)?Jb[t]=!0:(Yb[t]=!0,!1)}function Vk(t,n,l,h){if(l!==null&&l.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return h?!1:l!==null?!l.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Gk(t,n,l,h){if(n===null||typeof n>"u"||Vk(t,n,l,h))return!0;if(h)return!1;if(l!==null)switch(l.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function xi(t,n,l,h,m,x,b){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=t,this.type=n,this.sanitizeURL=x,this.removeEmptyString=b}var Kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kr[t]=new xi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];Kr[n]=new xi(n,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kr[t]=new xi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kr[t]=new xi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kr[t]=new xi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kr[t]=new xi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kr[t]=new xi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kr[t]=new xi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kr[t]=new xi(t,5,!1,t.toLowerCase(),null,!1,!1)});var o1=/[\-:]([a-z])/g;function s1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(o1,s1);Kr[n]=new xi(n,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(o1,s1);Kr[n]=new xi(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(o1,s1);Kr[n]=new xi(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kr[t]=new xi(t,1,!1,t.toLowerCase(),null,!1,!1)});Kr.xlinkHref=new xi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kr[t]=new xi(t,1,!1,t.toLowerCase(),null,!0,!0)});function a1(t,n,l,h){var m=Kr.hasOwnProperty(n)?Kr[n]:null;(m!==null?m.type!==0:h||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Gk(n,l,m,h)&&(l=null),h||m===null?jk(n)&&(l===null?t.removeAttribute(n):t.setAttribute(n,""+l)):m.mustUseProperty?t[m.propertyName]=l===null?m.type===3?!1:"":l:(n=m.attributeName,h=m.attributeNamespace,l===null?t.removeAttribute(n):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,h?t.setAttributeNS(h,n,l):t.setAttribute(n,l))))}var ea=Nk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Kf=Symbol.for("react.element"),cu=Symbol.for("react.portal"),uu=Symbol.for("react.fragment"),l1=Symbol.for("react.strict_mode"),Yy=Symbol.for("react.profiler"),uS=Symbol.for("react.provider"),hS=Symbol.for("react.context"),c1=Symbol.for("react.forward_ref"),Jy=Symbol.for("react.suspense"),Qy=Symbol.for("react.suspense_list"),u1=Symbol.for("react.memo"),Ba=Symbol.for("react.lazy"),dS=Symbol.for("react.offscreen"),Qb=Symbol.iterator;function Td(t){return t===null||typeof t!="object"?null:(t=Qb&&t[Qb]||t["@@iterator"],typeof t=="function"?t:null)}var ur=Object.assign,k_;function Bd(t){if(k_===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);k_=n&&n[1]||""}return`
`+k_+t}var M_=!1;function D_(t,n){if(!t||M_)return"";M_=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(k){var h=k}Reflect.construct(t,[],n)}else{try{n.call()}catch(k){h=k}t.call(n.prototype)}else{try{throw Error()}catch(k){h=k}t()}}catch(k){if(k&&h&&typeof k.stack=="string"){for(var m=k.stack.split(`
`),x=h.stack.split(`
`),b=m.length-1,s=x.length-1;1<=b&&0<=s&&m[b]!==x[s];)s--;for(;1<=b&&0<=s;b--,s--)if(m[b]!==x[s]){if(b!==1||s!==1)do if(b--,s--,0>s||m[b]!==x[s]){var C=`
`+m[b].replace(" at new "," at ");return t.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",t.displayName)),C}while(1<=b&&0<=s);break}}}finally{M_=!1,Error.prepareStackTrace=l}return(t=t?t.displayName||t.name:"")?Bd(t):""}function qk(t){switch(t.tag){case 5:return Bd(t.type);case 16:return Bd("Lazy");case 13:return Bd("Suspense");case 19:return Bd("SuspenseList");case 0:case 2:case 15:return t=D_(t.type,!1),t;case 11:return t=D_(t.type.render,!1),t;case 1:return t=D_(t.type,!0),t;default:return""}}function ex(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case uu:return"Fragment";case cu:return"Portal";case Yy:return"Profiler";case l1:return"StrictMode";case Jy:return"Suspense";case Qy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case hS:return(t.displayName||"Context")+".Consumer";case uS:return(t._context.displayName||"Context")+".Provider";case c1:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case u1:return n=t.displayName||null,n!==null?n:ex(t.type)||"Memo";case Ba:n=t._payload,t=t._init;try{return ex(t(n))}catch{}}return null}function $k(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ex(n);case 8:return n===l1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Za(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pS(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Wk(t){var n=pS(t)?"checked":"value",l=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),h=""+t[n];if(!t.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,x=l.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return m.call(this)},set:function(b){h=""+b,x.call(this,b)}}),Object.defineProperty(t,n,{enumerable:l.enumerable}),{getValue:function(){return h},setValue:function(b){h=""+b},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Yf(t){t._valueTracker||(t._valueTracker=Wk(t))}function fS(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var l=n.getValue(),h="";return t&&(h=pS(t)?t.checked?"true":"false":t.value),t=h,t!==l?(n.setValue(t),!0):!1}function N0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tx(t,n){var l=n.checked;return ur({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??t._wrapperState.initialChecked})}function e2(t,n){var l=n.defaultValue==null?"":n.defaultValue,h=n.checked!=null?n.checked:n.defaultChecked;l=Za(n.value!=null?n.value:l),t._wrapperState={initialChecked:h,initialValue:l,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function mS(t,n){n=n.checked,n!=null&&a1(t,"checked",n,!1)}function nx(t,n){mS(t,n);var l=Za(n.value),h=n.type;if(l!=null)h==="number"?(l===0&&t.value===""||t.value!=l)&&(t.value=""+l):t.value!==""+l&&(t.value=""+l);else if(h==="submit"||h==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?rx(t,n.type,l):n.hasOwnProperty("defaultValue")&&rx(t,n.type,Za(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function t2(t,n,l){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var h=n.type;if(!(h!=="submit"&&h!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,l||n===t.value||(t.value=n),t.defaultValue=n}l=t.name,l!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,l!==""&&(t.name=l)}function rx(t,n,l){(n!=="number"||N0(t.ownerDocument)!==t)&&(l==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+l&&(t.defaultValue=""+l))}var Ld=Array.isArray;function bu(t,n,l,h){if(t=t.options,n){n={};for(var m=0;m<l.length;m++)n["$"+l[m]]=!0;for(l=0;l<t.length;l++)m=n.hasOwnProperty("$"+t[l].value),t[l].selected!==m&&(t[l].selected=m),m&&h&&(t[l].defaultSelected=!0)}else{for(l=""+Za(l),n=null,m=0;m<t.length;m++){if(t[m].value===l){t[m].selected=!0,h&&(t[m].defaultSelected=!0);return}n!==null||t[m].disabled||(n=t[m])}n!==null&&(n.selected=!0)}}function ix(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(pt(91));return ur({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function n2(t,n){var l=n.value;if(l==null){if(l=n.children,n=n.defaultValue,l!=null){if(n!=null)throw Error(pt(92));if(Ld(l)){if(1<l.length)throw Error(pt(93));l=l[0]}n=l}n==null&&(n=""),l=n}t._wrapperState={initialValue:Za(l)}}function gS(t,n){var l=Za(n.value),h=Za(n.defaultValue);l!=null&&(l=""+l,l!==t.value&&(t.value=l),n.defaultValue==null&&t.defaultValue!==l&&(t.defaultValue=l)),h!=null&&(t.defaultValue=""+h)}function r2(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function _S(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ox(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?_S(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Jf,yS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,l,h,m){MSApp.execUnsafeLocalFunction(function(){return t(n,l,h,m)})}:t}(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(Jf=Jf||document.createElement("div"),Jf.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Jf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function Kd(t,n){if(n){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=n;return}}t.textContent=n}var Nd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hk=["Webkit","ms","Moz","O"];Object.keys(Nd).forEach(function(t){Hk.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),Nd[n]=Nd[t]})});function xS(t,n,l){return n==null||typeof n=="boolean"||n===""?"":l||typeof n!="number"||n===0||Nd.hasOwnProperty(t)&&Nd[t]?(""+n).trim():n+"px"}function vS(t,n){t=t.style;for(var l in n)if(n.hasOwnProperty(l)){var h=l.indexOf("--")===0,m=xS(l,n[l],h);l==="float"&&(l="cssFloat"),h?t.setProperty(l,m):t[l]=m}}var Zk=ur({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sx(t,n){if(n){if(Zk[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(pt(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(pt(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(pt(61))}if(n.style!=null&&typeof n.style!="object")throw Error(pt(62))}}function ax(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lx=null;function h1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var cx=null,Eu=null,Tu=null;function i2(t){if(t=xp(t)){if(typeof cx!="function")throw Error(pt(280));var n=t.stateNode;n&&(n=bm(n),cx(t.stateNode,t.type,n))}}function wS(t){Eu?Tu?Tu.push(t):Tu=[t]:Eu=t}function bS(){if(Eu){var t=Eu,n=Tu;if(Tu=Eu=null,i2(t),n)for(t=0;t<n.length;t++)i2(n[t])}}function ES(t,n){return t(n)}function TS(){}var P_=!1;function SS(t,n,l){if(P_)return t(n,l);P_=!0;try{return ES(t,n,l)}finally{P_=!1,(Eu!==null||Tu!==null)&&(TS(),bS())}}function Yd(t,n){var l=t.stateNode;if(l===null)return null;var h=bm(l);if(h===null)return null;l=h[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(t=t.type,h=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!h;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(pt(231,n,typeof l));return l}var ux=!1;if(Ks)try{var Sd={};Object.defineProperty(Sd,"passive",{get:function(){ux=!0}}),window.addEventListener("test",Sd,Sd),window.removeEventListener("test",Sd,Sd)}catch{ux=!1}function Xk(t,n,l,h,m,x,b,s,C){var k=Array.prototype.slice.call(arguments,3);try{n.apply(l,k)}catch(B){this.onError(B)}}var Ud=!1,U0=null,j0=!1,hx=null,Kk={onError:function(t){Ud=!0,U0=t}};function Yk(t,n,l,h,m,x,b,s,C){Ud=!1,U0=null,Xk.apply(Kk,arguments)}function Jk(t,n,l,h,m,x,b,s,C){if(Yk.apply(this,arguments),Ud){if(Ud){var k=U0;Ud=!1,U0=null}else throw Error(pt(198));j0||(j0=!0,hx=k)}}function ac(t){var n=t,l=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,n.flags&4098&&(l=n.return),t=n.return;while(t)}return n.tag===3?l:null}function CS(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function o2(t){if(ac(t)!==t)throw Error(pt(188))}function Qk(t){var n=t.alternate;if(!n){if(n=ac(t),n===null)throw Error(pt(188));return n!==t?null:t}for(var l=t,h=n;;){var m=l.return;if(m===null)break;var x=m.alternate;if(x===null){if(h=m.return,h!==null){l=h;continue}break}if(m.child===x.child){for(x=m.child;x;){if(x===l)return o2(m),t;if(x===h)return o2(m),n;x=x.sibling}throw Error(pt(188))}if(l.return!==h.return)l=m,h=x;else{for(var b=!1,s=m.child;s;){if(s===l){b=!0,l=m,h=x;break}if(s===h){b=!0,h=m,l=x;break}s=s.sibling}if(!b){for(s=x.child;s;){if(s===l){b=!0,l=x,h=m;break}if(s===h){b=!0,h=x,l=m;break}s=s.sibling}if(!b)throw Error(pt(189))}}if(l.alternate!==h)throw Error(pt(190))}if(l.tag!==3)throw Error(pt(188));return l.stateNode.current===l?t:n}function AS(t){return t=Qk(t),t!==null?IS(t):null}function IS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=IS(t);if(n!==null)return n;t=t.sibling}return null}var kS=Ji.unstable_scheduleCallback,s2=Ji.unstable_cancelCallback,eM=Ji.unstable_shouldYield,tM=Ji.unstable_requestPaint,mr=Ji.unstable_now,nM=Ji.unstable_getCurrentPriorityLevel,d1=Ji.unstable_ImmediatePriority,MS=Ji.unstable_UserBlockingPriority,V0=Ji.unstable_NormalPriority,rM=Ji.unstable_LowPriority,DS=Ji.unstable_IdlePriority,ym=null,vs=null;function iM(t){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(ym,t,void 0,(t.current.flags&128)===128)}catch{}}var Xo=Math.clz32?Math.clz32:aM,oM=Math.log,sM=Math.LN2;function aM(t){return t>>>=0,t===0?32:31-(oM(t)/sM|0)|0}var Qf=64,e0=4194304;function Rd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function G0(t,n){var l=t.pendingLanes;if(l===0)return 0;var h=0,m=t.suspendedLanes,x=t.pingedLanes,b=l&268435455;if(b!==0){var s=b&~m;s!==0?h=Rd(s):(x&=b,x!==0&&(h=Rd(x)))}else b=l&~m,b!==0?h=Rd(b):x!==0&&(h=Rd(x));if(h===0)return 0;if(n!==0&&n!==h&&!(n&m)&&(m=h&-h,x=n&-n,m>=x||m===16&&(x&4194240)!==0))return n;if(h&4&&(h|=l&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=h;0<n;)l=31-Xo(n),m=1<<l,h|=t[l],n&=~m;return h}function lM(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cM(t,n){for(var l=t.suspendedLanes,h=t.pingedLanes,m=t.expirationTimes,x=t.pendingLanes;0<x;){var b=31-Xo(x),s=1<<b,C=m[b];C===-1?(!(s&l)||s&h)&&(m[b]=lM(s,n)):C<=n&&(t.expiredLanes|=s),x&=~s}}function dx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function PS(){var t=Qf;return Qf<<=1,!(Qf&4194240)&&(Qf=64),t}function z_(t){for(var n=[],l=0;31>l;l++)n.push(t);return n}function _p(t,n,l){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-Xo(n),t[n]=l}function uM(t,n){var l=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var h=t.eventTimes;for(t=t.expirationTimes;0<l;){var m=31-Xo(l),x=1<<m;n[m]=0,h[m]=-1,t[m]=-1,l&=~x}}function p1(t,n){var l=t.entangledLanes|=n;for(t=t.entanglements;l;){var h=31-Xo(l),m=1<<h;m&n|t[h]&n&&(t[h]|=n),l&=~m}}var Ln=0;function zS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var BS,f1,LS,RS,FS,px=!1,t0=[],Ua=null,ja=null,Va=null,Jd=new Map,Qd=new Map,Ra=[],hM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function a2(t,n){switch(t){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":ja=null;break;case"mouseover":case"mouseout":Va=null;break;case"pointerover":case"pointerout":Jd.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qd.delete(n.pointerId)}}function Cd(t,n,l,h,m,x){return t===null||t.nativeEvent!==x?(t={blockedOn:n,domEventName:l,eventSystemFlags:h,nativeEvent:x,targetContainers:[m]},n!==null&&(n=xp(n),n!==null&&f1(n)),t):(t.eventSystemFlags|=h,n=t.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),t)}function dM(t,n,l,h,m){switch(n){case"focusin":return Ua=Cd(Ua,t,n,l,h,m),!0;case"dragenter":return ja=Cd(ja,t,n,l,h,m),!0;case"mouseover":return Va=Cd(Va,t,n,l,h,m),!0;case"pointerover":var x=m.pointerId;return Jd.set(x,Cd(Jd.get(x)||null,t,n,l,h,m)),!0;case"gotpointercapture":return x=m.pointerId,Qd.set(x,Cd(Qd.get(x)||null,t,n,l,h,m)),!0}return!1}function OS(t){var n=Hl(t.target);if(n!==null){var l=ac(n);if(l!==null){if(n=l.tag,n===13){if(n=CS(l),n!==null){t.blockedOn=n,FS(t.priority,function(){LS(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function w0(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var l=fx(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(l===null){l=t.nativeEvent;var h=new l.constructor(l.type,l);lx=h,l.target.dispatchEvent(h),lx=null}else return n=xp(l),n!==null&&f1(n),t.blockedOn=l,!1;n.shift()}return!0}function l2(t,n,l){w0(t)&&l.delete(n)}function pM(){px=!1,Ua!==null&&w0(Ua)&&(Ua=null),ja!==null&&w0(ja)&&(ja=null),Va!==null&&w0(Va)&&(Va=null),Jd.forEach(l2),Qd.forEach(l2)}function Ad(t,n){t.blockedOn===n&&(t.blockedOn=null,px||(px=!0,Ji.unstable_scheduleCallback(Ji.unstable_NormalPriority,pM)))}function ep(t){function n(m){return Ad(m,t)}if(0<t0.length){Ad(t0[0],t);for(var l=1;l<t0.length;l++){var h=t0[l];h.blockedOn===t&&(h.blockedOn=null)}}for(Ua!==null&&Ad(Ua,t),ja!==null&&Ad(ja,t),Va!==null&&Ad(Va,t),Jd.forEach(n),Qd.forEach(n),l=0;l<Ra.length;l++)h=Ra[l],h.blockedOn===t&&(h.blockedOn=null);for(;0<Ra.length&&(l=Ra[0],l.blockedOn===null);)OS(l),l.blockedOn===null&&Ra.shift()}var Su=ea.ReactCurrentBatchConfig,q0=!0;function fM(t,n,l,h){var m=Ln,x=Su.transition;Su.transition=null;try{Ln=1,m1(t,n,l,h)}finally{Ln=m,Su.transition=x}}function mM(t,n,l,h){var m=Ln,x=Su.transition;Su.transition=null;try{Ln=4,m1(t,n,l,h)}finally{Ln=m,Su.transition=x}}function m1(t,n,l,h){if(q0){var m=fx(t,n,l,h);if(m===null)G_(t,n,h,$0,l),a2(t,h);else if(dM(m,t,n,l,h))h.stopPropagation();else if(a2(t,h),n&4&&-1<hM.indexOf(t)){for(;m!==null;){var x=xp(m);if(x!==null&&BS(x),x=fx(t,n,l,h),x===null&&G_(t,n,h,$0,l),x===m)break;m=x}m!==null&&h.stopPropagation()}else G_(t,n,h,null,l)}}var $0=null;function fx(t,n,l,h){if($0=null,t=h1(h),t=Hl(t),t!==null)if(n=ac(t),n===null)t=null;else if(l=n.tag,l===13){if(t=CS(n),t!==null)return t;t=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return $0=t,null}function NS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nM()){case d1:return 1;case MS:return 4;case V0:case rM:return 16;case DS:return 536870912;default:return 16}default:return 16}}var Oa=null,g1=null,b0=null;function US(){if(b0)return b0;var t,n=g1,l=n.length,h,m="value"in Oa?Oa.value:Oa.textContent,x=m.length;for(t=0;t<l&&n[t]===m[t];t++);var b=l-t;for(h=1;h<=b&&n[l-h]===m[x-h];h++);return b0=m.slice(t,1<h?1-h:void 0)}function E0(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function n0(){return!0}function c2(){return!1}function eo(t){function n(l,h,m,x,b){this._reactName=l,this._targetInst=m,this.type=h,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(l=t[s],this[s]=l?l(x):x[s]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?n0:c2,this.isPropagationStopped=c2,this}return ur(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=n0)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=n0)},persist:function(){},isPersistent:n0}),n}var Uu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_1=eo(Uu),yp=ur({},Uu,{view:0,detail:0}),gM=eo(yp),B_,L_,Id,xm=ur({},yp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Id&&(Id&&t.type==="mousemove"?(B_=t.screenX-Id.screenX,L_=t.screenY-Id.screenY):L_=B_=0,Id=t),B_)},movementY:function(t){return"movementY"in t?t.movementY:L_}}),u2=eo(xm),_M=ur({},xm,{dataTransfer:0}),yM=eo(_M),xM=ur({},yp,{relatedTarget:0}),R_=eo(xM),vM=ur({},Uu,{animationName:0,elapsedTime:0,pseudoElement:0}),wM=eo(vM),bM=ur({},Uu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),EM=eo(bM),TM=ur({},Uu,{data:0}),h2=eo(TM),SM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},AM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IM(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=AM[t])?!!n[t]:!1}function y1(){return IM}var kM=ur({},yp,{key:function(t){if(t.key){var n=SM[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=E0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?CM[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y1,charCode:function(t){return t.type==="keypress"?E0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?E0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),MM=eo(kM),DM=ur({},xm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d2=eo(DM),PM=ur({},yp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y1}),zM=eo(PM),BM=ur({},Uu,{propertyName:0,elapsedTime:0,pseudoElement:0}),LM=eo(BM),RM=ur({},xm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),FM=eo(RM),OM=[9,13,27,32],x1=Ks&&"CompositionEvent"in window,jd=null;Ks&&"documentMode"in document&&(jd=document.documentMode);var NM=Ks&&"TextEvent"in window&&!jd,jS=Ks&&(!x1||jd&&8<jd&&11>=jd),p2=String.fromCharCode(32),f2=!1;function VS(t,n){switch(t){case"keyup":return OM.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var hu=!1;function UM(t,n){switch(t){case"compositionend":return GS(n);case"keypress":return n.which!==32?null:(f2=!0,p2);case"textInput":return t=n.data,t===p2&&f2?null:t;default:return null}}function jM(t,n){if(hu)return t==="compositionend"||!x1&&VS(t,n)?(t=US(),b0=g1=Oa=null,hu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return jS&&n.locale!=="ko"?null:n.data;default:return null}}var VM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m2(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!VM[t.type]:n==="textarea"}function qS(t,n,l,h){wS(h),n=W0(n,"onChange"),0<n.length&&(l=new _1("onChange","change",null,l,h),t.push({event:l,listeners:n}))}var Vd=null,tp=null;function GM(t){tC(t,0)}function vm(t){var n=fu(t);if(fS(n))return t}function qM(t,n){if(t==="change")return n}var $S=!1;if(Ks){var F_;if(Ks){var O_="oninput"in document;if(!O_){var g2=document.createElement("div");g2.setAttribute("oninput","return;"),O_=typeof g2.oninput=="function"}F_=O_}else F_=!1;$S=F_&&(!document.documentMode||9<document.documentMode)}function _2(){Vd&&(Vd.detachEvent("onpropertychange",WS),tp=Vd=null)}function WS(t){if(t.propertyName==="value"&&vm(tp)){var n=[];qS(n,tp,t,h1(t)),SS(GM,n)}}function $M(t,n,l){t==="focusin"?(_2(),Vd=n,tp=l,Vd.attachEvent("onpropertychange",WS)):t==="focusout"&&_2()}function WM(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vm(tp)}function HM(t,n){if(t==="click")return vm(n)}function ZM(t,n){if(t==="input"||t==="change")return vm(n)}function XM(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Qo=typeof Object.is=="function"?Object.is:XM;function np(t,n){if(Qo(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var l=Object.keys(t),h=Object.keys(n);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var m=l[h];if(!Ky.call(n,m)||!Qo(t[m],n[m]))return!1}return!0}function y2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function x2(t,n){var l=y2(t);t=0;for(var h;l;){if(l.nodeType===3){if(h=t+l.textContent.length,t<=n&&h>=n)return{node:l,offset:n-t};t=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=y2(l)}}function HS(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?HS(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function ZS(){for(var t=window,n=N0();n instanceof t.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)t=n.contentWindow;else break;n=N0(t.document)}return n}function v1(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function KM(t){var n=ZS(),l=t.focusedElem,h=t.selectionRange;if(n!==l&&l&&l.ownerDocument&&HS(l.ownerDocument.documentElement,l)){if(h!==null&&v1(l)){if(n=h.start,t=h.end,t===void 0&&(t=n),"selectionStart"in l)l.selectionStart=n,l.selectionEnd=Math.min(t,l.value.length);else if(t=(n=l.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var m=l.textContent.length,x=Math.min(h.start,m);h=h.end===void 0?x:Math.min(h.end,m),!t.extend&&x>h&&(m=h,h=x,x=m),m=x2(l,x);var b=x2(l,h);m&&b&&(t.rangeCount!==1||t.anchorNode!==m.node||t.anchorOffset!==m.offset||t.focusNode!==b.node||t.focusOffset!==b.offset)&&(n=n.createRange(),n.setStart(m.node,m.offset),t.removeAllRanges(),x>h?(t.addRange(n),t.extend(b.node,b.offset)):(n.setEnd(b.node,b.offset),t.addRange(n)))}}for(n=[],t=l;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<n.length;l++)t=n[l],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var YM=Ks&&"documentMode"in document&&11>=document.documentMode,du=null,mx=null,Gd=null,gx=!1;function v2(t,n,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;gx||du==null||du!==N0(h)||(h=du,"selectionStart"in h&&v1(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Gd&&np(Gd,h)||(Gd=h,h=W0(mx,"onSelect"),0<h.length&&(n=new _1("onSelect","select",null,n,l),t.push({event:n,listeners:h}),n.target=du)))}function r0(t,n){var l={};return l[t.toLowerCase()]=n.toLowerCase(),l["Webkit"+t]="webkit"+n,l["Moz"+t]="moz"+n,l}var pu={animationend:r0("Animation","AnimationEnd"),animationiteration:r0("Animation","AnimationIteration"),animationstart:r0("Animation","AnimationStart"),transitionend:r0("Transition","TransitionEnd")},N_={},XS={};Ks&&(XS=document.createElement("div").style,"AnimationEvent"in window||(delete pu.animationend.animation,delete pu.animationiteration.animation,delete pu.animationstart.animation),"TransitionEvent"in window||delete pu.transitionend.transition);function wm(t){if(N_[t])return N_[t];if(!pu[t])return t;var n=pu[t],l;for(l in n)if(n.hasOwnProperty(l)&&l in XS)return N_[t]=n[l];return t}var KS=wm("animationend"),YS=wm("animationiteration"),JS=wm("animationstart"),QS=wm("transitionend"),eC=new Map,w2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ja(t,n){eC.set(t,n),sc(n,[t])}for(var U_=0;U_<w2.length;U_++){var j_=w2[U_],JM=j_.toLowerCase(),QM=j_[0].toUpperCase()+j_.slice(1);Ja(JM,"on"+QM)}Ja(KS,"onAnimationEnd");Ja(YS,"onAnimationIteration");Ja(JS,"onAnimationStart");Ja("dblclick","onDoubleClick");Ja("focusin","onFocus");Ja("focusout","onBlur");Ja(QS,"onTransitionEnd");Mu("onMouseEnter",["mouseout","mouseover"]);Mu("onMouseLeave",["mouseout","mouseover"]);Mu("onPointerEnter",["pointerout","pointerover"]);Mu("onPointerLeave",["pointerout","pointerover"]);sc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sc("onBeforeInput",["compositionend","keypress","textInput","paste"]);sc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fd));function b2(t,n,l){var h=t.type||"unknown-event";t.currentTarget=l,Jk(h,n,void 0,t),t.currentTarget=null}function tC(t,n){n=(n&4)!==0;for(var l=0;l<t.length;l++){var h=t[l],m=h.event;h=h.listeners;e:{var x=void 0;if(n)for(var b=h.length-1;0<=b;b--){var s=h[b],C=s.instance,k=s.currentTarget;if(s=s.listener,C!==x&&m.isPropagationStopped())break e;b2(m,s,k),x=C}else for(b=0;b<h.length;b++){if(s=h[b],C=s.instance,k=s.currentTarget,s=s.listener,C!==x&&m.isPropagationStopped())break e;b2(m,s,k),x=C}}}if(j0)throw t=hx,j0=!1,hx=null,t}function Hn(t,n){var l=n[wx];l===void 0&&(l=n[wx]=new Set);var h=t+"__bubble";l.has(h)||(nC(n,t,2,!1),l.add(h))}function V_(t,n,l){var h=0;n&&(h|=4),nC(l,t,h,n)}var i0="_reactListening"+Math.random().toString(36).slice(2);function rp(t){if(!t[i0]){t[i0]=!0,cS.forEach(function(l){l!=="selectionchange"&&(e5.has(l)||V_(l,!1,t),V_(l,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[i0]||(n[i0]=!0,V_("selectionchange",!1,n))}}function nC(t,n,l,h){switch(NS(n)){case 1:var m=fM;break;case 4:m=mM;break;default:m=m1}l=m.bind(null,n,l,t),m=void 0,!ux||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),h?m!==void 0?t.addEventListener(n,l,{capture:!0,passive:m}):t.addEventListener(n,l,!0):m!==void 0?t.addEventListener(n,l,{passive:m}):t.addEventListener(n,l,!1)}function G_(t,n,l,h,m){var x=h;if(!(n&1)&&!(n&2)&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var s=h.stateNode.containerInfo;if(s===m||s.nodeType===8&&s.parentNode===m)break;if(b===4)for(b=h.return;b!==null;){var C=b.tag;if((C===3||C===4)&&(C=b.stateNode.containerInfo,C===m||C.nodeType===8&&C.parentNode===m))return;b=b.return}for(;s!==null;){if(b=Hl(s),b===null)return;if(C=b.tag,C===5||C===6){h=x=b;continue e}s=s.parentNode}}h=h.return}SS(function(){var k=x,B=h1(l),U=[];e:{var F=eC.get(t);if(F!==void 0){var Z=_1,q=t;switch(t){case"keypress":if(E0(l)===0)break e;case"keydown":case"keyup":Z=MM;break;case"focusin":q="focus",Z=R_;break;case"focusout":q="blur",Z=R_;break;case"beforeblur":case"afterblur":Z=R_;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=u2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=yM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=zM;break;case KS:case YS:case JS:Z=wM;break;case QS:Z=LM;break;case"scroll":Z=gM;break;case"wheel":Z=FM;break;case"copy":case"cut":case"paste":Z=EM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=d2}var K=(n&4)!==0,Y=!K&&t==="scroll",W=K?F!==null?F+"Capture":null:F;K=[];for(var O=k,V;O!==null;){V=O;var Q=V.stateNode;if(V.tag===5&&Q!==null&&(V=Q,W!==null&&(Q=Yd(O,W),Q!=null&&K.push(ip(O,Q,V)))),Y)break;O=O.return}0<K.length&&(F=new Z(F,q,null,l,B),U.push({event:F,listeners:K}))}}if(!(n&7)){e:{if(F=t==="mouseover"||t==="pointerover",Z=t==="mouseout"||t==="pointerout",F&&l!==lx&&(q=l.relatedTarget||l.fromElement)&&(Hl(q)||q[Ys]))break e;if((Z||F)&&(F=B.window===B?B:(F=B.ownerDocument)?F.defaultView||F.parentWindow:window,Z?(q=l.relatedTarget||l.toElement,Z=k,q=q?Hl(q):null,q!==null&&(Y=ac(q),q!==Y||q.tag!==5&&q.tag!==6)&&(q=null)):(Z=null,q=k),Z!==q)){if(K=u2,Q="onMouseLeave",W="onMouseEnter",O="mouse",(t==="pointerout"||t==="pointerover")&&(K=d2,Q="onPointerLeave",W="onPointerEnter",O="pointer"),Y=Z==null?F:fu(Z),V=q==null?F:fu(q),F=new K(Q,O+"leave",Z,l,B),F.target=Y,F.relatedTarget=V,Q=null,Hl(B)===k&&(K=new K(W,O+"enter",q,l,B),K.target=V,K.relatedTarget=Y,Q=K),Y=Q,Z&&q)t:{for(K=Z,W=q,O=0,V=K;V;V=lu(V))O++;for(V=0,Q=W;Q;Q=lu(Q))V++;for(;0<O-V;)K=lu(K),O--;for(;0<V-O;)W=lu(W),V--;for(;O--;){if(K===W||W!==null&&K===W.alternate)break t;K=lu(K),W=lu(W)}K=null}else K=null;Z!==null&&E2(U,F,Z,K,!1),q!==null&&Y!==null&&E2(U,Y,q,K,!0)}}e:{if(F=k?fu(k):window,Z=F.nodeName&&F.nodeName.toLowerCase(),Z==="select"||Z==="input"&&F.type==="file")var ue=qM;else if(m2(F))if($S)ue=ZM;else{ue=WM;var fe=$M}else(Z=F.nodeName)&&Z.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(ue=HM);if(ue&&(ue=ue(t,k))){qS(U,ue,l,B);break e}fe&&fe(t,F,k),t==="focusout"&&(fe=F._wrapperState)&&fe.controlled&&F.type==="number"&&rx(F,"number",F.value)}switch(fe=k?fu(k):window,t){case"focusin":(m2(fe)||fe.contentEditable==="true")&&(du=fe,mx=k,Gd=null);break;case"focusout":Gd=mx=du=null;break;case"mousedown":gx=!0;break;case"contextmenu":case"mouseup":case"dragend":gx=!1,v2(U,l,B);break;case"selectionchange":if(YM)break;case"keydown":case"keyup":v2(U,l,B)}var we;if(x1)e:{switch(t){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else hu?VS(t,l)&&(Ce="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(Ce="onCompositionStart");Ce&&(jS&&l.locale!=="ko"&&(hu||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&hu&&(we=US()):(Oa=B,g1="value"in Oa?Oa.value:Oa.textContent,hu=!0)),fe=W0(k,Ce),0<fe.length&&(Ce=new h2(Ce,t,null,l,B),U.push({event:Ce,listeners:fe}),we?Ce.data=we:(we=GS(l),we!==null&&(Ce.data=we)))),(we=NM?UM(t,l):jM(t,l))&&(k=W0(k,"onBeforeInput"),0<k.length&&(B=new h2("onBeforeInput","beforeinput",null,l,B),U.push({event:B,listeners:k}),B.data=we))}tC(U,n)})}function ip(t,n,l){return{instance:t,listener:n,currentTarget:l}}function W0(t,n){for(var l=n+"Capture",h=[];t!==null;){var m=t,x=m.stateNode;m.tag===5&&x!==null&&(m=x,x=Yd(t,l),x!=null&&h.unshift(ip(t,x,m)),x=Yd(t,n),x!=null&&h.push(ip(t,x,m))),t=t.return}return h}function lu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function E2(t,n,l,h,m){for(var x=n._reactName,b=[];l!==null&&l!==h;){var s=l,C=s.alternate,k=s.stateNode;if(C!==null&&C===h)break;s.tag===5&&k!==null&&(s=k,m?(C=Yd(l,x),C!=null&&b.unshift(ip(l,C,s))):m||(C=Yd(l,x),C!=null&&b.push(ip(l,C,s)))),l=l.return}b.length!==0&&t.push({event:n,listeners:b})}var t5=/\r\n?/g,n5=/\u0000|\uFFFD/g;function T2(t){return(typeof t=="string"?t:""+t).replace(t5,`
`).replace(n5,"")}function o0(t,n,l){if(n=T2(n),T2(t)!==n&&l)throw Error(pt(425))}function H0(){}var _x=null,yx=null;function xx(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var vx=typeof setTimeout=="function"?setTimeout:void 0,r5=typeof clearTimeout=="function"?clearTimeout:void 0,S2=typeof Promise=="function"?Promise:void 0,i5=typeof queueMicrotask=="function"?queueMicrotask:typeof S2<"u"?function(t){return S2.resolve(null).then(t).catch(o5)}:vx;function o5(t){setTimeout(function(){throw t})}function q_(t,n){var l=n,h=0;do{var m=l.nextSibling;if(t.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(h===0){t.removeChild(m),ep(n);return}h--}else l!=="$"&&l!=="$?"&&l!=="$!"||h++;l=m}while(l);ep(n)}function Ga(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function C2(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"){if(n===0)return t;n--}else l==="/$"&&n++}t=t.previousSibling}return null}var ju=Math.random().toString(36).slice(2),xs="__reactFiber$"+ju,op="__reactProps$"+ju,Ys="__reactContainer$"+ju,wx="__reactEvents$"+ju,s5="__reactListeners$"+ju,a5="__reactHandles$"+ju;function Hl(t){var n=t[xs];if(n)return n;for(var l=t.parentNode;l;){if(n=l[Ys]||l[xs]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(t=C2(t);t!==null;){if(l=t[xs])return l;t=C2(t)}return n}t=l,l=t.parentNode}return null}function xp(t){return t=t[xs]||t[Ys],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function fu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(pt(33))}function bm(t){return t[op]||null}var bx=[],mu=-1;function Qa(t){return{current:t}}function Zn(t){0>mu||(t.current=bx[mu],bx[mu]=null,mu--)}function Vn(t,n){mu++,bx[mu]=t.current,t.current=n}var Xa={},ui=Qa(Xa),Pi=Qa(!1),Ql=Xa;function Du(t,n){var l=t.type.contextTypes;if(!l)return Xa;var h=t.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===n)return h.__reactInternalMemoizedMaskedChildContext;var m={},x;for(x in l)m[x]=n[x];return h&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=m),m}function zi(t){return t=t.childContextTypes,t!=null}function Z0(){Zn(Pi),Zn(ui)}function A2(t,n,l){if(ui.current!==Xa)throw Error(pt(168));Vn(ui,n),Vn(Pi,l)}function rC(t,n,l){var h=t.stateNode;if(n=n.childContextTypes,typeof h.getChildContext!="function")return l;h=h.getChildContext();for(var m in h)if(!(m in n))throw Error(pt(108,$k(t)||"Unknown",m));return ur({},l,h)}function X0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xa,Ql=ui.current,Vn(ui,t),Vn(Pi,Pi.current),!0}function I2(t,n,l){var h=t.stateNode;if(!h)throw Error(pt(169));l?(t=rC(t,n,Ql),h.__reactInternalMemoizedMergedChildContext=t,Zn(Pi),Zn(ui),Vn(ui,t)):Zn(Pi),Vn(Pi,l)}var qs=null,Em=!1,$_=!1;function iC(t){qs===null?qs=[t]:qs.push(t)}function l5(t){Em=!0,iC(t)}function el(){if(!$_&&qs!==null){$_=!0;var t=0,n=Ln;try{var l=qs;for(Ln=1;t<l.length;t++){var h=l[t];do h=h(!0);while(h!==null)}qs=null,Em=!1}catch(m){throw qs!==null&&(qs=qs.slice(t+1)),kS(d1,el),m}finally{Ln=n,$_=!1}}return null}var gu=[],_u=0,K0=null,Y0=0,go=[],_o=0,ec=null,Hs=1,Zs="";function ql(t,n){gu[_u++]=Y0,gu[_u++]=K0,K0=t,Y0=n}function oC(t,n,l){go[_o++]=Hs,go[_o++]=Zs,go[_o++]=ec,ec=t;var h=Hs;t=Zs;var m=32-Xo(h)-1;h&=~(1<<m),l+=1;var x=32-Xo(n)+m;if(30<x){var b=m-m%5;x=(h&(1<<b)-1).toString(32),h>>=b,m-=b,Hs=1<<32-Xo(n)+m|l<<m|h,Zs=x+t}else Hs=1<<x|l<<m|h,Zs=t}function w1(t){t.return!==null&&(ql(t,1),oC(t,1,0))}function b1(t){for(;t===K0;)K0=gu[--_u],gu[_u]=null,Y0=gu[--_u],gu[_u]=null;for(;t===ec;)ec=go[--_o],go[_o]=null,Zs=go[--_o],go[_o]=null,Hs=go[--_o],go[_o]=null}var Ki=null,Xi=null,Jn=!1,Zo=null;function sC(t,n){var l=yo(5,null,null,0);l.elementType="DELETED",l.stateNode=n,l.return=t,n=t.deletions,n===null?(t.deletions=[l],t.flags|=16):n.push(l)}function k2(t,n){switch(t.tag){case 5:var l=t.type;return n=n.nodeType!==1||l.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Ki=t,Xi=Ga(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Ki=t,Xi=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(l=ec!==null?{id:Hs,overflow:Zs}:null,t.memoizedState={dehydrated:n,treeContext:l,retryLane:1073741824},l=yo(18,null,null,0),l.stateNode=n,l.return=t,t.child=l,Ki=t,Xi=null,!0):!1;default:return!1}}function Ex(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Tx(t){if(Jn){var n=Xi;if(n){var l=n;if(!k2(t,n)){if(Ex(t))throw Error(pt(418));n=Ga(l.nextSibling);var h=Ki;n&&k2(t,n)?sC(h,l):(t.flags=t.flags&-4097|2,Jn=!1,Ki=t)}}else{if(Ex(t))throw Error(pt(418));t.flags=t.flags&-4097|2,Jn=!1,Ki=t}}}function M2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ki=t}function s0(t){if(t!==Ki)return!1;if(!Jn)return M2(t),Jn=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!xx(t.type,t.memoizedProps)),n&&(n=Xi)){if(Ex(t))throw aC(),Error(pt(418));for(;n;)sC(t,n),n=Ga(n.nextSibling)}if(M2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(pt(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"){if(n===0){Xi=Ga(t.nextSibling);break e}n--}else l!=="$"&&l!=="$!"&&l!=="$?"||n++}t=t.nextSibling}Xi=null}}else Xi=Ki?Ga(t.stateNode.nextSibling):null;return!0}function aC(){for(var t=Xi;t;)t=Ga(t.nextSibling)}function Pu(){Xi=Ki=null,Jn=!1}function E1(t){Zo===null?Zo=[t]:Zo.push(t)}var c5=ea.ReactCurrentBatchConfig;function kd(t,n,l){if(t=l.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(pt(309));var h=l.stateNode}if(!h)throw Error(pt(147,t));var m=h,x=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===x?n.ref:(n=function(b){var s=m.refs;b===null?delete s[x]:s[x]=b},n._stringRef=x,n)}if(typeof t!="string")throw Error(pt(284));if(!l._owner)throw Error(pt(290,t))}return t}function a0(t,n){throw t=Object.prototype.toString.call(n),Error(pt(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function D2(t){var n=t._init;return n(t._payload)}function lC(t){function n(W,O){if(t){var V=W.deletions;V===null?(W.deletions=[O],W.flags|=16):V.push(O)}}function l(W,O){if(!t)return null;for(;O!==null;)n(W,O),O=O.sibling;return null}function h(W,O){for(W=new Map;O!==null;)O.key!==null?W.set(O.key,O):W.set(O.index,O),O=O.sibling;return W}function m(W,O){return W=Ha(W,O),W.index=0,W.sibling=null,W}function x(W,O,V){return W.index=V,t?(V=W.alternate,V!==null?(V=V.index,V<O?(W.flags|=2,O):V):(W.flags|=2,O)):(W.flags|=1048576,O)}function b(W){return t&&W.alternate===null&&(W.flags|=2),W}function s(W,O,V,Q){return O===null||O.tag!==6?(O=J_(V,W.mode,Q),O.return=W,O):(O=m(O,V),O.return=W,O)}function C(W,O,V,Q){var ue=V.type;return ue===uu?B(W,O,V.props.children,Q,V.key):O!==null&&(O.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Ba&&D2(ue)===O.type)?(Q=m(O,V.props),Q.ref=kd(W,O,V),Q.return=W,Q):(Q=M0(V.type,V.key,V.props,null,W.mode,Q),Q.ref=kd(W,O,V),Q.return=W,Q)}function k(W,O,V,Q){return O===null||O.tag!==4||O.stateNode.containerInfo!==V.containerInfo||O.stateNode.implementation!==V.implementation?(O=Q_(V,W.mode,Q),O.return=W,O):(O=m(O,V.children||[]),O.return=W,O)}function B(W,O,V,Q,ue){return O===null||O.tag!==7?(O=Jl(V,W.mode,Q,ue),O.return=W,O):(O=m(O,V),O.return=W,O)}function U(W,O,V){if(typeof O=="string"&&O!==""||typeof O=="number")return O=J_(""+O,W.mode,V),O.return=W,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Kf:return V=M0(O.type,O.key,O.props,null,W.mode,V),V.ref=kd(W,null,O),V.return=W,V;case cu:return O=Q_(O,W.mode,V),O.return=W,O;case Ba:var Q=O._init;return U(W,Q(O._payload),V)}if(Ld(O)||Td(O))return O=Jl(O,W.mode,V,null),O.return=W,O;a0(W,O)}return null}function F(W,O,V,Q){var ue=O!==null?O.key:null;if(typeof V=="string"&&V!==""||typeof V=="number")return ue!==null?null:s(W,O,""+V,Q);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Kf:return V.key===ue?C(W,O,V,Q):null;case cu:return V.key===ue?k(W,O,V,Q):null;case Ba:return ue=V._init,F(W,O,ue(V._payload),Q)}if(Ld(V)||Td(V))return ue!==null?null:B(W,O,V,Q,null);a0(W,V)}return null}function Z(W,O,V,Q,ue){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return W=W.get(V)||null,s(O,W,""+Q,ue);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Kf:return W=W.get(Q.key===null?V:Q.key)||null,C(O,W,Q,ue);case cu:return W=W.get(Q.key===null?V:Q.key)||null,k(O,W,Q,ue);case Ba:var fe=Q._init;return Z(W,O,V,fe(Q._payload),ue)}if(Ld(Q)||Td(Q))return W=W.get(V)||null,B(O,W,Q,ue,null);a0(O,Q)}return null}function q(W,O,V,Q){for(var ue=null,fe=null,we=O,Ce=O=0,Te=null;we!==null&&Ce<V.length;Ce++){we.index>Ce?(Te=we,we=null):Te=we.sibling;var Se=F(W,we,V[Ce],Q);if(Se===null){we===null&&(we=Te);break}t&&we&&Se.alternate===null&&n(W,we),O=x(Se,O,Ce),fe===null?ue=Se:fe.sibling=Se,fe=Se,we=Te}if(Ce===V.length)return l(W,we),Jn&&ql(W,Ce),ue;if(we===null){for(;Ce<V.length;Ce++)we=U(W,V[Ce],Q),we!==null&&(O=x(we,O,Ce),fe===null?ue=we:fe.sibling=we,fe=we);return Jn&&ql(W,Ce),ue}for(we=h(W,we);Ce<V.length;Ce++)Te=Z(we,W,Ce,V[Ce],Q),Te!==null&&(t&&Te.alternate!==null&&we.delete(Te.key===null?Ce:Te.key),O=x(Te,O,Ce),fe===null?ue=Te:fe.sibling=Te,fe=Te);return t&&we.forEach(function(Ne){return n(W,Ne)}),Jn&&ql(W,Ce),ue}function K(W,O,V,Q){var ue=Td(V);if(typeof ue!="function")throw Error(pt(150));if(V=ue.call(V),V==null)throw Error(pt(151));for(var fe=ue=null,we=O,Ce=O=0,Te=null,Se=V.next();we!==null&&!Se.done;Ce++,Se=V.next()){we.index>Ce?(Te=we,we=null):Te=we.sibling;var Ne=F(W,we,Se.value,Q);if(Ne===null){we===null&&(we=Te);break}t&&we&&Ne.alternate===null&&n(W,we),O=x(Ne,O,Ce),fe===null?ue=Ne:fe.sibling=Ne,fe=Ne,we=Te}if(Se.done)return l(W,we),Jn&&ql(W,Ce),ue;if(we===null){for(;!Se.done;Ce++,Se=V.next())Se=U(W,Se.value,Q),Se!==null&&(O=x(Se,O,Ce),fe===null?ue=Se:fe.sibling=Se,fe=Se);return Jn&&ql(W,Ce),ue}for(we=h(W,we);!Se.done;Ce++,Se=V.next())Se=Z(we,W,Ce,Se.value,Q),Se!==null&&(t&&Se.alternate!==null&&we.delete(Se.key===null?Ce:Se.key),O=x(Se,O,Ce),fe===null?ue=Se:fe.sibling=Se,fe=Se);return t&&we.forEach(function(Ue){return n(W,Ue)}),Jn&&ql(W,Ce),ue}function Y(W,O,V,Q){if(typeof V=="object"&&V!==null&&V.type===uu&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case Kf:e:{for(var ue=V.key,fe=O;fe!==null;){if(fe.key===ue){if(ue=V.type,ue===uu){if(fe.tag===7){l(W,fe.sibling),O=m(fe,V.props.children),O.return=W,W=O;break e}}else if(fe.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Ba&&D2(ue)===fe.type){l(W,fe.sibling),O=m(fe,V.props),O.ref=kd(W,fe,V),O.return=W,W=O;break e}l(W,fe);break}else n(W,fe);fe=fe.sibling}V.type===uu?(O=Jl(V.props.children,W.mode,Q,V.key),O.return=W,W=O):(Q=M0(V.type,V.key,V.props,null,W.mode,Q),Q.ref=kd(W,O,V),Q.return=W,W=Q)}return b(W);case cu:e:{for(fe=V.key;O!==null;){if(O.key===fe)if(O.tag===4&&O.stateNode.containerInfo===V.containerInfo&&O.stateNode.implementation===V.implementation){l(W,O.sibling),O=m(O,V.children||[]),O.return=W,W=O;break e}else{l(W,O);break}else n(W,O);O=O.sibling}O=Q_(V,W.mode,Q),O.return=W,W=O}return b(W);case Ba:return fe=V._init,Y(W,O,fe(V._payload),Q)}if(Ld(V))return q(W,O,V,Q);if(Td(V))return K(W,O,V,Q);a0(W,V)}return typeof V=="string"&&V!==""||typeof V=="number"?(V=""+V,O!==null&&O.tag===6?(l(W,O.sibling),O=m(O,V),O.return=W,W=O):(l(W,O),O=J_(V,W.mode,Q),O.return=W,W=O),b(W)):l(W,O)}return Y}var zu=lC(!0),cC=lC(!1),J0=Qa(null),Q0=null,yu=null,T1=null;function S1(){T1=yu=Q0=null}function C1(t){var n=J0.current;Zn(J0),t._currentValue=n}function Sx(t,n,l){for(;t!==null;){var h=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,h!==null&&(h.childLanes|=n)):h!==null&&(h.childLanes&n)!==n&&(h.childLanes|=n),t===l)break;t=t.return}}function Cu(t,n){Q0=t,T1=yu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&n&&(Di=!0),t.firstContext=null)}function vo(t){var n=t._currentValue;if(T1!==t)if(t={context:t,memoizedValue:n,next:null},yu===null){if(Q0===null)throw Error(pt(308));yu=t,Q0.dependencies={lanes:0,firstContext:t}}else yu=yu.next=t;return n}var Zl=null;function A1(t){Zl===null?Zl=[t]:Zl.push(t)}function uC(t,n,l,h){var m=n.interleaved;return m===null?(l.next=l,A1(n)):(l.next=m.next,m.next=l),n.interleaved=l,Js(t,h)}function Js(t,n){t.lanes|=n;var l=t.alternate;for(l!==null&&(l.lanes|=n),l=t,t=t.return;t!==null;)t.childLanes|=n,l=t.alternate,l!==null&&(l.childLanes|=n),l=t,t=t.return;return l.tag===3?l.stateNode:null}var La=!1;function I1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hC(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xs(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function qa(t,n,l){var h=t.updateQueue;if(h===null)return null;if(h=h.shared,xn&2){var m=h.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),h.pending=n,Js(t,l)}return m=h.interleaved,m===null?(n.next=n,A1(h)):(n.next=m.next,m.next=n),h.interleaved=n,Js(t,l)}function T0(t,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194240)!==0)){var h=n.lanes;h&=t.pendingLanes,l|=h,n.lanes=l,p1(t,l)}}function P2(t,n){var l=t.updateQueue,h=t.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var m=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var b={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};x===null?m=x=b:x=x.next=b,l=l.next}while(l!==null);x===null?m=x=n:x=x.next=n}else m=x=n;l={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:x,shared:h.shared,effects:h.effects},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=n:t.next=n,l.lastBaseUpdate=n}function em(t,n,l,h){var m=t.updateQueue;La=!1;var x=m.firstBaseUpdate,b=m.lastBaseUpdate,s=m.shared.pending;if(s!==null){m.shared.pending=null;var C=s,k=C.next;C.next=null,b===null?x=k:b.next=k,b=C;var B=t.alternate;B!==null&&(B=B.updateQueue,s=B.lastBaseUpdate,s!==b&&(s===null?B.firstBaseUpdate=k:s.next=k,B.lastBaseUpdate=C))}if(x!==null){var U=m.baseState;b=0,B=k=C=null,s=x;do{var F=s.lane,Z=s.eventTime;if((h&F)===F){B!==null&&(B=B.next={eventTime:Z,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var q=t,K=s;switch(F=n,Z=l,K.tag){case 1:if(q=K.payload,typeof q=="function"){U=q.call(Z,U,F);break e}U=q;break e;case 3:q.flags=q.flags&-65537|128;case 0:if(q=K.payload,F=typeof q=="function"?q.call(Z,U,F):q,F==null)break e;U=ur({},U,F);break e;case 2:La=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,F=m.effects,F===null?m.effects=[s]:F.push(s))}else Z={eventTime:Z,lane:F,tag:s.tag,payload:s.payload,callback:s.callback,next:null},B===null?(k=B=Z,C=U):B=B.next=Z,b|=F;if(s=s.next,s===null){if(s=m.shared.pending,s===null)break;F=s,s=F.next,F.next=null,m.lastBaseUpdate=F,m.shared.pending=null}}while(1);if(B===null&&(C=U),m.baseState=C,m.firstBaseUpdate=k,m.lastBaseUpdate=B,n=m.shared.interleaved,n!==null){m=n;do b|=m.lane,m=m.next;while(m!==n)}else x===null&&(m.shared.lanes=0);nc|=b,t.lanes=b,t.memoizedState=U}}function z2(t,n,l){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var h=t[n],m=h.callback;if(m!==null){if(h.callback=null,h=l,typeof m!="function")throw Error(pt(191,m));m.call(h)}}}var vp={},ws=Qa(vp),sp=Qa(vp),ap=Qa(vp);function Xl(t){if(t===vp)throw Error(pt(174));return t}function k1(t,n){switch(Vn(ap,n),Vn(sp,t),Vn(ws,vp),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:ox(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=ox(n,t)}Zn(ws),Vn(ws,n)}function Bu(){Zn(ws),Zn(sp),Zn(ap)}function dC(t){Xl(ap.current);var n=Xl(ws.current),l=ox(n,t.type);n!==l&&(Vn(sp,t),Vn(ws,l))}function M1(t){sp.current===t&&(Zn(ws),Zn(sp))}var lr=Qa(0);function tm(t){for(var n=t;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var W_=[];function D1(){for(var t=0;t<W_.length;t++)W_[t]._workInProgressVersionPrimary=null;W_.length=0}var S0=ea.ReactCurrentDispatcher,H_=ea.ReactCurrentBatchConfig,tc=0,cr=null,zr=null,jr=null,nm=!1,qd=!1,lp=0,u5=0;function si(){throw Error(pt(321))}function P1(t,n){if(n===null)return!1;for(var l=0;l<n.length&&l<t.length;l++)if(!Qo(t[l],n[l]))return!1;return!0}function z1(t,n,l,h,m,x){if(tc=x,cr=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,S0.current=t===null||t.memoizedState===null?f5:m5,t=l(h,m),qd){x=0;do{if(qd=!1,lp=0,25<=x)throw Error(pt(301));x+=1,jr=zr=null,n.updateQueue=null,S0.current=g5,t=l(h,m)}while(qd)}if(S0.current=rm,n=zr!==null&&zr.next!==null,tc=0,jr=zr=cr=null,nm=!1,n)throw Error(pt(300));return t}function B1(){var t=lp!==0;return lp=0,t}function ys(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?cr.memoizedState=jr=t:jr=jr.next=t,jr}function wo(){if(zr===null){var t=cr.alternate;t=t!==null?t.memoizedState:null}else t=zr.next;var n=jr===null?cr.memoizedState:jr.next;if(n!==null)jr=n,zr=t;else{if(t===null)throw Error(pt(310));zr=t,t={memoizedState:zr.memoizedState,baseState:zr.baseState,baseQueue:zr.baseQueue,queue:zr.queue,next:null},jr===null?cr.memoizedState=jr=t:jr=jr.next=t}return jr}function cp(t,n){return typeof n=="function"?n(t):n}function Z_(t){var n=wo(),l=n.queue;if(l===null)throw Error(pt(311));l.lastRenderedReducer=t;var h=zr,m=h.baseQueue,x=l.pending;if(x!==null){if(m!==null){var b=m.next;m.next=x.next,x.next=b}h.baseQueue=m=x,l.pending=null}if(m!==null){x=m.next,h=h.baseState;var s=b=null,C=null,k=x;do{var B=k.lane;if((tc&B)===B)C!==null&&(C=C.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),h=k.hasEagerState?k.eagerState:t(h,k.action);else{var U={lane:B,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};C===null?(s=C=U,b=h):C=C.next=U,cr.lanes|=B,nc|=B}k=k.next}while(k!==null&&k!==x);C===null?b=h:C.next=s,Qo(h,n.memoizedState)||(Di=!0),n.memoizedState=h,n.baseState=b,n.baseQueue=C,l.lastRenderedState=h}if(t=l.interleaved,t!==null){m=t;do x=m.lane,cr.lanes|=x,nc|=x,m=m.next;while(m!==t)}else m===null&&(l.lanes=0);return[n.memoizedState,l.dispatch]}function X_(t){var n=wo(),l=n.queue;if(l===null)throw Error(pt(311));l.lastRenderedReducer=t;var h=l.dispatch,m=l.pending,x=n.memoizedState;if(m!==null){l.pending=null;var b=m=m.next;do x=t(x,b.action),b=b.next;while(b!==m);Qo(x,n.memoizedState)||(Di=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),l.lastRenderedState=x}return[x,h]}function pC(){}function fC(t,n){var l=cr,h=wo(),m=n(),x=!Qo(h.memoizedState,m);if(x&&(h.memoizedState=m,Di=!0),h=h.queue,L1(_C.bind(null,l,h,t),[t]),h.getSnapshot!==n||x||jr!==null&&jr.memoizedState.tag&1){if(l.flags|=2048,up(9,gC.bind(null,l,h,m,n),void 0,null),Vr===null)throw Error(pt(349));tc&30||mC(l,n,m)}return m}function mC(t,n,l){t.flags|=16384,t={getSnapshot:n,value:l},n=cr.updateQueue,n===null?(n={lastEffect:null,stores:null},cr.updateQueue=n,n.stores=[t]):(l=n.stores,l===null?n.stores=[t]:l.push(t))}function gC(t,n,l,h){n.value=l,n.getSnapshot=h,yC(n)&&xC(t)}function _C(t,n,l){return l(function(){yC(n)&&xC(t)})}function yC(t){var n=t.getSnapshot;t=t.value;try{var l=n();return!Qo(t,l)}catch{return!0}}function xC(t){var n=Js(t,1);n!==null&&Ko(n,t,1,-1)}function B2(t){var n=ys();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cp,lastRenderedState:t},n.queue=t,t=t.dispatch=p5.bind(null,cr,t),[n.memoizedState,t]}function up(t,n,l,h){return t={tag:t,create:n,destroy:l,deps:h,next:null},n=cr.updateQueue,n===null?(n={lastEffect:null,stores:null},cr.updateQueue=n,n.lastEffect=t.next=t):(l=n.lastEffect,l===null?n.lastEffect=t.next=t:(h=l.next,l.next=t,t.next=h,n.lastEffect=t)),t}function vC(){return wo().memoizedState}function C0(t,n,l,h){var m=ys();cr.flags|=t,m.memoizedState=up(1|n,l,void 0,h===void 0?null:h)}function Tm(t,n,l,h){var m=wo();h=h===void 0?null:h;var x=void 0;if(zr!==null){var b=zr.memoizedState;if(x=b.destroy,h!==null&&P1(h,b.deps)){m.memoizedState=up(n,l,x,h);return}}cr.flags|=t,m.memoizedState=up(1|n,l,x,h)}function L2(t,n){return C0(8390656,8,t,n)}function L1(t,n){return Tm(2048,8,t,n)}function wC(t,n){return Tm(4,2,t,n)}function bC(t,n){return Tm(4,4,t,n)}function EC(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function TC(t,n,l){return l=l!=null?l.concat([t]):null,Tm(4,4,EC.bind(null,n,t),l)}function R1(){}function SC(t,n){var l=wo();n=n===void 0?null:n;var h=l.memoizedState;return h!==null&&n!==null&&P1(n,h[1])?h[0]:(l.memoizedState=[t,n],t)}function CC(t,n){var l=wo();n=n===void 0?null:n;var h=l.memoizedState;return h!==null&&n!==null&&P1(n,h[1])?h[0]:(t=t(),l.memoizedState=[t,n],t)}function AC(t,n,l){return tc&21?(Qo(l,n)||(l=PS(),cr.lanes|=l,nc|=l,t.baseState=!0),n):(t.baseState&&(t.baseState=!1,Di=!0),t.memoizedState=l)}function h5(t,n){var l=Ln;Ln=l!==0&&4>l?l:4,t(!0);var h=H_.transition;H_.transition={};try{t(!1),n()}finally{Ln=l,H_.transition=h}}function IC(){return wo().memoizedState}function d5(t,n,l){var h=Wa(t);if(l={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null},kC(t))MC(n,l);else if(l=uC(t,n,l,h),l!==null){var m=_i();Ko(l,t,h,m),DC(l,n,h)}}function p5(t,n,l){var h=Wa(t),m={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null};if(kC(t))MC(n,m);else{var x=t.alternate;if(t.lanes===0&&(x===null||x.lanes===0)&&(x=n.lastRenderedReducer,x!==null))try{var b=n.lastRenderedState,s=x(b,l);if(m.hasEagerState=!0,m.eagerState=s,Qo(s,b)){var C=n.interleaved;C===null?(m.next=m,A1(n)):(m.next=C.next,C.next=m),n.interleaved=m;return}}catch{}finally{}l=uC(t,n,m,h),l!==null&&(m=_i(),Ko(l,t,h,m),DC(l,n,h))}}function kC(t){var n=t.alternate;return t===cr||n!==null&&n===cr}function MC(t,n){qd=nm=!0;var l=t.pending;l===null?n.next=n:(n.next=l.next,l.next=n),t.pending=n}function DC(t,n,l){if(l&4194240){var h=n.lanes;h&=t.pendingLanes,l|=h,n.lanes=l,p1(t,l)}}var rm={readContext:vo,useCallback:si,useContext:si,useEffect:si,useImperativeHandle:si,useInsertionEffect:si,useLayoutEffect:si,useMemo:si,useReducer:si,useRef:si,useState:si,useDebugValue:si,useDeferredValue:si,useTransition:si,useMutableSource:si,useSyncExternalStore:si,useId:si,unstable_isNewReconciler:!1},f5={readContext:vo,useCallback:function(t,n){return ys().memoizedState=[t,n===void 0?null:n],t},useContext:vo,useEffect:L2,useImperativeHandle:function(t,n,l){return l=l!=null?l.concat([t]):null,C0(4194308,4,EC.bind(null,n,t),l)},useLayoutEffect:function(t,n){return C0(4194308,4,t,n)},useInsertionEffect:function(t,n){return C0(4,2,t,n)},useMemo:function(t,n){var l=ys();return n=n===void 0?null:n,t=t(),l.memoizedState=[t,n],t},useReducer:function(t,n,l){var h=ys();return n=l!==void 0?l(n):n,h.memoizedState=h.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},h.queue=t,t=t.dispatch=d5.bind(null,cr,t),[h.memoizedState,t]},useRef:function(t){var n=ys();return t={current:t},n.memoizedState=t},useState:B2,useDebugValue:R1,useDeferredValue:function(t){return ys().memoizedState=t},useTransition:function(){var t=B2(!1),n=t[0];return t=h5.bind(null,t[1]),ys().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,l){var h=cr,m=ys();if(Jn){if(l===void 0)throw Error(pt(407));l=l()}else{if(l=n(),Vr===null)throw Error(pt(349));tc&30||mC(h,n,l)}m.memoizedState=l;var x={value:l,getSnapshot:n};return m.queue=x,L2(_C.bind(null,h,x,t),[t]),h.flags|=2048,up(9,gC.bind(null,h,x,l,n),void 0,null),l},useId:function(){var t=ys(),n=Vr.identifierPrefix;if(Jn){var l=Zs,h=Hs;l=(h&~(1<<32-Xo(h)-1)).toString(32)+l,n=":"+n+"R"+l,l=lp++,0<l&&(n+="H"+l.toString(32)),n+=":"}else l=u5++,n=":"+n+"r"+l.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},m5={readContext:vo,useCallback:SC,useContext:vo,useEffect:L1,useImperativeHandle:TC,useInsertionEffect:wC,useLayoutEffect:bC,useMemo:CC,useReducer:Z_,useRef:vC,useState:function(){return Z_(cp)},useDebugValue:R1,useDeferredValue:function(t){var n=wo();return AC(n,zr.memoizedState,t)},useTransition:function(){var t=Z_(cp)[0],n=wo().memoizedState;return[t,n]},useMutableSource:pC,useSyncExternalStore:fC,useId:IC,unstable_isNewReconciler:!1},g5={readContext:vo,useCallback:SC,useContext:vo,useEffect:L1,useImperativeHandle:TC,useInsertionEffect:wC,useLayoutEffect:bC,useMemo:CC,useReducer:X_,useRef:vC,useState:function(){return X_(cp)},useDebugValue:R1,useDeferredValue:function(t){var n=wo();return zr===null?n.memoizedState=t:AC(n,zr.memoizedState,t)},useTransition:function(){var t=X_(cp)[0],n=wo().memoizedState;return[t,n]},useMutableSource:pC,useSyncExternalStore:fC,useId:IC,unstable_isNewReconciler:!1};function Wo(t,n){if(t&&t.defaultProps){n=ur({},n),t=t.defaultProps;for(var l in t)n[l]===void 0&&(n[l]=t[l]);return n}return n}function Cx(t,n,l,h){n=t.memoizedState,l=l(h,n),l=l==null?n:ur({},n,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var Sm={isMounted:function(t){return(t=t._reactInternals)?ac(t)===t:!1},enqueueSetState:function(t,n,l){t=t._reactInternals;var h=_i(),m=Wa(t),x=Xs(h,m);x.payload=n,l!=null&&(x.callback=l),n=qa(t,x,m),n!==null&&(Ko(n,t,m,h),T0(n,t,m))},enqueueReplaceState:function(t,n,l){t=t._reactInternals;var h=_i(),m=Wa(t),x=Xs(h,m);x.tag=1,x.payload=n,l!=null&&(x.callback=l),n=qa(t,x,m),n!==null&&(Ko(n,t,m,h),T0(n,t,m))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var l=_i(),h=Wa(t),m=Xs(l,h);m.tag=2,n!=null&&(m.callback=n),n=qa(t,m,h),n!==null&&(Ko(n,t,h,l),T0(n,t,h))}};function R2(t,n,l,h,m,x,b){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(h,x,b):n.prototype&&n.prototype.isPureReactComponent?!np(l,h)||!np(m,x):!0}function PC(t,n,l){var h=!1,m=Xa,x=n.contextType;return typeof x=="object"&&x!==null?x=vo(x):(m=zi(n)?Ql:ui.current,h=n.contextTypes,x=(h=h!=null)?Du(t,m):Xa),n=new n(l,x),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Sm,t.stateNode=n,n._reactInternals=t,h&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=m,t.__reactInternalMemoizedMaskedChildContext=x),n}function F2(t,n,l,h){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,h),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,h),n.state!==t&&Sm.enqueueReplaceState(n,n.state,null)}function Ax(t,n,l,h){var m=t.stateNode;m.props=l,m.state=t.memoizedState,m.refs={},I1(t);var x=n.contextType;typeof x=="object"&&x!==null?m.context=vo(x):(x=zi(n)?Ql:ui.current,m.context=Du(t,x)),m.state=t.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(Cx(t,n,x,l),m.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(n=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),n!==m.state&&Sm.enqueueReplaceState(m,m.state,null),em(t,l,m,h),m.state=t.memoizedState),typeof m.componentDidMount=="function"&&(t.flags|=4194308)}function Lu(t,n){try{var l="",h=n;do l+=qk(h),h=h.return;while(h);var m=l}catch(x){m=`
Error generating stack: `+x.message+`
`+x.stack}return{value:t,source:n,stack:m,digest:null}}function K_(t,n,l){return{value:t,source:null,stack:l??null,digest:n??null}}function Ix(t,n){try{console.error(n.value)}catch(l){setTimeout(function(){throw l})}}var _5=typeof WeakMap=="function"?WeakMap:Map;function zC(t,n,l){l=Xs(-1,l),l.tag=3,l.payload={element:null};var h=n.value;return l.callback=function(){om||(om=!0,Ox=h),Ix(t,n)},l}function BC(t,n,l){l=Xs(-1,l),l.tag=3;var h=t.type.getDerivedStateFromError;if(typeof h=="function"){var m=n.value;l.payload=function(){return h(m)},l.callback=function(){Ix(t,n)}}var x=t.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(l.callback=function(){Ix(t,n),typeof h!="function"&&($a===null?$a=new Set([this]):$a.add(this));var b=n.stack;this.componentDidCatch(n.value,{componentStack:b!==null?b:""})}),l}function O2(t,n,l){var h=t.pingCache;if(h===null){h=t.pingCache=new _5;var m=new Set;h.set(n,m)}else m=h.get(n),m===void 0&&(m=new Set,h.set(n,m));m.has(l)||(m.add(l),t=D5.bind(null,t,n,l),n.then(t,t))}function N2(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function U2(t,n,l,h,m){return t.mode&1?(t.flags|=65536,t.lanes=m,t):(t===n?t.flags|=65536:(t.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(n=Xs(-1,1),n.tag=2,qa(l,n,1))),l.lanes|=1),t)}var y5=ea.ReactCurrentOwner,Di=!1;function gi(t,n,l,h){n.child=t===null?cC(n,null,l,h):zu(n,t.child,l,h)}function j2(t,n,l,h,m){l=l.render;var x=n.ref;return Cu(n,m),h=z1(t,n,l,h,x,m),l=B1(),t!==null&&!Di?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~m,Qs(t,n,m)):(Jn&&l&&w1(n),n.flags|=1,gi(t,n,h,m),n.child)}function V2(t,n,l,h,m){if(t===null){var x=l.type;return typeof x=="function"&&!q1(x)&&x.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(n.tag=15,n.type=x,LC(t,n,x,h,m)):(t=M0(l.type,null,h,n,n.mode,m),t.ref=n.ref,t.return=n,n.child=t)}if(x=t.child,!(t.lanes&m)){var b=x.memoizedProps;if(l=l.compare,l=l!==null?l:np,l(b,h)&&t.ref===n.ref)return Qs(t,n,m)}return n.flags|=1,t=Ha(x,h),t.ref=n.ref,t.return=n,n.child=t}function LC(t,n,l,h,m){if(t!==null){var x=t.memoizedProps;if(np(x,h)&&t.ref===n.ref)if(Di=!1,n.pendingProps=h=x,(t.lanes&m)!==0)t.flags&131072&&(Di=!0);else return n.lanes=t.lanes,Qs(t,n,m)}return kx(t,n,l,h,m)}function RC(t,n,l){var h=n.pendingProps,m=h.children,x=t!==null?t.memoizedState:null;if(h.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vn(vu,Zi),Zi|=l;else{if(!(l&1073741824))return t=x!==null?x.baseLanes|l:l,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,Vn(vu,Zi),Zi|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=x!==null?x.baseLanes:l,Vn(vu,Zi),Zi|=h}else x!==null?(h=x.baseLanes|l,n.memoizedState=null):h=l,Vn(vu,Zi),Zi|=h;return gi(t,n,m,l),n.child}function FC(t,n){var l=n.ref;(t===null&&l!==null||t!==null&&t.ref!==l)&&(n.flags|=512,n.flags|=2097152)}function kx(t,n,l,h,m){var x=zi(l)?Ql:ui.current;return x=Du(n,x),Cu(n,m),l=z1(t,n,l,h,x,m),h=B1(),t!==null&&!Di?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~m,Qs(t,n,m)):(Jn&&h&&w1(n),n.flags|=1,gi(t,n,l,m),n.child)}function G2(t,n,l,h,m){if(zi(l)){var x=!0;X0(n)}else x=!1;if(Cu(n,m),n.stateNode===null)A0(t,n),PC(n,l,h),Ax(n,l,h,m),h=!0;else if(t===null){var b=n.stateNode,s=n.memoizedProps;b.props=s;var C=b.context,k=l.contextType;typeof k=="object"&&k!==null?k=vo(k):(k=zi(l)?Ql:ui.current,k=Du(n,k));var B=l.getDerivedStateFromProps,U=typeof B=="function"||typeof b.getSnapshotBeforeUpdate=="function";U||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(s!==h||C!==k)&&F2(n,b,h,k),La=!1;var F=n.memoizedState;b.state=F,em(n,h,b,m),C=n.memoizedState,s!==h||F!==C||Pi.current||La?(typeof B=="function"&&(Cx(n,l,B,h),C=n.memoizedState),(s=La||R2(n,l,s,h,F,C,k))?(U||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(n.flags|=4194308)):(typeof b.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=h,n.memoizedState=C),b.props=h,b.state=C,b.context=k,h=s):(typeof b.componentDidMount=="function"&&(n.flags|=4194308),h=!1)}else{b=n.stateNode,hC(t,n),s=n.memoizedProps,k=n.type===n.elementType?s:Wo(n.type,s),b.props=k,U=n.pendingProps,F=b.context,C=l.contextType,typeof C=="object"&&C!==null?C=vo(C):(C=zi(l)?Ql:ui.current,C=Du(n,C));var Z=l.getDerivedStateFromProps;(B=typeof Z=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(s!==U||F!==C)&&F2(n,b,h,C),La=!1,F=n.memoizedState,b.state=F,em(n,h,b,m);var q=n.memoizedState;s!==U||F!==q||Pi.current||La?(typeof Z=="function"&&(Cx(n,l,Z,h),q=n.memoizedState),(k=La||R2(n,l,k,h,F,q,C)||!1)?(B||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,q,C),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,q,C)),typeof b.componentDidUpdate=="function"&&(n.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof b.componentDidUpdate!="function"||s===t.memoizedProps&&F===t.memoizedState||(n.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&F===t.memoizedState||(n.flags|=1024),n.memoizedProps=h,n.memoizedState=q),b.props=h,b.state=q,b.context=C,h=k):(typeof b.componentDidUpdate!="function"||s===t.memoizedProps&&F===t.memoizedState||(n.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&F===t.memoizedState||(n.flags|=1024),h=!1)}return Mx(t,n,l,h,x,m)}function Mx(t,n,l,h,m,x){FC(t,n);var b=(n.flags&128)!==0;if(!h&&!b)return m&&I2(n,l,!1),Qs(t,n,x);h=n.stateNode,y5.current=n;var s=b&&typeof l.getDerivedStateFromError!="function"?null:h.render();return n.flags|=1,t!==null&&b?(n.child=zu(n,t.child,null,x),n.child=zu(n,null,s,x)):gi(t,n,s,x),n.memoizedState=h.state,m&&I2(n,l,!0),n.child}function OC(t){var n=t.stateNode;n.pendingContext?A2(t,n.pendingContext,n.pendingContext!==n.context):n.context&&A2(t,n.context,!1),k1(t,n.containerInfo)}function q2(t,n,l,h,m){return Pu(),E1(m),n.flags|=256,gi(t,n,l,h),n.child}var Dx={dehydrated:null,treeContext:null,retryLane:0};function Px(t){return{baseLanes:t,cachePool:null,transitions:null}}function NC(t,n,l){var h=n.pendingProps,m=lr.current,x=!1,b=(n.flags&128)!==0,s;if((s=b)||(s=t!==null&&t.memoizedState===null?!1:(m&2)!==0),s?(x=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(m|=1),Vn(lr,m&1),t===null)return Tx(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(n.mode&1?t.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(b=h.children,t=h.fallback,x?(h=n.mode,x=n.child,b={mode:"hidden",children:b},!(h&1)&&x!==null?(x.childLanes=0,x.pendingProps=b):x=Im(b,h,0,null),t=Jl(t,h,l,null),x.return=n,t.return=n,x.sibling=t,n.child=x,n.child.memoizedState=Px(l),n.memoizedState=Dx,t):F1(n,b));if(m=t.memoizedState,m!==null&&(s=m.dehydrated,s!==null))return x5(t,n,b,h,s,m,l);if(x){x=h.fallback,b=n.mode,m=t.child,s=m.sibling;var C={mode:"hidden",children:h.children};return!(b&1)&&n.child!==m?(h=n.child,h.childLanes=0,h.pendingProps=C,n.deletions=null):(h=Ha(m,C),h.subtreeFlags=m.subtreeFlags&14680064),s!==null?x=Ha(s,x):(x=Jl(x,b,l,null),x.flags|=2),x.return=n,h.return=n,h.sibling=x,n.child=h,h=x,x=n.child,b=t.child.memoizedState,b=b===null?Px(l):{baseLanes:b.baseLanes|l,cachePool:null,transitions:b.transitions},x.memoizedState=b,x.childLanes=t.childLanes&~l,n.memoizedState=Dx,h}return x=t.child,t=x.sibling,h=Ha(x,{mode:"visible",children:h.children}),!(n.mode&1)&&(h.lanes=l),h.return=n,h.sibling=null,t!==null&&(l=n.deletions,l===null?(n.deletions=[t],n.flags|=16):l.push(t)),n.child=h,n.memoizedState=null,h}function F1(t,n){return n=Im({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function l0(t,n,l,h){return h!==null&&E1(h),zu(n,t.child,null,l),t=F1(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function x5(t,n,l,h,m,x,b){if(l)return n.flags&256?(n.flags&=-257,h=K_(Error(pt(422))),l0(t,n,b,h)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(x=h.fallback,m=n.mode,h=Im({mode:"visible",children:h.children},m,0,null),x=Jl(x,m,b,null),x.flags|=2,h.return=n,x.return=n,h.sibling=x,n.child=h,n.mode&1&&zu(n,t.child,null,b),n.child.memoizedState=Px(b),n.memoizedState=Dx,x);if(!(n.mode&1))return l0(t,n,b,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var s=h.dgst;return h=s,x=Error(pt(419)),h=K_(x,h,void 0),l0(t,n,b,h)}if(s=(b&t.childLanes)!==0,Di||s){if(h=Vr,h!==null){switch(b&-b){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=m&(h.suspendedLanes|b)?0:m,m!==0&&m!==x.retryLane&&(x.retryLane=m,Js(t,m),Ko(h,t,m,-1))}return G1(),h=K_(Error(pt(421))),l0(t,n,b,h)}return m.data==="$?"?(n.flags|=128,n.child=t.child,n=P5.bind(null,t),m._reactRetry=n,null):(t=x.treeContext,Xi=Ga(m.nextSibling),Ki=n,Jn=!0,Zo=null,t!==null&&(go[_o++]=Hs,go[_o++]=Zs,go[_o++]=ec,Hs=t.id,Zs=t.overflow,ec=n),n=F1(n,h.children),n.flags|=4096,n)}function $2(t,n,l){t.lanes|=n;var h=t.alternate;h!==null&&(h.lanes|=n),Sx(t.return,n,l)}function Y_(t,n,l,h,m){var x=t.memoizedState;x===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:m}:(x.isBackwards=n,x.rendering=null,x.renderingStartTime=0,x.last=h,x.tail=l,x.tailMode=m)}function UC(t,n,l){var h=n.pendingProps,m=h.revealOrder,x=h.tail;if(gi(t,n,h.children,l),h=lr.current,h&2)h=h&1|2,n.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$2(t,l,n);else if(t.tag===19)$2(t,l,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}h&=1}if(Vn(lr,h),!(n.mode&1))n.memoizedState=null;else switch(m){case"forwards":for(l=n.child,m=null;l!==null;)t=l.alternate,t!==null&&tm(t)===null&&(m=l),l=l.sibling;l=m,l===null?(m=n.child,n.child=null):(m=l.sibling,l.sibling=null),Y_(n,!1,m,l,x);break;case"backwards":for(l=null,m=n.child,n.child=null;m!==null;){if(t=m.alternate,t!==null&&tm(t)===null){n.child=m;break}t=m.sibling,m.sibling=l,l=m,m=t}Y_(n,!0,l,null,x);break;case"together":Y_(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function A0(t,n){!(n.mode&1)&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function Qs(t,n,l){if(t!==null&&(n.dependencies=t.dependencies),nc|=n.lanes,!(l&n.childLanes))return null;if(t!==null&&n.child!==t.child)throw Error(pt(153));if(n.child!==null){for(t=n.child,l=Ha(t,t.pendingProps),n.child=l,l.return=n;t.sibling!==null;)t=t.sibling,l=l.sibling=Ha(t,t.pendingProps),l.return=n;l.sibling=null}return n.child}function v5(t,n,l){switch(n.tag){case 3:OC(n),Pu();break;case 5:dC(n);break;case 1:zi(n.type)&&X0(n);break;case 4:k1(n,n.stateNode.containerInfo);break;case 10:var h=n.type._context,m=n.memoizedProps.value;Vn(J0,h._currentValue),h._currentValue=m;break;case 13:if(h=n.memoizedState,h!==null)return h.dehydrated!==null?(Vn(lr,lr.current&1),n.flags|=128,null):l&n.child.childLanes?NC(t,n,l):(Vn(lr,lr.current&1),t=Qs(t,n,l),t!==null?t.sibling:null);Vn(lr,lr.current&1);break;case 19:if(h=(l&n.childLanes)!==0,t.flags&128){if(h)return UC(t,n,l);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Vn(lr,lr.current),h)break;return null;case 22:case 23:return n.lanes=0,RC(t,n,l)}return Qs(t,n,l)}var jC,zx,VC,GC;jC=function(t,n){for(var l=n.child;l!==null;){if(l.tag===5||l.tag===6)t.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};zx=function(){};VC=function(t,n,l,h){var m=t.memoizedProps;if(m!==h){t=n.stateNode,Xl(ws.current);var x=null;switch(l){case"input":m=tx(t,m),h=tx(t,h),x=[];break;case"select":m=ur({},m,{value:void 0}),h=ur({},h,{value:void 0}),x=[];break;case"textarea":m=ix(t,m),h=ix(t,h),x=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(t.onclick=H0)}sx(l,h);var b;l=null;for(k in m)if(!h.hasOwnProperty(k)&&m.hasOwnProperty(k)&&m[k]!=null)if(k==="style"){var s=m[k];for(b in s)s.hasOwnProperty(b)&&(l||(l={}),l[b]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(Xd.hasOwnProperty(k)?x||(x=[]):(x=x||[]).push(k,null));for(k in h){var C=h[k];if(s=m!=null?m[k]:void 0,h.hasOwnProperty(k)&&C!==s&&(C!=null||s!=null))if(k==="style")if(s){for(b in s)!s.hasOwnProperty(b)||C&&C.hasOwnProperty(b)||(l||(l={}),l[b]="");for(b in C)C.hasOwnProperty(b)&&s[b]!==C[b]&&(l||(l={}),l[b]=C[b])}else l||(x||(x=[]),x.push(k,l)),l=C;else k==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,s=s?s.__html:void 0,C!=null&&s!==C&&(x=x||[]).push(k,C)):k==="children"?typeof C!="string"&&typeof C!="number"||(x=x||[]).push(k,""+C):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(Xd.hasOwnProperty(k)?(C!=null&&k==="onScroll"&&Hn("scroll",t),x||s===C||(x=[])):(x=x||[]).push(k,C))}l&&(x=x||[]).push("style",l);var k=x;(n.updateQueue=k)&&(n.flags|=4)}};GC=function(t,n,l,h){l!==h&&(n.flags|=4)};function Md(t,n){if(!Jn)switch(t.tailMode){case"hidden":n=t.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:h.sibling=null}}function ai(t){var n=t.alternate!==null&&t.alternate.child===t.child,l=0,h=0;if(n)for(var m=t.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=t,m=m.sibling;else for(m=t.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=t,m=m.sibling;return t.subtreeFlags|=h,t.childLanes=l,n}function w5(t,n,l){var h=n.pendingProps;switch(b1(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ai(n),null;case 1:return zi(n.type)&&Z0(),ai(n),null;case 3:return h=n.stateNode,Bu(),Zn(Pi),Zn(ui),D1(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(t===null||t.child===null)&&(s0(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Zo!==null&&(jx(Zo),Zo=null))),zx(t,n),ai(n),null;case 5:M1(n);var m=Xl(ap.current);if(l=n.type,t!==null&&n.stateNode!=null)VC(t,n,l,h,m),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!h){if(n.stateNode===null)throw Error(pt(166));return ai(n),null}if(t=Xl(ws.current),s0(n)){h=n.stateNode,l=n.type;var x=n.memoizedProps;switch(h[xs]=n,h[op]=x,t=(n.mode&1)!==0,l){case"dialog":Hn("cancel",h),Hn("close",h);break;case"iframe":case"object":case"embed":Hn("load",h);break;case"video":case"audio":for(m=0;m<Fd.length;m++)Hn(Fd[m],h);break;case"source":Hn("error",h);break;case"img":case"image":case"link":Hn("error",h),Hn("load",h);break;case"details":Hn("toggle",h);break;case"input":e2(h,x),Hn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!x.multiple},Hn("invalid",h);break;case"textarea":n2(h,x),Hn("invalid",h)}sx(l,x),m=null;for(var b in x)if(x.hasOwnProperty(b)){var s=x[b];b==="children"?typeof s=="string"?h.textContent!==s&&(x.suppressHydrationWarning!==!0&&o0(h.textContent,s,t),m=["children",s]):typeof s=="number"&&h.textContent!==""+s&&(x.suppressHydrationWarning!==!0&&o0(h.textContent,s,t),m=["children",""+s]):Xd.hasOwnProperty(b)&&s!=null&&b==="onScroll"&&Hn("scroll",h)}switch(l){case"input":Yf(h),t2(h,x,!0);break;case"textarea":Yf(h),r2(h);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(h.onclick=H0)}h=m,n.updateQueue=h,h!==null&&(n.flags|=4)}else{b=m.nodeType===9?m:m.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_S(l)),t==="http://www.w3.org/1999/xhtml"?l==="script"?(t=b.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof h.is=="string"?t=b.createElement(l,{is:h.is}):(t=b.createElement(l),l==="select"&&(b=t,h.multiple?b.multiple=!0:h.size&&(b.size=h.size))):t=b.createElementNS(t,l),t[xs]=n,t[op]=h,jC(t,n,!1,!1),n.stateNode=t;e:{switch(b=ax(l,h),l){case"dialog":Hn("cancel",t),Hn("close",t),m=h;break;case"iframe":case"object":case"embed":Hn("load",t),m=h;break;case"video":case"audio":for(m=0;m<Fd.length;m++)Hn(Fd[m],t);m=h;break;case"source":Hn("error",t),m=h;break;case"img":case"image":case"link":Hn("error",t),Hn("load",t),m=h;break;case"details":Hn("toggle",t),m=h;break;case"input":e2(t,h),m=tx(t,h),Hn("invalid",t);break;case"option":m=h;break;case"select":t._wrapperState={wasMultiple:!!h.multiple},m=ur({},h,{value:void 0}),Hn("invalid",t);break;case"textarea":n2(t,h),m=ix(t,h),Hn("invalid",t);break;default:m=h}sx(l,m),s=m;for(x in s)if(s.hasOwnProperty(x)){var C=s[x];x==="style"?vS(t,C):x==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&yS(t,C)):x==="children"?typeof C=="string"?(l!=="textarea"||C!=="")&&Kd(t,C):typeof C=="number"&&Kd(t,""+C):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(Xd.hasOwnProperty(x)?C!=null&&x==="onScroll"&&Hn("scroll",t):C!=null&&a1(t,x,C,b))}switch(l){case"input":Yf(t),t2(t,h,!1);break;case"textarea":Yf(t),r2(t);break;case"option":h.value!=null&&t.setAttribute("value",""+Za(h.value));break;case"select":t.multiple=!!h.multiple,x=h.value,x!=null?bu(t,!!h.multiple,x,!1):h.defaultValue!=null&&bu(t,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(t.onclick=H0)}switch(l){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return ai(n),null;case 6:if(t&&n.stateNode!=null)GC(t,n,t.memoizedProps,h);else{if(typeof h!="string"&&n.stateNode===null)throw Error(pt(166));if(l=Xl(ap.current),Xl(ws.current),s0(n)){if(h=n.stateNode,l=n.memoizedProps,h[xs]=n,(x=h.nodeValue!==l)&&(t=Ki,t!==null))switch(t.tag){case 3:o0(h.nodeValue,l,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&o0(h.nodeValue,l,(t.mode&1)!==0)}x&&(n.flags|=4)}else h=(l.nodeType===9?l:l.ownerDocument).createTextNode(h),h[xs]=n,n.stateNode=h}return ai(n),null;case 13:if(Zn(lr),h=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Jn&&Xi!==null&&n.mode&1&&!(n.flags&128))aC(),Pu(),n.flags|=98560,x=!1;else if(x=s0(n),h!==null&&h.dehydrated!==null){if(t===null){if(!x)throw Error(pt(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(pt(317));x[xs]=n}else Pu(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;ai(n),x=!1}else Zo!==null&&(jx(Zo),Zo=null),x=!0;if(!x)return n.flags&65536?n:null}return n.flags&128?(n.lanes=l,n):(h=h!==null,h!==(t!==null&&t.memoizedState!==null)&&h&&(n.child.flags|=8192,n.mode&1&&(t===null||lr.current&1?Br===0&&(Br=3):G1())),n.updateQueue!==null&&(n.flags|=4),ai(n),null);case 4:return Bu(),zx(t,n),t===null&&rp(n.stateNode.containerInfo),ai(n),null;case 10:return C1(n.type._context),ai(n),null;case 17:return zi(n.type)&&Z0(),ai(n),null;case 19:if(Zn(lr),x=n.memoizedState,x===null)return ai(n),null;if(h=(n.flags&128)!==0,b=x.rendering,b===null)if(h)Md(x,!1);else{if(Br!==0||t!==null&&t.flags&128)for(t=n.child;t!==null;){if(b=tm(t),b!==null){for(n.flags|=128,Md(x,!1),h=b.updateQueue,h!==null&&(n.updateQueue=h,n.flags|=4),n.subtreeFlags=0,h=l,l=n.child;l!==null;)x=l,t=h,x.flags&=14680066,b=x.alternate,b===null?(x.childLanes=0,x.lanes=t,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=b.childLanes,x.lanes=b.lanes,x.child=b.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=b.memoizedProps,x.memoizedState=b.memoizedState,x.updateQueue=b.updateQueue,x.type=b.type,t=b.dependencies,x.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),l=l.sibling;return Vn(lr,lr.current&1|2),n.child}t=t.sibling}x.tail!==null&&mr()>Ru&&(n.flags|=128,h=!0,Md(x,!1),n.lanes=4194304)}else{if(!h)if(t=tm(b),t!==null){if(n.flags|=128,h=!0,l=t.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),Md(x,!0),x.tail===null&&x.tailMode==="hidden"&&!b.alternate&&!Jn)return ai(n),null}else 2*mr()-x.renderingStartTime>Ru&&l!==1073741824&&(n.flags|=128,h=!0,Md(x,!1),n.lanes=4194304);x.isBackwards?(b.sibling=n.child,n.child=b):(l=x.last,l!==null?l.sibling=b:n.child=b,x.last=b)}return x.tail!==null?(n=x.tail,x.rendering=n,x.tail=n.sibling,x.renderingStartTime=mr(),n.sibling=null,l=lr.current,Vn(lr,h?l&1|2:l&1),n):(ai(n),null);case 22:case 23:return V1(),h=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==h&&(n.flags|=8192),h&&n.mode&1?Zi&1073741824&&(ai(n),n.subtreeFlags&6&&(n.flags|=8192)):ai(n),null;case 24:return null;case 25:return null}throw Error(pt(156,n.tag))}function b5(t,n){switch(b1(n),n.tag){case 1:return zi(n.type)&&Z0(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Bu(),Zn(Pi),Zn(ui),D1(),t=n.flags,t&65536&&!(t&128)?(n.flags=t&-65537|128,n):null;case 5:return M1(n),null;case 13:if(Zn(lr),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(pt(340));Pu()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Zn(lr),null;case 4:return Bu(),null;case 10:return C1(n.type._context),null;case 22:case 23:return V1(),null;case 24:return null;default:return null}}var c0=!1,li=!1,E5=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function xu(t,n){var l=t.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(h){fr(t,n,h)}else l.current=null}function Bx(t,n,l){try{l()}catch(h){fr(t,n,h)}}var W2=!1;function T5(t,n){if(_x=q0,t=ZS(),v1(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var m=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var b=0,s=-1,C=-1,k=0,B=0,U=t,F=null;t:for(;;){for(var Z;U!==l||m!==0&&U.nodeType!==3||(s=b+m),U!==x||h!==0&&U.nodeType!==3||(C=b+h),U.nodeType===3&&(b+=U.nodeValue.length),(Z=U.firstChild)!==null;)F=U,U=Z;for(;;){if(U===t)break t;if(F===l&&++k===m&&(s=b),F===x&&++B===h&&(C=b),(Z=U.nextSibling)!==null)break;U=F,F=U.parentNode}U=Z}l=s===-1||C===-1?null:{start:s,end:C}}else l=null}l=l||{start:0,end:0}}else l=null;for(yx={focusedElem:t,selectionRange:l},q0=!1,Mt=n;Mt!==null;)if(n=Mt,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,Mt=t;else for(;Mt!==null;){n=Mt;try{var q=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(q!==null){var K=q.memoizedProps,Y=q.memoizedState,W=n.stateNode,O=W.getSnapshotBeforeUpdate(n.elementType===n.type?K:Wo(n.type,K),Y);W.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var V=n.stateNode.containerInfo;V.nodeType===1?V.textContent="":V.nodeType===9&&V.documentElement&&V.removeChild(V.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pt(163))}}catch(Q){fr(n,n.return,Q)}if(t=n.sibling,t!==null){t.return=n.return,Mt=t;break}Mt=n.return}return q=W2,W2=!1,q}function $d(t,n,l){var h=n.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&t)===t){var x=m.destroy;m.destroy=void 0,x!==void 0&&Bx(n,l,x)}m=m.next}while(m!==h)}}function Cm(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var l=n=n.next;do{if((l.tag&t)===t){var h=l.create;l.destroy=h()}l=l.next}while(l!==n)}}function Lx(t){var n=t.ref;if(n!==null){var l=t.stateNode;switch(t.tag){case 5:t=l;break;default:t=l}typeof n=="function"?n(t):n.current=t}}function qC(t){var n=t.alternate;n!==null&&(t.alternate=null,qC(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[xs],delete n[op],delete n[wx],delete n[s5],delete n[a5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $C(t){return t.tag===5||t.tag===3||t.tag===4}function H2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$C(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Rx(t,n,l){var h=t.tag;if(h===5||h===6)t=t.stateNode,n?l.nodeType===8?l.parentNode.insertBefore(t,n):l.insertBefore(t,n):(l.nodeType===8?(n=l.parentNode,n.insertBefore(t,l)):(n=l,n.appendChild(t)),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=H0));else if(h!==4&&(t=t.child,t!==null))for(Rx(t,n,l),t=t.sibling;t!==null;)Rx(t,n,l),t=t.sibling}function Fx(t,n,l){var h=t.tag;if(h===5||h===6)t=t.stateNode,n?l.insertBefore(t,n):l.appendChild(t);else if(h!==4&&(t=t.child,t!==null))for(Fx(t,n,l),t=t.sibling;t!==null;)Fx(t,n,l),t=t.sibling}var Zr=null,Ho=!1;function Da(t,n,l){for(l=l.child;l!==null;)WC(t,n,l),l=l.sibling}function WC(t,n,l){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(ym,l)}catch{}switch(l.tag){case 5:li||xu(l,n);case 6:var h=Zr,m=Ho;Zr=null,Da(t,n,l),Zr=h,Ho=m,Zr!==null&&(Ho?(t=Zr,l=l.stateNode,t.nodeType===8?t.parentNode.removeChild(l):t.removeChild(l)):Zr.removeChild(l.stateNode));break;case 18:Zr!==null&&(Ho?(t=Zr,l=l.stateNode,t.nodeType===8?q_(t.parentNode,l):t.nodeType===1&&q_(t,l),ep(t)):q_(Zr,l.stateNode));break;case 4:h=Zr,m=Ho,Zr=l.stateNode.containerInfo,Ho=!0,Da(t,n,l),Zr=h,Ho=m;break;case 0:case 11:case 14:case 15:if(!li&&(h=l.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var x=m,b=x.destroy;x=x.tag,b!==void 0&&(x&2||x&4)&&Bx(l,n,b),m=m.next}while(m!==h)}Da(t,n,l);break;case 1:if(!li&&(xu(l,n),h=l.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=l.memoizedProps,h.state=l.memoizedState,h.componentWillUnmount()}catch(s){fr(l,n,s)}Da(t,n,l);break;case 21:Da(t,n,l);break;case 22:l.mode&1?(li=(h=li)||l.memoizedState!==null,Da(t,n,l),li=h):Da(t,n,l);break;default:Da(t,n,l)}}function Z2(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var l=t.stateNode;l===null&&(l=t.stateNode=new E5),n.forEach(function(h){var m=z5.bind(null,t,h);l.has(h)||(l.add(h),h.then(m,m))})}}function $o(t,n){var l=n.deletions;if(l!==null)for(var h=0;h<l.length;h++){var m=l[h];try{var x=t,b=n,s=b;e:for(;s!==null;){switch(s.tag){case 5:Zr=s.stateNode,Ho=!1;break e;case 3:Zr=s.stateNode.containerInfo,Ho=!0;break e;case 4:Zr=s.stateNode.containerInfo,Ho=!0;break e}s=s.return}if(Zr===null)throw Error(pt(160));WC(x,b,m),Zr=null,Ho=!1;var C=m.alternate;C!==null&&(C.return=null),m.return=null}catch(k){fr(m,n,k)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)HC(n,t),n=n.sibling}function HC(t,n){var l=t.alternate,h=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($o(n,t),fs(t),h&4){try{$d(3,t,t.return),Cm(3,t)}catch(K){fr(t,t.return,K)}try{$d(5,t,t.return)}catch(K){fr(t,t.return,K)}}break;case 1:$o(n,t),fs(t),h&512&&l!==null&&xu(l,l.return);break;case 5:if($o(n,t),fs(t),h&512&&l!==null&&xu(l,l.return),t.flags&32){var m=t.stateNode;try{Kd(m,"")}catch(K){fr(t,t.return,K)}}if(h&4&&(m=t.stateNode,m!=null)){var x=t.memoizedProps,b=l!==null?l.memoizedProps:x,s=t.type,C=t.updateQueue;if(t.updateQueue=null,C!==null)try{s==="input"&&x.type==="radio"&&x.name!=null&&mS(m,x),ax(s,b);var k=ax(s,x);for(b=0;b<C.length;b+=2){var B=C[b],U=C[b+1];B==="style"?vS(m,U):B==="dangerouslySetInnerHTML"?yS(m,U):B==="children"?Kd(m,U):a1(m,B,U,k)}switch(s){case"input":nx(m,x);break;case"textarea":gS(m,x);break;case"select":var F=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!x.multiple;var Z=x.value;Z!=null?bu(m,!!x.multiple,Z,!1):F!==!!x.multiple&&(x.defaultValue!=null?bu(m,!!x.multiple,x.defaultValue,!0):bu(m,!!x.multiple,x.multiple?[]:"",!1))}m[op]=x}catch(K){fr(t,t.return,K)}}break;case 6:if($o(n,t),fs(t),h&4){if(t.stateNode===null)throw Error(pt(162));m=t.stateNode,x=t.memoizedProps;try{m.nodeValue=x}catch(K){fr(t,t.return,K)}}break;case 3:if($o(n,t),fs(t),h&4&&l!==null&&l.memoizedState.isDehydrated)try{ep(n.containerInfo)}catch(K){fr(t,t.return,K)}break;case 4:$o(n,t),fs(t);break;case 13:$o(n,t),fs(t),m=t.child,m.flags&8192&&(x=m.memoizedState!==null,m.stateNode.isHidden=x,!x||m.alternate!==null&&m.alternate.memoizedState!==null||(U1=mr())),h&4&&Z2(t);break;case 22:if(B=l!==null&&l.memoizedState!==null,t.mode&1?(li=(k=li)||B,$o(n,t),li=k):$o(n,t),fs(t),h&8192){if(k=t.memoizedState!==null,(t.stateNode.isHidden=k)&&!B&&t.mode&1)for(Mt=t,B=t.child;B!==null;){for(U=Mt=B;Mt!==null;){switch(F=Mt,Z=F.child,F.tag){case 0:case 11:case 14:case 15:$d(4,F,F.return);break;case 1:xu(F,F.return);var q=F.stateNode;if(typeof q.componentWillUnmount=="function"){h=F,l=F.return;try{n=h,q.props=n.memoizedProps,q.state=n.memoizedState,q.componentWillUnmount()}catch(K){fr(h,l,K)}}break;case 5:xu(F,F.return);break;case 22:if(F.memoizedState!==null){K2(U);continue}}Z!==null?(Z.return=F,Mt=Z):K2(U)}B=B.sibling}e:for(B=null,U=t;;){if(U.tag===5){if(B===null){B=U;try{m=U.stateNode,k?(x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(s=U.stateNode,C=U.memoizedProps.style,b=C!=null&&C.hasOwnProperty("display")?C.display:null,s.style.display=xS("display",b))}catch(K){fr(t,t.return,K)}}}else if(U.tag===6){if(B===null)try{U.stateNode.nodeValue=k?"":U.memoizedProps}catch(K){fr(t,t.return,K)}}else if((U.tag!==22&&U.tag!==23||U.memoizedState===null||U===t)&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===t)break e;for(;U.sibling===null;){if(U.return===null||U.return===t)break e;B===U&&(B=null),U=U.return}B===U&&(B=null),U.sibling.return=U.return,U=U.sibling}}break;case 19:$o(n,t),fs(t),h&4&&Z2(t);break;case 21:break;default:$o(n,t),fs(t)}}function fs(t){var n=t.flags;if(n&2){try{e:{for(var l=t.return;l!==null;){if($C(l)){var h=l;break e}l=l.return}throw Error(pt(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(Kd(m,""),h.flags&=-33);var x=H2(t);Fx(t,x,m);break;case 3:case 4:var b=h.stateNode.containerInfo,s=H2(t);Rx(t,s,b);break;default:throw Error(pt(161))}}catch(C){fr(t,t.return,C)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function S5(t,n,l){Mt=t,ZC(t)}function ZC(t,n,l){for(var h=(t.mode&1)!==0;Mt!==null;){var m=Mt,x=m.child;if(m.tag===22&&h){var b=m.memoizedState!==null||c0;if(!b){var s=m.alternate,C=s!==null&&s.memoizedState!==null||li;s=c0;var k=li;if(c0=b,(li=C)&&!k)for(Mt=m;Mt!==null;)b=Mt,C=b.child,b.tag===22&&b.memoizedState!==null?Y2(m):C!==null?(C.return=b,Mt=C):Y2(m);for(;x!==null;)Mt=x,ZC(x),x=x.sibling;Mt=m,c0=s,li=k}X2(t)}else m.subtreeFlags&8772&&x!==null?(x.return=m,Mt=x):X2(t)}}function X2(t){for(;Mt!==null;){var n=Mt;if(n.flags&8772){var l=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:li||Cm(5,n);break;case 1:var h=n.stateNode;if(n.flags&4&&!li)if(l===null)h.componentDidMount();else{var m=n.elementType===n.type?l.memoizedProps:Wo(n.type,l.memoizedProps);h.componentDidUpdate(m,l.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var x=n.updateQueue;x!==null&&z2(n,x,h);break;case 3:var b=n.updateQueue;if(b!==null){if(l=null,n.child!==null)switch(n.child.tag){case 5:l=n.child.stateNode;break;case 1:l=n.child.stateNode}z2(n,b,l)}break;case 5:var s=n.stateNode;if(l===null&&n.flags&4){l=s;var C=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&l.focus();break;case"img":C.src&&(l.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var k=n.alternate;if(k!==null){var B=k.memoizedState;if(B!==null){var U=B.dehydrated;U!==null&&ep(U)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pt(163))}li||n.flags&512&&Lx(n)}catch(F){fr(n,n.return,F)}}if(n===t){Mt=null;break}if(l=n.sibling,l!==null){l.return=n.return,Mt=l;break}Mt=n.return}}function K2(t){for(;Mt!==null;){var n=Mt;if(n===t){Mt=null;break}var l=n.sibling;if(l!==null){l.return=n.return,Mt=l;break}Mt=n.return}}function Y2(t){for(;Mt!==null;){var n=Mt;try{switch(n.tag){case 0:case 11:case 15:var l=n.return;try{Cm(4,n)}catch(C){fr(n,l,C)}break;case 1:var h=n.stateNode;if(typeof h.componentDidMount=="function"){var m=n.return;try{h.componentDidMount()}catch(C){fr(n,m,C)}}var x=n.return;try{Lx(n)}catch(C){fr(n,x,C)}break;case 5:var b=n.return;try{Lx(n)}catch(C){fr(n,b,C)}}}catch(C){fr(n,n.return,C)}if(n===t){Mt=null;break}var s=n.sibling;if(s!==null){s.return=n.return,Mt=s;break}Mt=n.return}}var C5=Math.ceil,im=ea.ReactCurrentDispatcher,O1=ea.ReactCurrentOwner,xo=ea.ReactCurrentBatchConfig,xn=0,Vr=null,Cr=null,Xr=0,Zi=0,vu=Qa(0),Br=0,hp=null,nc=0,Am=0,N1=0,Wd=null,Mi=null,U1=0,Ru=1/0,Gs=null,om=!1,Ox=null,$a=null,u0=!1,Na=null,sm=0,Hd=0,Nx=null,I0=-1,k0=0;function _i(){return xn&6?mr():I0!==-1?I0:I0=mr()}function Wa(t){return t.mode&1?xn&2&&Xr!==0?Xr&-Xr:c5.transition!==null?(k0===0&&(k0=PS()),k0):(t=Ln,t!==0||(t=window.event,t=t===void 0?16:NS(t.type)),t):1}function Ko(t,n,l,h){if(50<Hd)throw Hd=0,Nx=null,Error(pt(185));_p(t,l,h),(!(xn&2)||t!==Vr)&&(t===Vr&&(!(xn&2)&&(Am|=l),Br===4&&Fa(t,Xr)),Bi(t,h),l===1&&xn===0&&!(n.mode&1)&&(Ru=mr()+500,Em&&el()))}function Bi(t,n){var l=t.callbackNode;cM(t,n);var h=G0(t,t===Vr?Xr:0);if(h===0)l!==null&&s2(l),t.callbackNode=null,t.callbackPriority=0;else if(n=h&-h,t.callbackPriority!==n){if(l!=null&&s2(l),n===1)t.tag===0?l5(J2.bind(null,t)):iC(J2.bind(null,t)),i5(function(){!(xn&6)&&el()}),l=null;else{switch(zS(h)){case 1:l=d1;break;case 4:l=MS;break;case 16:l=V0;break;case 536870912:l=DS;break;default:l=V0}l=nA(l,XC.bind(null,t))}t.callbackPriority=n,t.callbackNode=l}}function XC(t,n){if(I0=-1,k0=0,xn&6)throw Error(pt(327));var l=t.callbackNode;if(Au()&&t.callbackNode!==l)return null;var h=G0(t,t===Vr?Xr:0);if(h===0)return null;if(h&30||h&t.expiredLanes||n)n=am(t,h);else{n=h;var m=xn;xn|=2;var x=YC();(Vr!==t||Xr!==n)&&(Gs=null,Ru=mr()+500,Yl(t,n));do try{k5();break}catch(s){KC(t,s)}while(1);S1(),im.current=x,xn=m,Cr!==null?n=0:(Vr=null,Xr=0,n=Br)}if(n!==0){if(n===2&&(m=dx(t),m!==0&&(h=m,n=Ux(t,m))),n===1)throw l=hp,Yl(t,0),Fa(t,h),Bi(t,mr()),l;if(n===6)Fa(t,h);else{if(m=t.current.alternate,!(h&30)&&!A5(m)&&(n=am(t,h),n===2&&(x=dx(t),x!==0&&(h=x,n=Ux(t,x))),n===1))throw l=hp,Yl(t,0),Fa(t,h),Bi(t,mr()),l;switch(t.finishedWork=m,t.finishedLanes=h,n){case 0:case 1:throw Error(pt(345));case 2:$l(t,Mi,Gs);break;case 3:if(Fa(t,h),(h&130023424)===h&&(n=U1+500-mr(),10<n)){if(G0(t,0)!==0)break;if(m=t.suspendedLanes,(m&h)!==h){_i(),t.pingedLanes|=t.suspendedLanes&m;break}t.timeoutHandle=vx($l.bind(null,t,Mi,Gs),n);break}$l(t,Mi,Gs);break;case 4:if(Fa(t,h),(h&4194240)===h)break;for(n=t.eventTimes,m=-1;0<h;){var b=31-Xo(h);x=1<<b,b=n[b],b>m&&(m=b),h&=~x}if(h=m,h=mr()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*C5(h/1960))-h,10<h){t.timeoutHandle=vx($l.bind(null,t,Mi,Gs),h);break}$l(t,Mi,Gs);break;case 5:$l(t,Mi,Gs);break;default:throw Error(pt(329))}}}return Bi(t,mr()),t.callbackNode===l?XC.bind(null,t):null}function Ux(t,n){var l=Wd;return t.current.memoizedState.isDehydrated&&(Yl(t,n).flags|=256),t=am(t,n),t!==2&&(n=Mi,Mi=l,n!==null&&jx(n)),t}function jx(t){Mi===null?Mi=t:Mi.push.apply(Mi,t)}function A5(t){for(var n=t;;){if(n.flags&16384){var l=n.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var h=0;h<l.length;h++){var m=l[h],x=m.getSnapshot;m=m.value;try{if(!Qo(x(),m))return!1}catch{return!1}}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Fa(t,n){for(n&=~N1,n&=~Am,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var l=31-Xo(n),h=1<<l;t[l]=-1,n&=~h}}function J2(t){if(xn&6)throw Error(pt(327));Au();var n=G0(t,0);if(!(n&1))return Bi(t,mr()),null;var l=am(t,n);if(t.tag!==0&&l===2){var h=dx(t);h!==0&&(n=h,l=Ux(t,h))}if(l===1)throw l=hp,Yl(t,0),Fa(t,n),Bi(t,mr()),l;if(l===6)throw Error(pt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,$l(t,Mi,Gs),Bi(t,mr()),null}function j1(t,n){var l=xn;xn|=1;try{return t(n)}finally{xn=l,xn===0&&(Ru=mr()+500,Em&&el())}}function rc(t){Na!==null&&Na.tag===0&&!(xn&6)&&Au();var n=xn;xn|=1;var l=xo.transition,h=Ln;try{if(xo.transition=null,Ln=1,t)return t()}finally{Ln=h,xo.transition=l,xn=n,!(xn&6)&&el()}}function V1(){Zi=vu.current,Zn(vu)}function Yl(t,n){t.finishedWork=null,t.finishedLanes=0;var l=t.timeoutHandle;if(l!==-1&&(t.timeoutHandle=-1,r5(l)),Cr!==null)for(l=Cr.return;l!==null;){var h=l;switch(b1(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Z0();break;case 3:Bu(),Zn(Pi),Zn(ui),D1();break;case 5:M1(h);break;case 4:Bu();break;case 13:Zn(lr);break;case 19:Zn(lr);break;case 10:C1(h.type._context);break;case 22:case 23:V1()}l=l.return}if(Vr=t,Cr=t=Ha(t.current,null),Xr=Zi=n,Br=0,hp=null,N1=Am=nc=0,Mi=Wd=null,Zl!==null){for(n=0;n<Zl.length;n++)if(l=Zl[n],h=l.interleaved,h!==null){l.interleaved=null;var m=h.next,x=l.pending;if(x!==null){var b=x.next;x.next=m,h.next=b}l.pending=h}Zl=null}return t}function KC(t,n){do{var l=Cr;try{if(S1(),S0.current=rm,nm){for(var h=cr.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}nm=!1}if(tc=0,jr=zr=cr=null,qd=!1,lp=0,O1.current=null,l===null||l.return===null){Br=1,hp=n,Cr=null;break}e:{var x=t,b=l.return,s=l,C=n;if(n=Xr,s.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var k=C,B=s,U=B.tag;if(!(B.mode&1)&&(U===0||U===11||U===15)){var F=B.alternate;F?(B.updateQueue=F.updateQueue,B.memoizedState=F.memoizedState,B.lanes=F.lanes):(B.updateQueue=null,B.memoizedState=null)}var Z=N2(b);if(Z!==null){Z.flags&=-257,U2(Z,b,s,x,n),Z.mode&1&&O2(x,k,n),n=Z,C=k;var q=n.updateQueue;if(q===null){var K=new Set;K.add(C),n.updateQueue=K}else q.add(C);break e}else{if(!(n&1)){O2(x,k,n),G1();break e}C=Error(pt(426))}}else if(Jn&&s.mode&1){var Y=N2(b);if(Y!==null){!(Y.flags&65536)&&(Y.flags|=256),U2(Y,b,s,x,n),E1(Lu(C,s));break e}}x=C=Lu(C,s),Br!==4&&(Br=2),Wd===null?Wd=[x]:Wd.push(x),x=b;do{switch(x.tag){case 3:x.flags|=65536,n&=-n,x.lanes|=n;var W=zC(x,C,n);P2(x,W);break e;case 1:s=C;var O=x.type,V=x.stateNode;if(!(x.flags&128)&&(typeof O.getDerivedStateFromError=="function"||V!==null&&typeof V.componentDidCatch=="function"&&($a===null||!$a.has(V)))){x.flags|=65536,n&=-n,x.lanes|=n;var Q=BC(x,s,n);P2(x,Q);break e}}x=x.return}while(x!==null)}QC(l)}catch(ue){n=ue,Cr===l&&l!==null&&(Cr=l=l.return);continue}break}while(1)}function YC(){var t=im.current;return im.current=rm,t===null?rm:t}function G1(){(Br===0||Br===3||Br===2)&&(Br=4),Vr===null||!(nc&268435455)&&!(Am&268435455)||Fa(Vr,Xr)}function am(t,n){var l=xn;xn|=2;var h=YC();(Vr!==t||Xr!==n)&&(Gs=null,Yl(t,n));do try{I5();break}catch(m){KC(t,m)}while(1);if(S1(),xn=l,im.current=h,Cr!==null)throw Error(pt(261));return Vr=null,Xr=0,Br}function I5(){for(;Cr!==null;)JC(Cr)}function k5(){for(;Cr!==null&&!eM();)JC(Cr)}function JC(t){var n=tA(t.alternate,t,Zi);t.memoizedProps=t.pendingProps,n===null?QC(t):Cr=n,O1.current=null}function QC(t){var n=t;do{var l=n.alternate;if(t=n.return,n.flags&32768){if(l=b5(l,n),l!==null){l.flags&=32767,Cr=l;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Br=6,Cr=null;return}}else if(l=w5(l,n,Zi),l!==null){Cr=l;return}if(n=n.sibling,n!==null){Cr=n;return}Cr=n=t}while(n!==null);Br===0&&(Br=5)}function $l(t,n,l){var h=Ln,m=xo.transition;try{xo.transition=null,Ln=1,M5(t,n,l,h)}finally{xo.transition=m,Ln=h}return null}function M5(t,n,l,h){do Au();while(Na!==null);if(xn&6)throw Error(pt(327));l=t.finishedWork;var m=t.finishedLanes;if(l===null)return null;if(t.finishedWork=null,t.finishedLanes=0,l===t.current)throw Error(pt(177));t.callbackNode=null,t.callbackPriority=0;var x=l.lanes|l.childLanes;if(uM(t,x),t===Vr&&(Cr=Vr=null,Xr=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||u0||(u0=!0,nA(V0,function(){return Au(),null})),x=(l.flags&15990)!==0,l.subtreeFlags&15990||x){x=xo.transition,xo.transition=null;var b=Ln;Ln=1;var s=xn;xn|=4,O1.current=null,T5(t,l),HC(l,t),KM(yx),q0=!!_x,yx=_x=null,t.current=l,S5(l),tM(),xn=s,Ln=b,xo.transition=x}else t.current=l;if(u0&&(u0=!1,Na=t,sm=m),x=t.pendingLanes,x===0&&($a=null),iM(l.stateNode),Bi(t,mr()),n!==null)for(h=t.onRecoverableError,l=0;l<n.length;l++)m=n[l],h(m.value,{componentStack:m.stack,digest:m.digest});if(om)throw om=!1,t=Ox,Ox=null,t;return sm&1&&t.tag!==0&&Au(),x=t.pendingLanes,x&1?t===Nx?Hd++:(Hd=0,Nx=t):Hd=0,el(),null}function Au(){if(Na!==null){var t=zS(sm),n=xo.transition,l=Ln;try{if(xo.transition=null,Ln=16>t?16:t,Na===null)var h=!1;else{if(t=Na,Na=null,sm=0,xn&6)throw Error(pt(331));var m=xn;for(xn|=4,Mt=t.current;Mt!==null;){var x=Mt,b=x.child;if(Mt.flags&16){var s=x.deletions;if(s!==null){for(var C=0;C<s.length;C++){var k=s[C];for(Mt=k;Mt!==null;){var B=Mt;switch(B.tag){case 0:case 11:case 15:$d(8,B,x)}var U=B.child;if(U!==null)U.return=B,Mt=U;else for(;Mt!==null;){B=Mt;var F=B.sibling,Z=B.return;if(qC(B),B===k){Mt=null;break}if(F!==null){F.return=Z,Mt=F;break}Mt=Z}}}var q=x.alternate;if(q!==null){var K=q.child;if(K!==null){q.child=null;do{var Y=K.sibling;K.sibling=null,K=Y}while(K!==null)}}Mt=x}}if(x.subtreeFlags&2064&&b!==null)b.return=x,Mt=b;else e:for(;Mt!==null;){if(x=Mt,x.flags&2048)switch(x.tag){case 0:case 11:case 15:$d(9,x,x.return)}var W=x.sibling;if(W!==null){W.return=x.return,Mt=W;break e}Mt=x.return}}var O=t.current;for(Mt=O;Mt!==null;){b=Mt;var V=b.child;if(b.subtreeFlags&2064&&V!==null)V.return=b,Mt=V;else e:for(b=O;Mt!==null;){if(s=Mt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Cm(9,s)}}catch(ue){fr(s,s.return,ue)}if(s===b){Mt=null;break e}var Q=s.sibling;if(Q!==null){Q.return=s.return,Mt=Q;break e}Mt=s.return}}if(xn=m,el(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(ym,t)}catch{}h=!0}return h}finally{Ln=l,xo.transition=n}}return!1}function Q2(t,n,l){n=Lu(l,n),n=zC(t,n,1),t=qa(t,n,1),n=_i(),t!==null&&(_p(t,1,n),Bi(t,n))}function fr(t,n,l){if(t.tag===3)Q2(t,t,l);else for(;n!==null;){if(n.tag===3){Q2(n,t,l);break}else if(n.tag===1){var h=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&($a===null||!$a.has(h))){t=Lu(l,t),t=BC(n,t,1),n=qa(n,t,1),t=_i(),n!==null&&(_p(n,1,t),Bi(n,t));break}}n=n.return}}function D5(t,n,l){var h=t.pingCache;h!==null&&h.delete(n),n=_i(),t.pingedLanes|=t.suspendedLanes&l,Vr===t&&(Xr&l)===l&&(Br===4||Br===3&&(Xr&130023424)===Xr&&500>mr()-U1?Yl(t,0):N1|=l),Bi(t,n)}function eA(t,n){n===0&&(t.mode&1?(n=e0,e0<<=1,!(e0&130023424)&&(e0=4194304)):n=1);var l=_i();t=Js(t,n),t!==null&&(_p(t,n,l),Bi(t,l))}function P5(t){var n=t.memoizedState,l=0;n!==null&&(l=n.retryLane),eA(t,l)}function z5(t,n){var l=0;switch(t.tag){case 13:var h=t.stateNode,m=t.memoizedState;m!==null&&(l=m.retryLane);break;case 19:h=t.stateNode;break;default:throw Error(pt(314))}h!==null&&h.delete(n),eA(t,l)}var tA;tA=function(t,n,l){if(t!==null)if(t.memoizedProps!==n.pendingProps||Pi.current)Di=!0;else{if(!(t.lanes&l)&&!(n.flags&128))return Di=!1,v5(t,n,l);Di=!!(t.flags&131072)}else Di=!1,Jn&&n.flags&1048576&&oC(n,Y0,n.index);switch(n.lanes=0,n.tag){case 2:var h=n.type;A0(t,n),t=n.pendingProps;var m=Du(n,ui.current);Cu(n,l),m=z1(null,n,h,t,m,l);var x=B1();return n.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,zi(h)?(x=!0,X0(n)):x=!1,n.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,I1(n),m.updater=Sm,n.stateNode=m,m._reactInternals=n,Ax(n,h,t,l),n=Mx(null,n,h,!0,x,l)):(n.tag=0,Jn&&x&&w1(n),gi(null,n,m,l),n=n.child),n;case 16:h=n.elementType;e:{switch(A0(t,n),t=n.pendingProps,m=h._init,h=m(h._payload),n.type=h,m=n.tag=L5(h),t=Wo(h,t),m){case 0:n=kx(null,n,h,t,l);break e;case 1:n=G2(null,n,h,t,l);break e;case 11:n=j2(null,n,h,t,l);break e;case 14:n=V2(null,n,h,Wo(h.type,t),l);break e}throw Error(pt(306,h,""))}return n;case 0:return h=n.type,m=n.pendingProps,m=n.elementType===h?m:Wo(h,m),kx(t,n,h,m,l);case 1:return h=n.type,m=n.pendingProps,m=n.elementType===h?m:Wo(h,m),G2(t,n,h,m,l);case 3:e:{if(OC(n),t===null)throw Error(pt(387));h=n.pendingProps,x=n.memoizedState,m=x.element,hC(t,n),em(n,h,null,l);var b=n.memoizedState;if(h=b.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},n.updateQueue.baseState=x,n.memoizedState=x,n.flags&256){m=Lu(Error(pt(423)),n),n=q2(t,n,h,l,m);break e}else if(h!==m){m=Lu(Error(pt(424)),n),n=q2(t,n,h,l,m);break e}else for(Xi=Ga(n.stateNode.containerInfo.firstChild),Ki=n,Jn=!0,Zo=null,l=cC(n,null,h,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Pu(),h===m){n=Qs(t,n,l);break e}gi(t,n,h,l)}n=n.child}return n;case 5:return dC(n),t===null&&Tx(n),h=n.type,m=n.pendingProps,x=t!==null?t.memoizedProps:null,b=m.children,xx(h,m)?b=null:x!==null&&xx(h,x)&&(n.flags|=32),FC(t,n),gi(t,n,b,l),n.child;case 6:return t===null&&Tx(n),null;case 13:return NC(t,n,l);case 4:return k1(n,n.stateNode.containerInfo),h=n.pendingProps,t===null?n.child=zu(n,null,h,l):gi(t,n,h,l),n.child;case 11:return h=n.type,m=n.pendingProps,m=n.elementType===h?m:Wo(h,m),j2(t,n,h,m,l);case 7:return gi(t,n,n.pendingProps,l),n.child;case 8:return gi(t,n,n.pendingProps.children,l),n.child;case 12:return gi(t,n,n.pendingProps.children,l),n.child;case 10:e:{if(h=n.type._context,m=n.pendingProps,x=n.memoizedProps,b=m.value,Vn(J0,h._currentValue),h._currentValue=b,x!==null)if(Qo(x.value,b)){if(x.children===m.children&&!Pi.current){n=Qs(t,n,l);break e}}else for(x=n.child,x!==null&&(x.return=n);x!==null;){var s=x.dependencies;if(s!==null){b=x.child;for(var C=s.firstContext;C!==null;){if(C.context===h){if(x.tag===1){C=Xs(-1,l&-l),C.tag=2;var k=x.updateQueue;if(k!==null){k=k.shared;var B=k.pending;B===null?C.next=C:(C.next=B.next,B.next=C),k.pending=C}}x.lanes|=l,C=x.alternate,C!==null&&(C.lanes|=l),Sx(x.return,l,n),s.lanes|=l;break}C=C.next}}else if(x.tag===10)b=x.type===n.type?null:x.child;else if(x.tag===18){if(b=x.return,b===null)throw Error(pt(341));b.lanes|=l,s=b.alternate,s!==null&&(s.lanes|=l),Sx(b,l,n),b=x.sibling}else b=x.child;if(b!==null)b.return=x;else for(b=x;b!==null;){if(b===n){b=null;break}if(x=b.sibling,x!==null){x.return=b.return,b=x;break}b=b.return}x=b}gi(t,n,m.children,l),n=n.child}return n;case 9:return m=n.type,h=n.pendingProps.children,Cu(n,l),m=vo(m),h=h(m),n.flags|=1,gi(t,n,h,l),n.child;case 14:return h=n.type,m=Wo(h,n.pendingProps),m=Wo(h.type,m),V2(t,n,h,m,l);case 15:return LC(t,n,n.type,n.pendingProps,l);case 17:return h=n.type,m=n.pendingProps,m=n.elementType===h?m:Wo(h,m),A0(t,n),n.tag=1,zi(h)?(t=!0,X0(n)):t=!1,Cu(n,l),PC(n,h,m),Ax(n,h,m,l),Mx(null,n,h,!0,t,l);case 19:return UC(t,n,l);case 22:return RC(t,n,l)}throw Error(pt(156,n.tag))};function nA(t,n){return kS(t,n)}function B5(t,n,l,h){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(t,n,l,h){return new B5(t,n,l,h)}function q1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function L5(t){if(typeof t=="function")return q1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===c1)return 11;if(t===u1)return 14}return 2}function Ha(t,n){var l=t.alternate;return l===null?(l=yo(t.tag,n,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=n,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&14680064,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,n=t.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l}function M0(t,n,l,h,m,x){var b=2;if(h=t,typeof t=="function")q1(t)&&(b=1);else if(typeof t=="string")b=5;else e:switch(t){case uu:return Jl(l.children,m,x,n);case l1:b=8,m|=8;break;case Yy:return t=yo(12,l,n,m|2),t.elementType=Yy,t.lanes=x,t;case Jy:return t=yo(13,l,n,m),t.elementType=Jy,t.lanes=x,t;case Qy:return t=yo(19,l,n,m),t.elementType=Qy,t.lanes=x,t;case dS:return Im(l,m,x,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case uS:b=10;break e;case hS:b=9;break e;case c1:b=11;break e;case u1:b=14;break e;case Ba:b=16,h=null;break e}throw Error(pt(130,t==null?t:typeof t,""))}return n=yo(b,l,n,m),n.elementType=t,n.type=h,n.lanes=x,n}function Jl(t,n,l,h){return t=yo(7,t,h,n),t.lanes=l,t}function Im(t,n,l,h){return t=yo(22,t,h,n),t.elementType=dS,t.lanes=l,t.stateNode={isHidden:!1},t}function J_(t,n,l){return t=yo(6,t,null,n),t.lanes=l,t}function Q_(t,n,l){return n=yo(4,t.children!==null?t.children:[],t.key,n),n.lanes=l,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function R5(t,n,l,h,m){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z_(0),this.expirationTimes=z_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z_(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function $1(t,n,l,h,m,x,b,s,C){return t=new R5(t,n,l,s,C),n===1?(n=1,x===!0&&(n|=8)):n=0,x=yo(3,null,null,n),t.current=x,x.stateNode=t,x.memoizedState={element:h,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},I1(x),t}function F5(t,n,l){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cu,key:h==null?null:""+h,children:t,containerInfo:n,implementation:l}}function rA(t){if(!t)return Xa;t=t._reactInternals;e:{if(ac(t)!==t||t.tag!==1)throw Error(pt(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(zi(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(pt(171))}if(t.tag===1){var l=t.type;if(zi(l))return rC(t,l,n)}return n}function iA(t,n,l,h,m,x,b,s,C){return t=$1(l,h,!0,t,m,x,b,s,C),t.context=rA(null),l=t.current,h=_i(),m=Wa(l),x=Xs(h,m),x.callback=n??null,qa(l,x,m),t.current.lanes=m,_p(t,m,h),Bi(t,h),t}function km(t,n,l,h){var m=n.current,x=_i(),b=Wa(m);return l=rA(l),n.context===null?n.context=l:n.pendingContext=l,n=Xs(x,b),n.payload={element:t},h=h===void 0?null:h,h!==null&&(n.callback=h),t=qa(m,n,b),t!==null&&(Ko(t,m,b,x),T0(t,m,b)),b}function lm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function eE(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<n?l:n}}function W1(t,n){eE(t,n),(t=t.alternate)&&eE(t,n)}function O5(){return null}var oA=typeof reportError=="function"?reportError:function(t){console.error(t)};function H1(t){this._internalRoot=t}Mm.prototype.render=H1.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(pt(409));km(t,n,null,null)};Mm.prototype.unmount=H1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;rc(function(){km(null,t,null,null)}),n[Ys]=null}};function Mm(t){this._internalRoot=t}Mm.prototype.unstable_scheduleHydration=function(t){if(t){var n=RS();t={blockedOn:null,target:t,priority:n};for(var l=0;l<Ra.length&&n!==0&&n<Ra[l].priority;l++);Ra.splice(l,0,t),l===0&&OS(t)}};function Z1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function tE(){}function N5(t,n,l,h,m){if(m){if(typeof h=="function"){var x=h;h=function(){var k=lm(b);x.call(k)}}var b=iA(n,h,t,0,null,!1,!1,"",tE);return t._reactRootContainer=b,t[Ys]=b.current,rp(t.nodeType===8?t.parentNode:t),rc(),b}for(;m=t.lastChild;)t.removeChild(m);if(typeof h=="function"){var s=h;h=function(){var k=lm(C);s.call(k)}}var C=$1(t,0,!1,null,null,!1,!1,"",tE);return t._reactRootContainer=C,t[Ys]=C.current,rp(t.nodeType===8?t.parentNode:t),rc(function(){km(n,C,l,h)}),C}function Pm(t,n,l,h,m){var x=l._reactRootContainer;if(x){var b=x;if(typeof m=="function"){var s=m;m=function(){var C=lm(b);s.call(C)}}km(n,b,t,m)}else b=N5(l,n,t,m,h);return lm(b)}BS=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var l=Rd(n.pendingLanes);l!==0&&(p1(n,l|1),Bi(n,mr()),!(xn&6)&&(Ru=mr()+500,el()))}break;case 13:rc(function(){var h=Js(t,1);if(h!==null){var m=_i();Ko(h,t,1,m)}}),W1(t,1)}};f1=function(t){if(t.tag===13){var n=Js(t,134217728);if(n!==null){var l=_i();Ko(n,t,134217728,l)}W1(t,134217728)}};LS=function(t){if(t.tag===13){var n=Wa(t),l=Js(t,n);if(l!==null){var h=_i();Ko(l,t,n,h)}W1(t,n)}};RS=function(){return Ln};FS=function(t,n){var l=Ln;try{return Ln=t,n()}finally{Ln=l}};cx=function(t,n,l){switch(n){case"input":if(nx(t,l),n=l.name,l.type==="radio"&&n!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<l.length;n++){var h=l[n];if(h!==t&&h.form===t.form){var m=bm(h);if(!m)throw Error(pt(90));fS(h),nx(h,m)}}}break;case"textarea":gS(t,l);break;case"select":n=l.value,n!=null&&bu(t,!!l.multiple,n,!1)}};ES=j1;TS=rc;var U5={usingClientEntryPoint:!1,Events:[xp,fu,bm,wS,bS,j1]},Dd={findFiberByHostInstance:Hl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},j5={bundleType:Dd.bundleType,version:Dd.version,rendererPackageName:Dd.rendererPackageName,rendererConfig:Dd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=AS(t),t===null?null:t.stateNode},findFiberByHostInstance:Dd.findFiberByHostInstance||O5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var h0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!h0.isDisabled&&h0.supportsFiber)try{ym=h0.inject(j5),vs=h0}catch{}}Qi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U5;Qi.createPortal=function(t,n){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z1(n))throw Error(pt(200));return F5(t,n,null,l)};Qi.createRoot=function(t,n){if(!Z1(t))throw Error(pt(299));var l=!1,h="",m=oA;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(h=n.identifierPrefix),n.onRecoverableError!==void 0&&(m=n.onRecoverableError)),n=$1(t,1,!1,null,null,l,!1,h,m),t[Ys]=n.current,rp(t.nodeType===8?t.parentNode:t),new H1(n)};Qi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(pt(188)):(t=Object.keys(t).join(","),Error(pt(268,t)));return t=AS(n),t=t===null?null:t.stateNode,t};Qi.flushSync=function(t){return rc(t)};Qi.hydrate=function(t,n,l){if(!Dm(n))throw Error(pt(200));return Pm(null,t,n,!0,l)};Qi.hydrateRoot=function(t,n,l){if(!Z1(t))throw Error(pt(405));var h=l!=null&&l.hydratedSources||null,m=!1,x="",b=oA;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onRecoverableError!==void 0&&(b=l.onRecoverableError)),n=iA(n,null,t,1,l??null,m,!1,x,b),t[Ys]=n.current,rp(t),h)for(t=0;t<h.length;t++)l=h[t],m=l._getVersion,m=m(l._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[l,m]:n.mutableSourceEagerHydrationData.push(l,m);return new Mm(n)};Qi.render=function(t,n,l){if(!Dm(n))throw Error(pt(200));return Pm(null,t,n,!1,l)};Qi.unmountComponentAtNode=function(t){if(!Dm(t))throw Error(pt(40));return t._reactRootContainer?(rc(function(){Pm(null,null,t,!1,function(){t._reactRootContainer=null,t[Ys]=null})}),!0):!1};Qi.unstable_batchedUpdates=j1;Qi.unstable_renderSubtreeIntoContainer=function(t,n,l,h){if(!Dm(l))throw Error(pt(200));if(t==null||t._reactInternals===void 0)throw Error(pt(38));return Pm(t,n,l,!1,h)};Qi.version="18.3.1-next-f1338f8080-20240426";function sA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sA)}catch(t){console.error(t)}}sA(),sS.exports=Qi;var X1=sS.exports,Vx,nE=X1;Vx=nE.createRoot,nE.hydrateRoot;const V5="Logging",G5="NoHubcallbackProvidedException";var Hi;(function(t){t.DEBUG="DEBUG",t.ERROR="ERROR",t.INFO="INFO",t.WARN="WARN",t.VERBOSE="VERBOSE",t.NONE="NONE"})(Hi||(Hi={}));const rE={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class Yo{constructor(n,l=Hi.WARN){this.name=n,this.level=l,this._pluggables=[]}_padding(n){return n<10?"0"+n:""+n}_ts(){const n=new Date;return[this._padding(n.getMinutes()),this._padding(n.getSeconds())].join(":")+"."+n.getMilliseconds()}configure(n){return n?(this._config=n,this._config):this._config}_log(n,...l){let h=this.level;Yo.LOG_LEVEL&&(h=Yo.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(h=window.LOG_LEVEL);const m=rE[h];if(!(rE[n]>=m))return;let b=console.log.bind(console);n===Hi.ERROR&&console.error&&(b=console.error.bind(console)),n===Hi.WARN&&console.warn&&(b=console.warn.bind(console)),Yo.BIND_ALL_LOG_LEVELS&&(n===Hi.INFO&&console.info&&(b=console.info.bind(console)),n===Hi.DEBUG&&console.debug&&(b=console.debug.bind(console)));const s=`[${n}] ${this._ts()} ${this.name}`;let C="";if(l.length===1&&typeof l[0]=="string")C=`${s} - ${l[0]}`,b(C);else if(l.length===1)C=`${s} ${l[0]}`,b(s,l[0]);else if(typeof l[0]=="string"){let k=l.slice(1);k.length===1&&(k=k[0]),C=`${s} - ${l[0]} ${k}`,b(`${s} - ${l[0]}`,k)}else C=`${s} ${l}`,b(s,l);for(const k of this._pluggables){const B={message:C,timestamp:Date.now()};k.pushLogs([B])}}log(...n){this._log(Hi.INFO,...n)}info(...n){this._log(Hi.INFO,...n)}warn(...n){this._log(Hi.WARN,...n)}error(...n){this._log(Hi.ERROR,...n)}debug(...n){this._log(Hi.DEBUG,...n)}verbose(...n){this._log(Hi.VERBOSE,...n)}addPluggable(n){n&&n.getCategoryName()===V5&&(this._pluggables.push(n),n.configure(this._config))}listPluggables(){return this._pluggables}}Yo.LOG_LEVEL=null;Yo.BIND_ALL_LOG_LEVELS=!1;class bs extends Error{constructor({message:n,name:l,recoverySuggestion:h,underlyingError:m,metadata:x}){if(super(n),this.name=l,this.underlyingError=m,this.recoverySuggestion=h,x){const{extendedRequestId:b,httpStatusCode:s,requestId:C}=x;this.metadata={extendedRequestId:b,httpStatusCode:s,requestId:C}}this.constructor=bs,Object.setPrototypeOf(this,bs.prototype)}}var ic;(function(t){t.NoEndpointId="NoEndpointId",t.PlatformNotSupported="PlatformNotSupported",t.Unknown="Unknown",t.NetworkError="NetworkError"})(ic||(ic={}));const aA=(t,n=bs)=>(l,h,m)=>{const{message:x,recoverySuggestion:b}=t[h];if(!l)throw new n({name:h,message:m?`${x} ${m}`:x,recoverySuggestion:b})},cm=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",Pd=new Yo("Hub");class q5{constructor(n){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=n}_remove(n,l){const h=this.listeners.get(n);if(!h){Pd.warn(`No listeners for ${n}`);return}this.listeners.set(n,[...h.filter(({callback:m})=>m!==l)])}dispatch(n,l,h,m){typeof n=="string"&&this.protectedChannels.indexOf(n)>-1&&(m===cm||Pd.warn(`WARNING: ${n} is protected and dispatching on it can have unintended consequences`));const x={channel:n,payload:{...l},source:h,patternInfo:[]};try{this._toListeners(x)}catch(b){Pd.error(b)}}listen(n,l,h="noname"){let m;if(typeof l!="function")throw new bs({name:G5,message:"No callback supplied to Hub"});m=l;let x=this.listeners.get(n);return x||(x=[],this.listeners.set(n,x)),x.push({name:h,callback:m}),()=>{this._remove(n,m)}}_toListeners(n){const{channel:l,payload:h}=n,m=this.listeners.get(l);m&&m.forEach(x=>{Pd.debug(`Dispatching to ${l} with `,h);try{x.callback(n)}catch(b){Pd.error(b)}})}}const Gx=new q5("__default__"),$5=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new bs({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},W5={convert(t,n){let l=t;return n!=null&&n.urlSafe&&(l=l.replace(/-/g,"+").replace(/_/g,"/")),$5()(l)}};var $s;(function(t){t.AuthTokenConfigException="AuthTokenConfigException",t.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",t.AuthUserPoolException="AuthUserPoolException",t.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",t.OAuthNotConfigureException="OAuthNotConfigureException"})($s||($s={}));const H5={[$s.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[$s.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[$s.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[$s.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[$s.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},lA=aA(H5);function ki(t){let n=!0;t?n=!!t.userPoolId&&!!t.userPoolClientId:n=!1,lA(n,$s.AuthUserPoolException)}function D0(t){const n=!!(t!=null&&t.identityPoolId);lA(n,$s.InvalidIdentityPoolIdException)}function dp(t){const n=t.split(".");if(n.length!==3)throw new Error("Invalid token");try{const h=n[1].replace(/-/g,"+").replace(/_/g,"/"),m=decodeURIComponent(W5.convert(h).split("").map(b=>`%${`00${b.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),x=JSON.parse(m);return{toString:()=>t,payload:x}}catch{throw new Error("Invalid token payload")}}const cA=t=>{const n=Reflect.ownKeys(t);for(const l of n){const h=t[l];(h&&typeof h=="object"||typeof h=="function")&&cA(h)}return Object.freeze(t)},Z5=new Yo("parseAWSExports"),X5={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},K5=(t={})=>{var tt,nn,Wt,yn,Ht,Lr;if(!Object.prototype.hasOwnProperty.call(t,"aws_project_region"))throw new bs({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:n,aws_appsync_authenticationType:l,aws_appsync_graphqlEndpoint:h,aws_appsync_region:m,aws_bots_config:x,aws_cognito_identity_pool_id:b,aws_cognito_sign_up_verification_method:s,aws_cognito_mfa_configuration:C,aws_cognito_mfa_types:k,aws_cognito_password_protection_settings:B,aws_cognito_verification_mechanisms:U,aws_cognito_signup_attributes:F,aws_cognito_social_providers:Z,aws_cognito_username_attributes:q,aws_mandatory_sign_in:K,aws_mobile_analytics_app_id:Y,aws_mobile_analytics_app_region:W,aws_user_files_s3_bucket:O,aws_user_files_s3_bucket_region:V,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:Q,aws_user_pools_id:ue,aws_user_pools_web_client_id:fe,geo:we,oauth:Ce,predictions:Te,aws_cloud_logic_custom:Se,Notifications:Ne,modelIntrospection:Ue}=t,Ve={};Y&&(Ve.Analytics={Pinpoint:{appId:Y,region:W}});const{InAppMessaging:St,Push:kt}=Ne??{};if(St!=null&&St.AWSPinpoint||kt!=null&&kt.AWSPinpoint){if(St!=null&&St.AWSPinpoint){const{appId:ln,region:Rt}=St.AWSPinpoint;Ve.Notifications={InAppMessaging:{Pinpoint:{appId:ln,region:Rt}}}}if(kt!=null&&kt.AWSPinpoint){const{appId:ln,region:Rt}=kt.AWSPinpoint;Ve.Notifications={...Ve.Notifications,PushNotification:{Pinpoint:{appId:ln,region:Rt}}}}}if(Array.isArray(x)&&(Ve.Interactions={LexV1:Object.fromEntries(x.map(ln=>[ln.name,ln]))}),h){const ln=X5[l];ln||Z5.debug(`Invalid authentication type ${l}. Falling back to IAM.`),Ve.API={GraphQL:{endpoint:h,apiKey:n,region:m,defaultAuthMode:ln??"iam"}},Ue&&(Ve.API.GraphQL.modelIntrospection=Ue)}const Ot=C?{status:C&&C.toLowerCase(),totpEnabled:(k==null?void 0:k.includes("TOTP"))??!1,smsEnabled:(k==null?void 0:k.includes("SMS"))??!1}:void 0,on=B?{minLength:B.passwordPolicyMinLength,requireLowercase:((tt=B.passwordPolicyCharacters)==null?void 0:tt.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((nn=B.passwordPolicyCharacters)==null?void 0:nn.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((Wt=B.passwordPolicyCharacters)==null?void 0:Wt.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((yn=B.passwordPolicyCharacters)==null?void 0:yn.includes("REQUIRES_SYMBOLS"))??!1}:void 0,bt=Array.from(new Set([...U??[],...F??[]])).reduce((ln,Rt)=>({...ln,[Rt.toLowerCase()]:{required:!0}}),{}),ft=(q==null?void 0:q.includes("EMAIL"))??!1,je=(q==null?void 0:q.includes("PHONE_NUMBER"))??!1;(b||ue)&&(Ve.Auth={Cognito:{identityPoolId:b,allowGuestAccess:K!=="enable",signUpVerificationMethod:s,userAttributes:bt,userPoolClientId:fe,userPoolId:ue,mfa:Ot,passwordFormat:on,loginWith:{username:!(ft||je),email:ft,phone:je}}});const Je=Ce?Object.keys(Ce).length>0:!1,et=Z?Z.length>0:!1;if(Ve.Auth&&Je&&(Ve.Auth.Cognito.loginWith={...Ve.Auth.Cognito.loginWith,oauth:{...Y5(Ce),...et&&{providers:J5(Z)}}}),O&&(Ve.Storage={S3:{bucket:O,region:V,dangerouslyConnectToHttpEndpointForTesting:Q}}),we){const{amazon_location_service:ln}=we;Ve.Geo={LocationService:{maps:ln.maps,geofenceCollections:ln.geofenceCollections,searchIndices:ln.search_indices,region:ln.region}}}if(Se&&(Ve.API={...Ve.API,REST:Se.reduce((ln,Rt)=>{const{name:Yr,endpoint:zn,region:Xn,service:mn}=Rt;return{...ln,[Yr]:{endpoint:zn,...mn?{service:mn}:void 0,...Xn?{region:Xn}:void 0}}},{})}),Te){const{VoiceId:ln}=((Lr=(Ht=Te==null?void 0:Te.convert)==null?void 0:Ht.speechGenerator)==null?void 0:Lr.defaults)??{};Ve.Predictions=ln?{...Te,convert:{...Te.convert,speechGenerator:{...Te.convert.speechGenerator,defaults:{voiceId:ln}}}}:Te}return Ve},iE=t=>(t==null?void 0:t.split(","))??[],Y5=({domain:t,scope:n,redirectSignIn:l,redirectSignOut:h,responseType:m})=>({domain:t,scopes:n,redirectSignIn:iE(l),redirectSignOut:iE(h),responseType:m}),J5=t=>t.map(n=>{const l=n.toLowerCase();return l.charAt(0).toUpperCase()+l.slice(1)}),Q5=Symbol("oauth-listener");let d0;const eD=new Uint8Array(16);function tD(){if(!d0&&(d0=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!d0))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d0(eD)}const Hr=[];for(let t=0;t<256;++t)Hr.push((t+256).toString(16).slice(1));function nD(t,n=0){return Hr[t[n+0]]+Hr[t[n+1]]+Hr[t[n+2]]+Hr[t[n+3]]+"-"+Hr[t[n+4]]+Hr[t[n+5]]+"-"+Hr[t[n+6]]+Hr[t[n+7]]+"-"+Hr[t[n+8]]+Hr[t[n+9]]+"-"+Hr[t[n+10]]+Hr[t[n+11]]+Hr[t[n+12]]+Hr[t[n+13]]+Hr[t[n+14]]+Hr[t[n+15]]}const rD=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),oE={randomUUID:rD};function iD(t,n,l){if(oE.randomUUID&&!n&&!t)return oE.randomUUID();t=t||{};const h=t.random||(t.rng||tD)();if(h[6]=h[6]&15|64,h[8]=h[8]&63|128,n){l=l||0;for(let m=0;m<16;++m)n[l+m]=h[m];return n}return nD(h)}function oD(t){const{version:n}=t;return n?n.startsWith("1"):!1}function sD(t){if(!t)return;const{bucket_name:n,aws_region:l,buckets:h}=t;return{S3:{bucket:n,region:l,buckets:h&&_D(h)}}}function aD(t){if(!t)return;const{user_pool_id:n,user_pool_client_id:l,identity_pool_id:h,password_policy:m,mfa_configuration:x,mfa_methods:b,unauthenticated_identities_enabled:s,oauth:C,username_attributes:k,standard_required_attributes:B,groups:U}=t,F={Cognito:{userPoolId:n,userPoolClientId:l,groups:U}};return h&&(F.Cognito={...F.Cognito,identityPoolId:h}),m&&(F.Cognito.passwordFormat={requireLowercase:m.require_lowercase,requireNumbers:m.require_numbers,requireUppercase:m.require_uppercase,requireSpecialCharacters:m.require_symbols,minLength:m.min_length??6}),x&&(F.Cognito.mfa={status:gD(x),smsEnabled:b==null?void 0:b.includes("SMS"),totpEnabled:b==null?void 0:b.includes("TOTP")}),s&&(F.Cognito.allowGuestAccess=s),C&&(F.Cognito.loginWith={oauth:{domain:C.domain,redirectSignIn:C.redirect_sign_in_uri,redirectSignOut:C.redirect_sign_out_uri,responseType:C.response_type==="token"?"token":"code",scopes:C.scopes,providers:mD(C.identity_providers)}}),k&&(F.Cognito.loginWith={...F.Cognito.loginWith,email:k.includes("email"),phone:k.includes("phone_number"),username:k.includes("username")}),B&&(F.Cognito.userAttributes=B.reduce((Z,q)=>({...Z,[q]:{required:!0}}),{})),F}function lD(t){if(!(t!=null&&t.amazon_pinpoint))return;const{amazon_pinpoint:n}=t;return{Pinpoint:{appId:n.app_id,region:n.aws_region}}}function cD(t){if(!t)return;const{aws_region:n,geofence_collections:l,maps:h,search_indices:m}=t;return{LocationService:{region:n,searchIndices:m,geofenceCollections:l,maps:h}}}function uD(t){if(!t)return;const{aws_region:n,default_authorization_type:l,url:h,api_key:m,model_introspection:x}=t;return{GraphQL:{endpoint:h,defaultAuthMode:uA(l),region:n,apiKey:m,modelIntrospection:x}}}function hD(t){if(!(t!=null&&t.events))return;const{url:n,aws_region:l,api_key:h,default_authorization_type:m}=t.events;return{Events:{endpoint:n,defaultAuthMode:uA(m),region:l,apiKey:h}}}function dD(t){if(!t)return;const{aws_region:n,channels:l,amazon_pinpoint_app_id:h}=t,m=l.includes("IN_APP_MESSAGING"),x=l.includes("APNS")||l.includes("FCM");if(!(m||x))return;const b={};return m&&(b.InAppMessaging={Pinpoint:{appId:h,region:n}}),x&&(b.PushNotification={Pinpoint:{appId:h,region:n}}),b}function pD(t){const n={};if(t.storage&&(n.Storage=sD(t.storage)),t.auth&&(n.Auth=aD(t.auth)),t.analytics&&(n.Analytics=lD(t.analytics)),t.geo&&(n.Geo=cD(t.geo)),t.data&&(n.API=uD(t.data)),t.custom){const l=hD(t.custom);l&&"Events"in l&&(n.API={...n.API,...l})}return t.notifications&&(n.Notifications=dD(t.notifications)),n}const fD={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function uA(t){return fD[t]}const sE={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function mD(t=[]){return t.reduce((n,l)=>(sE[l]!==void 0&&n.push(sE[l]),n),[])}function gD(t){return t==="OPTIONAL"?"optional":t==="REQUIRED"?"on":"off"}function _D(t){const n={};return t.forEach(({name:l,bucket_name:h,aws_region:m,paths:x})=>{if(l in n)throw new Error(`Duplicate friendly name found: ${l}. Name must be unique.`);const b=x?Object.entries(x).reduce((s,[C,k])=>(k!==void 0&&(s[C]=k),s),{}):void 0;n[l]={bucketName:h,region:m,paths:b}}),n}const hA=t=>Object.keys(t).some(n=>n.startsWith("aws_"))?K5(t):oD(t)?pD(t):t,yD=t=>new TextEncoder().encode(t);typeof Buffer<"u"&&Buffer.from;for(let t=0;t<256;t++){let n=t.toString(16).toLowerCase();n.length===1&&(n=`0${n}`)}var pr;(function(t){t.WebUnknown="0",t.React="1",t.NextJs="2",t.Angular="3",t.VueJs="4",t.Nuxt="5",t.Svelte="6",t.ServerSideUnknown="100",t.ReactSSR="101",t.NextJsSSR="102",t.AngularSSR="103",t.VueJsSSR="104",t.NuxtSSR="105",t.SvelteSSR="106",t.ReactNative="201",t.Expo="202"})(pr||(pr={}));var aE;(function(t){t.AI="ai",t.API="api",t.Auth="auth",t.Analytics="analytics",t.DataStore="datastore",t.Geo="geo",t.InAppMessaging="inappmessaging",t.Interactions="interactions",t.Predictions="predictions",t.PubSub="pubsub",t.PushNotification="pushnotification",t.Storage="storage"})(aE||(aE={}));var lE;(function(t){t.CreateConversation="1",t.GetConversation="2",t.ListConversations="3",t.DeleteConversation="4",t.SendMessage="5",t.ListMessages="6",t.OnMessage="7",t.Generation="8",t.UpdateConversation="9"})(lE||(lE={}));var cE;(function(t){t.Record="1",t.IdentifyUser="2"})(cE||(cE={}));var uE;(function(t){t.GraphQl="1",t.Get="2",t.Post="3",t.Put="4",t.Patch="5",t.Del="6",t.Head="7"})(uE||(uE={}));var hE;(function(t){t.SignUp="1",t.ConfirmSignUp="2",t.ResendSignUpCode="3",t.SignIn="4",t.FetchMFAPreference="6",t.UpdateMFAPreference="7",t.SetUpTOTP="10",t.VerifyTOTPSetup="11",t.ConfirmSignIn="12",t.DeleteUserAttributes="15",t.DeleteUser="16",t.UpdateUserAttributes="17",t.FetchUserAttributes="18",t.ConfirmUserAttribute="22",t.SignOut="26",t.UpdatePassword="27",t.ResetPassword="28",t.ConfirmResetPassword="29",t.FederatedSignIn="30",t.RememberDevice="32",t.ForgetDevice="33",t.FetchDevices="34",t.SendUserAttributeVerificationCode="35",t.SignInWithRedirect="36",t.StartWebAuthnRegistration="37",t.CompleteWebAuthnRegistration="38",t.ListWebAuthnCredentials="39",t.DeleteWebAuthnCredential="40"})(hE||(hE={}));var dE;(function(t){t.Subscribe="1",t.GraphQl="2"})(dE||(dE={}));var pE;(function(t){t.SearchByText="0",t.SearchByCoordinates="1",t.SearchForSuggestions="2",t.SearchByPlaceId="3",t.SaveGeofences="4",t.GetGeofence="5",t.ListGeofences="6",t.DeleteGeofences="7"})(pE||(pE={}));var fE;(function(t){t.SyncMessages="1",t.IdentifyUser="2",t.NotifyMessageInteraction="3"})(fE||(fE={}));var mE;(function(t){t.None="0"})(mE||(mE={}));var gE;(function(t){t.Convert="1",t.Identify="2",t.Interpret="3"})(gE||(gE={}));var _E;(function(t){t.Subscribe="1"})(_E||(_E={}));var yE;(function(t){t.InitializePushNotifications="1",t.IdentifyUser="2"})(yE||(yE={}));var xE;(function(t){t.UploadData="1",t.DownloadData="2",t.List="3",t.Copy="4",t.Remove="5",t.GetProperties="6",t.GetUrl="7",t.GetDataAccess="8",t.ListCallerAccessGrants="9"})(xE||(xE={}));const dA="6.14.3",zm=()=>typeof global<"u",Vu=()=>typeof window<"u",pA=()=>typeof document<"u",K1=()=>typeof process<"u",pp=(t,n)=>!!Object.keys(t).find(l=>l.startsWith(n));function xD(){const t=h=>h.startsWith("_react")||h.startsWith("__react"),n=h=>Object.keys(h).find(t),l=()=>Array.from(document.querySelectorAll("[id]"));return pA()&&l().some(n)}function vD(){return K1()&&typeof process.env<"u"&&!!Object.keys(process.env).find(t=>t.includes("react"))}function wD(){return Vu()&&pp(window,"__VUE")}function bD(){return zm()&&pp(global,"__VUE")}function ED(){return Vu()&&pp(window,"__SVELTE")}function TD(){return K1()&&typeof process.env<"u"&&!!Object.keys(process.env).find(t=>t.includes("svelte"))}function SD(){return Vu()&&window.next&&typeof window.next=="object"}function CD(){return zm()&&(pp(global,"__next")||pp(global,"__NEXT"))}function AD(){return Vu()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function ID(){return zm()&&typeof global.__NUXT_PATHS__<"u"}function kD(){const t=!!(pA()&&document.querySelector("[ng-version]")),n=!!(Vu()&&typeof window.ng<"u");return t||n}function MD(){var t;return K1()&&typeof process.env=="object"&&((t={}.npm_lifecycle_script)==null?void 0:t.startsWith("ng "))||!1}function DD(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function PD(){return zm()&&typeof global.expo<"u"}function zD(){return Vu()}const BD=[{platform:pr.Expo,detectionMethod:PD},{platform:pr.ReactNative,detectionMethod:DD},{platform:pr.NextJs,detectionMethod:SD},{platform:pr.Nuxt,detectionMethod:AD},{platform:pr.Angular,detectionMethod:kD},{platform:pr.React,detectionMethod:xD},{platform:pr.VueJs,detectionMethod:wD},{platform:pr.Svelte,detectionMethod:ED},{platform:pr.WebUnknown,detectionMethod:zD},{platform:pr.NextJsSSR,detectionMethod:CD},{platform:pr.NuxtSSR,detectionMethod:ID},{platform:pr.ReactSSR,detectionMethod:vD},{platform:pr.VueJsSSR,detectionMethod:bD},{platform:pr.AngularSSR,detectionMethod:MD},{platform:pr.SvelteSSR,detectionMethod:TD}];function LD(){var t;return((t=BD.find(n=>n.detectionMethod()))==null?void 0:t.platform)||pr.ServerSideUnknown}let Zd;const P0=[];let um=!1;const RD=10,FD=10,OD=1e3,Y1=()=>{var t;if(!Zd){if(Zd=LD(),um)for(;P0.length;)(t=P0.pop())==null||t();else P0.forEach(n=>{n()});vE(pr.ServerSideUnknown,RD),vE(pr.WebUnknown,FD)}return Zd},fA=t=>{um||P0.push(t)};function ND(){Zd=void 0}function vE(t,n){Zd===t&&!um&&setTimeout(()=>{ND(),um=!0,setTimeout(Y1,OD)},n)}const UD={},jD=(t,n)=>{var l,h;return(h=(l=UD[t])==null?void 0:l[n])==null?void 0:h.additionalDetails},mA="aws-amplify",gA=t=>t.replace(/\+.*/,"");class VD{constructor(){this.userAgent=`${mA}/${gA(dA)}`}get framework(){return Y1()}get isReactNative(){return this.framework===pr.ReactNative||this.framework===pr.Expo}observeFrameworkChanges(n){fA(n)}}new VD;const GD=({category:t,action:n}={})=>{const l=[[mA,gA(dA)]];if(t&&l.push([t,n]),l.push(["framework",Y1()]),t&&n){const h=jD(t,n);h&&h.forEach(m=>{l.push(m)})}return l},J1=t=>GD(t).map(([h,m])=>h&&m?`${h}/${m}`:h).join(" "),qD=()=>typeof window<"u"&&typeof window.document<"u";class $D{configure(n,l){this.authConfig=n,this.authOptions=l}async fetchAuthSession(n={}){var x,b,s,C,k,B;let l,h;const m=await this.getTokens(n);return m?(h=(b=(x=m.accessToken)==null?void 0:x.payload)==null?void 0:b.sub,l=await((C=(s=this.authOptions)==null?void 0:s.credentialsProvider)==null?void 0:C.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:m,authenticated:!0,forceRefresh:n.forceRefresh}))):l=await((B=(k=this.authOptions)==null?void 0:k.credentialsProvider)==null?void 0:B.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:n.forceRefresh})),{tokens:m,credentials:l==null?void 0:l.credentials,identityId:l==null?void 0:l.identityId,userSub:h}}async clearCredentials(){var n,l;await((l=(n=this.authOptions)==null?void 0:n.credentialsProvider)==null?void 0:l.clearCredentialsAndIdentityId())}async getTokens(n){var l,h;return await((h=(l=this.authOptions)==null?void 0:l.tokenProvider)==null?void 0:h.getTokens(n))??void 0}}class WD{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new $D}configure(n,l){const h=hA(n);this.resourcesConfig=h,l&&(this.libraryOptions=l),this.resourcesConfig=cA(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Gx.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",cm),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[Q5](n){var l,h,m;(h=(l=this.resourcesConfig.Auth)==null?void 0:l.Cognito.loginWith)!=null&&h.oauth?n((m=this.resourcesConfig.Auth)==null?void 0:m.Cognito):this.oAuthListener=n}notifyOAuthListener(){var n,l,h;!((l=(n=this.resourcesConfig.Auth)==null?void 0:n.Cognito.loginWith)!=null&&l.oauth)||!this.oAuthListener||(this.oAuthListener((h=this.resourcesConfig.Auth)==null?void 0:h.Cognito),this.oAuthListener=void 0)}}const Pa=new WD,Bm=t=>{const{headers:n,statusCode:l}=t;return{...HD(t)?t.$metadata:{},httpStatusCode:l,requestId:n["x-amzn-requestid"]??n["x-amzn-request-id"]??n["x-amz-request-id"],extendedRequestId:n["x-amz-id-2"],cfId:n["x-amz-cf-id"]}},HD=t=>typeof(t==null?void 0:t.$metadata)=="object",wp=async t=>{if(!t||t.statusCode<300)return;const n=await Lm(t),h=(b=>{const[s]=b.toString().split(/[,:]+/);return s.includes("#")?s.split("#")[1]:s})(t.headers["x-amzn-errortype"]??n.code??n.__type??"UnknownError"),m=n.message??n.Message??"Unknown error",x=new Error(m);return Object.assign(x,{name:h,$metadata:Bm(t)})},Lm=async t=>{if(!t.body)throw new Error("Missing response payload");const n=await t.body.json();return Object.assign(n,{$metadata:Bm(t)})},Q1=(t,n,l,h)=>async(m,x)=>{const b={...h,...m},s=await b.endpointResolver(b,x),C=await n(x,s),k=await t(C,{...b});return l(k)},_A={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},ZD={partitions:[_A,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},yA=t=>{const{partitions:n}=ZD;for(const{regions:l,outputs:h,regionRegex:m}of n){const x=new RegExp(m);if(l.includes(t)||x.test(t))return h.dnsSuffix}return _A.outputs.dnsSuffix},xA=3,wE="amz-sdk-invocation-id",XD="amz-sdk-request",bE=5*60*1e3,KD=({maxAttempts:t=xA,retryDecider:n,computeDelay:l,abortSignal:h})=>{if(t<1)throw new Error("maxAttempts must be greater than 0");return(m,x)=>async function(s){let C,k=x.attemptsCount??0,B;const U=()=>{if(B)return EE(B,k),B;throw EE(C,k),C};for(;!(h!=null&&h.aborted)&&k<t;){try{B=await m(s),C=void 0}catch(q){C=q,B=void 0}k=(x.attemptsCount??0)>k?x.attemptsCount??0:k+1,x.attemptsCount=k;const{isCredentialsExpiredError:F,retryable:Z}=await n(B,C,x);if(Z){if(x.isCredentialsExpired=!!F,!(h!=null&&h.aborted)&&k<t){const q=l(k);await YD(q,h)}continue}else return U()}if(h!=null&&h.aborted)throw new Error("Request aborted.");return U()}},YD=(t,n)=>{if(n!=null&&n.aborted)return Promise.resolve();let l,h;const m=new Promise(x=>{h=x,l=setTimeout(x,t)});return n==null||n.addEventListener("abort",function x(b){clearTimeout(l),n==null||n.removeEventListener("abort",x),h()}),m},EE=(t,n)=>{Object.prototype.toString.call(t)==="[object Object]"&&(t.$metadata={...t.$metadata??{},attempts:n})},JD=iD,QD=()=>t=>async function(l){return l.headers[wE]||(l.headers[wE]=JD()),t(l)},eP=({maxAttempts:t=xA})=>(n,l)=>async function(m){const x=l.attemptsCount??0;return m.headers[XD]=`attempt=${x+1}; max=${t}`,n(m)},tP=({userAgentHeader:t="x-amz-user-agent",userAgentValue:n=""})=>l=>async function(m){if(n.trim().length===0)return await l(m);{const x=t.toLowerCase();return m.headers[x]=m.headers[x]?`${m.headers[x]} ${n}`:n,await l(m)}},ev=(t,n)=>(l,h)=>{const m={};let x=b=>t(b,h);for(let b=n.length-1;b>=0;b--){const s=n[b];x=s(h)(x,m)}return x(l)},ey=t=>{let n;return()=>(n||(n=t()),n)},nP=t=>!["HEAD","GET","DELETE"].includes(t.toUpperCase()),rP=async({url:t,method:n,headers:l,body:h},{abortSignal:m,cache:x,withCrossDomainCredentials:b})=>{var U;let s;try{s=await fetch(t,{method:n,headers:l,body:nP(n)?h:void 0,signal:m,cache:x,credentials:b?"include":"same-origin"})}catch(F){throw F instanceof TypeError?new bs({name:ic.NetworkError,message:"A network error has occurred.",underlyingError:F}):F}const C={};(U=s.headers)==null||U.forEach((F,Z)=>{C[Z.toLowerCase()]=F});const k={statusCode:s.status,headers:C,body:null},B=Object.assign(s.body??{},{text:ey(()=>s.text()),blob:ey(()=>s.blob()),json:ey(()=>s.json())});return{...k,body:B}},vA=ev(rP,[tP,QD,KD,eP]),iP=5*60*1e3;function oP(t=iP){return h=>{const m=2**h*100+100*Math.random();return m>t?!1:m}}const wA=t=>{const l=oP(bE)(t);return l===!1?bE:l},sP=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],aP=t=>!!t&&sP.includes(t),bA=t=>async(n,l)=>{const h=l??await t(n)??void 0,m=(h==null?void 0:h.code)||(h==null?void 0:h.name),x=n==null?void 0:n.statusCode;return{retryable:hP(l)||uP(x,m)||aP(m)||dP(x,m)}},lP=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],cP=["TimeoutError","RequestTimeout","RequestTimeoutException"],uP=(t,n)=>t===429||!!n&&lP.includes(n),hP=t=>[ic.NetworkError,"ERR_NETWORK"].includes(t==null?void 0:t.name),dP=(t,n)=>!!t&&[500,502,503,504].includes(t)||!!n&&cP.includes(n),tv=URL,pP="cognito-identity",fP=({region:t})=>({url:new tv(`https://cognito-identity.${t}.${yA(t)}`)}),mP=()=>t=>async function(l){return l.headers["cache-control"]="no-store",t(l)},EA=ev(vA,[mP]),nv={service:pP,endpointResolver:fP,retryDecider:bA(wp),computeDelay:wA,userAgentValue:J1(),cache:"no-store"};fA(()=>{nv.userAgentValue=J1()});const TA=t=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${t}`}),SA=({url:t},n,l)=>({headers:n,url:t,body:l,method:"POST"}),gP=(t,n)=>{const l=TA("GetId"),h=JSON.stringify(t);return SA(n,l,h)},_P=async t=>{if(t.statusCode>=300)throw await wp(t);return{IdentityId:(await Lm(t)).IdentityId,$metadata:Bm(t)}},yP=Q1(EA,gP,_P,nv),xP=(t,n)=>{const l=TA("GetCredentialsForIdentity"),h=JSON.stringify(t);return SA(n,l,h)},vP=async t=>{if(t.statusCode>=300)throw await wp(t);{const n=await Lm(t);return{IdentityId:n.IdentityId,Credentials:wP(n.Credentials),$metadata:Bm(t)}}},wP=({AccessKeyId:t,SecretKey:n,SessionToken:l,Expiration:h}={})=>({AccessKeyId:t,SecretKey:n,SessionToken:l,Expiration:h&&new Date(h*1e3)}),TE=Q1(EA,xP,vP,nv);class Od extends bs{constructor(){super({name:ic.PlatformNotSupported,message:"Function not supported on current platform"})}}class CA{constructor(n){this.storage=n}async setItem(n,l){if(!this.storage)throw new Od;this.storage.setItem(n,l)}async getItem(n){if(!this.storage)throw new Od;return this.storage.getItem(n)}async removeItem(n){if(!this.storage)throw new Od;this.storage.removeItem(n)}async clear(){if(!this.storage)throw new Od;this.storage.clear()}}class AA{constructor(){this.storage=new Map}get length(){return this.storage.size}key(n){return n>this.length-1?null:Array.from(this.storage.keys())[n]}setItem(n,l){this.storage.set(n,l)}getItem(n){return this.storage.get(n)??null}removeItem(n){this.storage.delete(n)}clear(){this.storage.clear()}}const IA=new Yo("CoreStorageUtils"),bP=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{IA.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new AA},kA=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return IA.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new AA}};class EP extends CA{constructor(){super(bP())}}class TP extends CA{constructor(){super(kA())}}class SP{constructor(n){this._storage=n}get storage(){if(!this._storage)throw new Od;return this._storage}setItem(n,l){this.storage.setItem(n,l)}getItem(n){return this.storage.getItem(n)}removeItem(n){this.storage.removeItem(n)}clear(){this.storage.clear()}}class CP extends SP{constructor(){super(kA())}}/*! js-cookie v3.0.5 | MIT */function p0(t){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var h in l)t[h]=l[h]}return t}var AP={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function qx(t,n){function l(m,x,b){if(!(typeof document>"u")){b=p0({},n,b),typeof b.expires=="number"&&(b.expires=new Date(Date.now()+b.expires*864e5)),b.expires&&(b.expires=b.expires.toUTCString()),m=encodeURIComponent(m).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var C in b)b[C]&&(s+="; "+C,b[C]!==!0&&(s+="="+b[C].split(";")[0]));return document.cookie=m+"="+t.write(x,m)+s}}function h(m){if(!(typeof document>"u"||arguments.length&&!m)){for(var x=document.cookie?document.cookie.split("; "):[],b={},s=0;s<x.length;s++){var C=x[s].split("="),k=C.slice(1).join("=");try{var B=decodeURIComponent(C[0]);if(b[B]=t.read(k,B),m===B)break}catch{}}return m?b[m]:b}}return Object.create({set:l,get:h,remove:function(m,x){l(m,"",p0({},x,{expires:-1}))},withAttributes:function(m){return qx(this.converter,p0({},this.attributes,m))},withConverter:function(m){return qx(p0({},this.converter,m),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}var f0=qx(AP,{path:"/"});class IP{constructor(n={}){const{path:l,domain:h,expires:m,sameSite:x,secure:b}=n;if(this.domain=h,this.path=l||"/",this.expires=Object.prototype.hasOwnProperty.call(n,"expires")?m:365,this.secure=Object.prototype.hasOwnProperty.call(n,"secure")?b:!0,Object.prototype.hasOwnProperty.call(n,"sameSite")){if(!x||!["strict","lax","none"].includes(x))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(x==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=x}}async setItem(n,l){f0.set(n,l,this.getData())}async getItem(n){return f0.get(n)??null}async removeItem(n){f0.remove(n,this.getData())}async clear(){const n=f0.get(),l=Object.keys(n).map(h=>this.removeItem(h));await Promise.all(l)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const Rm=new EP;new TP;new CP;const kP=t=>{let n;return async(...l)=>n||(n=new Promise((h,m)=>{t(...l).then(x=>{h(x)}).catch(x=>{m(x)}).finally(()=>{n=void 0})}),n)};function SE({expiresAt:t,clockDrift:n,tolerance:l=5e3}){return Date.now()+n+l>t}class Gn extends bs{constructor(n){super(n),this.constructor=Gn,Object.setPrototypeOf(this,Gn.prototype)}}function MP(t){const n=t==null?void 0:t.split("_")[0];if(!t||t.indexOf("_")<0||!n||typeof n!="string")throw new Gn({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return n}function $x(t){if(!t||!t.includes(":"))throw new Gn({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return t.split(":")[0]}const MA="UserUnAuthenticatedException",DP="InvalidRedirectException",PP="InvalidAppSchemeException",zP="InvalidPreferredRedirectUrlException";new Gn({name:DP,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new Gn({name:PP,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new Gn({name:zP,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const BP="InvalidOriginException";new Gn({name:BP,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});const LP="TokenRefreshException";function RP(t){if(!t||!t.idToken)throw new Gn({name:MA,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const FP=new Gn({name:LP,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),OP=new Gn({name:MA,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function NP(t){if(VP(t))throw FP;if(!jP(t))throw OP}const UP={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function DA(t){return(t==null?void 0:t.accessToken)||(t==null?void 0:t.idToken)}function jP(t){return DA(t)&&(t==null?void 0:t.refreshToken)}function VP(t){return DA(t)&&!(t!=null&&t.refreshToken)}const GP=t=>(n,l)=>{const h=qP(t),m=JSON.stringify(n);return $P(l,h,m)},qP=t=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${t}`}),$P=({url:t},n,l)=>({headers:n,url:t,body:l,method:"POST"});function fp(t){if(!t||t.name==="Error"||t instanceof TypeError)throw new Gn({name:ic.Unknown,message:"An unknown error has occurred.",underlyingError:t})}const WP=()=>async t=>{if(t.statusCode>=300){const n=await wp(t);throw fp(n),new Gn({name:n.name,message:n.message,metadata:n.$metadata})}return Lm(t)},HP=()=>(t,n)=>async function(h){return h.headers["cache-control"]="no-store",t(h)},ZP=ev(vA,[HP]),PA="cognito-idp",XP={service:PA,retryDecider:bA(wp),computeDelay:wA,userAgentValue:J1(),cache:"no-store"},KP=t=>Q1(ZP,GP("InitiateAuth"),WP(),{...XP,...t}),YP=({region:t})=>({url:new tv(`https://${PA}.${t}.${yA(t)}`)}),JP=({endpointOverride:t})=>n=>t?{url:new tv(t)}:YP(n);function QP({username:t,userPoolId:n,userPoolClientId:l}){if(typeof window>"u")return;const h=window.AmazonCognitoAdvancedSecurityData;if(typeof h>"u")return;const m=h.getData(t,n,l);return m?{EncodedData:m}:{}}const ez=async({tokens:t,authConfig:n,username:l})=>{var Y;ki(n==null?void 0:n.Cognito);const{userPoolId:h,userPoolClientId:m,userPoolEndpoint:x}=n.Cognito,b=MP(h);NP(t);const s=t.refreshToken,C={REFRESH_TOKEN:s};(Y=t.deviceMetadata)!=null&&Y.deviceKey&&(C.DEVICE_KEY=t.deviceMetadata.deviceKey);const k=QP({username:l,userPoolId:h,userPoolClientId:m}),B=KP({endpointResolver:JP({endpointOverride:x})}),{AuthenticationResult:U}=await B({region:b},{ClientId:m,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:C,UserContextData:k}),F=dp((U==null?void 0:U.AccessToken)??""),Z=U!=null&&U.IdToken?dp(U.IdToken):void 0,{iat:q}=F.payload;if(!q)throw new Gn({name:"iatNotFoundException",message:"iat not found in access token"});const K=q*1e3-new Date().getTime();return{accessToken:F,idToken:Z,clockDrift:K,refreshToken:s,username:l}},tz=kP(ez),nz={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var hm;(function(t){t.InvalidAuthTokens="InvalidAuthTokens"})(hm||(hm={}));const rz={[hm.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},iz=aA(rz),CE="CognitoIdentityServiceProvider";class oz{getKeyValueStorage(){if(!this.keyValueStorage)throw new Gn({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(n){this.keyValueStorage=n}setAuthConfig(n){this.authConfig=n}async loadTokens(){try{const n=await this.getAuthKeys(),l=await this.getKeyValueStorage().getItem(n.accessToken);if(!l)throw new Gn({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const h=dp(l),m=await this.getKeyValueStorage().getItem(n.idToken),x=m?dp(m):void 0,b=await this.getKeyValueStorage().getItem(n.refreshToken)??void 0,s=await this.getKeyValueStorage().getItem(n.clockDrift)??"0",C=Number.parseInt(s),k=await this.getKeyValueStorage().getItem(n.signInDetails),B={accessToken:h,idToken:x,refreshToken:b,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:C,username:await this.getLastAuthUser()};return k&&(B.signInDetails=JSON.parse(k)),B}catch{return null}}async storeTokens(n){iz(n!==void 0,hm.InvalidAuthTokens);const l=n.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),l);const h=await this.getAuthKeys();await this.getKeyValueStorage().setItem(h.accessToken,n.accessToken.toString()),n.idToken?await this.getKeyValueStorage().setItem(h.idToken,n.idToken.toString()):await this.getKeyValueStorage().removeItem(h.idToken),n.refreshToken?await this.getKeyValueStorage().setItem(h.refreshToken,n.refreshToken):await this.getKeyValueStorage().removeItem(h.refreshToken),n.deviceMetadata&&(n.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(h.deviceKey,n.deviceMetadata.deviceKey),n.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(h.deviceGroupKey,n.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(h.randomPasswordKey,n.deviceMetadata.randomPassword)),n.signInDetails?await this.getKeyValueStorage().setItem(h.signInDetails,JSON.stringify(n.signInDetails)):await this.getKeyValueStorage().removeItem(h.signInDetails),await this.getKeyValueStorage().setItem(h.clockDrift,`${n.clockDrift}`)}async clearTokens(){const n=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(n.accessToken),this.getKeyValueStorage().removeItem(n.idToken),this.getKeyValueStorage().removeItem(n.clockDrift),this.getKeyValueStorage().removeItem(n.refreshToken),this.getKeyValueStorage().removeItem(n.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(n.oauthMetadata)])}async getDeviceMetadata(n){const l=await this.getAuthKeys(n),h=await this.getKeyValueStorage().getItem(l.deviceKey),m=await this.getKeyValueStorage().getItem(l.deviceGroupKey),x=await this.getKeyValueStorage().getItem(l.randomPasswordKey);return x&&m&&h?{deviceKey:h,deviceGroupKey:m,randomPassword:x}:null}async clearDeviceMetadata(n){const l=await this.getAuthKeys(n);await Promise.all([this.getKeyValueStorage().removeItem(l.deviceKey),this.getKeyValueStorage().removeItem(l.deviceGroupKey),this.getKeyValueStorage().removeItem(l.randomPasswordKey)])}async getAuthKeys(n){var h;ki((h=this.authConfig)==null?void 0:h.Cognito);const l=n??await this.getLastAuthUser();return sz(CE,`${this.authConfig.Cognito.userPoolClientId}.${l}`)}getLastAuthUserKey(){var l;ki((l=this.authConfig)==null?void 0:l.Cognito);const n=this.authConfig.Cognito.userPoolClientId;return`${CE}.${n}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(n){const{oauthMetadata:l}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(l,JSON.stringify(n))}async getOAuthMetadata(){const{oauthMetadata:n}=await this.getAuthKeys(),l=await this.getKeyValueStorage().getItem(n);return l&&JSON.parse(l)}}const sz=(t,n)=>rv(nz)(`${t}`,n);function rv(t){const n=Object.values({...t});return(l,h)=>n.reduce((m,x)=>({...m,[x]:`${l}.${h}.${x}`}),{})}const AE="amplify-signin-with-hostedUI",ms="CognitoIdentityServiceProvider";class az{constructor(n){this.keyValueStorage=n}async clearOAuthInflightData(){ki(this.cognitoConfig);const n=gs(ms,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(n.inflightOAuth),this.keyValueStorage.removeItem(n.oauthPKCE),this.keyValueStorage.removeItem(n.oauthState)])}async clearOAuthData(){ki(this.cognitoConfig);const n=gs(ms,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(AE),this.keyValueStorage.removeItem(n.oauthSignIn)}loadOAuthState(){ki(this.cognitoConfig);const n=gs(ms,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(n.oauthState)}storeOAuthState(n){ki(this.cognitoConfig);const l=gs(ms,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(l.oauthState,n)}loadPKCE(){ki(this.cognitoConfig);const n=gs(ms,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(n.oauthPKCE)}storePKCE(n){ki(this.cognitoConfig);const l=gs(ms,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(l.oauthPKCE,n)}setAuthConfig(n){this.cognitoConfig=n}async loadOAuthInFlight(){ki(this.cognitoConfig);const n=gs(ms,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(n.inflightOAuth)==="true"}async storeOAuthInFlight(n){ki(this.cognitoConfig);const l=gs(ms,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(l.inflightOAuth,`${n}`)}async loadOAuthSignIn(){var x;ki(this.cognitoConfig);const n=gs(ms,this.cognitoConfig.userPoolClientId),l=await this.keyValueStorage.getItem(AE),[h,m]=((x=await this.keyValueStorage.getItem(n.oauthSignIn))==null?void 0:x.split(","))??[];return{isOAuthSignIn:h==="true"||l==="true",preferPrivateSession:m==="true"}}async storeOAuthSignIn(n,l=!1){ki(this.cognitoConfig);const h=gs(ms,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(h.oauthSignIn,`${n},${l}`)}}const gs=(t,n)=>rv(UP)(t,n),IE=new az(Rm),lz=[],cz=t=>{lz.push(t)};class uz{constructor(){this.waitForInflightOAuth=qD()?async()=>{if(await IE.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((n,l)=>{cz(n)}),this.inflightPromise)}:async()=>{}}setAuthConfig(n){IE.setAuthConfig(n.Cognito),this.authConfig=n}setTokenRefresher(n){this.tokenRefresher=n}setAuthTokenStore(n){this.tokenStore=n}getTokenStore(){if(!this.tokenStore)throw new Gn({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new Gn({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(n){var b,s,C,k,B;let l;try{ki((b=this.authConfig)==null?void 0:b.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,l=await this.getTokenStore().loadTokens();const h=await this.getTokenStore().getLastAuthUser();if(l===null)return null;const m=!!(l!=null&&l.idToken)&&SE({expiresAt:(((C=(s=l.idToken)==null?void 0:s.payload)==null?void 0:C.exp)??0)*1e3,clockDrift:l.clockDrift??0}),x=SE({expiresAt:(((B=(k=l.accessToken)==null?void 0:k.payload)==null?void 0:B.exp)??0)*1e3,clockDrift:l.clockDrift??0});return(n!=null&&n.forceRefresh||m||x)&&(l=await this.refreshTokens({tokens:l,username:h}),l===null)?null:{accessToken:l==null?void 0:l.accessToken,idToken:l==null?void 0:l.idToken,signInDetails:l==null?void 0:l.signInDetails}}async refreshTokens({tokens:n,username:l}){try{const{signInDetails:h}=n,m=await this.getTokenRefresher()({tokens:n,authConfig:this.authConfig,username:l});return m.signInDetails=h,await this.setTokens({tokens:m}),Gx.dispatch("auth",{event:"tokenRefresh"},"Auth",cm),m}catch(h){return this.handleErrors(h)}}handleErrors(n){if(fp(n),n.name!==ic.NetworkError&&this.clearTokens(),Gx.dispatch("auth",{event:"tokenRefresh_failure",data:{error:n}},"Auth",cm),n.name.startsWith("NotAuthorizedException"))return null;throw n}async setTokens({tokens:n}){return this.getTokenStore().storeTokens(n)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(n){return this.getTokenStore().getDeviceMetadata(n)}clearDeviceMetadata(n){return this.getTokenStore().clearDeviceMetadata(n)}setOAuthMetadata(n){return this.getTokenStore().setOAuthMetadata(n)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class hz{constructor(){this.authTokenStore=new oz,this.authTokenStore.setKeyValueStorage(Rm),this.tokenOrchestrator=new uz,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(tz)}getTokens({forceRefresh:n}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:n})}setKeyValueStorage(n){this.authTokenStore.setKeyValueStorage(n)}setAuthConfig(n){this.authTokenStore.setAuthConfig(n),this.tokenOrchestrator.setAuthConfig(n)}}const m0=new hz,dz={identityId:"identityId"},pz=new Yo("DefaultIdentityIdStore");class zA{setAuthConfig(n){D0(n.Cognito),this.authConfig=n,this._authKeys=fz("Cognito",n.Cognito.identityPoolId)}constructor(n){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=n}async loadIdentityId(){var n;D0((n=this.authConfig)==null?void 0:n.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const l=await this.keyValueStorage.getItem(this._authKeys.identityId);return l?(this._hasGuestIdentityId=!0,{id:l,type:"guest"}):null}}catch(l){return pz.log("Error getting stored IdentityId.",l),null}}async storeIdentityId(n){var l;D0((l=this.authConfig)==null?void 0:l.Cognito),n.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,n.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=n.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const fz=(t,n)=>rv(dz)(`com.amplify.${t}`,n);function BA(t){const n=dp(t).payload.iss,l={};if(!n)throw new Gn({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const h=n.replace(/(^\w+:|^)\/\//,"");return l[h]=t,l}async function mz({tokens:t,authConfig:n,identityIdStore:l}){l.setAuthConfig({Cognito:n});const h=await l.loadIdentityId();if(h)return h.id;const m=t!=null&&t.idToken?BA(t.idToken.toString()):{},x=await gz(m,n);return l.storeIdentityId({id:x,type:t?"primary":"guest"}),x}async function gz(t,n){const l=n==null?void 0:n.identityPoolId,h=$x(l);let m;try{m=(await yP({region:h},{IdentityPoolId:l,Logins:t})).IdentityId}catch(x){throw fp(x),new Gn(x)}if(!m)throw new Gn({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return m}const g0=new Yo("CognitoCredentialsProvider"),kE=50*60*1e3;class LA{constructor(n){this._nextCredentialsRefresh=0,this._identityIdStore=n}async clearCredentialsAndIdentityId(){g0.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){g0.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(n){const l=n.authenticated,{tokens:h}=n,{authConfig:m}=n;try{D0(m==null?void 0:m.Cognito)}catch{return}if(!l&&!m.Cognito.allowGuestAccess)return;const{forceRefresh:x}=n,b=this.hasTokenChanged(h),s=await mz({tokens:h,authConfig:m.Cognito,identityIdStore:this._identityIdStore});return(x||b)&&this.clearCredentials(),l?(RP(h),this.credsForOIDCTokens(m.Cognito,h,s)):this.getGuestCredentials(s,m.Cognito)}async getGuestCredentials(n,l){var x,b;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return g0.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const h=$x(l.identityPoolId);let m;try{m=await TE({region:h},{IdentityId:n})}catch(s){throw fp(s),new Gn(s)}if((x=m==null?void 0:m.Credentials)!=null&&x.AccessKeyId&&((b=m==null?void 0:m.Credentials)!=null&&b.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+kE;const s={credentials:{accessKeyId:m.Credentials.AccessKeyId,secretAccessKey:m.Credentials.SecretKey,sessionToken:m.Credentials.SessionToken,expiration:m.Credentials.Expiration},identityId:n};return m.IdentityId&&(s.identityId=m.IdentityId,this._identityIdStore.storeIdentityId({id:m.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...s,isAuthenticatedCreds:!1},s}else throw new Gn({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(n,l,h){var s,C,k;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return g0.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const m=l.idToken?BA(l.idToken.toString()):{},x=$x(n.identityPoolId);let b;try{b=await TE({region:x},{IdentityId:h,Logins:m})}catch(B){throw fp(B),new Gn(B)}if((s=b==null?void 0:b.Credentials)!=null&&s.AccessKeyId&&((C=b==null?void 0:b.Credentials)!=null&&C.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+kE;const B={credentials:{accessKeyId:b.Credentials.AccessKeyId,secretAccessKey:b.Credentials.SecretKey,sessionToken:b.Credentials.SessionToken,expiration:b.Credentials.Expiration},identityId:h};return b.IdentityId&&(B.identityId=b.IdentityId,this._identityIdStore.storeIdentityId({id:b.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...B,isAuthenticatedCreds:!0,associatedIdToken:(k=l.idToken)==null?void 0:k.toString()},B}else throw new Gn({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(n){var l,h;return!!n&&!!((l=this._credentialsAndIdentityId)!=null&&l.associatedIdToken)&&((h=n.idToken)==null?void 0:h.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const _z=new LA(new zA(Rm)),yz={configure(t,n){const l=hA(t),h=new IP({sameSite:"lax"}),m=n!=null&&n.ssr?h:Rm,x=n!=null&&n.ssr?new LA(new zA(h)):_z;if(!l.Auth){Pa.configure(l,n);return}if(n!=null&&n.Auth){Pa.configure(l,n);return}if(!Pa.libraryOptions.Auth){m0.setAuthConfig(l.Auth),m0.setKeyValueStorage(m),Pa.configure(l,{...n,Auth:{tokenProvider:m0,credentialsProvider:x}});return}if(n){const b=Pa.libraryOptions.Auth;n.ssr!==void 0&&(m0.setKeyValueStorage(m),b.credentialsProvider=x),Pa.configure(l,{Auth:b,...n});return}Pa.configure(l)},getConfig(){return Pa.getConfig()}};/*
 * Frontend UI component library for the CORI Data API 
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */var xz={oauth:{domain:"authcori.auth.us-east-1.amazoncognito.com"}},vz="us-east-1",wz="us-east-1_QeA4600FA",bz="5eusi16g0o2q1g1rr5ehgudodm",Ez="authcori.auth.us-east-1.amazoncognito.com",Tz="us-east-1",Sz="us-east-1:2194a76a-fa3d-4c33-999e-e3c4b2b049ee",Cz=["EMAIL"],Az=["EMAIL","OPENID"],Iz=["EMAIL","OPENID"],kz={passwordPolicyMinLength:8,passwordPolicyCharacters:["REQUIRES_NUMBERS","REQUIRES_LOWERCASE","REQUIRES_UPPERCASE","REQUIRES_SYMBOLS"]},Mz="https://bdkxhfgus5dztobic7gvn5ymue.appsync-api.us-east-1.amazonaws.com/graphql",Dz="us-east-1",Pz="da2-yexc3mow25fc3amaendi4vscuq",zz="API_KEY",Bz="AMAZON_COGNITO_USER_POOLS,AWS_IAM",Lz={version:1,models:{Todo:{name:"Todo",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},content:{name:"content",isArray:!1,type:"String",isRequired:!1,attributes:[]},owner:{name:"owner",isArray:!1,type:"String",isRequired:!1,attributes:[]},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!0,attributes:[]},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!0,attributes:[]}},syncable:!0,pluralName:"Todos",attributes:[{type:"model",properties:{}},{type:"key",properties:{fields:["id"]}},{type:"auth",properties:{rules:[{provider:"userPools",ownerField:"owner",allow:"owner",identityClaim:"cognito:username",operations:["create","update","delete","read"]},{allow:"public",operations:["read"]}]}}],primaryKeyInfo:{isCustomPrimaryKey:!1,primaryKeyFieldName:"id",sortKeyFieldNames:[]}}},enums:{},nonModels:{}},Rz={Auth:xz,aws_project_region:vz,aws_user_pools_id:wz,aws_user_pools_web_client_id:bz,aws_cognito_domain:Ez,aws_cognito_region:Tz,aws_cognito_identity_pool_id:Sz,aws_cognito_signup_attributes:Cz,aws_cognito_username_attributes:Az,aws_cognito_verification_mechanisms:Iz,aws_cognito_password_protection_settings:kz,aws_appsync_graphqlEndpoint:Mz,aws_appsync_region:Dz,aws_appsync_apiKey:Pz,aws_appsync_authenticationType:zz,aws_appsync_additionalAuthenticationTypes:Bz,modelIntrospection:Lz};/*
 * Frontend UI component library for the CORI Data API 
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */yz.configure(Rz);const Fz={domain:void 0,region:void 0,identityPoolId:void 0,userPoolId:void 0,userPoolClientId:void 0};xt.createContext(Fz);function RA(t,n){return function(){return t.apply(n,arguments)}}const{toString:Oz}=Object.prototype,{getPrototypeOf:iv}=Object,Fm=(t=>n=>{const l=Oz.call(n);return t[l]||(t[l]=l.slice(8,-1).toLowerCase())})(Object.create(null)),es=t=>(t=t.toLowerCase(),n=>Fm(n)===t),Om=t=>n=>typeof n===t,{isArray:Gu}=Array,mp=Om("undefined");function Nz(t){return t!==null&&!mp(t)&&t.constructor!==null&&!mp(t.constructor)&&Yi(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const FA=es("ArrayBuffer");function Uz(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&FA(t.buffer),n}const jz=Om("string"),Yi=Om("function"),OA=Om("number"),Nm=t=>t!==null&&typeof t=="object",Vz=t=>t===!0||t===!1,z0=t=>{if(Fm(t)!=="object")return!1;const n=iv(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Gz=es("Date"),qz=es("File"),$z=es("Blob"),Wz=es("FileList"),Hz=t=>Nm(t)&&Yi(t.pipe),Zz=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||Yi(t.append)&&((n=Fm(t))==="formdata"||n==="object"&&Yi(t.toString)&&t.toString()==="[object FormData]"))},Xz=es("URLSearchParams"),[Kz,Yz,Jz,Qz]=["ReadableStream","Request","Response","Headers"].map(es),eB=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function bp(t,n,{allOwnKeys:l=!1}={}){if(t===null||typeof t>"u")return;let h,m;if(typeof t!="object"&&(t=[t]),Gu(t))for(h=0,m=t.length;h<m;h++)n.call(null,t[h],h,t);else{const x=l?Object.getOwnPropertyNames(t):Object.keys(t),b=x.length;let s;for(h=0;h<b;h++)s=x[h],n.call(null,t[s],s,t)}}function NA(t,n){n=n.toLowerCase();const l=Object.keys(t);let h=l.length,m;for(;h-- >0;)if(m=l[h],n===m.toLowerCase())return m;return null}const Kl=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),UA=t=>!mp(t)&&t!==Kl;function Wx(){const{caseless:t}=UA(this)&&this||{},n={},l=(h,m)=>{const x=t&&NA(n,m)||m;z0(n[x])&&z0(h)?n[x]=Wx(n[x],h):z0(h)?n[x]=Wx({},h):Gu(h)?n[x]=h.slice():n[x]=h};for(let h=0,m=arguments.length;h<m;h++)arguments[h]&&bp(arguments[h],l);return n}const tB=(t,n,l,{allOwnKeys:h}={})=>(bp(n,(m,x)=>{l&&Yi(m)?t[x]=RA(m,l):t[x]=m},{allOwnKeys:h}),t),nB=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),rB=(t,n,l,h)=>{t.prototype=Object.create(n.prototype,h),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),l&&Object.assign(t.prototype,l)},iB=(t,n,l,h)=>{let m,x,b;const s={};if(n=n||{},t==null)return n;do{for(m=Object.getOwnPropertyNames(t),x=m.length;x-- >0;)b=m[x],(!h||h(b,t,n))&&!s[b]&&(n[b]=t[b],s[b]=!0);t=l!==!1&&iv(t)}while(t&&(!l||l(t,n))&&t!==Object.prototype);return n},oB=(t,n,l)=>{t=String(t),(l===void 0||l>t.length)&&(l=t.length),l-=n.length;const h=t.indexOf(n,l);return h!==-1&&h===l},sB=t=>{if(!t)return null;if(Gu(t))return t;let n=t.length;if(!OA(n))return null;const l=new Array(n);for(;n-- >0;)l[n]=t[n];return l},aB=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&iv(Uint8Array)),lB=(t,n)=>{const h=(t&&t[Symbol.iterator]).call(t);let m;for(;(m=h.next())&&!m.done;){const x=m.value;n.call(t,x[0],x[1])}},cB=(t,n)=>{let l;const h=[];for(;(l=t.exec(n))!==null;)h.push(l);return h},uB=es("HTMLFormElement"),hB=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(l,h,m){return h.toUpperCase()+m}),ME=(({hasOwnProperty:t})=>(n,l)=>t.call(n,l))(Object.prototype),dB=es("RegExp"),jA=(t,n)=>{const l=Object.getOwnPropertyDescriptors(t),h={};bp(l,(m,x)=>{let b;(b=n(m,x,t))!==!1&&(h[x]=b||m)}),Object.defineProperties(t,h)},pB=t=>{jA(t,(n,l)=>{if(Yi(t)&&["arguments","caller","callee"].indexOf(l)!==-1)return!1;const h=t[l];if(Yi(h)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+l+"'")})}})},fB=(t,n)=>{const l={},h=m=>{m.forEach(x=>{l[x]=!0})};return Gu(t)?h(t):h(String(t).split(n)),l},mB=()=>{},gB=(t,n)=>t!=null&&Number.isFinite(t=+t)?t:n;function _B(t){return!!(t&&Yi(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const yB=t=>{const n=new Array(10),l=(h,m)=>{if(Nm(h)){if(n.indexOf(h)>=0)return;if(!("toJSON"in h)){n[m]=h;const x=Gu(h)?[]:{};return bp(h,(b,s)=>{const C=l(b,m+1);!mp(C)&&(x[s]=C)}),n[m]=void 0,x}}return h};return l(t,0)},xB=es("AsyncFunction"),vB=t=>t&&(Nm(t)||Yi(t))&&Yi(t.then)&&Yi(t.catch),VA=((t,n)=>t?setImmediate:n?((l,h)=>(Kl.addEventListener("message",({source:m,data:x})=>{m===Kl&&x===l&&h.length&&h.shift()()},!1),m=>{h.push(m),Kl.postMessage(l,"*")}))(`axios@${Math.random()}`,[]):l=>setTimeout(l))(typeof setImmediate=="function",Yi(Kl.postMessage)),wB=typeof queueMicrotask<"u"?queueMicrotask.bind(Kl):typeof process<"u"&&process.nextTick||VA,Xe={isArray:Gu,isArrayBuffer:FA,isBuffer:Nz,isFormData:Zz,isArrayBufferView:Uz,isString:jz,isNumber:OA,isBoolean:Vz,isObject:Nm,isPlainObject:z0,isReadableStream:Kz,isRequest:Yz,isResponse:Jz,isHeaders:Qz,isUndefined:mp,isDate:Gz,isFile:qz,isBlob:$z,isRegExp:dB,isFunction:Yi,isStream:Hz,isURLSearchParams:Xz,isTypedArray:aB,isFileList:Wz,forEach:bp,merge:Wx,extend:tB,trim:eB,stripBOM:nB,inherits:rB,toFlatObject:iB,kindOf:Fm,kindOfTest:es,endsWith:oB,toArray:sB,forEachEntry:lB,matchAll:cB,isHTMLForm:uB,hasOwnProperty:ME,hasOwnProp:ME,reduceDescriptors:jA,freezeMethods:pB,toObjectSet:fB,toCamelCase:hB,noop:mB,toFiniteNumber:gB,findKey:NA,global:Kl,isContextDefined:UA,isSpecCompliantForm:_B,toJSONObject:yB,isAsyncFn:xB,isThenable:vB,setImmediate:VA,asap:wB};function tn(t,n,l,h,m){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),l&&(this.config=l),h&&(this.request=h),m&&(this.response=m,this.status=m.status?m.status:null)}Xe.inherits(tn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.status}}});const GA=tn.prototype,qA={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{qA[t]={value:t}});Object.defineProperties(tn,qA);Object.defineProperty(GA,"isAxiosError",{value:!0});tn.from=(t,n,l,h,m,x)=>{const b=Object.create(GA);return Xe.toFlatObject(t,b,function(C){return C!==Error.prototype},s=>s!=="isAxiosError"),tn.call(b,t.message,n,l,h,m),b.cause=t,b.name=t.name,x&&Object.assign(b,x),b};const bB=null;function Hx(t){return Xe.isPlainObject(t)||Xe.isArray(t)}function $A(t){return Xe.endsWith(t,"[]")?t.slice(0,-2):t}function DE(t,n,l){return t?t.concat(n).map(function(m,x){return m=$A(m),!l&&x?"["+m+"]":m}).join(l?".":""):n}function EB(t){return Xe.isArray(t)&&!t.some(Hx)}const TB=Xe.toFlatObject(Xe,{},null,function(n){return/^is[A-Z]/.test(n)});function Um(t,n,l){if(!Xe.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,l=Xe.toFlatObject(l,{metaTokens:!0,dots:!1,indexes:!1},!1,function(K,Y){return!Xe.isUndefined(Y[K])});const h=l.metaTokens,m=l.visitor||B,x=l.dots,b=l.indexes,C=(l.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(n);if(!Xe.isFunction(m))throw new TypeError("visitor must be a function");function k(q){if(q===null)return"";if(Xe.isDate(q))return q.toISOString();if(!C&&Xe.isBlob(q))throw new tn("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(q)||Xe.isTypedArray(q)?C&&typeof Blob=="function"?new Blob([q]):Buffer.from(q):q}function B(q,K,Y){let W=q;if(q&&!Y&&typeof q=="object"){if(Xe.endsWith(K,"{}"))K=h?K:K.slice(0,-2),q=JSON.stringify(q);else if(Xe.isArray(q)&&EB(q)||(Xe.isFileList(q)||Xe.endsWith(K,"[]"))&&(W=Xe.toArray(q)))return K=$A(K),W.forEach(function(V,Q){!(Xe.isUndefined(V)||V===null)&&n.append(b===!0?DE([K],Q,x):b===null?K:K+"[]",k(V))}),!1}return Hx(q)?!0:(n.append(DE(Y,K,x),k(q)),!1)}const U=[],F=Object.assign(TB,{defaultVisitor:B,convertValue:k,isVisitable:Hx});function Z(q,K){if(!Xe.isUndefined(q)){if(U.indexOf(q)!==-1)throw Error("Circular reference detected in "+K.join("."));U.push(q),Xe.forEach(q,function(W,O){(!(Xe.isUndefined(W)||W===null)&&m.call(n,W,Xe.isString(O)?O.trim():O,K,F))===!0&&Z(W,K?K.concat(O):[O])}),U.pop()}}if(!Xe.isObject(t))throw new TypeError("data must be an object");return Z(t),n}function PE(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(h){return n[h]})}function ov(t,n){this._pairs=[],t&&Um(t,this,n)}const WA=ov.prototype;WA.append=function(n,l){this._pairs.push([n,l])};WA.toString=function(n){const l=n?function(h){return n.call(this,h,PE)}:PE;return this._pairs.map(function(m){return l(m[0])+"="+l(m[1])},"").join("&")};function SB(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function HA(t,n,l){if(!n)return t;const h=l&&l.encode||SB;Xe.isFunction(l)&&(l={serialize:l});const m=l&&l.serialize;let x;if(m?x=m(n,l):x=Xe.isURLSearchParams(n)?n.toString():new ov(n,l).toString(h),x){const b=t.indexOf("#");b!==-1&&(t=t.slice(0,b)),t+=(t.indexOf("?")===-1?"?":"&")+x}return t}class CB{constructor(){this.handlers=[]}use(n,l,h){return this.handlers.push({fulfilled:n,rejected:l,synchronous:h?h.synchronous:!1,runWhen:h?h.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Xe.forEach(this.handlers,function(h){h!==null&&n(h)})}}const zE=CB,ZA={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},AB=typeof URLSearchParams<"u"?URLSearchParams:ov,IB=typeof FormData<"u"?FormData:null,kB=typeof Blob<"u"?Blob:null,MB={isBrowser:!0,classes:{URLSearchParams:AB,FormData:IB,Blob:kB},protocols:["http","https","file","blob","url","data"]},sv=typeof window<"u"&&typeof document<"u",Zx=typeof navigator=="object"&&navigator||void 0,DB=sv&&(!Zx||["ReactNative","NativeScript","NS"].indexOf(Zx.product)<0),PB=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),zB=sv&&window.location.href||"http://localhost",BB=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sv,hasStandardBrowserEnv:DB,hasStandardBrowserWebWorkerEnv:PB,navigator:Zx,origin:zB},Symbol.toStringTag,{value:"Module"})),ci={...BB,...MB};function LB(t,n){return Um(t,new ci.classes.URLSearchParams,Object.assign({visitor:function(l,h,m,x){return ci.isNode&&Xe.isBuffer(l)?(this.append(h,l.toString("base64")),!1):x.defaultVisitor.apply(this,arguments)}},n))}function RB(t){return Xe.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function FB(t){const n={},l=Object.keys(t);let h;const m=l.length;let x;for(h=0;h<m;h++)x=l[h],n[x]=t[x];return n}function XA(t){function n(l,h,m,x){let b=l[x++];if(b==="__proto__")return!0;const s=Number.isFinite(+b),C=x>=l.length;return b=!b&&Xe.isArray(m)?m.length:b,C?(Xe.hasOwnProp(m,b)?m[b]=[m[b],h]:m[b]=h,!s):((!m[b]||!Xe.isObject(m[b]))&&(m[b]=[]),n(l,h,m[b],x)&&Xe.isArray(m[b])&&(m[b]=FB(m[b])),!s)}if(Xe.isFormData(t)&&Xe.isFunction(t.entries)){const l={};return Xe.forEachEntry(t,(h,m)=>{n(RB(h),m,l,0)}),l}return null}function OB(t,n,l){if(Xe.isString(t))try{return(n||JSON.parse)(t),Xe.trim(t)}catch(h){if(h.name!=="SyntaxError")throw h}return(l||JSON.stringify)(t)}const av={transitional:ZA,adapter:["xhr","http","fetch"],transformRequest:[function(n,l){const h=l.getContentType()||"",m=h.indexOf("application/json")>-1,x=Xe.isObject(n);if(x&&Xe.isHTMLForm(n)&&(n=new FormData(n)),Xe.isFormData(n))return m?JSON.stringify(XA(n)):n;if(Xe.isArrayBuffer(n)||Xe.isBuffer(n)||Xe.isStream(n)||Xe.isFile(n)||Xe.isBlob(n)||Xe.isReadableStream(n))return n;if(Xe.isArrayBufferView(n))return n.buffer;if(Xe.isURLSearchParams(n))return l.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let s;if(x){if(h.indexOf("application/x-www-form-urlencoded")>-1)return LB(n,this.formSerializer).toString();if((s=Xe.isFileList(n))||h.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return Um(s?{"files[]":n}:n,C&&new C,this.formSerializer)}}return x||m?(l.setContentType("application/json",!1),OB(n)):n}],transformResponse:[function(n){const l=this.transitional||av.transitional,h=l&&l.forcedJSONParsing,m=this.responseType==="json";if(Xe.isResponse(n)||Xe.isReadableStream(n))return n;if(n&&Xe.isString(n)&&(h&&!this.responseType||m)){const b=!(l&&l.silentJSONParsing)&&m;try{return JSON.parse(n)}catch(s){if(b)throw s.name==="SyntaxError"?tn.from(s,tn.ERR_BAD_RESPONSE,this,null,this.response):s}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ci.classes.FormData,Blob:ci.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],t=>{av.headers[t]={}});const lv=av,NB=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UB=t=>{const n={};let l,h,m;return t&&t.split(`
`).forEach(function(b){m=b.indexOf(":"),l=b.substring(0,m).trim().toLowerCase(),h=b.substring(m+1).trim(),!(!l||n[l]&&NB[l])&&(l==="set-cookie"?n[l]?n[l].push(h):n[l]=[h]:n[l]=n[l]?n[l]+", "+h:h)}),n},BE=Symbol("internals");function zd(t){return t&&String(t).trim().toLowerCase()}function B0(t){return t===!1||t==null?t:Xe.isArray(t)?t.map(B0):String(t)}function jB(t){const n=Object.create(null),l=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let h;for(;h=l.exec(t);)n[h[1]]=h[2];return n}const VB=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function ty(t,n,l,h,m){if(Xe.isFunction(h))return h.call(this,n,l);if(m&&(n=l),!!Xe.isString(n)){if(Xe.isString(h))return n.indexOf(h)!==-1;if(Xe.isRegExp(h))return h.test(n)}}function GB(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,l,h)=>l.toUpperCase()+h)}function qB(t,n){const l=Xe.toCamelCase(" "+n);["get","set","has"].forEach(h=>{Object.defineProperty(t,h+l,{value:function(m,x,b){return this[h].call(this,n,m,x,b)},configurable:!0})})}class jm{constructor(n){n&&this.set(n)}set(n,l,h){const m=this;function x(s,C,k){const B=zd(C);if(!B)throw new Error("header name must be a non-empty string");const U=Xe.findKey(m,B);(!U||m[U]===void 0||k===!0||k===void 0&&m[U]!==!1)&&(m[U||C]=B0(s))}const b=(s,C)=>Xe.forEach(s,(k,B)=>x(k,B,C));if(Xe.isPlainObject(n)||n instanceof this.constructor)b(n,l);else if(Xe.isString(n)&&(n=n.trim())&&!VB(n))b(UB(n),l);else if(Xe.isHeaders(n))for(const[s,C]of n.entries())x(C,s,h);else n!=null&&x(l,n,h);return this}get(n,l){if(n=zd(n),n){const h=Xe.findKey(this,n);if(h){const m=this[h];if(!l)return m;if(l===!0)return jB(m);if(Xe.isFunction(l))return l.call(this,m,h);if(Xe.isRegExp(l))return l.exec(m);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,l){if(n=zd(n),n){const h=Xe.findKey(this,n);return!!(h&&this[h]!==void 0&&(!l||ty(this,this[h],h,l)))}return!1}delete(n,l){const h=this;let m=!1;function x(b){if(b=zd(b),b){const s=Xe.findKey(h,b);s&&(!l||ty(h,h[s],s,l))&&(delete h[s],m=!0)}}return Xe.isArray(n)?n.forEach(x):x(n),m}clear(n){const l=Object.keys(this);let h=l.length,m=!1;for(;h--;){const x=l[h];(!n||ty(this,this[x],x,n,!0))&&(delete this[x],m=!0)}return m}normalize(n){const l=this,h={};return Xe.forEach(this,(m,x)=>{const b=Xe.findKey(h,x);if(b){l[b]=B0(m),delete l[x];return}const s=n?GB(x):String(x).trim();s!==x&&delete l[x],l[s]=B0(m),h[s]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const l=Object.create(null);return Xe.forEach(this,(h,m)=>{h!=null&&h!==!1&&(l[m]=n&&Xe.isArray(h)?h.join(", "):h)}),l}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,l])=>n+": "+l).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...l){const h=new this(n);return l.forEach(m=>h.set(m)),h}static accessor(n){const h=(this[BE]=this[BE]={accessors:{}}).accessors,m=this.prototype;function x(b){const s=zd(b);h[s]||(qB(m,b),h[s]=!0)}return Xe.isArray(n)?n.forEach(x):x(n),this}}jm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(jm.prototype,({value:t},n)=>{let l=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(h){this[l]=h}}});Xe.freezeMethods(jm);const Jo=jm;function ny(t,n){const l=this||lv,h=n||l,m=Jo.from(h.headers);let x=h.data;return Xe.forEach(t,function(s){x=s.call(l,x,m.normalize(),n?n.status:void 0)}),m.normalize(),x}function KA(t){return!!(t&&t.__CANCEL__)}function qu(t,n,l){tn.call(this,t??"canceled",tn.ERR_CANCELED,n,l),this.name="CanceledError"}Xe.inherits(qu,tn,{__CANCEL__:!0});function YA(t,n,l){const h=l.config.validateStatus;!l.status||!h||h(l.status)?t(l):n(new tn("Request failed with status code "+l.status,[tn.ERR_BAD_REQUEST,tn.ERR_BAD_RESPONSE][Math.floor(l.status/100)-4],l.config,l.request,l))}function $B(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function WB(t,n){t=t||10;const l=new Array(t),h=new Array(t);let m=0,x=0,b;return n=n!==void 0?n:1e3,function(C){const k=Date.now(),B=h[x];b||(b=k),l[m]=C,h[m]=k;let U=x,F=0;for(;U!==m;)F+=l[U++],U=U%t;if(m=(m+1)%t,m===x&&(x=(x+1)%t),k-b<n)return;const Z=B&&k-B;return Z?Math.round(F*1e3/Z):void 0}}function HB(t,n){let l=0,h=1e3/n,m,x;const b=(k,B=Date.now())=>{l=B,m=null,x&&(clearTimeout(x),x=null),t.apply(null,k)};return[(...k)=>{const B=Date.now(),U=B-l;U>=h?b(k,B):(m=k,x||(x=setTimeout(()=>{x=null,b(m)},h-U)))},()=>m&&b(m)]}const dm=(t,n,l=3)=>{let h=0;const m=WB(50,250);return HB(x=>{const b=x.loaded,s=x.lengthComputable?x.total:void 0,C=b-h,k=m(C),B=b<=s;h=b;const U={loaded:b,total:s,progress:s?b/s:void 0,bytes:C,rate:k||void 0,estimated:k&&s&&B?(s-b)/k:void 0,event:x,lengthComputable:s!=null,[n?"download":"upload"]:!0};t(U)},l)},LE=(t,n)=>{const l=t!=null;return[h=>n[0]({lengthComputable:l,total:t,loaded:h}),n[1]]},RE=t=>(...n)=>Xe.asap(()=>t(...n)),ZB=ci.hasStandardBrowserEnv?((t,n)=>l=>(l=new URL(l,ci.origin),t.protocol===l.protocol&&t.host===l.host&&(n||t.port===l.port)))(new URL(ci.origin),ci.navigator&&/(msie|trident)/i.test(ci.navigator.userAgent)):()=>!0,XB=ci.hasStandardBrowserEnv?{write(t,n,l,h,m,x){const b=[t+"="+encodeURIComponent(n)];Xe.isNumber(l)&&b.push("expires="+new Date(l).toGMTString()),Xe.isString(h)&&b.push("path="+h),Xe.isString(m)&&b.push("domain="+m),x===!0&&b.push("secure"),document.cookie=b.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function KB(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function YB(t,n){return n?t.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):t}function JA(t,n,l){let h=!KB(n);return t&&(h||l==!1)?YB(t,n):n}const FE=t=>t instanceof Jo?{...t}:t;function oc(t,n){n=n||{};const l={};function h(k,B,U,F){return Xe.isPlainObject(k)&&Xe.isPlainObject(B)?Xe.merge.call({caseless:F},k,B):Xe.isPlainObject(B)?Xe.merge({},B):Xe.isArray(B)?B.slice():B}function m(k,B,U,F){if(Xe.isUndefined(B)){if(!Xe.isUndefined(k))return h(void 0,k,U,F)}else return h(k,B,U,F)}function x(k,B){if(!Xe.isUndefined(B))return h(void 0,B)}function b(k,B){if(Xe.isUndefined(B)){if(!Xe.isUndefined(k))return h(void 0,k)}else return h(void 0,B)}function s(k,B,U){if(U in n)return h(k,B);if(U in t)return h(void 0,k)}const C={url:x,method:x,data:x,baseURL:b,transformRequest:b,transformResponse:b,paramsSerializer:b,timeout:b,timeoutMessage:b,withCredentials:b,withXSRFToken:b,adapter:b,responseType:b,xsrfCookieName:b,xsrfHeaderName:b,onUploadProgress:b,onDownloadProgress:b,decompress:b,maxContentLength:b,maxBodyLength:b,beforeRedirect:b,transport:b,httpAgent:b,httpsAgent:b,cancelToken:b,socketPath:b,responseEncoding:b,validateStatus:s,headers:(k,B,U)=>m(FE(k),FE(B),U,!0)};return Xe.forEach(Object.keys(Object.assign({},t,n)),function(B){const U=C[B]||m,F=U(t[B],n[B],B);Xe.isUndefined(F)&&U!==s||(l[B]=F)}),l}const QA=t=>{const n=oc({},t);let{data:l,withXSRFToken:h,xsrfHeaderName:m,xsrfCookieName:x,headers:b,auth:s}=n;n.headers=b=Jo.from(b),n.url=HA(JA(n.baseURL,n.url,n.allowAbsoluteUrls),t.params,t.paramsSerializer),s&&b.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let C;if(Xe.isFormData(l)){if(ci.hasStandardBrowserEnv||ci.hasStandardBrowserWebWorkerEnv)b.setContentType(void 0);else if((C=b.getContentType())!==!1){const[k,...B]=C?C.split(";").map(U=>U.trim()).filter(Boolean):[];b.setContentType([k||"multipart/form-data",...B].join("; "))}}if(ci.hasStandardBrowserEnv&&(h&&Xe.isFunction(h)&&(h=h(n)),h||h!==!1&&ZB(n.url))){const k=m&&x&&XB.read(x);k&&b.set(m,k)}return n},JB=typeof XMLHttpRequest<"u",QB=JB&&function(t){return new Promise(function(l,h){const m=QA(t);let x=m.data;const b=Jo.from(m.headers).normalize();let{responseType:s,onUploadProgress:C,onDownloadProgress:k}=m,B,U,F,Z,q;function K(){Z&&Z(),q&&q(),m.cancelToken&&m.cancelToken.unsubscribe(B),m.signal&&m.signal.removeEventListener("abort",B)}let Y=new XMLHttpRequest;Y.open(m.method.toUpperCase(),m.url,!0),Y.timeout=m.timeout;function W(){if(!Y)return;const V=Jo.from("getAllResponseHeaders"in Y&&Y.getAllResponseHeaders()),ue={data:!s||s==="text"||s==="json"?Y.responseText:Y.response,status:Y.status,statusText:Y.statusText,headers:V,config:t,request:Y};YA(function(we){l(we),K()},function(we){h(we),K()},ue),Y=null}"onloadend"in Y?Y.onloadend=W:Y.onreadystatechange=function(){!Y||Y.readyState!==4||Y.status===0&&!(Y.responseURL&&Y.responseURL.indexOf("file:")===0)||setTimeout(W)},Y.onabort=function(){Y&&(h(new tn("Request aborted",tn.ECONNABORTED,t,Y)),Y=null)},Y.onerror=function(){h(new tn("Network Error",tn.ERR_NETWORK,t,Y)),Y=null},Y.ontimeout=function(){let Q=m.timeout?"timeout of "+m.timeout+"ms exceeded":"timeout exceeded";const ue=m.transitional||ZA;m.timeoutErrorMessage&&(Q=m.timeoutErrorMessage),h(new tn(Q,ue.clarifyTimeoutError?tn.ETIMEDOUT:tn.ECONNABORTED,t,Y)),Y=null},x===void 0&&b.setContentType(null),"setRequestHeader"in Y&&Xe.forEach(b.toJSON(),function(Q,ue){Y.setRequestHeader(ue,Q)}),Xe.isUndefined(m.withCredentials)||(Y.withCredentials=!!m.withCredentials),s&&s!=="json"&&(Y.responseType=m.responseType),k&&([F,q]=dm(k,!0),Y.addEventListener("progress",F)),C&&Y.upload&&([U,Z]=dm(C),Y.upload.addEventListener("progress",U),Y.upload.addEventListener("loadend",Z)),(m.cancelToken||m.signal)&&(B=V=>{Y&&(h(!V||V.type?new qu(null,t,Y):V),Y.abort(),Y=null)},m.cancelToken&&m.cancelToken.subscribe(B),m.signal&&(m.signal.aborted?B():m.signal.addEventListener("abort",B)));const O=$B(m.url);if(O&&ci.protocols.indexOf(O)===-1){h(new tn("Unsupported protocol "+O+":",tn.ERR_BAD_REQUEST,t));return}Y.send(x||null)})},eL=(t,n)=>{const{length:l}=t=t?t.filter(Boolean):[];if(n||l){let h=new AbortController,m;const x=function(k){if(!m){m=!0,s();const B=k instanceof Error?k:this.reason;h.abort(B instanceof tn?B:new qu(B instanceof Error?B.message:B))}};let b=n&&setTimeout(()=>{b=null,x(new tn(`timeout ${n} of ms exceeded`,tn.ETIMEDOUT))},n);const s=()=>{t&&(b&&clearTimeout(b),b=null,t.forEach(k=>{k.unsubscribe?k.unsubscribe(x):k.removeEventListener("abort",x)}),t=null)};t.forEach(k=>k.addEventListener("abort",x));const{signal:C}=h;return C.unsubscribe=()=>Xe.asap(s),C}},tL=eL,nL=function*(t,n){let l=t.byteLength;if(!n||l<n){yield t;return}let h=0,m;for(;h<l;)m=h+n,yield t.slice(h,m),h=m},rL=async function*(t,n){for await(const l of iL(t))yield*nL(l,n)},iL=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const n=t.getReader();try{for(;;){const{done:l,value:h}=await n.read();if(l)break;yield h}}finally{await n.cancel()}},OE=(t,n,l,h)=>{const m=rL(t,n);let x=0,b,s=C=>{b||(b=!0,h&&h(C))};return new ReadableStream({async pull(C){try{const{done:k,value:B}=await m.next();if(k){s(),C.close();return}let U=B.byteLength;if(l){let F=x+=U;l(F)}C.enqueue(new Uint8Array(B))}catch(k){throw s(k),k}},cancel(C){return s(C),m.return()}},{highWaterMark:2})},Vm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",e4=Vm&&typeof ReadableStream=="function",oL=Vm&&(typeof TextEncoder=="function"?(t=>n=>t.encode(n))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),t4=(t,...n)=>{try{return!!t(...n)}catch{return!1}},sL=e4&&t4(()=>{let t=!1;const n=new Request(ci.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!n}),NE=64*1024,Xx=e4&&t4(()=>Xe.isReadableStream(new Response("").body)),pm={stream:Xx&&(t=>t.body)};Vm&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!pm[n]&&(pm[n]=Xe.isFunction(t[n])?l=>l[n]():(l,h)=>{throw new tn(`Response type '${n}' is not supported`,tn.ERR_NOT_SUPPORT,h)})})})(new Response);const aL=async t=>{if(t==null)return 0;if(Xe.isBlob(t))return t.size;if(Xe.isSpecCompliantForm(t))return(await new Request(ci.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(t)||Xe.isArrayBuffer(t))return t.byteLength;if(Xe.isURLSearchParams(t)&&(t=t+""),Xe.isString(t))return(await oL(t)).byteLength},lL=async(t,n)=>{const l=Xe.toFiniteNumber(t.getContentLength());return l??aL(n)},cL=Vm&&(async t=>{let{url:n,method:l,data:h,signal:m,cancelToken:x,timeout:b,onDownloadProgress:s,onUploadProgress:C,responseType:k,headers:B,withCredentials:U="same-origin",fetchOptions:F}=QA(t);k=k?(k+"").toLowerCase():"text";let Z=tL([m,x&&x.toAbortSignal()],b),q;const K=Z&&Z.unsubscribe&&(()=>{Z.unsubscribe()});let Y;try{if(C&&sL&&l!=="get"&&l!=="head"&&(Y=await lL(B,h))!==0){let ue=new Request(n,{method:"POST",body:h,duplex:"half"}),fe;if(Xe.isFormData(h)&&(fe=ue.headers.get("content-type"))&&B.setContentType(fe),ue.body){const[we,Ce]=LE(Y,dm(RE(C)));h=OE(ue.body,NE,we,Ce)}}Xe.isString(U)||(U=U?"include":"omit");const W="credentials"in Request.prototype;q=new Request(n,{...F,signal:Z,method:l.toUpperCase(),headers:B.normalize().toJSON(),body:h,duplex:"half",credentials:W?U:void 0});let O=await fetch(q);const V=Xx&&(k==="stream"||k==="response");if(Xx&&(s||V&&K)){const ue={};["status","statusText","headers"].forEach(Te=>{ue[Te]=O[Te]});const fe=Xe.toFiniteNumber(O.headers.get("content-length")),[we,Ce]=s&&LE(fe,dm(RE(s),!0))||[];O=new Response(OE(O.body,NE,we,()=>{Ce&&Ce(),K&&K()}),ue)}k=k||"text";let Q=await pm[Xe.findKey(pm,k)||"text"](O,t);return!V&&K&&K(),await new Promise((ue,fe)=>{YA(ue,fe,{data:Q,headers:Jo.from(O.headers),status:O.status,statusText:O.statusText,config:t,request:q})})}catch(W){throw K&&K(),W&&W.name==="TypeError"&&/fetch/i.test(W.message)?Object.assign(new tn("Network Error",tn.ERR_NETWORK,t,q),{cause:W.cause||W}):tn.from(W,W&&W.code,t,q)}}),Kx={http:bB,xhr:QB,fetch:cL};Xe.forEach(Kx,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const UE=t=>`- ${t}`,uL=t=>Xe.isFunction(t)||t===null||t===!1,n4={getAdapter:t=>{t=Xe.isArray(t)?t:[t];const{length:n}=t;let l,h;const m={};for(let x=0;x<n;x++){l=t[x];let b;if(h=l,!uL(l)&&(h=Kx[(b=String(l)).toLowerCase()],h===void 0))throw new tn(`Unknown adapter '${b}'`);if(h)break;m[b||"#"+x]=h}if(!h){const x=Object.entries(m).map(([s,C])=>`adapter ${s} `+(C===!1?"is not supported by the environment":"is not available in the build"));let b=n?x.length>1?`since :
`+x.map(UE).join(`
`):" "+UE(x[0]):"as no adapter specified";throw new tn("There is no suitable adapter to dispatch the request "+b,"ERR_NOT_SUPPORT")}return h},adapters:Kx};function ry(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new qu(null,t)}function jE(t){return ry(t),t.headers=Jo.from(t.headers),t.data=ny.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),n4.getAdapter(t.adapter||lv.adapter)(t).then(function(h){return ry(t),h.data=ny.call(t,t.transformResponse,h),h.headers=Jo.from(h.headers),h},function(h){return KA(h)||(ry(t),h&&h.response&&(h.response.data=ny.call(t,t.transformResponse,h.response),h.response.headers=Jo.from(h.response.headers))),Promise.reject(h)})}const r4="1.8.4",Gm={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{Gm[t]=function(h){return typeof h===t||"a"+(n<1?"n ":" ")+t}});const VE={};Gm.transitional=function(n,l,h){function m(x,b){return"[Axios v"+r4+"] Transitional option '"+x+"'"+b+(h?". "+h:"")}return(x,b,s)=>{if(n===!1)throw new tn(m(b," has been removed"+(l?" in "+l:"")),tn.ERR_DEPRECATED);return l&&!VE[b]&&(VE[b]=!0,console.warn(m(b," has been deprecated since v"+l+" and will be removed in the near future"))),n?n(x,b,s):!0}};Gm.spelling=function(n){return(l,h)=>(console.warn(`${h} is likely a misspelling of ${n}`),!0)};function hL(t,n,l){if(typeof t!="object")throw new tn("options must be an object",tn.ERR_BAD_OPTION_VALUE);const h=Object.keys(t);let m=h.length;for(;m-- >0;){const x=h[m],b=n[x];if(b){const s=t[x],C=s===void 0||b(s,x,t);if(C!==!0)throw new tn("option "+x+" must be "+C,tn.ERR_BAD_OPTION_VALUE);continue}if(l!==!0)throw new tn("Unknown option "+x,tn.ERR_BAD_OPTION)}}const L0={assertOptions:hL,validators:Gm},_s=L0.validators;class fm{constructor(n){this.defaults=n,this.interceptors={request:new zE,response:new zE}}async request(n,l){try{return await this._request(n,l)}catch(h){if(h instanceof Error){let m={};Error.captureStackTrace?Error.captureStackTrace(m):m=new Error;const x=m.stack?m.stack.replace(/^.+\n/,""):"";try{h.stack?x&&!String(h.stack).endsWith(x.replace(/^.+\n.+\n/,""))&&(h.stack+=`
`+x):h.stack=x}catch{}}throw h}}_request(n,l){typeof n=="string"?(l=l||{},l.url=n):l=n||{},l=oc(this.defaults,l);const{transitional:h,paramsSerializer:m,headers:x}=l;h!==void 0&&L0.assertOptions(h,{silentJSONParsing:_s.transitional(_s.boolean),forcedJSONParsing:_s.transitional(_s.boolean),clarifyTimeoutError:_s.transitional(_s.boolean)},!1),m!=null&&(Xe.isFunction(m)?l.paramsSerializer={serialize:m}:L0.assertOptions(m,{encode:_s.function,serialize:_s.function},!0)),l.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?l.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:l.allowAbsoluteUrls=!0),L0.assertOptions(l,{baseUrl:_s.spelling("baseURL"),withXsrfToken:_s.spelling("withXSRFToken")},!0),l.method=(l.method||this.defaults.method||"get").toLowerCase();let b=x&&Xe.merge(x.common,x[l.method]);x&&Xe.forEach(["delete","get","head","post","put","patch","common"],q=>{delete x[q]}),l.headers=Jo.concat(b,x);const s=[];let C=!0;this.interceptors.request.forEach(function(K){typeof K.runWhen=="function"&&K.runWhen(l)===!1||(C=C&&K.synchronous,s.unshift(K.fulfilled,K.rejected))});const k=[];this.interceptors.response.forEach(function(K){k.push(K.fulfilled,K.rejected)});let B,U=0,F;if(!C){const q=[jE.bind(this),void 0];for(q.unshift.apply(q,s),q.push.apply(q,k),F=q.length,B=Promise.resolve(l);U<F;)B=B.then(q[U++],q[U++]);return B}F=s.length;let Z=l;for(U=0;U<F;){const q=s[U++],K=s[U++];try{Z=q(Z)}catch(Y){K.call(this,Y);break}}try{B=jE.call(this,Z)}catch(q){return Promise.reject(q)}for(U=0,F=k.length;U<F;)B=B.then(k[U++],k[U++]);return B}getUri(n){n=oc(this.defaults,n);const l=JA(n.baseURL,n.url,n.allowAbsoluteUrls);return HA(l,n.params,n.paramsSerializer)}}Xe.forEach(["delete","get","head","options"],function(n){fm.prototype[n]=function(l,h){return this.request(oc(h||{},{method:n,url:l,data:(h||{}).data}))}});Xe.forEach(["post","put","patch"],function(n){function l(h){return function(x,b,s){return this.request(oc(s||{},{method:n,headers:h?{"Content-Type":"multipart/form-data"}:{},url:x,data:b}))}}fm.prototype[n]=l(),fm.prototype[n+"Form"]=l(!0)});const R0=fm;class cv{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let l;this.promise=new Promise(function(x){l=x});const h=this;this.promise.then(m=>{if(!h._listeners)return;let x=h._listeners.length;for(;x-- >0;)h._listeners[x](m);h._listeners=null}),this.promise.then=m=>{let x;const b=new Promise(s=>{h.subscribe(s),x=s}).then(m);return b.cancel=function(){h.unsubscribe(x)},b},n(function(x,b,s){h.reason||(h.reason=new qu(x,b,s),l(h.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const l=this._listeners.indexOf(n);l!==-1&&this._listeners.splice(l,1)}toAbortSignal(){const n=new AbortController,l=h=>{n.abort(h)};return this.subscribe(l),n.signal.unsubscribe=()=>this.unsubscribe(l),n.signal}static source(){let n;return{token:new cv(function(m){n=m}),cancel:n}}}const dL=cv;function pL(t){return function(l){return t.apply(null,l)}}function fL(t){return Xe.isObject(t)&&t.isAxiosError===!0}const Yx={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Yx).forEach(([t,n])=>{Yx[n]=t});const mL=Yx;function i4(t){const n=new R0(t),l=RA(R0.prototype.request,n);return Xe.extend(l,R0.prototype,n,{allOwnKeys:!0}),Xe.extend(l,n,null,{allOwnKeys:!0}),l.create=function(m){return i4(oc(t,m))},l}const Ar=i4(lv);Ar.Axios=R0;Ar.CanceledError=qu;Ar.CancelToken=dL;Ar.isCancel=KA;Ar.VERSION=r4;Ar.toFormData=Um;Ar.AxiosError=tn;Ar.Cancel=Ar.CanceledError;Ar.all=function(n){return Promise.all(n)};Ar.spread=pL;Ar.isAxiosError=fL;Ar.mergeConfig=oc;Ar.AxiosHeaders=Jo;Ar.formToJSON=t=>XA(Xe.isHTMLForm(t)?new FormData(t):t);Ar.getAdapter=n4.getAdapter;Ar.HttpStatusCode=mL;Ar.default=Ar;const gL=Ar;/*
 * Frontend UI component library for the CORI Data API 
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */const wu="https://cori-data-api.ruralinnovation.us/";function iy(t){t(),window.alert("Please refresh this session by clicking the browser's reload button!"),window.location=window.location.protocol+"//"+window.location.host+window.location.pathname}const Jx=gL.create({baseURL:wu,headers:{"Content-Type":"application/json"}}),oy={},o4={apiClient:Jx,authenticated:!1,authenticated_user:null,autoSignOut:null,baseURL:wu,token:null,data:{get:()=>oy,set:t=>{for(const n in t)t.hasOwnProperty[n]&&(oy[n]=t)}},setData:t=>{for(const n in t)t.hasOwnProperty[n]&&(oy[n]=t)}},s4=xt.createContext(o4);let _0=!1,GE=!1;function qE(t){const[n,l]=xt.useState(Object.assign(Object.assign({},o4),{baseURL:t.baseURL?t.baseURL:wu,setData:h}));function h(m){const x=n;l(Object.assign(Object.assign({},x),{data:Object.assign(Object.assign({},x.data),m),setData:h}))}return t.baseURL&&t.baseURL.length>0&&Jx.interceptors.request.use(m=>(m.baseURL=t.baseURL,console.log("API baseURL updated:",m.baseURL),m),m=>Promise.reject(m)),xt.useEffect(()=>{if(l(Object.assign(Object.assign({},n),{autoSignOut:t.signOut&&typeof t.signOut=="function"?()=>{console.log("autoSignOut defined in ApiContextProvider line 212"),t.signOut&&typeof t.signOut=="function"&&iy(t.signOut)}:null,baseURL:t.baseURL?t.baseURL:wu})),t.fetchAuthSession){const{fetchAuthSession:m}=t;m().then(b=>{if(!_0){const s=b.tokens;if(console.log("API tokens:",s),s&&s.hasOwnProperty("idToken")&&(_0=!0,console.log("API Session is authenticated:",_0),console.log("API Session config:",b),console.log("idToken:",s.idToken),Jx.interceptors.request.use(C=>{const k=s.idToken;return k&&(C.headers.Authorization=`Bearer ${k}`),t.baseURL&&(C.baseURL=t.baseURL),C},C=>Promise.reject(C)),l(Object.assign(Object.assign({},n),{authenticated:!0,autoSignOut:t.signOut&&typeof t.signOut=="function"?()=>{console.log("autoSignOut defined in ApiContextProvider line 263"),t.signOut&&typeof t.signOut=="function"&&iy(t.signOut)}:null,baseURL:t.baseURL||wu,token:s.idToken})),t.getCurrentUser)){const{getCurrentUser:C}=t;C().then(B=>{GE||(GE=!0,console.log("API User is authenticated:",_0),console.log("API User:",B),console.log("API User type:",B.constructor.name),l(Object.assign(Object.assign({},n),{authenticated:!0,authenticated_user:B,autoSignOut:t.signOut&&typeof t.signOut=="function"?()=>{console.log("autoSignOut defined in ApiContextProvider line 339"),t.signOut&&typeof t.signOut=="function"&&iy(t.signOut)}:null,baseURL:t.baseURL||wu,token:s.idToken})))})}}})}},[]),I_.createElement(I_.Fragment,null,I_.createElement(s4.Provider,{value:n},t.children))}const _L="modulepreload",yL=function(t){return"/"+t},$E={},xL=function(n,l,h){if(!l||l.length===0)return n();const m=document.getElementsByTagName("link");return Promise.all(l.map(x=>{if(x=yL(x),x in $E)return;$E[x]=!0;const b=x.endsWith(".css"),s=b?'[rel="stylesheet"]':"";if(!!h)for(let B=m.length-1;B>=0;B--){const U=m[B];if(U.href===x&&(!b||U.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${s}`))return;const k=document.createElement("link");if(k.rel=b?"stylesheet":_L,b||(k.as="script",k.crossOrigin=""),k.href=x,document.head.appendChild(k),b)return new Promise((B,U)=>{k.addEventListener("load",B),k.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${x}`)))})})).then(()=>n()).catch(x=>{const b=new Event("vite:preloadError",{cancelable:!0});if(b.payload=x,window.dispatchEvent(b),!b.defaultPrevented)throw x})},vL=xt.createContext(null);function wL(t,n){const l=Array.isArray(t)?t[0]:t?t.x:0,h=Array.isArray(t)?t[1]:t?t.y:0,m=Array.isArray(n)?n[0]:n?n.x:0,x=Array.isArray(n)?n[1]:n?n.y:0;return l===m&&h===x}function Ws(t,n){if(t===n)return!0;if(!t||!n)return!1;if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let l=0;l<t.length;l++)if(!Ws(t[l],n[l]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof t=="object"&&typeof n=="object"){const l=Object.keys(t),h=Object.keys(n);if(l.length!==h.length)return!1;for(const m of l)if(!n.hasOwnProperty(m)||!Ws(t[m],n[m]))return!1;return!0}return!1}function bL(t){const n=t.clone();return n.pixelsToGLUnits=t.pixelsToGLUnits,n}function WE(t,n){if(!t.getProjection)return;const l=t.getProjection(),h=n.getProjection();Ws(l,h)||n.setProjection(l)}function HE(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function ZE(t,n){const l=n.viewState||n;let h=!1;if("zoom"in l){const m=t.zoom;t.zoom=l.zoom,h=h||m!==t.zoom}if("bearing"in l){const m=t.bearing;t.bearing=l.bearing,h=h||m!==t.bearing}if("pitch"in l){const m=t.pitch;t.pitch=l.pitch,h=h||m!==t.pitch}if(l.padding&&!t.isPaddingEqual(l.padding)&&(h=!0,t.padding=l.padding),"longitude"in l&&"latitude"in l){const m=t.center;t.center=new m.constructor(l.longitude,l.latitude),h=h||m!==t.center}return h}const EL=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function XE(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const n={};for(const h of t.layers)n[h.id]=h;const l=t.layers.map(h=>{let m=null;"interactive"in h&&(m=Object.assign({},h),delete m.interactive);const x=n[h.ref];if(x){m=m||Object.assign({},h),delete m.ref;for(const b of EL)b in x&&(m[b]=x[b])}return m||h});return{...t,layers:l}}const KE={version:8,sources:{},layers:[]},YE={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},sy={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},JE={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},TL=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],SL=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Fu{constructor(n,l,h){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=m=>{const x=this.props[JE[m.type]];x?x(m):m.type==="error"&&console.error(m.error)},this._onPointerEvent=m=>{(m.type==="mousemove"||m.type==="mouseout")&&this._updateHover(m);const x=this.props[YE[m.type]];x&&(this.props.interactiveLayerIds&&m.type!=="mouseover"&&m.type!=="mouseout"&&(m.features=this._hoveredFeatures||this._queryRenderedFeatures(m.point)),x(m),delete m.features)},this._onCameraEvent=m=>{if(!this._internalUpdate){const x=this.props[sy[m.type]];x&&x(m)}m.type in this._deferredEvents&&(this._deferredEvents[m.type]=!1)},this._MapClass=n,this.props=l,this._initialize(h)}get map(){return this._map}get transform(){return this._renderTransform}setProps(n){const l=this.props;this.props=n;const h=this._updateSettings(n,l);h&&this._createShadowTransform(this._map);const m=this._updateSize(n),x=this._updateViewState(n,!0);this._updateStyle(n,l),this._updateStyleComponents(n,l),this._updateHandlers(n,l),(h||m||x&&!this._map.isMoving())&&this.redraw()}static reuse(n,l){const h=Fu.savedMaps.pop();if(!h)return null;const m=h.map,x=m.getContainer();for(l.className=x.className;x.childNodes.length>0;)l.appendChild(x.childNodes[0]);m._container=l;const b=m._resizeObserver;b&&(b.disconnect(),b.observe(l)),h.setProps({...n,styleDiffing:!1}),m.resize();const{initialViewState:s}=n;return s&&(s.bounds?m.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):h._updateViewState(s,!1)),m.isStyleLoaded()?m.fire("load"):m.once("styledata",()=>m.fire("load")),m._update(),h}_initialize(n){const{props:l}=this,{mapStyle:h=KE}=l,m={...l,...l.initialViewState,accessToken:l.mapboxAccessToken||CL()||null,container:n,style:XE(h)},x=m.initialViewState||m.viewState||m;if(Object.assign(m,{center:[x.longitude||0,x.latitude||0],zoom:x.zoom||0,pitch:x.pitch||0,bearing:x.bearing||0}),l.gl){const B=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=B,l.gl)}const b=new this._MapClass(m);x.padding&&b.setPadding(x.padding),l.cursor&&(b.getCanvas().style.cursor=l.cursor),this._createShadowTransform(b);const s=b._render;b._render=B=>{this._inRender=!0,s.call(b,B),this._inRender=!1};const C=b._renderTaskQueue.run;b._renderTaskQueue.run=B=>{C.call(b._renderTaskQueue,B),this._onBeforeRepaint()},b.on("render",()=>this._onAfterRepaint());const k=b.fire;b.fire=this._fireEvent.bind(this,k),b.on("resize",()=>{this._renderTransform.resize(b.transform.width,b.transform.height)}),b.on("styledata",()=>{this._updateStyleComponents(this.props,{}),WE(b.transform,this._renderTransform)}),b.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const B in YE)b.on(B,this._onPointerEvent);for(const B in sy)b.on(B,this._onCameraEvent);for(const B in JE)b.on(B,this._onEvent);this._map=b}recycle(){const l=this.map.getContainer().querySelector("[mapboxgl-children]");l==null||l.remove(),Fu.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;!this._inRender&&n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_createShadowTransform(n){const l=bL(n.transform);n.painter.transform=l,this._renderTransform=l}_updateSize(n){const{viewState:l}=n;if(l){const h=this._map;if(l.width!==h.transform.width||l.height!==h.transform.height)return h.resize(),!0}return!1}_updateViewState(n,l){if(this._internalUpdate)return!1;const h=this._map,m=this._renderTransform,{zoom:x,pitch:b,bearing:s}=m,C=h.isMoving();C&&(m.cameraElevationReference="sea");const k=ZE(m,{...HE(h.transform),...n});if(C&&(m.cameraElevationReference="ground"),k&&l){const B=this._deferredEvents;B.move=!0,B.zoom||(B.zoom=x!==m.zoom),B.rotate||(B.rotate=s!==m.bearing),B.pitch||(B.pitch=b!==m.pitch)}return C||ZE(h.transform,n),k}_updateSettings(n,l){const h=this._map;let m=!1;for(const x of TL)if(x in n&&!Ws(n[x],l[x])){m=!0;const b=h[`set${x[0].toUpperCase()}${x.slice(1)}`];b==null||b.call(h,n[x])}return m}_updateStyle(n,l){if(n.cursor!==l.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==l.mapStyle){const{mapStyle:h=KE,styleDiffing:m=!0}=n,x={diff:m};return"localIdeographFontFamily"in n&&(x.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(XE(h),x),!0}return!1}_updateStyleComponents(n,l){const h=this._map;let m=!1;return h.isStyleLoaded()&&("light"in n&&h.setLight&&!Ws(n.light,l.light)&&(m=!0,h.setLight(n.light)),"fog"in n&&h.setFog&&!Ws(n.fog,l.fog)&&(m=!0,h.setFog(n.fog)),"terrain"in n&&h.setTerrain&&!Ws(n.terrain,l.terrain)&&(!n.terrain||h.getSource(n.terrain.source))&&(m=!0,h.setTerrain(n.terrain))),m}_updateHandlers(n,l){var h,m;const x=this._map;let b=!1;for(const s of SL){const C=(h=n[s])!==null&&h!==void 0?h:!0,k=(m=l[s])!==null&&m!==void 0?m:!0;Ws(C,k)||(b=!0,C?x[s].enable(C):x[s].disable())}return b}_queryRenderedFeatures(n){const l=this._map,h=l.transform,{interactiveLayerIds:m=[]}=this.props;try{return l.transform=this._renderTransform,l.queryRenderedFeatures(n,{layers:m.filter(l.getLayer.bind(l))})}catch{return[]}finally{l.transform=h}}_updateHover(n){var l;const{props:h}=this;if(h.interactiveLayerIds&&(h.onMouseMove||h.onMouseEnter||h.onMouseLeave)){const x=n.type,b=((l=this._hoveredFeatures)===null||l===void 0?void 0:l.length)>0,s=this._queryRenderedFeatures(n.point),C=s.length>0;!C&&b&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=s,C&&!b&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=x}else this._hoveredFeatures=null}_fireEvent(n,l,h){const m=this._map,x=m.transform,b=typeof l=="string"?l:l.type;return b==="move"&&this._updateViewState(this.props,!1),b in sy&&(typeof l=="object"&&(l.viewState=HE(x)),this._map.isMoving())?(m.transform=this._renderTransform,n.call(m,l,h),m.transform=x,m):(n.call(m,l,h),m)}_onBeforeRepaint(){const n=this._map;this._internalUpdate=!0;for(const h in this._deferredEvents)this._deferredEvents[h]&&n.fire(h);this._internalUpdate=!1;const l=this._map.transform;n.transform=this._renderTransform,this._onAfterRepaint=()=>{WE(this._renderTransform,l),n.transform=l}}}Fu.savedMaps=[];function CL(){let t=null;if(typeof location<"u"){const n=/access_token=([^&\/]*)/.exec(location.search);t=n&&n[1]}try{t=t||void 0}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const AL=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function IL(t){if(!t)return null;const n=t.map,l={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:h=>{const m=n.transform;n.transform=t.transform;const x=n.project(h);return n.transform=m,x},unproject:h=>{const m=n.transform;n.transform=t.transform;const x=n.unproject(h);return n.transform=m,x},queryTerrainElevation:(h,m)=>{const x=n.transform;n.transform=t.transform;const b=n.queryTerrainElevation(h,m);return n.transform=x,b},queryRenderedFeatures:(h,m)=>{const x=n.transform;n.transform=t.transform;const b=n.queryRenderedFeatures(h,m);return n.transform=x,b}};for(const h of kL(n))!(h in l)&&!AL.includes(h)&&(l[h]=n[h].bind(n));return l}function kL(t){const n=new Set;let l=t;for(;l;){for(const h of Object.getOwnPropertyNames(l))h[0]!=="_"&&typeof t[h]=="function"&&h!=="fire"&&h!=="setEventedParent"&&n.add(h);l=Object.getPrototypeOf(l)}return Array.from(n)}const ML=typeof document<"u"?xt.useLayoutEffect:xt.useEffect,DL=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function PL(t,n){for(const h of DL)h in n&&(t[h]=n[h]);const{RTLTextPlugin:l="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=n;l&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(l,h=>{h&&console.error(h)},!0)}const qm=xt.createContext(null);function zL(t,n,l){const h=xt.useContext(vL),[m,x]=xt.useState(null),b=xt.useRef(),{current:s}=xt.useRef({mapLib:null,map:null});xt.useEffect(()=>{const B=t.mapLib;let U=!0,F;return Promise.resolve(B||l).then(Z=>{if(!U)return;if(!Z)throw new Error("Invalid mapLib");const q="Map"in Z?Z:Z.default;if(!q.Map)throw new Error("Invalid mapLib");if(PL(q,t),!q.supported||q.supported(t))t.reuseMaps&&(F=Fu.reuse(t,b.current)),F||(F=new Fu(q.Map,t,b.current)),s.map=IL(F),s.mapLib=q,x(F),h==null||h.onMapMount(s.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(Z=>{const{onError:q}=t;q?q({type:"error",target:null,originalEvent:null,error:Z}):console.error(Z)}),()=>{U=!1,F&&(h==null||h.onMapUnmount(t.id),t.reuseMaps?F.recycle():F.destroy())}},[]),ML(()=>{m&&m.setProps(t)}),xt.useImperativeHandle(n,()=>s.map,[m]);const C=xt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),k={height:"100%"};return xt.createElement("div",{id:t.id,ref:b,style:C},m&&xt.createElement(qm.Provider,{value:s},xt.createElement("div",{"mapboxgl-children":"",style:k},t.children)))}const BL=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function lc(t,n){if(!t||!n)return;const l=t.style;for(const h in n){const m=n[h];Number.isFinite(m)&&!BL.test(h)?l[h]=`${m}px`:l[h]=m}}function LL(t,n){const{map:l,mapLib:h}=xt.useContext(qm),m=xt.useRef({props:t});m.current.props=t;const x=xt.useMemo(()=>{let K=!1;xt.Children.forEach(t.children,O=>{O&&(K=!0)});const Y={...t,element:K?document.createElement("div"):null},W=new h.Marker(Y);return W.setLngLat([t.longitude,t.latitude]),W.getElement().addEventListener("click",O=>{var V,Q;(Q=(V=m.current.props).onClick)===null||Q===void 0||Q.call(V,{type:"click",target:W,originalEvent:O})}),W.on("dragstart",O=>{var V,Q;const ue=O;ue.lngLat=x.getLngLat(),(Q=(V=m.current.props).onDragStart)===null||Q===void 0||Q.call(V,ue)}),W.on("drag",O=>{var V,Q;const ue=O;ue.lngLat=x.getLngLat(),(Q=(V=m.current.props).onDrag)===null||Q===void 0||Q.call(V,ue)}),W.on("dragend",O=>{var V,Q;const ue=O;ue.lngLat=x.getLngLat(),(Q=(V=m.current.props).onDragEnd)===null||Q===void 0||Q.call(V,ue)}),W},[]);xt.useEffect(()=>(x.addTo(l.getMap()),()=>{x.remove()}),[]);const{longitude:b,latitude:s,offset:C,style:k,draggable:B=!1,popup:U=null,rotation:F=0,rotationAlignment:Z="auto",pitchAlignment:q="auto"}=t;return xt.useEffect(()=>{lc(x.getElement(),k)},[k]),xt.useImperativeHandle(n,()=>x,[]),(x.getLngLat().lng!==b||x.getLngLat().lat!==s)&&x.setLngLat([b,s]),C&&!wL(x.getOffset(),C)&&x.setOffset(C),x.isDraggable()!==B&&x.setDraggable(B),x.getRotation()!==F&&x.setRotation(F),x.getRotationAlignment()!==Z&&x.setRotationAlignment(Z),x.getPitchAlignment()!==q&&x.setPitchAlignment(q),x.getPopup()!==U&&x.setPopup(U),X1.createPortal(t.children,x.getElement())}const RL=xt.memo(xt.forwardRef(LL));function QE(t){return new Set(t?t.trim().split(/\s+/):[])}function FL(t,n){const{map:l,mapLib:h}=xt.useContext(qm),m=xt.useMemo(()=>document.createElement("div"),[]),x=xt.useRef({props:t});x.current.props=t;const b=xt.useMemo(()=>{const s={...t},C=new h.Popup(s);return C.setLngLat([t.longitude,t.latitude]),C.once("open",k=>{var B,U;(U=(B=x.current.props).onOpen)===null||U===void 0||U.call(B,k)}),C},[]);if(xt.useEffect(()=>{const s=C=>{var k,B;(B=(k=x.current.props).onClose)===null||B===void 0||B.call(k,C)};return b.on("close",s),b.setDOMContent(m).addTo(l.getMap()),()=>{b.off("close",s),b.isOpen()&&b.remove()}},[]),xt.useEffect(()=>{lc(b.getElement(),t.style)},[t.style]),xt.useImperativeHandle(n,()=>b,[]),b.isOpen()&&((b.getLngLat().lng!==t.longitude||b.getLngLat().lat!==t.latitude)&&b.setLngLat([t.longitude,t.latitude]),t.offset&&!Ws(b.options.offset,t.offset)&&b.setOffset(t.offset),(b.options.anchor!==t.anchor||b.options.maxWidth!==t.maxWidth)&&(b.options.anchor=t.anchor,b.setMaxWidth(t.maxWidth)),b.options.className!==t.className)){const s=QE(b.options.className),C=QE(t.className);for(const k of s)C.has(k)||b.removeClassName(k);for(const k of C)s.has(k)||b.addClassName(k);b.options.className=t.className}return X1.createPortal(t.children,m)}xt.memo(xt.forwardRef(FL));function $u(t,n,l,h){const m=xt.useContext(qm),x=xt.useMemo(()=>t(m),[]);return xt.useEffect(()=>{const b=h||l||n,s=typeof n=="function"&&typeof l=="function"?n:null,C=typeof l=="function"?l:typeof n=="function"?n:null,{map:k}=m;return k.hasControl(x)||(k.addControl(x,b==null?void 0:b.position),s&&s(m)),()=>{C&&C(m),k.hasControl(x)&&k.removeControl(x)}},[]),x}function OL(t){const n=$u(({mapLib:l})=>new l.AttributionControl(t),{position:t.position});return xt.useEffect(()=>{lc(n._container,t.style)},[t.style]),null}xt.memo(OL);function NL(t){const n=$u(({mapLib:l})=>new l.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return xt.useEffect(()=>{lc(n._controlContainer,t.style)},[t.style]),null}xt.memo(NL);function UL(t,n){const l=xt.useRef({props:t}),h=$u(({mapLib:m})=>{const x=new m.GeolocateControl(t),b=x._setupUI;return x._setupUI=s=>{x._container.hasChildNodes()||b(s)},x.on("geolocate",s=>{var C,k;(k=(C=l.current.props).onGeolocate)===null||k===void 0||k.call(C,s)}),x.on("error",s=>{var C,k;(k=(C=l.current.props).onError)===null||k===void 0||k.call(C,s)}),x.on("outofmaxbounds",s=>{var C,k;(k=(C=l.current.props).onOutOfMaxBounds)===null||k===void 0||k.call(C,s)}),x.on("trackuserlocationstart",s=>{var C,k;(k=(C=l.current.props).onTrackUserLocationStart)===null||k===void 0||k.call(C,s)}),x.on("trackuserlocationend",s=>{var C,k;(k=(C=l.current.props).onTrackUserLocationEnd)===null||k===void 0||k.call(C,s)}),x},{position:t.position});return l.current.props=t,xt.useImperativeHandle(n,()=>h,[]),xt.useEffect(()=>{lc(h._container,t.style)},[t.style]),null}const jL=xt.memo(xt.forwardRef(UL));function VL(t){const n=$u(({mapLib:l})=>new l.NavigationControl(t),{position:t.position});return xt.useEffect(()=>{lc(n._container,t.style)},[t.style]),null}const GL=xt.memo(VL);function qL(t){const n=$u(({mapLib:x})=>new x.ScaleControl(t),{position:t.position}),l=xt.useRef(t),h=l.current;l.current=t;const{style:m}=t;return t.maxWidth!==void 0&&t.maxWidth!==h.maxWidth&&(n.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==h.unit&&n.setUnit(t.unit),xt.useEffect(()=>{lc(n._container,m)},[m]),null}const $L=xt.memo(qL),WL=xL(()=>Promise.resolve().then(()=>z6),void 0),HL=(()=>xt.forwardRef(function(n,l){return zL(n,l,WL)}))(),a4=RL,ZL=GL,XL=jL,KL=$L;var Wu=JL,YL=Object.prototype.hasOwnProperty;function JL(){for(var t={},n=0;n<arguments.length;n++){var l=arguments[n];for(var h in l)YL.call(l,h)&&(t[h]=l[h])}return t}var l4={exports:{}};(function(t,n){(function(){var l={};t.exports=l,l.simpleFilter=function(h,m){return m.filter(function(x){return l.test(h,x)})},l.test=function(h,m){return l.match(h,m)!==null},l.match=function(h,m,x){x=x||{};var b=0,s=[],C=m.length,k=0,B=0,U=x.pre||"",F=x.post||"",Z=x.caseSensitive&&m||m.toLowerCase(),q;h=x.caseSensitive&&h||h.toLowerCase();for(var K=0;K<C;K++)q=m[K],Z[K]===h[b]?(q=U+q+F,b+=1,B+=1+B):B=0,k+=B,s[s.length]=q;return b===h.length?(k=Z===h?1/0:k,{rendered:s.join(""),score:k}):null},l.filter=function(h,m,x){return!m||m.length===0?[]:typeof h!="string"?m:(x=x||{},m.reduce(function(b,s,C,k){var B=s;x.extract&&(B=x.extract(s));var U=l.match(h,B,x);return U!=null&&(b[b.length]={string:U.rendered,score:U.score,index:C,original:s}),b},[]).sort(function(b,s){var C=s.score-b.score;return C||b.index-s.index}))}})()})(l4);var QL=l4.exports,Li=function(t){return this.component=t,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};Li.prototype.show=function(){this.element.style.display="block"};Li.prototype.hide=function(){this.element.style.display="none"};Li.prototype.add=function(t){this.items.push(t)};Li.prototype.clear=function(){this.items=[],this.active=0};Li.prototype.isEmpty=function(){return!this.items.length};Li.prototype.isVisible=function(){return this.element.style.display==="block"};Li.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()};Li.prototype.drawItem=function(t,n){var l=document.createElement("li"),h=document.createElement("a");n&&(l.className+=" active"),h.innerHTML=t.string,l.appendChild(h),this.element.appendChild(l),l.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),l.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,t)}).bind(this))};Li.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()};Li.prototype.move=function(t){this.active=t,this.draw()};Li.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};Li.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};Li.prototype.drawError=function(t){var n=document.createElement("li");n.innerHTML=t,this.element.appendChild(n),this.show()};var eR=Li,tR=Wu,nR=QL,rR=eR,hi=function(t,n,l){return l=l||{},this.options=tR({minLength:2,limit:5,filter:!0,hideOnBlur:!0},l),this.el=t,this.data=n||[],this.list=new rR(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(h){this.handleKeyUp(h.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(h){this.handleKeyDown(h)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(h){this.handlePaste(h)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};hi.prototype.handleKeyUp=function(t){t===40||t===38||t===27||t===13||t===9||this.handleInputChange(this.el.value)};hi.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};hi.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};hi.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var n=this;setTimeout(function(){n.handleInputChange(t.target.value)},100)}};hi.prototype.handleInputChange=function(t){if(this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(n){for(var l=0;l<n.length&&(this.list.add(n[l]),l!==this.options.limit-1);l++);this.list.draw()}).bind(this))};hi.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};hi.prototype.update=function(t){this.data=t,this.handleKeyUp()};hi.prototype.clear=function(){this.data=[],this.list.clear()};hi.prototype.normalize=function(t){return t=t.toLowerCase(),t};hi.prototype.match=function(t,n){return t.indexOf(n)>-1};hi.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!1),this.el.dispatchEvent(n)}else this.el.fireEvent("onchange")};hi.prototype.getCandidates=function(t){var n={pre:"<strong>",post:"</strong>",extract:(function(h){return this.getItemValue(h)}).bind(this)},l;this.options.filter?(l=nR.filter(this.query,this.data,n),l=l.map((function(h){return{original:h.original,string:this.render(h.original,h.string)}}).bind(this))):l=this.data.map((function(h){var m=this.render(h);return{original:h,string:m}}).bind(this)),t(l)};hi.prototype.getItemValue=function(t){return t};hi.prototype.render=function(t,n){if(n)return n;for(var l=t.original?this.getItemValue(t.original):this.getItemValue(t),h=this.normalize(l),m=h.lastIndexOf(this.query);m>-1;){var x=m+this.query.length;l=l.slice(0,m)+"<strong>"+l.slice(m,x)+"</strong>"+l.slice(x),m=h.slice(0,m).lastIndexOf(this.query)}return l};hi.prototype.renderError=function(t){this.list.drawError(t)};var iR=hi,c4=iR,oR=c4;typeof window<"u"&&(window.Suggestions=c4);var sR="Expected a function",eT=0/0,aR="[object Symbol]",lR=/^\s+|\s+$/g,cR=/^[-+]0x[0-9a-f]+$/i,uR=/^0b[01]+$/i,hR=/^0o[0-7]+$/i,dR=parseInt,pR=typeof $t=="object"&&$t&&$t.Object===Object&&$t,fR=typeof self=="object"&&self&&self.Object===Object&&self,mR=pR||fR||Function("return this")(),gR=Object.prototype,_R=gR.toString,yR=Math.max,xR=Math.min,ay=function(){return mR.Date.now()};function vR(t,n,l){var h,m,x,b,s,C,k=0,B=!1,U=!1,F=!0;if(typeof t!="function")throw new TypeError(sR);n=tT(n)||0,Qx(l)&&(B=!!l.leading,U="maxWait"in l,x=U?yR(tT(l.maxWait)||0,n):x,F="trailing"in l?!!l.trailing:F);function Z(fe){var we=h,Ce=m;return h=m=void 0,k=fe,b=t.apply(Ce,we),b}function q(fe){return k=fe,s=setTimeout(W,n),B?Z(fe):b}function K(fe){var we=fe-C,Ce=fe-k,Te=n-we;return U?xR(Te,x-Ce):Te}function Y(fe){var we=fe-C,Ce=fe-k;return C===void 0||we>=n||we<0||U&&Ce>=x}function W(){var fe=ay();if(Y(fe))return O(fe);s=setTimeout(W,K(fe))}function O(fe){return s=void 0,F&&h?Z(fe):(h=m=void 0,b)}function V(){s!==void 0&&clearTimeout(s),k=0,h=C=m=s=void 0}function Q(){return s===void 0?b:O(ay())}function ue(){var fe=ay(),we=Y(fe);if(h=arguments,m=this,C=fe,we){if(s===void 0)return q(C);if(U)return s=setTimeout(W,n),Z(C)}return s===void 0&&(s=setTimeout(W,n)),b}return ue.cancel=V,ue.flush=Q,ue}function Qx(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}function wR(t){return!!t&&typeof t=="object"}function bR(t){return typeof t=="symbol"||wR(t)&&_R.call(t)==aR}function tT(t){if(typeof t=="number")return t;if(bR(t))return eT;if(Qx(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=Qx(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=t.replace(lR,"");var l=uR.test(t);return l||hR.test(t)?dR(t.slice(2),l?2:8):cR.test(t)?eT:+t}var ER=vR,uv={exports:{}},Iu=typeof Reflect=="object"?Reflect:null,nT=Iu&&typeof Iu.apply=="function"?Iu.apply:function(n,l,h){return Function.prototype.apply.call(n,l,h)},F0;Iu&&typeof Iu.ownKeys=="function"?F0=Iu.ownKeys:Object.getOwnPropertySymbols?F0=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:F0=function(n){return Object.getOwnPropertyNames(n)};function TR(t){console&&console.warn&&console.warn(t)}var u4=Number.isNaN||function(n){return n!==n};function On(){On.init.call(this)}uv.exports=On;uv.exports.once=IR;On.EventEmitter=On;On.prototype._events=void 0;On.prototype._eventsCount=0;On.prototype._maxListeners=void 0;var rT=10;function $m(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(On,"defaultMaxListeners",{enumerable:!0,get:function(){return rT},set:function(t){if(typeof t!="number"||t<0||u4(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");rT=t}});On.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};On.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||u4(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};function h4(t){return t._maxListeners===void 0?On.defaultMaxListeners:t._maxListeners}On.prototype.getMaxListeners=function(){return h4(this)};On.prototype.emit=function(n){for(var l=[],h=1;h<arguments.length;h++)l.push(arguments[h]);var m=n==="error",x=this._events;if(x!==void 0)m=m&&x.error===void 0;else if(!m)return!1;if(m){var b;if(l.length>0&&(b=l[0]),b instanceof Error)throw b;var s=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw s.context=b,s}var C=x[n];if(C===void 0)return!1;if(typeof C=="function")nT(C,this,l);else for(var k=C.length,B=g4(C,k),h=0;h<k;++h)nT(B[h],this,l);return!0};function d4(t,n,l,h){var m,x,b;if($m(l),x=t._events,x===void 0?(x=t._events=Object.create(null),t._eventsCount=0):(x.newListener!==void 0&&(t.emit("newListener",n,l.listener?l.listener:l),x=t._events),b=x[n]),b===void 0)b=x[n]=l,++t._eventsCount;else if(typeof b=="function"?b=x[n]=h?[l,b]:[b,l]:h?b.unshift(l):b.push(l),m=h4(t),m>0&&b.length>m&&!b.warned){b.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=n,s.count=b.length,TR(s)}return t}On.prototype.addListener=function(n,l){return d4(this,n,l,!1)};On.prototype.on=On.prototype.addListener;On.prototype.prependListener=function(n,l){return d4(this,n,l,!0)};function SR(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p4(t,n,l){var h={fired:!1,wrapFn:void 0,target:t,type:n,listener:l},m=SR.bind(h);return m.listener=l,h.wrapFn=m,m}On.prototype.once=function(n,l){return $m(l),this.on(n,p4(this,n,l)),this};On.prototype.prependOnceListener=function(n,l){return $m(l),this.prependListener(n,p4(this,n,l)),this};On.prototype.removeListener=function(n,l){var h,m,x,b,s;if($m(l),m=this._events,m===void 0)return this;if(h=m[n],h===void 0)return this;if(h===l||h.listener===l)--this._eventsCount===0?this._events=Object.create(null):(delete m[n],m.removeListener&&this.emit("removeListener",n,h.listener||l));else if(typeof h!="function"){for(x=-1,b=h.length-1;b>=0;b--)if(h[b]===l||h[b].listener===l){s=h[b].listener,x=b;break}if(x<0)return this;x===0?h.shift():CR(h,x),h.length===1&&(m[n]=h[0]),m.removeListener!==void 0&&this.emit("removeListener",n,s||l)}return this};On.prototype.off=On.prototype.removeListener;On.prototype.removeAllListeners=function(n){var l,h,m;if(h=this._events,h===void 0)return this;if(h.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):h[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete h[n]),this;if(arguments.length===0){var x=Object.keys(h),b;for(m=0;m<x.length;++m)b=x[m],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(l=h[n],typeof l=="function")this.removeListener(n,l);else if(l!==void 0)for(m=l.length-1;m>=0;m--)this.removeListener(n,l[m]);return this};function f4(t,n,l){var h=t._events;if(h===void 0)return[];var m=h[n];return m===void 0?[]:typeof m=="function"?l?[m.listener||m]:[m]:l?AR(m):g4(m,m.length)}On.prototype.listeners=function(n){return f4(this,n,!0)};On.prototype.rawListeners=function(n){return f4(this,n,!1)};On.listenerCount=function(t,n){return typeof t.listenerCount=="function"?t.listenerCount(n):m4.call(t,n)};On.prototype.listenerCount=m4;function m4(t){var n=this._events;if(n!==void 0){var l=n[t];if(typeof l=="function")return 1;if(l!==void 0)return l.length}return 0}On.prototype.eventNames=function(){return this._eventsCount>0?F0(this._events):[]};function g4(t,n){for(var l=new Array(n),h=0;h<n;++h)l[h]=t[h];return l}function CR(t,n){for(;n+1<t.length;n++)t[n]=t[n+1];t.pop()}function AR(t){for(var n=new Array(t.length),l=0;l<n.length;++l)n[l]=t[l].listener||t[l];return n}function IR(t,n){return new Promise(function(l,h){function m(b){t.removeListener(n,x),h(b)}function x(){typeof t.removeListener=="function"&&t.removeListener("error",m),l([].slice.call(arguments))}_4(t,n,x,{once:!0}),n!=="error"&&kR(t,m,{once:!0})})}function kR(t,n,l){typeof t.on=="function"&&_4(t,"error",n,l)}function _4(t,n,l,h){if(typeof t.on=="function")h.once?t.once(n,l):t.on(n,l);else if(typeof t.addEventListener=="function")t.addEventListener(n,function m(x){h.once&&t.removeEventListener(n,m),l(x)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var MR=uv.exports,DR={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function PR(t){var n=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return n?{key:n[1],value:n[2]}:null}function zR(t){var n=t.match(/<?([^>]*)>(.*)/);if(!n)return null;var l=n[1],h=n[2].split(";"),m=null,x=h.reduce(function(b,s){var C=PR(s);return C?C.key==="rel"?(m||(m=C.value),b):(b[C.key]=C.value,b):b},{});return m?{url:l,rel:m,params:x}:null}function BR(t){return t?t.split(/,\s*</).reduce(function(n,l){var h=zR(l);if(!h)return n;var m=h.rel.split(/\s+/);return m.forEach(function(x){n[x]||(n[x]={url:h.url,params:h.params})}),n},{}):{}}var LR=BR,RR=LR;function hv(t,n){this.request=t,this.headers=n.headers,this.rawBody=n.body,this.statusCode=n.statusCode;try{this.body=JSON.parse(n.body||"{}")}catch{this.body=n.body}this.links=RR(this.headers.link)}hv.prototype.hasNextPage=function(){return!!this.links.next};hv.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var FR=hv,Wm={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},iT=Wm;function OR(t){var n=t.type||iT.ERROR_HTTP,l;if(t.body)try{l=JSON.parse(t.body)}catch{l=t.body}else l=null;var h=t.message||null;h||(typeof l=="string"?h=l:l&&typeof l.message=="string"?h=l.message:n===iT.ERROR_REQUEST_ABORTED&&(h="Request aborted")),this.message=h,this.type=n,this.statusCode=t.statusCode||null,this.request=t.request,this.body=l}var NR=OR;function UR(t){var n=t.indexOf(":"),l=t.substring(0,n).trim().toLowerCase(),h=t.substring(n+1).trim();return{name:l,value:h}}function jR(t){var n={};return t&&t.trim().split(/[\r|\n]+/).forEach(function(l){var h=UR(l);n[h.name]=h.value}),n}var VR=jR,GR=FR,oT=NR,ly=Wm,qR=VR,mm={};function $R(t){var n=mm[t.id];n&&(n.abort(),delete mm[t.id])}function WR(t,n){return new GR(t,{body:n.response,headers:qR(n.getAllResponseHeaders()),statusCode:n.status})}function sT(t){var n=t.total,l=t.loaded,h=100*l/n;return{total:n,transferred:l,percent:h}}function y4(t,n){return new Promise(function(l,h){n.onprogress=function(b){t.emitter.emit(ly.EVENT_PROGRESS_DOWNLOAD,sT(b))};var m=t.file;m&&(n.upload.onprogress=function(b){t.emitter.emit(ly.EVENT_PROGRESS_UPLOAD,sT(b))}),n.onerror=function(b){h(b)},n.onabort=function(){var b=new oT({request:t,type:ly.ERROR_REQUEST_ABORTED});h(b)},n.onload=function(){if(delete mm[t.id],n.status<200||n.status>=400){var b=new oT({request:t,body:n.response,statusCode:n.status});h(b);return}l(n)};var x=t.body;typeof x=="string"?n.send(x):x?n.send(JSON.stringify(x)):m?n.send(m):n.send(),mm[t.id]=n}).then(function(l){return WR(t,l)})}function x4(t,n){var l=t.url(n),h=new window.XMLHttpRequest;return h.open(t.method,l),Object.keys(t.headers).forEach(function(m){h.setRequestHeader(m,t.headers[m])}),h}function HR(t){return Promise.resolve().then(function(){var n=x4(t,t.client.accessToken);return y4(t,n)})}var ZR={browserAbort:$R,sendRequestXhr:y4,browserSend:HR,createRequestXhr:x4},gm={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */gm.exports;(function(t,n){(function(l){var h=n,m=t&&t.exports==h&&t,x=typeof $t=="object"&&$t;(x.global===x||x.window===x)&&(l=x);var b=function(q){this.message=q};b.prototype=new Error,b.prototype.name="InvalidCharacterError";var s=function(q){throw new b(q)},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=/[\t\n\f\r ]/g,B=function(q){q=String(q).replace(k,"");var K=q.length;K%4==0&&(q=q.replace(/==?$/,""),K=q.length),(K%4==1||/[^+a-zA-Z0-9/]/.test(q))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var Y=0,W,O,V="",Q=-1;++Q<K;)O=C.indexOf(q.charAt(Q)),W=Y%4?W*64+O:O,Y++%4&&(V+=String.fromCharCode(255&W>>(-2*Y&6)));return V},U=function(q){q=String(q),/[^\0-\xFF]/.test(q)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var K=q.length%3,Y="",W=-1,O,V,Q,ue,fe=q.length-K;++W<fe;)O=q.charCodeAt(W)<<16,V=q.charCodeAt(++W)<<8,Q=q.charCodeAt(++W),ue=O+V+Q,Y+=C.charAt(ue>>18&63)+C.charAt(ue>>12&63)+C.charAt(ue>>6&63)+C.charAt(ue&63);return K==2?(O=q.charCodeAt(W)<<8,V=q.charCodeAt(++W),ue=O+V,Y+=C.charAt(ue>>10)+C.charAt(ue>>4&63)+C.charAt(ue<<2&63)+"="):K==1&&(ue=q.charCodeAt(W),Y+=C.charAt(ue>>2)+C.charAt(ue<<4&63)+"=="),Y},F={encode:U,decode:B,version:"0.1.0"};if(h&&!h.nodeType)if(m)m.exports=F;else for(var Z in F)F.hasOwnProperty(Z)&&(h[Z]=F[Z]);else l.base64=F})($t)})(gm,gm.exports);var XR=gm.exports,KR=XR,cy={};function YR(t){if(cy[t])return cy[t];var n=t.split("."),l=n[0],h=n[1];if(!h)throw new Error("Invalid token");var m=JR(h),x={usage:l,user:m.u};return Gl(m,"a")&&(x.authorization=m.a),Gl(m,"exp")&&(x.expires=m.exp*1e3),Gl(m,"iat")&&(x.created=m.iat*1e3),Gl(m,"scopes")&&(x.scopes=m.scopes),Gl(m,"client")&&(x.client=m.client),Gl(m,"ll")&&(x.lastLogin=m.ll),Gl(m,"iu")&&(x.impersonator=m.iu),cy[t]=x,x}function JR(t){try{return JSON.parse(KR.decode(t))}catch{throw new Error("Invalid token")}}function Gl(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var v4=YR,w4={exports:{}};(function(t){var n=Object.prototype.hasOwnProperty,l="~";function h(){}Object.create&&(h.prototype=Object.create(null),new h().__proto__||(l=!1));function m(C,k,B){this.fn=C,this.context=k,this.once=B||!1}function x(C,k,B,U,F){if(typeof B!="function")throw new TypeError("The listener must be a function");var Z=new m(B,U||C,F),q=l?l+k:k;return C._events[q]?C._events[q].fn?C._events[q]=[C._events[q],Z]:C._events[q].push(Z):(C._events[q]=Z,C._eventsCount++),C}function b(C,k){--C._eventsCount===0?C._events=new h:delete C._events[k]}function s(){this._events=new h,this._eventsCount=0}s.prototype.eventNames=function(){var k=[],B,U;if(this._eventsCount===0)return k;for(U in B=this._events)n.call(B,U)&&k.push(l?U.slice(1):U);return Object.getOwnPropertySymbols?k.concat(Object.getOwnPropertySymbols(B)):k},s.prototype.listeners=function(k){var B=l?l+k:k,U=this._events[B];if(!U)return[];if(U.fn)return[U.fn];for(var F=0,Z=U.length,q=new Array(Z);F<Z;F++)q[F]=U[F].fn;return q},s.prototype.listenerCount=function(k){var B=l?l+k:k,U=this._events[B];return U?U.fn?1:U.length:0},s.prototype.emit=function(k,B,U,F,Z,q){var K=l?l+k:k;if(!this._events[K])return!1;var Y=this._events[K],W=arguments.length,O,V;if(Y.fn){switch(Y.once&&this.removeListener(k,Y.fn,void 0,!0),W){case 1:return Y.fn.call(Y.context),!0;case 2:return Y.fn.call(Y.context,B),!0;case 3:return Y.fn.call(Y.context,B,U),!0;case 4:return Y.fn.call(Y.context,B,U,F),!0;case 5:return Y.fn.call(Y.context,B,U,F,Z),!0;case 6:return Y.fn.call(Y.context,B,U,F,Z,q),!0}for(V=1,O=new Array(W-1);V<W;V++)O[V-1]=arguments[V];Y.fn.apply(Y.context,O)}else{var Q=Y.length,ue;for(V=0;V<Q;V++)switch(Y[V].once&&this.removeListener(k,Y[V].fn,void 0,!0),W){case 1:Y[V].fn.call(Y[V].context);break;case 2:Y[V].fn.call(Y[V].context,B);break;case 3:Y[V].fn.call(Y[V].context,B,U);break;case 4:Y[V].fn.call(Y[V].context,B,U,F);break;default:if(!O)for(ue=1,O=new Array(W-1);ue<W;ue++)O[ue-1]=arguments[ue];Y[V].fn.apply(Y[V].context,O)}}return!0},s.prototype.on=function(k,B,U){return x(this,k,B,U,!1)},s.prototype.once=function(k,B,U){return x(this,k,B,U,!0)},s.prototype.removeListener=function(k,B,U,F){var Z=l?l+k:k;if(!this._events[Z])return this;if(!B)return b(this,Z),this;var q=this._events[Z];if(q.fn)q.fn===B&&(!F||q.once)&&(!U||q.context===U)&&b(this,Z);else{for(var K=0,Y=[],W=q.length;K<W;K++)(q[K].fn!==B||F&&!q[K].once||U&&q[K].context!==U)&&Y.push(q[K]);Y.length?this._events[Z]=Y.length===1?Y[0]:Y:b(this,Z)}return this},s.prototype.removeAllListeners=function(k){var B;return k?(B=l?l+k:k,this._events[B]&&b(this,B)):(this._events=new h,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=l,s.EventEmitter=s,t.exports=s})(w4);var QR=w4.exports;function e8(t){return t.map(encodeURIComponent).join(",")}function b4(t){return Array.isArray(t)?e8(t):encodeURIComponent(String(t))}function E4(t,n,l){if(l===!1||l===null)return t;var h=/\?/.test(t)?"&":"?",m=encodeURIComponent(n);return l!==void 0&&l!==""&&l!==!0&&(m+="="+b4(l)),""+t+h+m}function t8(t,n){if(!n)return t;var l=t;return Object.keys(n).forEach(function(h){var m=n[h];m!==void 0&&(Array.isArray(m)&&(m=m.filter(function(x){return x!=null}).join(",")),l=E4(l,h,m))}),l}function n8(t,n){if(!n||t.slice(0,4)==="http")return t;var l=t[0]==="/"?"":"/";return""+n.replace(/\/$/,"")+l+t}function r8(t,n){return n?t.replace(/\/:([a-zA-Z0-9]+)/g,function(l,h){var m=n[h];if(m===void 0)throw new Error("Unspecified route parameter "+h);var x=b4(m);return"/"+x}):t}var i8={appendQueryObject:t8,appendQueryParam:E4,prependOrigin:n8,interpolateRouteParams:r8},o8=v4,dv=Wu,s8=QR,y0=i8,aT=Wm,a8=1;function Ka(t,n){if(!t)throw new Error("MapiRequest requires a client");if(!n||!n.path||!n.method)throw new Error("MapiRequest requires an options object with path and method properties");var l={};n.body&&(l["content-type"]="application/json");var h=dv(l,n.headers),m=Object.keys(h).reduce(function(x,b){return x[b.toLowerCase()]=h[b],x},{});this.id=a8++,this._options=n,this.emitter=new s8,this.client=t,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=n.path,this.method=n.method,this.origin=n.origin||t.origin,this.query=n.query||{},this.params=n.params||{},this.body=n.body||null,this.file=n.file||null,this.encoding=n.encoding||"utf8",this.sendFileAs=n.sendFileAs||null,this.headers=m}Ka.prototype.url=function(n){var l=y0.prependOrigin(this.path,this.origin);l=y0.appendQueryObject(l,this.query);var h=this.params,m=n??this.client.accessToken;if(m){l=y0.appendQueryParam(l,"access_token",m);var x=o8(m).user;h=dv({ownerId:x},h)}return l=y0.interpolateRouteParams(l,h),l};Ka.prototype.send=function(){var n=this;if(n.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return n.sent=!0,n.client.sendRequest(n).then(function(l){return n.response=l,n.emitter.emit(aT.EVENT_RESPONSE,l),l},function(l){throw n.error=l,n.emitter.emit(aT.EVENT_ERROR,l),l})};Ka.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};Ka.prototype.eachPage=function(n){var l=this;function h(b){function s(){delete l._nextPageRequest;var C=b.nextPage();C&&(l._nextPageRequest=C,x(C))}n(null,b,s)}function m(b){n(b,null,function(){})}function x(b){b.send().then(h,m)}x(this)};Ka.prototype.clone=function(){return this._extend()};Ka.prototype._extend=function(n){var l=dv(this._options,n);return new Ka(this.client,l)};var l8=Ka,c8=v4,u8=l8,h8=Wm;function T4(t){if(!t||!t.accessToken)throw new Error("Cannot create a client without an access token");c8(t.accessToken),this.accessToken=t.accessToken,this.origin=t.origin||h8.API_ORIGIN}T4.prototype.createRequest=function(n){return new u8(this,n)};var S4=T4,C4=ZR,A4=S4;function Ou(t){A4.call(this,t)}Ou.prototype=Object.create(A4.prototype);Ou.prototype.constructor=Ou;Ou.prototype.sendRequest=C4.browserSend;Ou.prototype.abortRequest=C4.browserAbort;function d8(t){return new Ou(t)}var I4=d8,p8=I4,f8=p8,m8=Object.prototype.toString,g8=function(t){var n;return m8.call(t)==="[object Object]"&&(n=Object.getPrototypeOf(t),n===null||n===Object.getPrototypeOf({}))},_8=g8,y8=Wu,k4="value",uy=`
  `,qn={};qn.assert=function(t,n){return n=n||{},function(l){var h=Ya(t,l);if(h){var m=pv(h,n);throw n.apiName&&(m=n.apiName+": "+m),new Error(m)}}};qn.shape=function(n){var l=b8(n);return function(m){var x=Ya(qn.plainObject,m);if(x)return x;for(var b,s,C=[],k=0;k<l.length;k++)b=l[k].key,s=l[k].value,x=Ya(s,m[b]),x&&C.push([b].concat(x));return C.length<2?C[0]:function(B){C=C.map(function(Z){var q=Z[0],K=pv(Z,B).split(`
`).join(uy);return"- "+q+": "+K});var U=B.path.join("."),F=U===k4?"":" of "+U;return"The following properties"+F+" have invalid values:"+uy+C.join(uy)}}};qn.strictShape=function(n){var l=qn.shape(n);return function(m){var x=l(m);if(x)return x;var b=Object.keys(m).reduce(function(s,C){return n[C]===void 0&&s.push(C),s},[]);if(b.length!==0)return function(){return"The following keys are invalid: "+b.join(", ")}}};qn.arrayOf=function(n){return M4(n)};qn.tuple=function(){var n=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return M4(n)};function M4(t){var n=Array.isArray(t),l=function(h){return n?t[h]:t};return function(m){var x=Ya(qn.plainArray,m);if(x)return x;if(n&&m.length!==t.length)return"an array with "+t.length+" items";for(var b=0;b<m.length;b++)if(x=Ya(l(b),m[b]),x)return[b].concat(x)}}qn.required=function(n){function l(h){return h==null?function(m){return D4(m,P4(m.path)?"cannot be undefined/null.":"is required.")}:n.apply(this,arguments)}return l.__required=!0,l};qn.oneOfType=function(){var n=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(h){var m=n.map(function(x){return Ya(x,h)}).filter(Boolean);if(m.length===n.length)return m.every(function(x){return x.length===1&&typeof x[0]=="string"})?x8(m.map(function(x){return x[0]})):m.reduce(function(x,b){return b.length>x.length?b:x})}};qn.equal=function(n){return function(h){if(h!==n)return JSON.stringify(n)}};qn.oneOf=function(){var n=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),l=n.map(function(h){return qn.equal(h)});return qn.oneOfType.apply(this,l)};qn.range=function(n){var l=n[0],h=n[1];return function(x){var b=Ya(qn.number,x);if(b||x<l||x>h)return"number between "+l+" & "+h+" (inclusive)"}};qn.any=function(){};qn.boolean=function(n){if(typeof n!="boolean")return"boolean"};qn.number=function(n){if(typeof n!="number")return"number"};qn.plainArray=function(n){if(!Array.isArray(n))return"array"};qn.plainObject=function(n){if(!_8(n))return"object"};qn.string=function(n){if(typeof n!="string")return"string"};qn.func=function(n){if(typeof n!="function")return"function"};function Ya(t,n){if(!(n==null&&!t.hasOwnProperty("__required"))){var l=t(n);if(l)return Array.isArray(l)?l:[l]}}function pv(t,n){var l=t.length,h=t[l-1],m=t.slice(0,l-1);return m.length===0&&(m=[k4]),n=y8(n,{path:m}),typeof h=="function"?h(n):D4(n,v8(h))}function x8(t){return t.length<2?t[0]:t.length===2?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t.slice(-1)}function v8(t){return"must be "+w8(t)+"."}function w8(t){return/^an? /.test(t)?t:/^[aeiou]/i.test(t)?"an "+t:/^[a-z]/i.test(t)?"a "+t:t}function D4(t,n){var l=P4(t.path),h=t.path.join(".")+" "+n,m=l?"Item at position ":"";return m+h}function P4(t){return typeof t[t.length-1]=="number"||typeof t[0]=="number"}function b8(t){return Object.keys(t||{}).map(function(n){return{key:n,value:t[n]}})}qn.validate=Ya;qn.processMessage=pv;var E8=qn,T8=Wu,ku=E8;function S8(t){if(typeof window<"u")return t instanceof $t.Blob||t instanceof $t.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof t=="string"||t.pipe!==void 0))return"Filename or Readable stream"}function C8(t,n){return ku.assert(ku.strictShape(t),n)}function A8(t){var n="date";if(typeof t=="boolean")return n;try{var l=new Date(t);if(l.getTime&&isNaN(l.getTime()))return n}catch{return n}}function I8(t){return ku.tuple(ku.number,ku.number)(t)}var k8=T8(ku,{file:S8,date:A8,coordinates:I8,assertShape:C8});function M8(t,n){var l=function(h,m){return n.indexOf(h)!==-1&&m!==void 0};return typeof n=="function"&&(l=n),Object.keys(t).filter(function(h){return l(h,t[h])}).reduce(function(h,m){return h[m]=t[m],h},{})}var D8=M8;function P8(t,n){return Object.keys(t).reduce(function(l,h){return l[h]=n(h,t[h]),l},{})}var z8=P8,B8=z8;function L8(t){return B8(t,function(n,l){return typeof l=="boolean"?JSON.stringify(l):l})}var R8=L8,F8=S4,O8=I4;function N8(t){return function(n){var l;F8.prototype.isPrototypeOf(n)?l=n:l=O8(n);var h=Object.create(t);return h.client=l,h}}var U8=N8,z4=Wu,hn=k8,_m=D8,B4=R8,j8=U8,fv={},L4=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];fv.forwardGeocode=function(t){hn.assertShape({query:hn.required(hn.string),mode:hn.oneOf("mapbox.places","mapbox.places-permanent"),countries:hn.arrayOf(hn.string),proximity:hn.oneOf(hn.coordinates,"ip"),types:hn.arrayOf(hn.oneOf(L4)),autocomplete:hn.boolean,bbox:hn.arrayOf(hn.number),limit:hn.number,language:hn.arrayOf(hn.string),routing:hn.boolean,fuzzyMatch:hn.boolean,worldview:hn.string,session_token:hn.string})(t),t.mode=t.mode||"mapbox.places";var n=B4(z4({country:t.countries},_m(t,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:_m(t,["mode","query"]),query:n})};fv.reverseGeocode=function(t){hn.assertShape({query:hn.required(hn.coordinates),mode:hn.oneOf("mapbox.places","mapbox.places-permanent"),countries:hn.arrayOf(hn.string),types:hn.arrayOf(hn.oneOf(L4)),bbox:hn.arrayOf(hn.number),limit:hn.number,language:hn.arrayOf(hn.string),reverseMode:hn.oneOf("distance","score"),routing:hn.boolean,worldview:hn.string,session_token:hn.string})(t),t.mode=t.mode||"mapbox.places";var n=B4(z4({country:t.countries},_m(t,["country","types","bbox","limit","language","reverseMode","routing","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:_m(t,["mode","query"]),query:n})};var V8=j8(fv);let G8="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",R4=t=>crypto.getRandomValues(new Uint8Array(t)),F4=(t,n,l)=>{let h=(2<<Math.log(t.length-1)/Math.LN2)-1,m=-~(1.6*h*n/t.length);return(x=n)=>{let b="";for(;;){let s=l(m),C=m|0;for(;C--;)if(b+=t[s[C]&h]||"",b.length===x)return b}}},q8=(t,n=21)=>F4(t,n,R4),$8=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((n,l)=>(l&=63,l<36?n+=l.toString(36):l<62?n+=(l-26).toString(36).toUpperCase():l>62?n+="-":n+="_",n),"");const W8=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:q8,customRandom:F4,nanoid:$8,random:R4,urlAlphabet:G8},Symbol.toStringTag,{value:"Module"})),H8=KT(W8);var Z8=H8.nanoid;function O4(t){this.origin=t.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=t.accessToken,this.version="0.3.0",this.pluginSessionID=this.generateSessionID(),this.sessionIncrementer=0,this.userAgent=this.getUserAgent(),this.options=t,this.send=this.send.bind(this),this.countries=t.countries?t.countries.split(","):null,this.types=t.types?t.types.split(","):null,this.bbox=t.bbox?t.bbox:null,this.language=t.language?t.language.split(","):null,this.limit=t.limit?+t.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(t),this.eventQueue=new Array,this.flushInterval=t.flushInterval||1e3,this.maxQueueSize=t.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}O4.prototype={select:function(t,n){var l=this.getEventPayload("search.select",n,{selectedFeature:t});if(l&&!(l.resultIndex===this.lastSentIndex&&l.queryString===this.lastSentInput||l.resultIndex==-1))return this.lastSentIndex=l.resultIndex,this.lastSentInput=l.queryString,this.push(l)},start:function(t){var n=this.getEventPayload("search.start",t);if(n)return this.push(n)},keyevent:function(t,n){if(t.key&&!(t.metaKey||[9,27,37,39,13,38,40].indexOf(t.keyCode)!==-1)){var l=this.getEventPayload("search.keystroke",n,{key:t.key});if(l)return this.push(l)}},send:function(t,n){if(!this.enableEventLogging)return n?n():void 0;var l=this.getRequestOptions(t);this.request(l,(function(h){if(h)return this.handleError(h,n);if(n)return n()}).bind(this))},getRequestOptions:function(t){Array.isArray(t)||(t=[t]);var n={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return n},getEventPayload:function(t,n,l={}){if(t==="search.select"&&!l.selectedFeature||t==="search.keystroke"&&!l.key)return null;var h;if(!n.options.proximity)h=null;else if(typeof n.options.proximity=="object")h=[n.options.proximity.longitude,n.options.proximity.latitude];else if(n.options.proximity==="ip"){var m=n._headers?n._headers["ip-proximity"]:null;m&&typeof m=="string"?h=m.split(",").map(parseFloat):h=[999,999]}else h=n.options.proximity;var x=n._map?n._map.getZoom():void 0,b={event:t,version:this.getEventSchemaVersion(t),created:+new Date,sessionIdentifier:this.getSessionId(),country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:n.options.autocomplete,fuzzyMatch:n.options.fuzzyMatch,proximity:h,limit:n.options.limit,routing:n.options.routing,worldview:n.options.worldview,mapZoom:x,keyboardLocale:this.locale};if(t==="search.select"?b.queryString=n.inputString:t!="search.select"&&n._inputEl?b.queryString=n._inputEl.value:b.queryString=n.inputString,["search.keystroke","search.select"].includes(t)&&(b.path="geocoding/v5/mapbox.places"),t==="search.keystroke"&&l.key)b.lastAction=l.key;else if(t==="search.select"&&l.selectedFeature){var s=l.selectedFeature,C=this.getSelectedIndex(s,n);if(b.resultIndex=C,b.resultPlaceName=s.place_name,b.resultId=s.id,s.properties&&(b.resultMapboxId=s.properties.mapbox_id),n._typeahead){var k=n._typeahead.data;k&&k.length>0&&(b.suggestionIds=this.getSuggestionIds(k),b.suggestionNames=this.getSuggestionNames(k),b.suggestionTypes=this.getSuggestionTypes(k),b.suggestionSources=this.getSuggestionSources(k))}}return this.validatePayload(b)?b:null},request:function(t,n){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(this.readyState==4)return this.status==204?n(null):n(this.statusText)},l.open(t.method,t.host+"/"+t.path,!0);for(var h in t.headers){var m=t.headers[h];l.setRequestHeader(h,m)}l.send(t.body)},handleError:function(t,n){if(n)return n(t)},generateSessionID:function(){return Z8()},getSessionId:function(){return this.pluginSessionID+"."+this.sessionIncrementer},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(t,n){if(n._typeahead){var l=n._typeahead.data,h=t.id,m=l.map(function(b){return b.id}),x=m.indexOf(h);return x}},getSuggestionIds:function(t){return t.map(function(n){return n.properties?n.properties.mapbox_id||"":n.id||""})},getSuggestionNames:function(t){return t.map(function(n){return n.place_name||""})},getSuggestionTypes:function(t){return t.map(function(n){return n.place_type&&Array.isArray(n.place_type)&&n.place_type[0]||""})},getSuggestionSources:function(t){return t.map(function(n){return n._source||""})},getEventSchemaVersion:function(t){return["search.keystroke","search.select"].includes(t)?"2.2":"2.0"},validatePayload:function(t){if(!t||!t.event)return!1;var n=["event","created","sessionIdentifier","queryString"],l=["event","created","sessionIdentifier","queryString","lastAction"],h=["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"],m=t.event;return m==="search.start"?this.objectHasRequiredProps(t,n):m==="search.keystroke"?this.objectHasRequiredProps(t,l):m==="search.select"?this.objectHasRequiredProps(t,h):!0},objectHasRequiredProps:function(t,n){return n.every(function(l){return l==="queryString"?typeof t[l]=="string"&&t[l].length>0:t[l]!==void 0})},shouldEnableLogging:function(t){return!(t.enableEventLogging===!1||t.origin&&t.origin!=="https://api.mapbox.com")},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(t,n){this.eventQueue.push(t),(this.eventQueue.length>=this.maxQueueSize||n)&&this.flush()},remove:function(){this.flush()}};var X8=O4,K8={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},Y8={placeholder:K8},N4={exports:{}};(function(t){(function(n,l,h){t.exports?t.exports=h():n[l]=h()})($t,"subtag",function(){var n="",l=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function h(C){return C.match(l)||[]}function m(C){return h(C).filter(function(k,B){return k&&B})}function x(C){return C=h(C),{language:C[1]||n,extlang:C[2]||n,script:C[3]||n,region:C[4]||n}}function b(C,k,B){Object.defineProperty(C,k,{value:B,enumerable:!0})}function s(C,k,B){function U(F){return h(F)[C]||n}b(U,"pattern",k),b(x,B,U)}return s(1,/^[a-zA-Z]{2,3}$/,"language"),s(2,/^[a-zA-Z]{3}$/,"extlang"),s(3,/^[a-zA-Z]{4}$/,"script"),s(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),b(x,"split",m),x})})(N4);var J8=N4.exports;function U4(){}U4.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const t={enableHighAccuracy:!0};return new Promise(function(n,l){window.navigator.geolocation.getCurrentPosition(n,l,t)})}};var Q8=U4;function e6(t,n){const l=j4(t),h=["address","street","place","country"];var m;if(typeof n=="function")return n(l);const x=h.indexOf(n);return x===-1?m=h:m=h.slice(x),m.reduce(function(b,s){return l[s]?(b!==""&&(b=b+", "),b+l[s]):b},"")}function j4(t){const n=t.address||"",l=t.text||"",h=t.place_name||"",x={address:h.split(",")[0],houseNumber:n,street:l,placeName:h};return t.context.forEach(function(b){const s=b.id.split(".")[0];x[s]=b.text}),x}const t6=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/;var n6={transformFeatureToGeolocationText:e6,getAddressInfo:j4,REVERSE_GEOCODE_COORD_RGX:t6},r6=oR,i6=ER,Wl=Wu,o6=MR.EventEmitter,lT=DR,hy=f8,dy=V8,s6=X8,a6=Y8,l6=J8,c6=Q8,cT=n6;const za={FORWARD:0,LOCAL:1,REVERSE:2};function u6(){var t=document.createElement("div");return t.className="mapboxgl-ctrl-geocoder--powered-by",t.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',t}function V4(t){this._eventEmitter=new o6,this.options=Wl({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new c6}V4.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(t){return t.place_name},render:function(t){var n=t.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+n[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+n.splice(1,n.length).join(",")+"</div></div>"}},_headers:{},addTo:function(t){function n(l,h){if(!document.body.contains(h))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const m=l.onAdd();h.appendChild(m)}if(t._controlContainer)t.addControl(this);else if(t instanceof HTMLElement)n(this,t);else if(typeof t=="string"){const l=document.querySelectorAll(t);if(l.length===0)throw new Error("Element ",t,"not found.");if(l.length>1)throw new Error("Geocoder can only be added to a single html element");n(this,l[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(t){if(t&&typeof t!="string"&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=dy(hy({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new s6(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var n=this.container=document.createElement("div");n.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var l=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",i6(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(k){this.eventManager.keyevent(k,this)}).bind(this));var h=document.createElement("div");h.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var m=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(m),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),h.appendChild(this._clearEl),h.appendChild(this._loadingEl),n.appendChild(l),n.appendChild(this._inputEl),n.appendChild(h),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var x=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(x),h.appendChild(this._geolocateEl),this._showGeolocateButton()}var b=this._typeahead=new r6(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),b.getItemValue=this.options.getItemValue;var s=b.list.draw,C=this._footerNode=u6();return b.list.draw=function(){s.call(this),C.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),C.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(C)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),n},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(t){this._hideLoadingIcon();const n={geometry:{type:"Point",coordinates:[t.coords.longitude,t.coords.latitude]}};this._handleMarker(n),this._fly(n),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(n),this._showClearButton(),this.fresh=!1;const l={limit:1,language:[this.options.language],query:n.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const h=n.geometry.coordinates[0]+","+n.geometry.coordinates[1];this._setInputValue(h),this._eventEmitter.emit("result",{result:n})}else this.geocoderService.reverseGeocode(l).send().then((function(h){const m=h.body.features[0];if(m){const x=cT.transformFeatureToGeolocationText(m,this.options.addressAccuracy);this._setInputValue(x),m.user_coordinates=n.geometry.coordinates,this._eventEmitter.emit("result",{result:m})}else this._eventEmitter.emit("result",{result:{user_coordinates:n.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(t){t.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(t,n){var l=document.createElementNS("http://www.w3.org/2000/svg","svg");return l.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+t),l.setAttribute("viewBox","0 0 18 18"),l.setAttribute("xml:space","preserve"),l.setAttribute("width",18),l.setAttribute("height",18),l.innerHTML=n,l},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(t){this._inputEl.value=t,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(t){var n=(t.clipboardData||window.clipboardData).getData("text");n.length>=this.options.minLength&&this._geocode(n)},_onKeyDown:function(t){var n=27,l=9;if(t.keyCode===n&&this.options.clearAndBlurOnEsc)return this._clear(t),this._inputEl.blur();var h=t.target&&t.target.shadowRoot?t.target.shadowRoot.activeElement:t.target,m=h?h.value:"";if(!m)return this.fresh=!0,t.keyCode!==l&&this.clear(t),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(t.metaKey||[l,n,37,39,13,38,40].indexOf(t.keyCode)!==-1)&&h.value.length>=this.options.minLength&&this._geocode(h.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()},_onChange:function(){var t=this._typeahead.selected;t&&JSON.stringify(t)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(t),this.options.marker&&this._mapboxgl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._eventEmitter.emit("result",{result:t}),this.eventManager.select(t,this))},_fly:function(t){var n;if(t.properties&&lT[t.properties.short_code])n=Wl({},this.options.flyTo),this._map&&this._map.fitBounds(lT[t.properties.short_code].bbox,n);else if(t.bbox){var l=t.bbox;n=Wl({},this.options.flyTo),this._map&&this._map.fitBounds([[l[0],l[1]],[l[2],l[3]]],n)}else{var h={zoom:this.options.zoom};n=Wl({},h,this.options.flyTo),t.center?n.center=t.center:t.geometry&&t.geometry.type&&t.geometry.type==="Point"&&t.geometry.coordinates&&(n.center=t.geometry.coordinates),this._map&&this._map.flyTo(n)}},_requestType:function(t,n){var l;return t.localGeocoderOnly?l=za.LOCAL:t.reverseGeocode&&cT.REVERSE_GEOCODE_COORD_RGX.test(n)?l=za.REVERSE:l=za.FORWARD,l},_setupConfig:function(t,n){const l=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],h=/[\s,]+/;var m=this,x=l.reduce(function(s,C){if(m.options[C]===void 0||m.options[C]===null)return s;["countries","types","language"].indexOf(C)>-1?s[C]=m.options[C].split(h):s[C]=m.options[C];const k=typeof m.options[C].longitude=="number"&&typeof m.options[C].latitude=="number";if(C==="proximity"&&k){const B=m.options[C].longitude,U=m.options[C].latitude;s[C]=[B,U]}return s},{});switch(t){case za.REVERSE:{var b=n.split(h).map(function(s){return parseFloat(s,10)});m.options.flipCoordinates||b.reverse(),x.types&&x.types[0],x=Wl(x,{query:b,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(s){s in x&&delete x[s]})}break;case za.FORWARD:{const s=n.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(s)&&(n=n.replace(/,/g," ")),x=Wl(x,{query:n})}break}return x.session_token=this.eventManager.getSessionId(),x},_geocode:function(t){this.inputString=t,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:t});const n=this._requestType(this.options,t),l=this._setupConfig(n,t);var h;switch(n){case za.LOCAL:h=Promise.resolve();break;case za.FORWARD:h=this.geocoderService.forwardGeocode(l).send();break;case za.REVERSE:h=this.geocoderService.reverseGeocode(l).send();break}var m=this.options.localGeocoder?this.options.localGeocoder(t)||[]:[],x=[],b=null;return h.catch((function(s){b=s}).bind(this)).then((function(s){this._hideLoadingIcon();var C={};return s?s.statusCode=="200"&&(C=s.body,C.request=s.request,C.headers=s.headers,this._headers=s.headers):C={type:"FeatureCollection",features:[]},C.config=l,this.fresh&&(this.eventManager.start(this),this.fresh=!1),C.features&&C.features.length&&C.features.map(function(k){k._source="mapbox"}),C.features=C.features?m.concat(C.features):m,this.options.externalGeocoder?(x=this.options.externalGeocoder(t,C.features)||Promise.resolve([]),x.then(function(k){return C.features=C.features?k.concat(C.features):k,C},function(){return C})):C}).bind(this)).then((function(s){if(b)throw b;this.options.filter&&s.features.length&&(s.features=s.features.filter(this.options.filter)),s.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",s),this._typeahead.update(s.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",s))}).bind(this)).catch((function(s){this._hideLoadingIcon(),this._hideAttribution(),m.length&&this.options.localGeocoder||x.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(m)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:m}),this._eventEmitter.emit("error",{error:s})}).bind(this)),h},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this.eventManager.sessionIncrementer++,this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(t){this._clear(t),this._inputEl.focus()},_clearOnBlur:function(t){var n=this;t.relatedTarget&&n._clear(t)},_onQueryResult:function(t){var n=t.body;if(n.features.length){var l=n.features[0];this._typeahead.selected=l,this._inputEl.value=l.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(t){return this._geocode(t).then(this._onQueryResult),this},_renderError:function(){var t="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(t)},_renderLocationError:function(){var t="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(t)},_renderNoResults:function(){var t="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(t)},_renderUserDeniedGeolocationError:function(){var t="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(t)},_renderMessage:function(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var t=this.options.language.split(",")[0],n=l6.language(t),l=a6.placeholder[n];if(l)return l}return"Search"},setInput:function(t,n){return n===void 0&&(n=!1),this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&(n?this._geocode(t):this._onChange()),this},setProximity:function(t,n=!0){return this.options.proximity=t,n&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(t){return t&&typeof t=="function"&&(this._typeahead.render=t),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(t){var n=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=t||this.options.language||n,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(t){return this.options.zoom=t,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(t){return this.options.flyTo=t,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(t){return this.options.placeholder=t||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(t){return this.options.bbox=t,this},getCountries:function(){return this.options.countries},setCountries:function(t){return this.options.countries=t,this},getTypes:function(){return this.options.types},setTypes:function(t){return this.options.types=t,this},getMinLength:function(){return this.options.minLength},setMinLength:function(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.options.minLength=t),this},getLimit:function(){return this.options.limit},setLimit:function(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this},getFilter:function(){return this.options.filter},setFilter:function(t){return this.options.filter=t,this},setOrigin:function(t){return this.options.origin=t,this.geocoderService=dy(hy({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(t){return this.options.accessToken=t,this.geocoderService=dy(hy({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(t){return this.options.autocomplete=t,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(t){return this.options.fuzzyMatch=t,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(t){return this.options.routing=t,this},getRouting:function(){return this.options.routing},setWorldview:function(t){return this.options.worldview=t,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(t){if(this._map){this._removeMarker();var n={color:"#4668F2"},l=Wl({},n,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(l),t.center?this.mapMarker.setLngLat(t.center).addTo(this._map):t.geometry&&t.geometry.type&&t.geometry.type==="Point"&&t.geometry.coordinates&&this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(t,n){return this._eventEmitter.on(t,n),this},off:function(t,n){return this._eventEmitter.removeListener(t,n),this.eventManager.remove(),this}};var h6=V4;const d6=e1(h6);/*
 * Frontend UI component library for the CORI Data API 
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */function p6(t){const[n,l]=xt.useState(null),h=Object.assign({},t),m=$u(()=>{const x=new d6(Object.assign(Object.assign({},h),{marker:n||!1,accessToken:h.mapboxAccessToken}));return h.onLoading&&x.on("loading",h.onLoading),h.onResults&&x.on("results",h.onResults),h.onResult&&x.on("result",b=>{var s;h.onResult!==void 0&&h.onResult(b);const{result:C}=b,k=C&&(C.center||((s=C.geometry)===null||s===void 0?void 0:s.type)==="Point"&&C.geometry.coordinates);if(k&&h.marker){const B=typeof h.marker=="object"?h.marker:{};l(xt.createElement(a4,Object.assign({},B,{longitude:k[0],latitude:k[1]})))}else l(null)}),h.onError&&x.on("error",h.onError),x},{position:h.position});return m.hasOwnProperty("_map")&&m._map&&(m.getProximity()!==h.proximity&&h.proximity!==void 0&&m.setProximity(h.proximity),m.getRenderFunction()!==h.render&&h.render!==void 0&&m.setRenderFunction(h.render),m.getLanguage()!==h.language&&h.language!==void 0&&m.setLanguage(h.language),m.getZoom()!==h.zoom&&h.zoom!==void 0&&m.setZoom(h.zoom),m.getFlyTo()!==h.flyTo&&h.flyTo!==void 0&&m.setFlyTo(h.flyTo),m.getPlaceholder()!==h.placeholder&&h.placeholder!==void 0&&m.setPlaceholder(h.placeholder),m.getCountries()!==h.countries&&h.countries!==void 0&&m.setCountries(h.countries),m.getTypes()!==h.types&&h.types!==void 0&&m.setTypes(h.types),m.getMinLength()!==h.minLength&&h.minLength!==void 0&&m.setMinLength(h.minLength),m.getLimit()!==h.limit&&h.limit!==void 0&&m.setLimit(h.limit),m.getFilter()!==h.filter&&h.filter!==void 0&&m.setFilter(h.filter),m.getOrigin()!==h.origin&&h.origin!==void 0&&m.setOrigin(h.origin),m.getAutocomplete()!==h.autocomplete&&h.autocomplete!==void 0&&m.setAutocomplete(h.autocomplete),m.getFuzzyMatch()!==h.fuzzyMatch&&h.fuzzyMatch!==void 0&&m.setFuzzyMatch(h.fuzzyMatch),m.getRouting()!==h.routing&&h.routing!==void 0&&m.setRouting(h.routing),m.getWorldview()!==h.worldview&&h.worldview!==void 0&&m.setWorldview(h.worldview)),n}/*
 * Frontend UI component library for the CORI Data API 
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */var f6=8,m6="LIVE - CORI light basemap - county labels",g6={"mapbox:type":"default","mapbox:origin":"light-v10","mapbox:autocomposite":!0,"mapbox:groups":{"1444855769305.6016":{name:"Tunnels",collapsed:!0},"1444855786460.0557":{name:"Roads",collapsed:!0},"1444855799204.86":{name:"Bridges",collapsed:!0},"1444934295202.7542":{name:"Admin boundaries",collapsed:!1}},"mapbox:sdk-support":{js:"0.54.0",android:"7.4.0",ios:"4.10.0"},"mapbox:uiParadigm":"layers","mapbox:thumb":"data:image/webp;base64,UklGRmAJAABXRUJQVlA4TFQJAAAvO8AOAPX4drZtmWTXts7/wMzUqCCLGZOCMjCzbfx/1jFYYr9m+zeF5Gqx8bj3bozqqoouhWLj6dCYQqn+K1W6Vb1HB+Nn+HqXMatDQowkSVJTM/xwkv+mwu1OF8S2kRxJ7PyjfbMzs6a7+j8Be9jFwDSO7Za6ajtXwy/CHsEeYqSRsWzFQAbkSKlndkzfLGcN0zHLlJYZyNmbaOFmTdM0apq3d+t5Y906dr68rJ16zskdY1kaCWdraPJQE8CKlJazrjk+nrVM2/y0Q8ZpQtFux7BmD3bG8fxnncEJvUfnnPObbeMBsKIKWwJLA5PS8njL3DLP4CPmpnkG4+PxuFaBT22n9wiwUuTNx93WpXE+s4bmwJJyWCFwVAX3SJuMZ8fb5ic/uYKb5qc/HY+XqSvlgEmPIYI91BF5/X6fOW3Hpn0x7BGCGMgOIUVMAPdLSmn8xk/+ddM0zT/NUlqmDDhHT0NSj4pzfDEiNh53M7rOC/ElKUxkESgctcF75jilNBuP35gtU2kUjLo1fQicFbF5v7lCb488VM7WALsaKYd2zVFMDJBTSmn50/F4uY8oH9g2dlja+Pv3HebWDpZz2CAZV8BymTpIaTYb/3SZ9qXU6tvEuVU4hpI2Xye6NVcGNl5gQmAtIFJK47Qcj4/vYUcXT2V/e+hiR0dKjfeJAXNqGGNjZyGHYGhSSrPZcjkbH+83Acwe6dm7BBtfXc6umi7y9rHj4OwwIMkKSw5gmVJqm/FsNhvPlmlc+PcAb+MGLpNvvzvdHEb//8OovHFcQ+Yq/v9FAAPYcsiPFeA6pdTGbLkcz8YpXVyWKaW1nwkYRs7diBfOOr8KN/XMr5rQ0a5ZP9bB2pgIyCgcIBlYpJT6JqXl+HicUjv5Y0rp+jbBBm1ktlJfyo4HjVCu55uvNWTWNgGEcRjHAhvXJeOfjmep/JFd4HvbAxzyF3Odt55noJNjJLBCyEgTLJk6peO0PB7PlmVLsAG10hVYoHr+7tb9Xnc+Gq9LkmUp5EAAOaWOWc5mhcmkYAH+9Y69oGxQ5rm+/blu2ZcnO8ieP+xiF/UnHn5CsSdvpGRwWo4fz5bj8QTIKdUqxA4DhjDSXN3bt/Ha18gPbdnClr2jx9/+C/GJd2vFG1e2C6uWywDw0KQAUNdOEHYNtdW/9Ppr//pCNFKyMNiw+I5lm+I8GpNlnQuACwNyDES2sNDdYzNgTqQqy4CycbYlyn/fGMJR56jXN5Bxl/k8lnLsCjmL/zgc0lfHoSnKIiaEXOZssAXrI0t7EE3HQLYenf4V9p3x7Le+duJxX2Uu4IN6w2A8AvZRYLMfBfv7gOs6f/4Qh9THjV3bkxx+9L5vzc/c983rz+06z4+BKDFWCKySTMgGEOW5ydRzy6pCJj76rcn68b9LrtNns3fqsW0A+cjYLlkRkjH3+nFcfyKbqtCX7v4vzs98Z5ulUMGaHrGvbYdldC/acUDMI+ogY9183D4xWa0atXp1Br1lYw5HKnGOiHB2CO/nHtr6vCTlx0cmz3Gsv3eHObHhVctqJNe877Ab7FbtEc2e1A6XKBS5tkS5X360Y9aVjhVZn9gJGwSNx7N9/c6ZCgLgO3R6exWZUku4tlww9q0U0NLnbVRPI7tw57hOOqLMqjr1TIaJXRYSZIVsii+vgOg4skLzlWTD3c//qfA+yp242/sFnDDP4So+huswWBjmlsucf4/xnfEEj8BG783+2+m1R/Cwpne5evS5sQcLGVuteLpeZ7t/G9xbff0Z2zLAfWyKHbTUtLDN0QHWoN5OvctX2717l9Pva6cXffKx4bCViTpG+tVNnNTa5To8WwdB2UMAAw2Zon5/ALs1zbroWo0Y4X6velAf1fMDOyYxtTE8CTd9B3XbZaOa7TodvmY9vT4jvkIrjFmfqvz74xFhs1bO88CeoLNJpRweGiaO6s0RMyD5SJu+O73drb1VV6tOo9aXe3UGdR4CQ54G9w7T69Pt06SzDDx8Hqf1kXqv+rVsSi2rSZ6bubRsjXZYAOrTBwatmpl3mvaI2tXLv/+bbsw9QFv16qXf50bdXd7OZbV7/XOnV6/3p9ml79Y1ZDzSwgXLPLmji9aluLFNAQ9oAxZdfaknii934lsv8XK2bcAjuF9Pr6/O5W/1a0BhTB523M/AWetlA3tmaFOmXUO5w1i2AQLY0+L3n6c4MEOlxchsfJZ6hhtxcSoAnriA7AlgABsJMGZOcfFHk+sMho1j6TdNfOzUi6rwNkXLqsFl2GDLMjmA36dexbYL3nzu+M2J8ZIFfPpBwZZCtilmwEVh+P79qDeifhpzKNl4Pvdv2mupHWSAAUPx+47wnrFx4b4NBocBs4uqJf0XpTady3fw3Mhy/nZW2/5EGHBYVRgb3IEpWqZ0BlsZA7aFW5fuMyencAAHhvuQ8ye+/fD/fvUw4/vvtso8oiDLYLhPX08oOgYl4u6xhubkBMIc/hqo+UQYYmWxr3MIq5CJN2mq5wDKOdew+XfldefSRoX6NZKV69dHAMXLeD/AddTuqU85SNTfH1s4fAR07k8ekrXJlWXqeDtMNhXYR0F5VQKOHGHxcnyJ79kMC/ousDIHp7Zm2CMaCsbK1psuubIKWlaZrZyzye1oO4cmYwCZty45t7eYTIB/AiMHWlV+U9yrjE3k/E/yv9chv6lqOrXQ2oyrr1lzZ8DyAuNQR28WDBhTqMAR7/7MEACWb5ubKeJ7VUxdW8haAAK7otSADZji39Rd2pUKxPyjO8HTp+AHDmFccMG5BLBsF7xYrOIWzjJtvVtw/sKHF/sLgL9vCYxs4YKHZh8Zm1U1nZqa/PTXBuwdMiLP7OLgrULXSAaBsYRs38GW/rtgyWyMlV9EMSMdAKtGqu7Td3BzPBgxAOrjqKZ0wj16DETYvrZc31VRqj24OoBzp4u7vpT7zvk4OqBEuT4seAG4DFeWbLQ+9ZJclv13AxI8+yvIA/qFKR+AwSIfCVAFYJdAoG99F0uAASJ+7Xi5EzjuZk6s0hOYTLCZqwIsl4NhOjk0QLgQkevcYqaLo5VxjzyzJ/ltOJTB8wgDqICNVX3/cUwBt5OcFdkG/4OAbDbok6v49AOAgnrQJKaTmMi5qmKxcLBaev4vkeePDFjAp+cUg2cm51YN1WMoN56HKE4rgx0vnz19+Fc/ub79ZLILKw5pa4UxHOSSqQE="},_6=[-72.26808525539167,43.37747275058169],y6=10.873762090608595,x6=0,v6=2,w6={composite:{url:"mapbox://mapbox.mapbox-terrain-v2,mapbox.mapbox-streets-v8,ruralinno.2pv0vm2z,ruralinno.3v9y79ly,ruralinno.5639ssfg,ruralinno.c504wkuy,ruralinno.7stpbs93,ruralinno.cwz2k5qc,ruralinno.1joudpqe",type:"vector"}},b6="mapbox://sprites/ruralinno/cl010e7b7001p15pe3l0306hv/68n9slz9mfbus83an19oqbf32",E6="mapbox://fonts/ruralinno/{fontstack}/{range}.pbf",T6=[{id:"land",type:"background",layout:{},paint:{"background-color":"hsl(55, 0%, 100%)"}},{id:"landcover",type:"fill",source:"composite","source-layer":"landcover",maxzoom:7,layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":["interpolate",["exponential",1.5],["zoom"],2,.1,7,0],"fill-antialias":!1}},{id:"national-park",type:"fill",source:"composite","source-layer":"landuse_overlay",minzoom:5,filter:["==",["get","class"],"national_park"],layout:{},paint:{"fill-color":"hsla(150, 6%, 93%, 0.63)","fill-opacity":["interpolate",["linear"],["zoom"],5,0,6,.5]}},{id:"landuse",type:"fill",source:"composite","source-layer":"landuse",minzoom:5,filter:["match",["get","class"],["park","airport","glacier","pitch","sand"],!0,!1],layout:{},paint:{"fill-opacity":["interpolate",["linear"],["zoom"],5,0,6,["match",["get","class"],"glacier",.5,1]],"fill-color":"hsl(150, 0%, 100%)"}},{id:"water-shadow",type:"fill",source:"composite","source-layer":"water",layout:{},paint:{"fill-translate-anchor":"viewport","fill-translate":["interpolate",["exponential",1.2],["zoom"],7,["literal",[0,0]],16,["literal",[-1,-1]]],"fill-color":"hsl(185, 7%, 73%)"}},{id:"waterway",type:"line",source:"composite","source-layer":"waterway",minzoom:8,layout:{"line-cap":["step",["zoom"],"butt",11,"round"],"line-join":"round"},paint:{"line-color":"hsl(187, 9%, 81%)","line-width":["interpolate",["exponential",1.3],["zoom"],9,["match",["get","class"],["canal","river"],.1,0],20,["match",["get","class"],["canal","river"],8,3]],"line-opacity":["interpolate",["linear"],["zoom"],8,0,8.5,1]}},{id:"water",type:"fill",source:"composite","source-layer":"water",layout:{},paint:{"fill-color":"#cad2d3","fill-opacity":.5}},{id:"hillshade",type:"fill",source:"composite","source-layer":"hillshade",minzoom:6,layout:{},paint:{"fill-color":["match",["get","class"],"shadow","hsl(0, 0%, 35%)","hsl(0, 0%, 100%)"],"fill-opacity":["interpolate",["linear"],["zoom"],12,["match",["get","level"],[67,56],.02,[89,78],.01,.015],15,0]}},{id:"land-structure-polygon",type:"fill",source:"composite","source-layer":"structure",minzoom:21.1,filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","class"],"land"]],layout:{},paint:{"fill-color":"hsl(156, 20%, 95%)"}},{id:"land-structure-line",type:"line",source:"composite","source-layer":"structure",minzoom:13,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","class"],"land"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.99],["zoom"],14,.75,20,40],"line-color":"hsl(156, 20%, 95%)"}},{id:"aeroway-polygon",type:"fill",source:"composite","source-layer":"aeroway",minzoom:11,filter:["all",["==",["geometry-type"],"Polygon"],["match",["get","type"],["runway","taxiway","helipad"],!0,!1]],layout:{},paint:{"fill-opacity":["interpolate",["linear"],["zoom"],11,0,11.5,1],"fill-color":"hsl(0, 0%, 97%)"}},{id:"aeroway-line",type:"line",source:"composite","source-layer":"aeroway",minzoom:9,filter:["==",["geometry-type"],"LineString"],layout:{},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],9,["match",["get","type"],"runway",1,.5],18,["match",["get","type"],"runway",80,20]],"line-color":"hsl(0, 0%, 97%)"}},{id:"building-outline",type:"line",source:"composite","source-layer":"building",minzoom:15,filter:["all",["!=",["get","type"],"building:part"],["==",["get","underground"],"false"]],layout:{},paint:{"line-color":"hsl(55, 3%, 87%)","line-width":["interpolate",["exponential",1.5],["zoom"],15,.75,20,3],"line-opacity":["interpolate",["linear"],["zoom"],15,0,16,1]}},{id:"building",type:"fill",source:"composite","source-layer":"building",minzoom:15,filter:["all",["!=",["get","type"],"building:part"],["==",["get","underground"],"false"]],layout:{},paint:{"fill-outline-color":"hsl(55, 3%, 87%)","fill-opacity":["interpolate",["linear"],["zoom"],15,0,16,1],"fill-color":"hsl(55, 5%, 91%)"}},{id:"tunnel-street-minor-low",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["step",["zoom"],["match",["get","class"],["street","street_limited","track","primary_link"],!0,!1],14,["match",["get","class"],["street","street_limited","track","primary_link","secondary_link","tertiary_link","service"],!0,!1]],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,["match",["get","class"],["street","street_limited","primary_link"],2,"track",1,.5],18,["match",["get","class"],["street","street_limited","primary_link"],18,12]],"line-color":"hsl(185, 7%, 88%)","line-opacity":["step",["zoom"],1,14,0]}},{id:"tunnel-street-minor-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["step",["zoom"],["match",["get","class"],["street","street_limited","track","primary_link"],!0,!1],14,["match",["get","class"],["street","street_limited","track","primary_link","secondary_link","tertiary_link","service"],!0,!1]],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-color":"hsl(185, 12%, 89%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,["match",["get","class"],["street","street_limited","primary_link"],2,"track",1,.5],18,["match",["get","class"],["street","street_limited","primary_link"],18,12]],"line-opacity":["step",["zoom"],0,14,1],"line-dasharray":[3,3]}},{id:"tunnel-primary-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["match",["get","class"],["primary","secondary","tertiary"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,["match",["get","class"],"primary",1,.75],18,2],"line-color":"hsl(185, 12%, 89%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,["match",["get","class"],"primary",.75,.1],18,["match",["get","class"],"primary",32,26]],"line-dasharray":[3,3]}},{id:"tunnel-major-link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-color":"hsl(185, 12%, 89%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-dasharray":[3,3]}},{id:"tunnel-motorway-trunk-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["match",["get","class"],["motorway","trunk"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,18,2],"line-color":"hsl(185, 12%, 89%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-dasharray":[3,3]}},{id:"tunnel-construction",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==",["get","structure"],"tunnel"],["==",["get","class"],"construction"],["==",["geometry-type"],"LineString"]],layout:{},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,2,18,18],"line-color":"hsl(187, 7%, 88%)","line-dasharray":["step",["zoom"],["literal",[.4,.8]],15,["literal",[.3,.6]],16,["literal",[.2,.3]],17,["literal",[.2,.25]],18,["literal",[.15,.15]]]}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["==",["get","class"],"path"],["!=",["get","type"],"steps"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],15,1,18,4],"line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.75,1]],16,["literal",[1,.75]],17,["literal",[1,.5]]],"line-color":"hsl(0, 0%, 85%)"}},{id:"tunnel-steps",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==",["get","structure"],"tunnel"],["==",["get","class"],"steps"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],15,1,16,1.6,18,6],"line-color":"hsl(0, 0%, 85%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.75,1]],16,["literal",[1,.75]],17,["literal",[.3,.3]]]}},{id:"tunnel-major-link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(187, 7%, 88%)"}},{id:"tunnel-pedestrian",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["==",["get","class"],"pedestrian"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,.5,18,12],"line-color":"hsl(187, 7%, 88%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.5,.4]],16,["literal",[1,.2]]]}},{id:"tunnel-street-minor",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["step",["zoom"],["match",["get","class"],["street","street_limited","track","primary_link"],!0,!1],14,["match",["get","class"],["street","street_limited","track","primary_link","secondary_link","tertiary_link","service"],!0,!1]],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,["match",["get","class"],["street","street_limited","primary_link"],2,"track",1,.5],18,["match",["get","class"],["street","street_limited","primary_link"],18,12]],"line-color":"hsl(187, 7%, 88%)","line-opacity":["step",["zoom"],0,14,1]}},{id:"tunnel-primary-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["match",["get","class"],["primary","secondary","tertiary"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,["match",["get","class"],"primary",.75,.1],18,["match",["get","class"],"primary",32,26]],"line-color":"hsl(187, 7%, 88%)"}},{id:"tunnel-motorway-trunk",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"tunnel"],["match",["get","class"],["motorway","trunk"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-color":"hsl(187, 7%, 88%)"}},{id:"road-pedestrian-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==",["get","class"],"pedestrian"],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,2,18,14.5],"line-color":"hsl(156, 12%, 92%)","line-opacity":["step",["zoom"],0,14,1]}},{id:"road-minor-low",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["step",["zoom"],["==",["get","class"],"track"],14,["match",["get","class"],["track","secondary_link","tertiary_link","service"],!0,!1]],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,["match",["get","class"],"track",1,.5],18,12],"line-color":"hsl(0, 0%, 100%)","line-opacity":["step",["zoom"],1,14,0]}},{id:"road-street-low",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["match",["get","class"],["street","street_limited","primary_link"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(0, 0%, 100%)","line-opacity":["step",["zoom"],1,14,0]}},{id:"road-minor-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["step",["zoom"],["==",["get","class"],"track"],14,["match",["get","class"],["track","secondary_link","tertiary_link","service"],!0,!1]],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],14,["match",["get","class"],"track",1,.5],18,12],"line-opacity":["step",["zoom"],0,14,1]}},{id:"road-street-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["match",["get","class"],["street","street_limited","primary_link"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-opacity":["step",["zoom"],0,14,1]}},{id:"road-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:9.3,filter:["all",["match",["get","class"],["secondary","tertiary"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,.75,18,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,.1,18,26]}},{id:"road-primary-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:9.9,filter:["all",["==",["get","class"],"primary"],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,18,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32]}},{id:"road-major-link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:10,filter:["all",["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-opacity":["step",["zoom"],0,11,1]}},{id:"road-motorway-trunk-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:8.5,filter:["all",["match",["get","class"],["motorway","trunk"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,18,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-opacity":["step",["zoom"],["match",["get","class"],"motorway",1,0],6,1]}},{id:"road-construction",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==",["get","class"],"construction"],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,2,18,18],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[.4,.8]],15,["literal",[.3,.6]],16,["literal",[.2,.3]],17,["literal",[.2,.25]],18,["literal",[.15,.15]]]}},{id:"road-path",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==",["get","class"],"path"],["step",["zoom"],["!",["match",["get","type"],["steps","sidewalk","crossing"],!0,!1]],16,["!=",["get","type"],"steps"]],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],13,.5,14,1,15,1,18,4],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.75,1]],16,["literal",[1,.75]],17,["literal",[1,.5]]]}},{id:"road-steps",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==",["get","type"],"steps"],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],15,1,16,1.6,18,6],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.75,1]],16,["literal",[1,.75]],17,["literal",[.3,.3]]]}},{id:"road-major-link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:10,filter:["all",["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(0, 0%, 100%)"}},{id:"road-pedestrian",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==",["get","class"],"pedestrian"],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,.5,18,12],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.5,.4]],16,["literal",[1,.2]]]}},{id:"road-minor",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["step",["zoom"],["==",["get","class"],"track"],14,["match",["get","class"],["track","secondary_link","tertiary_link","service"],!0,!1]],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,["match",["get","class"],"track",1,.5],18,12],"line-color":"hsl(0, 0%, 100%)","line-opacity":["step",["zoom"],0,14,1]}},{id:"road-street",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["match",["get","class"],["street","street_limited","primary_link"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(0, 0%, 100%)","line-opacity":["step",["zoom"],0,14,1]}},{id:"road-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["match",["get","class"],["secondary","tertiary"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,.1,18,22],"line-color":"hsl(0, 0%, 100%)"}},{id:"road-primary",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:9,filter:["all",["==",["get","class"],"primary"],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-color":"#f6eac1","line-opacity":["interpolate",["linear"],["zoom"],6,0,8,["match",["get","class"],["trunk"],.2,0],16,["match",["get","class"],["trunk"],1,.81]]}},{id:"road-motorway-trunk",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:8,filter:["all",["match",["get","class"],["motorway","trunk"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,.5,18,32],"line-color":["match",["get","class"],["motorway"],"hsl(26, 100%, 68%)","#f2d163"],"line-opacity":["interpolate",["linear"],["zoom"],6,["match",["get","class"],["trunk"],.3,0],8,.4,18,.7]}},{id:"road-rail",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["match",["get","class"],["major_rail","minor_rail"],!0,!1],["match",["get","structure"],["none","ford"],!0,!1]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,.5,20,1],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-pedestrian-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["==",["get","class"],"pedestrian"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,2,18,14.5],"line-opacity":["step",["zoom"],0,14,1],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-street-minor-low",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["step",["zoom"],["match",["get","class"],["street","street_limited","track","primary_link"],!0,!1],14,["match",["get","class"],["street","street_limited","track","primary_link","secondary_link","tertiary_link","service"],!0,!1]],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,["match",["get","class"],["street","street_limited","primary_link"],2,"track",1,.5],18,["match",["get","class"],["street","street_limited","primary_link"],18,12]],"line-color":"hsl(0, 0%, 100%)","line-opacity":["step",["zoom"],1,14,0]}},{id:"bridge-street-minor-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["step",["zoom"],["match",["get","class"],["street","street_limited","track","primary_link"],!0,!1],14,["match",["get","class"],["street","street_limited","track","primary_link","secondary_link","tertiary_link","service"],!0,!1]],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-opacity":["step",["zoom"],0,14,1],"line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,["match",["get","class"],["street","street_limited","primary_link"],2,"track",1,.5],18,["match",["get","class"],["street","street_limited","primary_link"],18,12]],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-primary-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["primary","secondary","tertiary"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,["match",["get","class"],"primary",1,.75],18,2],"line-opacity":["step",["zoom"],0,10,1],"line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,["match",["get","class"],"primary",.75,.1],18,["match",["get","class"],"primary",32,26]],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-major-link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["<=",["get","layer"],1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-motorway-trunk-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["motorway","trunk"],!0,!1],["<=",["get","layer"],1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,18,2],"line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-construction",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==",["get","structure"],"bridge"],["==",["get","class"],"construction"],["==",["geometry-type"],"LineString"]],layout:{},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,2,18,18],"line-dasharray":["step",["zoom"],["literal",[.4,.8]],15,["literal",[.3,.6]],16,["literal",[.2,.3]],17,["literal",[.2,.25]],18,["literal",[.15,.15]]],"line-color":"hsl(156, 0%, 100%)"}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["==",["get","class"],"path"],["!=",["get","type"],"steps"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],15,1,18,4],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.75,1]],16,["literal",[1,.75]],17,["literal",[1,.5]]]}},{id:"bridge-steps",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==",["get","type"],"steps"],["==",["get","structure"],"bridge"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],15,1,16,1.6,18,6],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.75,1]],16,["literal",[1,.75]],17,["literal",[.3,.3]]]}},{id:"bridge-major-link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["<=",["get","layer"],1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(0, 0%, 100%)"}},{id:"bridge-pedestrian",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["==",["get","class"],"pedestrian"],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,.5,18,12],"line-color":"hsl(0, 0%, 100%)","line-dasharray":["step",["zoom"],["literal",[1,0]],15,["literal",[1.5,.4]],16,["literal",[1,.2]]]}},{id:"bridge-street-minor",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["step",["zoom"],["match",["get","class"],["street","street_limited","track","primary_link"],!0,!1],14,["match",["get","class"],["street","street_limited","track","primary_link","secondary_link","tertiary_link","service"],!0,!1]],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,["match",["get","class"],["street","street_limited","primary_link"],2,"track",1,.5],18,["match",["get","class"],["street","street_limited","primary_link"],18,12]],"line-color":"hsl(0, 0%, 100%)","line-opacity":["step",["zoom"],0,14,1]}},{id:"bridge-primary-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["primary","secondary","tertiary"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,["match",["get","class"],"primary",.75,.1],18,["match",["get","class"],"primary",32,26]],"line-color":"hsl(0, 0%, 100%)"}},{id:"bridge-motorway-trunk",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["motorway","trunk"],!0,!1],["<=",["get","layer"],1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-color":"hsl(0, 0%, 100%)"}},{id:"bridge-rail",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],["match",["get","class"],["major_rail","minor_rail"],!0,!1]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],14,.5,20,1],"line-color":"hsl(156, 12%, 92%)"}},{id:"bridge-major-link-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],[">=",["get","layer"],2],["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.75,20,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18]}},{id:"bridge-motorway-trunk-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],[">=",["get","layer"],2],["match",["get","class"],["motorway","trunk"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,18,2],"line-color":"hsl(156, 12%, 92%)","line-gap-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32]}},{id:"bridge-major-link-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],[">=",["get","layer"],2],["match",["get","class"],["motorway_link","trunk_link"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],12,.5,14,2,18,18],"line-color":"hsl(0, 0%, 100%)"}},{id:"bridge-motorway-trunk-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==",["get","structure"],"bridge"],[">=",["get","layer"],2],["match",["get","class"],["motorway","trunk"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["interpolate",["exponential",1.5],["zoom"],5,.75,18,32],"line-color":"hsl(0, 0%, 100%)"}},{id:"admin-1-boundary-bg",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",filter:["all",["==",["get","admin_level"],1],["==",["get","maritime"],"false"],["match",["get","worldview"],["all","US"],!0,!1]],layout:{"line-join":"bevel"},paint:{"line-blur":["interpolate",["linear"],["zoom"],3,0,8,3],"line-width":["interpolate",["linear"],["zoom"],7,3.75,12,5.5],"line-opacity":["interpolate",["linear"],["zoom"],7,0,8,.75],"line-dasharray":[1,0],"line-translate":[0,0],"line-color":"hsl(0, 0%, 84%)"}},{id:"admin-0-boundary-bg",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==",["get","admin_level"],0],["==",["get","maritime"],"false"],["match",["get","worldview"],["all","US"],!0,!1]],paint:{"line-width":["interpolate",["linear"],["zoom"],3,3.5,10,8],"line-color":"hsl(0, 0%, 84%)","line-opacity":["interpolate",["linear"],["zoom"],3,0,4,.5],"line-translate":[0,0],"line-blur":["interpolate",["linear"],["zoom"],3,0,10,2]}},{id:"admin-1-boundary",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",filter:["all",["==",["get","admin_level"],1],["==",["get","maritime"],"false"],["match",["get","worldview"],["all","US"],!0,!1]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-width":["interpolate",["linear"],["zoom"],7,.75,12,1.5],"line-opacity":["interpolate",["linear"],["zoom"],2,0,3,1],"line-color":["interpolate",["linear"],["zoom"],3,"hsl(0, 0%, 80%)",7,"hsl(0, 0%, 70%)"]}},{id:"admin-0-boundary",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==",["get","admin_level"],0],["==",["get","disputed"],"false"],["==",["get","maritime"],"false"],["match",["get","worldview"],["all","US"],!0,!1]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"hsl(0, 0%, 62%)","line-width":["interpolate",["linear"],["zoom"],3,.5,10,2]}},{id:"admin-0-boundary-disputed",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==",["get","disputed"],"true"],["==",["get","admin_level"],0],["==",["get","maritime"],"false"],["match",["get","worldview"],["all","US"],!0,!1]],layout:{"line-join":"round"},paint:{"line-dasharray":[1.5,1.5],"line-color":"hsl(0, 0%, 62%)","line-width":["interpolate",["linear"],["zoom"],3,.5,10,2]}},{id:"county_border",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"attr_county_labels_pg-155yvu",minzoom:6,maxzoom:12,paint:{"line-width":["interpolate",["linear"],["zoom"],5,.5,9,1.7,18,2],"line-color":"hsl(0, 0%, 59%)","line-opacity":["interpolate",["linear"],["zoom"],5,.2,9,.5,18,1]}},{id:"cousub_border",type:"line",source:"composite","source-layer":"attr_cousub_labels_less_pl-9lemol",minzoom:8,maxzoom:14,layout:{},paint:{"line-color":"hsl(0, 3%, 38%)","line-width":["interpolate",["linear"],["zoom"],0,1,6,1,22,1],"line-opacity":["interpolate",["linear"],["zoom"],7,.1,18,.2]}},{id:"place_border",type:"line",source:"composite","source-layer":"attr_place_labels_less_pl-0n1bxr",minzoom:8,maxzoom:14,paint:{"line-color":"hsla(0, 0%, 58%, 0.62)","line-dasharray":[3,2]}},{id:"road-label",type:"symbol",source:"composite","source-layer":"road",minzoom:10,filter:["step",["zoom"],["match",["get","class"],["motorway","trunk","primary","secondary","tertiary"],!0,!1],12,["match",["get","class"],["motorway","trunk","primary","secondary","tertiary","pedestrian","street","street_limited"],!0,!1],15,["match",["get","class"],["ferry","golf","path"],!1,!0]],layout:{"text-size":["interpolate",["linear"],["zoom"],10,["match",["get","class"],["motorway","trunk","primary","secondary","tertiary"],10,["motorway_link","trunk_link","primary_link","secondary_link","tertiary_link","pedestrian","street","street_limited"],9,6.5],18,["match",["get","class"],["motorway","trunk","primary","secondary","tertiary"],16,["motorway_link","trunk_link","primary_link","secondary_link","tertiary_link","pedestrian","street","street_limited"],14,13]],"text-max-angle":30,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-pitch-alignment":"viewport","text-field":["coalesce",["get","name_en"],["get","name"]],"text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 42%)","text-halo-color":["match",["get","class"],["motorway","trunk"],"hsla(0, 0%, 100%, 0.75)","hsl(0, 0%, 100%)"],"text-halo-blur":1,"text-halo-width":.1}},{id:"waterway-label",type:"symbol",source:"composite","source-layer":"natural_label",minzoom:13,filter:["all",["match",["get","class"],["canal","river","stream"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-max-angle":30,"symbol-spacing":["interpolate",["linear",1],["zoom"],15,250,17,400],"text-size":["interpolate",["linear"],["zoom"],13,12,18,16],"symbol-placement":"line","text-pitch-alignment":"viewport","text-field":["coalesce",["get","name_en"],["get","name"]]},paint:{"text-color":"hsl(187, 7%, 51%)"}},{id:"natural-line-label",type:"symbol",source:"composite","source-layer":"natural_label",minzoom:4,filter:["all",["match",["get","class"],["glacier","landform"],!0,!1],["==",["geometry-type"],"LineString"],["<=",["get","filterrank"],1]],layout:{"text-size":["step",["zoom"],["step",["get","sizerank"],18,5,12],17,["step",["get","sizerank"],18,13,12]],"text-max-angle":30,"text-field":["coalesce",["get","name_en"],["get","name"]],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"symbol-placement":"line-center","text-pitch-alignment":"viewport"},paint:{"text-halo-width":.5,"text-halo-color":"hsl(0, 0%, 100%)","text-halo-blur":.5,"text-color":"hsl(0, 0%, 42%)"}},{id:"natural-point-label",type:"symbol",source:"composite","source-layer":"natural_label",minzoom:4,filter:["all",["match",["get","class"],["dock","glacier","landform","water_feature","wetland"],!0,!1],["==",["geometry-type"],"Point"],["<=",["get","filterrank"],1]],layout:{"text-size":["step",["zoom"],["step",["get","sizerank"],18,5,12],17,["step",["get","sizerank"],18,13,12]],"text-field":["coalesce",["get","name_en"],["get","name"]],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-offset":["literal",[0,0]]},paint:{"text-color":"hsl(0, 0%, 42%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5}},{id:"water-line-label",type:"symbol",source:"composite","source-layer":"natural_label",filter:["all",["match",["get","class"],["bay","ocean","reservoir","sea","water"],!0,!1],["==",["geometry-type"],"LineString"]],layout:{"text-size":["interpolate",["linear"],["zoom"],7,["step",["get","sizerank"],24,6,18,12,12],10,["step",["get","sizerank"],18,9,12],18,["step",["get","sizerank"],18,9,16]],"text-max-angle":30,"text-letter-spacing":["match",["get","class"],"ocean",.25,["sea","bay"],.15,0],"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line-center","text-pitch-alignment":"viewport","text-field":["coalesce",["get","name_en"],["get","name"]]},paint:{"text-color":"hsl(187, 7%, 51%)"}},{id:"water-point-label",type:"symbol",source:"composite","source-layer":"natural_label",filter:["all",["match",["get","class"],["bay","ocean","reservoir","sea","water"],!0,!1],["==",["geometry-type"],"Point"]],layout:{"text-line-height":1.3,"text-size":["interpolate",["linear"],["zoom"],7,["step",["get","sizerank"],24,6,18,12,12],10,["step",["get","sizerank"],18,9,12]],"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-field":["coalesce",["get","name_en"],["get","name"]],"text-letter-spacing":["match",["get","class"],"ocean",.25,["bay","sea"],.15,.01],"text-max-width":["match",["get","class"],"ocean",4,"sea",5,["bay","water"],7,10]},paint:{"text-color":"hsl(187, 7%, 51%)"}},{id:"poi-label",type:"symbol",source:"composite","source-layer":"poi_label",minzoom:6,filter:["<=",["get","filterrank"],1],layout:{"text-size":["step",["zoom"],["step",["get","sizerank"],18,5,12],17,["step",["get","sizerank"],18,13,12]],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-field":["coalesce",["get","name_en"],["get","name"]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.1,"text-halo-blur":.5,"text-color":["step",["zoom"],["step",["get","sizerank"],"hsl(0, 0%, 66%)",5,"hsl(230, 0%, 56%)"],17,["step",["get","sizerank"],"hsl(0, 0%, 66%)",13,"hsl(0, 0%, 56%)"]]}},{id:"airport-label",type:"symbol",source:"composite","source-layer":"airport_label",minzoom:8,layout:{"text-line-height":1.1,"text-size":["step",["get","sizerank"],18,9,12],"icon-image":["step",["get","sizerank"],["concat",["get","maki"],"-15"],9,["concat",["get","maki"],"-11"]],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],visibility:"none","text-offset":[0,.75],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":["step",["get","sizerank"],["coalesce",["get","name_en"],["get","name"]],15,["get","ref"]],"text-letter-spacing":.01,"text-max-width":9},paint:{"text-color":"hsla(0, 0%, 42%, 0)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-opacity":0}},{id:"settlement-subdivision-label",type:"symbol",source:"composite","source-layer":"place_label",minzoom:10,maxzoom:15,filter:["all",["==",["get","class"],"settlement_subdivision"],["<=",["get","filterrank"],4]],layout:{"text-field":["coalesce",["get","name_en"],["get","name"]],"text-transform":"uppercase","text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-letter-spacing":["match",["get","type"],"suburb",.15,.1],"text-max-width":7,"text-padding":3,"text-size":["interpolate",["cubic-bezier",.5,0,1,1],["zoom"],11,["match",["get","type"],"suburb",11,10.5],15,["match",["get","type"],"suburb",17,16]],visibility:"none"},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-color":"hsl(0, 0%, 62%)","text-halo-blur":.5,"text-halo-width":.1}},{id:"state-label",type:"symbol",source:"composite","source-layer":"place_label",minzoom:3,maxzoom:9,filter:["==",["get","class"],"state"],layout:{"text-size":["interpolate",["cubic-bezier",.85,.7,.65,1],["zoom"],4,["step",["get","symbolrank"],10,6,9.5,7,9],9,["step",["get","symbolrank"],24,6,18,7,14]],"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-field":["step",["zoom"],["step",["get","symbolrank"],["coalesce",["get","name_en"],["get","name"]],5,["coalesce",["get","abbr"],["get","name_en"],["get","name"]]],5,["coalesce",["get","name_en"],["get","name"]]],"text-letter-spacing":.15,"text-max-width":6},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-color":"hsl(0, 0%, 66%)","text-halo-width":.1}},{id:"county_label",type:"symbol",source:"composite","source-layer":"attr_county_labels-5i5o0f",minzoom:7.5,maxzoom:14,layout:{"text-field":["step",["zoom"],["upcase",["to-string",["get","name"]]],6,["upcase",["to-string",["get","name"]]],10,["upcase",["to-string",["get","namelsad"]]],22,["upcase",["to-string",["get","namelsad"]]]],"text-font":["step",["zoom"],["literal",["Open Sans Regular","Arial Unicode MS Regular"]],6,["literal",["Montserrat Medium","Arial Unicode MS Regular"]],8,["literal",["Montserrat Medium","Arial Unicode MS Regular"]],11,["literal",["Montserrat Medium","Arial Unicode MS Regular"]],22,["literal",["Montserrat Medium","Arial Unicode MS Regular"]]],"text-size":["interpolate",["linear"],["zoom"],0,0,6,6,6.5,10,7.5,14,9,30,11,75,14,85],"text-allow-overlap":["step",["zoom"],!1,5,!1,10,!1,11,!0],"text-max-width":5,"text-ignore-placement":["step",["zoom"],!1,6,!1,9,!0,12,!0,22,!0]},paint:{"text-color":"hsl(0, 0%, 48%)","text-opacity":["interpolate",["linear"],["zoom"],6.49999,1,6.5,.7,8,.3,11,.1,16,.05]}},{id:"cousub_label",type:"symbol",source:"composite","source-layer":"attr_cousub_labels_plus_pt-0kx5lj",minzoom:9,layout:{"text-field":["upcase",["get","display_name"]],"text-size":["interpolate",["linear"],["zoom"],7.9,0,8,8,9,10,14,30],"text-max-width":5,"text-line-height":1.1,visibility:"none"},paint:{"text-color":"hsla(0, 0%, 31%, 0.76)","text-halo-width":10,"text-halo-color":"hsl(0, 0%, 100%)"}},{id:"place-label new",type:"symbol",source:"composite","source-layer":"rural_places-4rf4i9",minzoom:9,filter:["match",["get","census_boundary_year"],[2020],!0,!1],layout:{"text-line-height":1.1,"text-size":["interpolate",["cubic-bezier",.2,0,.9,1],["zoom"],3,["step",["get","symbolrank"],12,9,11,10,10.5,12,9.5,14,8.5,16,6.5,17,4],15,["step",["get","symbolrank"],28,9,26,10,23,11,21,12,20,13,19,15,17]],"icon-image":["case",["==",["get","capital"],2],"border-dot-13",["step",["get","symbolrank"],"dot-11",9,"dot-10",11,"dot-9"]],"text-font":["Montserrat Medium","Arial Unicode MS Regular"],"text-justify":["step",["zoom"],["match",["get","text_anchor"],["left","bottom-left","top-left"],"left",["right","bottom-right","top-right"],"right","center"],8,"center"],visibility:"none","text-offset":["step",["zoom"],["match",["get","capital"],2,["match",["get","text_anchor"],"bottom",["literal",[0,-.3]],"bottom-left",["literal",[.3,-.1]],"left",["literal",[.45,.1]],"top-left",["literal",[.3,.1]],"top",["literal",[0,.3]],"top-right",["literal",[-.3,.1]],"right",["literal",[-.45,0]],"bottom-right",["literal",[-.3,-.1]],["literal",[0,-.3]]],["match",["get","text_anchor"],"bottom",["literal",[0,-.25]],"bottom-left",["literal",[.2,-.05]],"left",["literal",[.4,.05]],"top-left",["literal",[.2,.05]],"top",["literal",[0,.25]],"top-right",["literal",[-.2,.05]],"right",["literal",[-.4,.05]],"bottom-right",["literal",[-.2,-.05]],["literal",[0,-.25]]]],8,["literal",[0,0]]],"text-anchor":["step",["zoom"],["get","text_anchor"],8,"center"],"text-field":["coalesce",["get","NAME"]],"text-max-width":7},paint:{"text-color":["step",["get","symbolrank"],"hsl(0, 2%, 61%)",11,"hsl(0, 1%, 68%)",16,"hsl(0, 1%, 75%)"],"text-halo-color":"hsl(0, 0%, 100%)","icon-opacity":["step",["zoom"],1,8,0],"text-halo-blur":1,"text-halo-width":.1}},{id:"settlement-label",type:"symbol",source:"composite","source-layer":"place_label",maxzoom:10.76,filter:["all",["<=",["get","filterrank"],3],["==",["get","class"],"settlement"],["step",["zoom"],!0,12,[">=",["get","symbolrank"],11],13,[">=",["get","symbolrank"],12]]],layout:{"text-line-height":1.1,"text-size":["interpolate",["cubic-bezier",.2,0,.9,1],["zoom"],3,["step",["get","symbolrank"],12,9,11,10,10.5,12,9.5,14,8.5,16,6.5,17,4],15,["step",["get","symbolrank"],28,9,26,10,23,11,21,12,20,13,19,15,17]],"icon-image":["case",["==",["get","capital"],2],"border-dot-13",["step",["get","symbolrank"],"dot-11",9,"dot-10",11,"dot-9"]],"text-font":["step",["zoom"],["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]],8,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],11,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],10,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],12,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],11,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],13,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],12,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],15,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],13,["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]]],"text-justify":["step",["zoom"],["match",["get","text_anchor"],["left","bottom-left","top-left"],"left",["right","bottom-right","top-right"],"right","center"],8,"center"],"text-offset":["step",["zoom"],["match",["get","capital"],2,["match",["get","text_anchor"],"bottom",["literal",[0,-.3]],"bottom-left",["literal",[.3,-.1]],"left",["literal",[.45,.1]],"top-left",["literal",[.3,.1]],"top",["literal",[0,.3]],"top-right",["literal",[-.3,.1]],"right",["literal",[-.45,0]],"bottom-right",["literal",[-.3,-.1]],["literal",[0,-.3]]],["match",["get","text_anchor"],"bottom",["literal",[0,-.25]],"bottom-left",["literal",[.2,-.05]],"left",["literal",[.4,.05]],"top-left",["literal",[.2,.05]],"top",["literal",[0,.25]],"top-right",["literal",[-.2,.05]],"right",["literal",[-.4,.05]],"bottom-right",["literal",[-.2,-.05]],["literal",[0,-.25]]]],8,["literal",[0,0]]],"text-anchor":["step",["zoom"],["get","text_anchor"],8,"center"],"text-field":["coalesce",["get","name_en"],["get","name"]],"text-max-width":7},paint:{"text-color":["step",["get","symbolrank"],"hsl(0, 0%, 42%)",11,"hsl(0, 0%, 55%)",16,"hsl(0, 0%, 62%)"],"text-halo-color":"hsl(0, 0%, 100%)","icon-opacity":["step",["zoom"],1,8,0],"text-halo-blur":1,"text-halo-width":.1}},{id:"wwb2s-places_lat_lon",type:"symbol",source:"composite","source-layer":"places_lat_lon-awryh9",minzoom:10.75,maxzoom:20,filter:["all",[">=",["get","pop"],101],[">",["get","pct_rural"],0],["step",["zoom"],!0,13,[">=",["get","symbolrank"],11],14,[">=",["get","symbolrank"],13]]],layout:{"text-line-height":1.1,"text-size":["step",["get","symbolrank"],20,9,18,10,16,11,14,12,12],"icon-image":["case",["==",["get","capital"],2],"border-dot-13",["step",["get","symbolrank"],"dot-11",9,"dot-10",11,"dot-9"]],"text-font":["step",["zoom"],["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]],8,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],11,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],10,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],12,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],11,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],13,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],12,["step",["get","symbolrank"],["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]],15,["literal",["DIN Offc Pro Regular","Arial Unicode MS Regular"]]],13,["literal",["DIN Offc Pro Medium","Arial Unicode MS Regular"]]],"text-justify":["step",["zoom"],["match",["get","text_anchor"],["left","bottom-left","top-left"],"left",["right","bottom-right","top-right"],"right","center"],8,"center"],"text-offset":["step",["zoom"],["match",["get","capital"],2,["match",["get","text_anchor"],"bottom",["literal",[0,-.3]],"bottom-left",["literal",[.3,-.1]],"left",["literal",[.45,.1]],"top-left",["literal",[.3,.1]],"top",["literal",[0,.3]],"top-right",["literal",[-.3,.1]],"right",["literal",[-.45,0]],"bottom-right",["literal",[-.3,-.1]],["literal",[0,-.3]]],["match",["get","text_anchor"],"bottom",["literal",[0,-.25]],"bottom-left",["literal",[.2,-.05]],"left",["literal",[.4,.05]],"top-left",["literal",[.2,.05]],"top",["literal",[0,.25]],"top-right",["literal",[-.2,.05]],"right",["literal",[-.4,.05]],"bottom-right",["literal",[-.2,-.05]],["literal",[0,-.25]]]],8,["literal",[0,0]]],"text-anchor":["step",["zoom"],["get","text_anchor"],8,"center"],"text-field":["coalesce",["get","NAME"],["get","name"]],"text-max-width":7},paint:{"text-halo-color":"hsl(0, 0%, 100%)","icon-opacity":["step",["zoom"],1,8,0],"text-halo-blur":1,"text-halo-width":.1,"text-color":["interpolate",["linear"],["zoom"],0,"hsl(0, 0%, 62%)",22,"#000000"],"text-opacity":["interpolate",["linear"],["zoom"],7,0,9,.97,22,1]}},{id:"custom-pattern",type:"fill",source:"composite","source-layer":"attr_county_labels_pg-155yvu",minzoom:6,layout:{visibility:"none"},paint:{"fill-color":"hsla(303, 73%, 74%, 0.66)","fill-pattern":"stripe-4"}}],S6="2022-02-24T13:16:14.872Z",C6="2024-07-11T16:18:50.102Z",A6="cl010e7b7001p15pe3l0306hv",I6="ruralinno",k6="private",M6=!1,D6={version:f6,name:m6,metadata:g6,center:_6,zoom:y6,bearing:x6,pitch:v6,sources:w6,sprite:b6,glyphs:E6,layers:T6,created:S6,modified:C6,id:A6,owner:I6,visibility:k6,protected:!1,draft:M6};/*
 * Frontend UI component library for the CORI Data API 
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */Object.assign({},D6);var G4={exports:{}};(function(t,n){(function(l,h){t.exports=h()})($t,function(){var l,h,m;function x(s,C){if(!l)l=C;else if(!h)h=C;else{var k="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",B={};l(B),m=C(B),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}x(["exports"],function(s){var C=typeof self<"u"?self:{},k="2.15.0";let B;const U={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(B==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{B={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{B=r}}return B},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!U.API_URL)return null;try{const r=new URL(U.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(r){!K&&q&&(Y?W(r):Z=r)}};let Z,q,K=!1,Y=!1;function W(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,q),r.isContextLost())return;F.supported=!0}catch{}r.deleteTexture(e),K=!0}C.document&&(q=C.document.createElement("img"),q.onload=function(){Z&&W(Z),Z=null,Y=!0},q.onerror=function(){K=!0,Z=null},q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function V(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Q=ue;function ue(r,e,i,a){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=i,this.p2y=a}ue.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,a=0;a<8;a++){var u=this.sampleCurveX(i)-r;if(Math.abs(u)<e)return i;var p=this.sampleCurveDerivativeX(i);if(Math.abs(p)<1e-6)break;i-=u/p}var g=0,y=1;for(i=r,a=0;a<20&&(u=this.sampleCurveX(i),!(Math.abs(u-r)<e));a++)r>u?g=i:y=i,i=.5*(y-g)+g;return i},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var fe=V(Q),we=Ce;function Ce(r,e){this.x=r,this.y=e}Ce.prototype={clone:function(){return new Ce(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,i=r.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),i=Math.sin(r),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(r,e){var i=Math.cos(r),a=Math.sin(r),u=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ce.convert=function(r){return r instanceof Ce?r:Array.isArray(r)?new Ce(r[0],r[1]):r};var Te=V(we);const Se=Math.PI/180,Ne=180/Math.PI;function Ue(r){return r*Se}function Ve(r){return r*Ne}const St=[[0,0],[1,0],[1,1],[0,1]];function kt(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,i=e*r;return 4*(r<.5?i:3*(r-e)+i-.75)}function Ot(r,e,i,a){const u=new fe(r,e,i,a);return function(p){return u.solve(p)}}const on=Ot(.25,.1,.25,1);function We(r,e,i){return Math.min(i,Math.max(e,r))}function bt(r,e,i){return(i=We((i-r)/(e-r),0,1))*i*(3-2*i)}function ft(r,e,i){const a=i-e,u=((r-e)%a+a)%a+e;return u===e?i:u}function je(r,e,i){if(!r.length)return i(null,[]);let a=r.length;const u=new Array(r.length);let p=null;r.forEach((g,y)=>{e(g,(w,E)=>{w&&(p=w),u[y]=E,--a==0&&i(p,u)})})}function Je(r){const e=[];for(const i in r)e.push(r[i]);return e}function et(r,...e){for(const i of e)for(const a in i)r[a]=i[a];return r}let tt=1;function nn(){return tt++}function Wt(){return function r(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function yn(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Ht(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function Lr(r,e){r.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function ln(r,e){return r.indexOf(e,r.length-e.length)!==-1}function Rt(r,e,i){const a={};for(const u in r)a[u]=e.call(i||this,r[u],u,r);return a}function Yr(r,e,i){const a={};for(const u in r)e.call(i||this,r[u],u,r)&&(a[u]=r[u]);return a}function zn(r){return Array.isArray(r)?r.map(zn):typeof r=="object"&&r?Rt(r,zn):r}const Xn={};function mn(r){Xn[r]||(typeof console<"u"&&console.warn(r),Xn[r]=!0)}function gr(r,e,i){return(i.y-r.y)*(e.x-r.x)>(e.y-r.y)*(i.x-r.x)}function bo(r){let e=0;for(let i,a,u=0,p=r.length,g=p-1;u<p;g=u++)i=r[u],a=r[g],e+=(a.x-i.x)*(i.y+a.y);return e}function qr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ir(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,u,p)=>{const g=u||p;return e[a]=!g||g.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Ri=null;function _r(r){if(Ri==null){const e=r.navigator?r.navigator.userAgent:null;Ri=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ri}function yr(r){try{const e=C[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function kr(r,e){return[r[4*e],r[4*e+1],r[4*e+2],r[4*e+3]]}const Fi="mapbox-tiles";let Es=500,Oi=50,xr,to;function ts(){try{return C.caches}catch{}}function no(){ts()&&!xr&&(xr=C.caches.open(Fi))}function di(r){const e=r.indexOf("?");if(e<0)return r;const i=function(u){const p=u.indexOf("?");return p>0?u.slice(p+1).split("&"):[]}(r),a=i.filter(u=>{const p=u.split("=");return p[0]==="language"||p[0]==="worldview"});return a.length?`${r.slice(0,e)}?${a.join("&")}`:r.slice(0,e)}let Ni=1/0;const Eo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Eo);class Ui extends Error{constructor(e,i,a){i===401&&Me(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ro=qr()?()=>self.worker&&self.worker.referrer:()=>(C.location.protocol==="blob:"?C.parent:C).location.href,To=function(r,e){if(!(/^file:/.test(i=r.url)||/^file:/.test(ro())&&!/^\w+:/.test(i))){if(C.fetch&&C.Request&&C.AbortController&&C.Request.prototype.hasOwnProperty("signal"))return function(a,u){const p=new C.AbortController,g=new C.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:ro(),referrerPolicy:a.referrerPolicy,signal:p.signal});let y=!1,w=!1;const E=(A=g.url).indexOf("sku=")>0&&Me(A);var A;a.type==="json"&&g.headers.set("Accept","application/json");const M=(L,R,G)=>{if(w)return;if(L&&L.message!=="SecurityError"&&mn(L.toString()),R&&G)return D(R);const J=Date.now();C.fetch(g).then(oe=>{if(oe.ok){const pe=E?oe.clone():null;return D(oe,pe,J)}return u(new Ui(oe.statusText,oe.status,a.url))}).catch(oe=>{oe.name!=="AbortError"&&u(new Error(`${oe.message} ${a.url}`))})},D=(L,R,G)=>{(a.type==="arrayBuffer"?L.arrayBuffer():a.type==="json"?L.json():L.text()).then(J=>{w||(R&&G&&function(oe,pe,se){if(no(),!xr)return;const he={status:pe.status,statusText:pe.statusText,headers:new C.Headers};pe.headers.forEach((Le,Pe)=>he.headers.set(Pe,Le));const ge=Ir(pe.headers.get("Cache-Control")||"");if(ge["no-store"])return;ge["max-age"]&&he.headers.set("Expires",new Date(se+1e3*ge["max-age"]).toUTCString());const me=he.headers.get("Expires");me&&(new Date(me).getTime()-se<42e4||function(Le,Pe){if(to===void 0)try{new Response(new ReadableStream),to=!0}catch{to=!1}to?Pe(Le.body):Le.blob().then(Pe)}(pe,Le=>{const Pe=new C.Response(Le,he);no(),xr&&xr.then($e=>$e.put(di(oe.url),Pe)).catch($e=>mn($e.message))}))}(g,R,G),y=!0,u(null,J,L.headers.get("Cache-Control"),L.headers.get("Expires")))}).catch(J=>{w||u(new Error(J.message))})};return E?function(L,R){if(no(),!xr)return R(null);const G=di(L.url);xr.then(J=>{J.match(G).then(oe=>{const pe=function(se){if(!se)return!1;const he=new Date(se.headers.get("Expires")||0),ge=Ir(se.headers.get("Cache-Control")||"");return he>Date.now()&&!ge["no-cache"]}(oe);J.delete(G),pe&&J.put(G,oe.clone()),R(null,oe,pe)}).catch(R)}).catch(R)}(g,M):M(null,null),{cancel:()=>{w=!0,y||p.abort()}}}(r,e);if(qr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var i;return function(a,u){const p=new C.XMLHttpRequest;p.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const g in a.headers)p.setRequestHeader(g,a.headers[g]);return a.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=a.credentials==="include",p.onerror=()=>{u(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let g=p.response;if(a.type==="json")try{g=JSON.parse(p.response)}catch(y){return u(y)}u(null,g,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else u(new Ui(p.statusText,p.status,a.url))},p.send(a.body),{cancel:()=>p.abort()}}(r,e)},ns=function(r,e){return To(et(r,{type:"arrayBuffer"}),e)};function Ts(r){const e=C.document.createElement("a");return e.href=r,e.protocol===C.document.location.protocol&&e.host===C.document.location.host}const de="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $,H;$=[],H=0;const ce=function(r,e){if(F.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),H>=U.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return $.push(p),p}H++;let i=!1;const a=()=>{if(!i)for(i=!0,H--;$.length&&H<U.MAX_PARALLEL_IMAGE_REQUESTS;){const p=$.shift(),{requestParameters:g,callback:y,cancelled:w}=p;w||(p.cancel=ce(g,y).cancel)}},u=ns(r,(p,g,y,w)=>{a(),p?e(p):g&&(C.createImageBitmap?function(E,A){const M=new C.Blob([new Uint8Array(E)],{type:"image/png"});C.createImageBitmap(M).then(D=>{A(null,D)}).catch(D=>{A(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(E,A)=>e(E,A,y,w)):function(E,A){const M=new C.Image,D=C.URL;M.onload=()=>{A(null,M),D.revokeObjectURL(M.src),M.onload=null,C.requestAnimationFrame(()=>{M.src=de})},M.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new C.Blob([new Uint8Array(E)],{type:"image/png"});M.src=E.byteLength?D.createObjectURL(L):de}(g,(E,A)=>e(E,A,y,w)))});return{cancel:()=>{u.cancel(),a()}}},_e="NO_ACCESS_TOKEN";function Ee(r){return r.indexOf("mapbox:")===0}function Me(r){return U.API_URL_REGEX.test(r)}function ke(r){return U.API_CDN_URL_REGEX.test(r)}function be(r){return U.API_STYLE_REGEX.test(r)&&!Re(r)}function Re(r){return U.API_SPRITE_REGEX.test(r)}const ct=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function dt(r){const e=r.match(ct);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function st(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}const Pt="mapbox.eventData";function Lt(r){if(!r)return null;const e=r.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(C.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Nt{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Lt(U.ACCESS_TOKEN);let a="";return a=i&&i.u?C.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(u,p)=>String.fromCharCode(+("0x"+p)))):U.ACCESS_TOKEN||"",e?`${Pt}.${e}:${a}`:`${Pt}:${a}`}fetchEventData(){const e=yr("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const u=C.localStorage.getItem(i);u&&(this.eventData=JSON.parse(u));const p=C.localStorage.getItem(a);p&&(this.anonId=p)}catch{mn("Unable to read from LocalStorage")}}saveEventData(){const e=yr("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{C.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&C.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{mn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,a,u){if(!U.EVENTS_URL)return;const p=dt(U.EVENTS_URL);p.params.push(`access_token=${u||U.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(e).toISOString()},y=i?et(g,i):g,w={url:st(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=function(E,A){return To(et(E,{method:"POST"}),A)}(w,E=>{this.pendingRequest=null,a(E),this.saveEventData(),this.processRequests(u)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const Zt=new class extends Nt{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){U.EVENTS_URL&&U.ACCESS_TOKEN&&Array.isArray(r)&&r.some(i=>Ee(i)||Me(i))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Lt(U.ACCESS_TOKEN),i=e?e.u:U.ACCESS_TOKEN;let a=i!==this.eventData.tokenU;Ht(this.anonId)||(this.anonId=Wt(),a=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),g=new Date(u),y=(u-this.eventData.lastSuccess)/864e5;a=a||y>=1||y<-1||p.getDate()!==g.getDate()}else a=!0;a?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:k,skuId:O,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=u,this.eventData.tokenU=i)},r):this.processRequests()}},en=Zt.postTurnstileEvent.bind(Zt),Nn=new class extends Nt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,i,a){this.skuToken=e,this.errorCb=a,U.EVENTS_URL&&(i||U.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(_e)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Ht(this.anonId)||(this.anonId=Wt()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:k,skuId:O,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},r))}},Qn=Nn.postMapLoadEvent.bind(Nn),Rr=new class extends Nt{constructor(){super("gljs.performance")}postPerformanceEvent(r,e){U.EVENTS_URL&&(r||U.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:i}=this.queue.shift(),a=function(u){const p=C.performance.getEntriesByType("resource"),g=C.performance.getEntriesByType("mark"),y=function(D){const L={};if(D){for(const R in D)if(R!=="other")for(const G of D[R]){const J=`${R}ResolveRangeMin`,oe=`${R}ResolveRangeMax`,pe=`${R}RequestCount`,se=`${R}RequestCachedCount`;L[J]=Math.min(L[J]||1/0,G.startTime),L[oe]=Math.max(L[oe]||-1/0,G.responseEnd);const he=ge=>{L[ge]===void 0&&(L[ge]=0),++L[ge]};G.transferSize!==void 0&&G.transferSize===0&&he(se),he(pe)}}return L}(function(D,L){const R={};if(D)for(const G of D){const J=L(G);R[J]===void 0&&(R[J]=[]),R[J].push(G)}return R}(p,Ep)),w=C.devicePixelRatio,E=C.navigator.connection||C.navigator.mozConnection||C.navigator.webkitConnection,A={counters:[],metadata:[],attributes:[]},M=(D,L,R)=>{R!=null&&D.push({name:L,value:R.toString()})};for(const D in y)M(A.counters,D,y[D]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(M(A.counters,"interactionRangeMin",u.interactionRange[0]),M(A.counters,"interactionRangeMax",u.interactionRange[1])),g)for(const D of Object.keys(ta)){const L=ta[D],R=g.find(G=>G.name===L);R&&M(A.counters,L,R.startTime)}return M(A.counters,"visibilityHidden",u.visibilityHidden),M(A.attributes,"style",function(D){if(D)for(const L of D){const R=L.name.split("?")[0];if(be(R)){const G=R.split("/").slice(-2);if(G.length===2)return`mapbox://styles/${G[0]}/${G[1]}`}}}(p)),M(A.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),M(A.attributes,"fogEnabled",u.fogEnabled?"true":"false"),M(A.attributes,"projection",u.projection),M(A.attributes,"zoom",u.zoom),M(A.metadata,"devicePixelRatio",w),M(A.metadata,"connectionEffectiveType",E?E.effectiveType:void 0),M(A.metadata,"navigatorUserAgent",C.navigator.userAgent),M(A.metadata,"screenWidth",C.screen.width),M(A.metadata,"screenHeight",C.screen.height),M(A.metadata,"windowWidth",C.innerWidth),M(A.metadata,"windowHeight",C.innerHeight),M(A.metadata,"mapWidth",u.width/w),M(A.metadata,"mapHeight",u.height/w),M(A.metadata,"webglRenderer",u.renderer),M(A.metadata,"webglVendor",u.vendor),M(A.metadata,"sdkVersion",k),M(A.metadata,"sdkIdentifier","mapbox-gl-js"),A}(i);for(const u of a.metadata);for(const u of a.counters);for(const u of a.attributes);this.postEvent(e,a,()=>{},r)}},hr=Rr.postPerformanceEvent.bind(Rr),io=new class extends Nt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,i,a){if(!U.API_URL||!U.SESSION_PATH)return;const u=dt(U.API_URL+U.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${a||U.ACCESS_TOKEN||""}`);const p={url:st(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(g,y){return To(et(g,{method:"GET"}),y)}(p,g=>{this.pendingRequest=null,i(g),this.saveEventData(),this.processRequests(a)})}getSessionAPI(r,e,i,a){this.skuToken=e,this.errorCb=a,U.SESSION_PATH&&U.API_URL&&(i||U.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(_e)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},r)}},vr=io.getSessionAPI.bind(io),$r=new Set,ta={create:"create",load:"load",fullLoad:"fullLoad"},Zm={mark(r){C.performance.mark(r)},measure(r,e,i){C.performance.measure(r,e,i)}};function Ep(r){const e=r.name.split("?")[0];return ke(e)&&e.includes("mapbox-gl.js")?"javascript":ke(e)&&e.includes("mapbox-gl.css")?"css":function(i){return U.API_FONTS_REGEX.test(i)}(e)?"fontRange":Re(e)?"sprite":be(e)?"style":function(i){return U.API_TILEJSON_REGEX.test(i)}(e)?"tilejson":"other"}const pn=C.performance;function Hu(r){const e=r?r.url.toString():void 0;return pn.getEntriesByName(e)}let nl,Zu,hc,oo;const So={now:()=>hc!==void 0?hc:C.performance.now(),setNow(r){hc=r},restoreNow(){hc=void 0},frame(r){const e=C.requestAnimationFrame(r);return{cancel:()=>C.cancelAnimationFrame(e)}},getImageData(r,e=0){const{width:i,height:a}=r;oo||(oo=C.document.createElement("canvas"));const u=oo.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(i>oo.width||a>oo.height)&&(oo.width=i,oo.height=a),u.clearRect(-e,-e,i+2*e,a+2*e),u.drawImage(r,0,0,i,a),u.getImageData(-e,-e,i+2*e,a+2*e)},resolveURL:r=>(nl||(nl=C.document.createElement("a")),nl.href=r,nl.href),get devicePixelRatio(){return C.devicePixelRatio},get prefersReducedMotion(){return!!C.matchMedia&&(Zu==null&&(Zu=C.matchMedia("(prefers-reduced-motion: reduce)")),Zu.matches)}};function Xu(r,e,i){i[r]&&i[r].indexOf(e)!==-1||(i[r]=i[r]||[],i[r].push(e))}function Ku(r,e,i){if(i&&i[r]){const a=i[r].indexOf(e);a!==-1&&i[r].splice(a,1)}}class Ss{constructor(e,i={}){et(this,i),this.type=e}}class Co extends Ss{constructor(e,i={}){super("error",et({error:e},i))}}class rl{on(e,i){return this._listeners=this._listeners||{},Xu(e,i,this._listeners),this}off(e,i){return Ku(e,i,this._listeners),Ku(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Xu(e,i,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,i){typeof e=="string"&&(e=new Ss(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const u=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const y of u)y.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const y of p)Ku(a,y,this._oneTimeListeners),y.call(this,e);const g=this._eventedParent;g&&(et(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof Co&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var qe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ao(r,...e){for(const i of e)for(const a in i)r[a]=i[a];return r}function er(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function wr(r){if(Array.isArray(r))return r.map(wr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const i in r)e[i]=wr(r[i]);return e}return er(r)}class Tp extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var so=Tp;class Yu{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,u]of i)this.bindings[a]=u}concat(e){return new Yu(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Sp=Yu;const na={kind:"null"},yt={kind:"number"},Qt={kind:"string"},Kt={kind:"boolean"},pi={kind:"color"},ji={kind:"object"},Yt={kind:"value"},fi={kind:"collator"},il={kind:"formatted"},Cs={kind:"resolvedImage"};function vi(r,e){return{kind:"array",itemType:r,N:e}}function Rn(r){if(r.kind==="array"){const e=Rn(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Cp=[na,yt,Qt,Kt,pi,il,ji,vi(Yt),Cs];function Io(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Io(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const i of Cp)if(!Io(i,e))return null}}return`Expected ${Rn(r)} but found ${Rn(e)} instead.`}function ol(r,e){return e.some(i=>i.kind===r.kind)}function sl(r,e){return e.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}var Ju,Ap={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function al(r){return(r=Math.round(r))<0?0:r>255?255:r}function ll(r){return al(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function dc(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function ra(r,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(e-r)*i*6:2*i<1?e:3*i<2?r+(e-r)*(2/3-i)*6:r}try{Ju={}.parseCSSColor=function(r){var e,i=r.replace(/ /g,"").toLowerCase();if(i in Ap)return Ap[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=i.indexOf("("),u=i.indexOf(")");if(a!==-1&&u+1===i.length){var p=i.substr(0,a),g=i.substr(a+1,u-(a+1)).split(","),y=1;switch(p){case"rgba":if(g.length!==4)return null;y=dc(g.pop());case"rgb":return g.length!==3?null:[ll(g[0]),ll(g[1]),ll(g[2]),y];case"hsla":if(g.length!==4)return null;y=dc(g.pop());case"hsl":if(g.length!==3)return null;var w=(parseFloat(g[0])%360+360)%360/360,E=dc(g[1]),A=dc(g[2]),M=A<=.5?A*(E+1):A+E-A*E,D=2*A-M;return[al(255*ra(D,M,w+1/3)),al(255*ra(D,M,w)),al(255*ra(D,M,w-1/3)),y];default:return null}}return null}}catch{}class Jr{constructor(e,i,a,u=1){this.r=e,this.g=i,this.b=a,this.a=u}static parse(e){if(!e)return;if(e instanceof Jr)return e;if(typeof e!="string")return;const i=Ju(e);return i?new Jr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${u})`}toArray(){const{r:e,g:i,b:a,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*i/u,255*a/u,u]}toArray01(){const{r:e,g:i,b:a,a:u}=this;return u===0?[0,0,0,0]:[e/u,i/u,a/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:a,a:u}=this;return[e,i,a,u]}}Jr.black=new Jr(0,0,0,1),Jr.white=new Jr(1,1,1,1),Jr.transparent=new Jr(0,0,0,0),Jr.red=new Jr(1,0,0,1),Jr.blue=new Jr(0,0,1,1);var Kn=Jr;class Qu{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class eh{constructor(e,i,a,u,p){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=a,this.fontStack=u,this.textColor=p}}class Qr{constructor(e){this.sections=e}static fromString(e){return new Qr([new eh(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Qr?e:Qr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const a={};i.fontStack&&(a["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(a["font-scale"]=i.scale),i.textColor&&(a["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(a)}return e}}class wi{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new wi({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ip(r,e,i,a){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,e,i,a]:[r,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function cl(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Kn||r instanceof Qu||r instanceof Qr||r instanceof wi)return!0;if(Array.isArray(r)){for(const e of r)if(!cl(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!cl(r[e]))return!1;return!0}return!1}function $n(r){if(r===null)return na;if(typeof r=="string")return Qt;if(typeof r=="boolean")return Kt;if(typeof r=="number")return yt;if(r instanceof Kn)return pi;if(r instanceof Qu)return fi;if(r instanceof Qr)return il;if(r instanceof wi)return Cs;if(Array.isArray(r)){const e=r.length;let i;for(const a of r){const u=$n(a);if(i){if(i===u)continue;i=Yt;break}i=u}return vi(i||Yt,e)}return ji}function ul(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof Kn||r instanceof Qr||r instanceof wi?r.toString():JSON.stringify(r)}class th{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!cl(e[1]))return i.error("invalid value");const a=e[1];let u=$n(a);const p=i.expectedType;return u.kind!=="array"||u.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(u=p),new th(u,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Kn?["rgba"].concat(this.value.toArray()):this.value instanceof Qr?this.value.serialize():this.value}}var As=th,Mr=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const nh={string:Qt,number:yt,boolean:Kt,object:ji};class rh{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,u=1;const p=e[0];if(p==="array"){let y,w;if(e.length>2){const E=e[1];if(typeof E!="string"||!(E in nh)||E==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);y=nh[E],u++}else y=Yt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);w=e[2],u++}a=vi(y,w)}else a=nh[p];const g=[];for(;u<e.length;u++){const y=i.parse(e[u],u,Yt);if(!y)return null;g.push(y)}return new rh(a,g)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!Io(this.type,$n(a)))return a;if(i===this.args.length-1)throw new Mr(`Expected value to be of type ${Rn(this.type)}, but found ${Rn($n(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){i.push(a.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&i.push(u)}}return i.concat(this.args.map(a=>a.serialize()))}}var ko=rh;class rs{constructor(e){this.type=il,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return i.error("First argument must be an image or text section.");const u=[];let p=!1;for(let g=1;g<=e.length-1;++g){const y=e[g];if(p&&typeof y=="object"&&!Array.isArray(y)){p=!1;let w=null;if(y["font-scale"]&&(w=i.parse(y["font-scale"],1,yt),!w))return null;let E=null;if(y["text-font"]&&(E=i.parse(y["text-font"],1,vi(Qt)),!E))return null;let A=null;if(y["text-color"]&&(A=i.parse(y["text-color"],1,pi),!A))return null;const M=u[u.length-1];M.scale=w,M.font=E,M.textColor=A}else{const w=i.parse(e[g],1,Yt);if(!w)return null;const E=w.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,u.push({content:w,scale:null,font:null,textColor:null})}}return new rs(u)}evaluate(e){return new Qr(this.sections.map(i=>{const a=i.content.evaluate(e);return $n(a)===Cs?new eh("",a,null,null,null):new eh(ul(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const a={};i.scale&&(a["font-scale"]=i.scale.serialize()),i.font&&(a["text-font"]=i.font.serialize()),i.textColor&&(a["text-color"]=i.textColor.serialize()),e.push(a)}return e}}class pc{constructor(e){this.type=Cs,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Qt);return a?new pc(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=wi.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Xm={"to-boolean":Kt,"to-color":pi,"to-number":yt,"to-string":Qt};class ih{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return i.error("Expected one argument.");const u=Xm[a],p=[];for(let g=1;g<e.length;g++){const y=i.parse(e[g],g,Yt);if(!y)return null;p.push(y)}return new ih(u,p)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let i,a;for(const u of this.args){if(i=u.evaluate(e),a=null,i instanceof Kn)return i;if(typeof i=="string"){const p=e.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Ip(i[0],i[1],i[2],i[3]),!a))return new Kn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Mr(a||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const a of this.args){if(i=a.evaluate(e),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Mr(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Qr.fromString(ul(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?wi.fromString(ul(this.args[0].evaluate(e))):ul(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new rs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new pc(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var ia=ih;const ao=["Unknown","Point","LineString","Polygon"];var oh=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ao[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-r[0])+this.featureDistanceData.bearing[1]*(a*e-r[1])}return 0}parseColor(r){let e=this._parseColorCache[r];return e||(e=this._parseColorCache[r]=Kn.parse(r)),e}};class Is{constructor(e,i,a,u){this.name=e,this.type=i,this._evaluate=a,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const a=e[0],u=Is.definitions[a];if(!u)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(u)?u[0]:u.type,g=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=g.filter(([E])=>!Array.isArray(E)||E.length===e.length-1);let w=null;for(const[E,A]of y){w=new hh(i.registry,i.path,null,i.scope);const M=[];let D=!1;for(let L=1;L<e.length;L++){const R=e[L],G=Array.isArray(E)?E[L-1]:E.type,J=w.parse(R,1+M.length,G);if(!J){D=!0;break}M.push(J)}if(!D)if(Array.isArray(E)&&E.length!==M.length)w.error(`Expected ${E.length} arguments, but found ${M.length} instead.`);else{for(let L=0;L<M.length;L++){const R=Array.isArray(E)?E[L]:E.type,G=M[L];w.concat(L+1).checkSubtype(R,G.type)}if(w.errors.length===0)return new Is(a,p,A,M)}}if(y.length===1)i.errors.push(...w.errors);else{const E=(y.length?y:g).map(([M])=>{return D=M,Array.isArray(D)?`(${D.map(Rn).join(", ")})`:`(${Rn(D.type)}...)`;var D}).join(" | "),A=[];for(let M=1;M<e.length;M++){const D=i.parse(e[M],1+A.length);if(!D)return null;A.push(Rn(D.type))}i.error(`Expected arguments of type ${E}, but found (${A.join(", ")}) instead.`)}return null}static register(e,i){Is.definitions=i;for(const a in i)e[a]=Is}}var Mo=Is;class hl{constructor(e,i,a){this.type=fi,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return i.error("Collator options argument must be an object.");const u=i.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Kt);if(!u)return null;const p=i.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Kt);if(!p)return null;let g=null;return a.locale&&(g=i.parse(a.locale,1,Qt),!g)?null:new hl(u,p,g)}evaluate(e){return new Qu(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Do=8192;function fc(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function oa(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function dl(r,e){const i=(180+r[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*Do),Math.round(a*u*Do)]}function kp(r,e,i){const a=r[0]-e[0],u=r[1]-e[1],p=r[0]-i[0],g=r[1]-i[1];return a*g-p*u==0&&a*p<=0&&u*g<=0}function mc(r,e){let i=!1;for(let g=0,y=e.length;g<y;g++){const w=e[g];for(let E=0,A=w.length;E<A-1;E++){if(kp(r,w[E],w[E+1]))return!1;(u=w[E])[1]>(a=r)[1]!=(p=w[E+1])[1]>a[1]&&a[0]<(p[0]-u[0])*(a[1]-u[1])/(p[1]-u[1])+u[0]&&(i=!i)}}var a,u,p;return i}function sh(r,e){for(let i=0;i<e.length;i++)if(mc(r,e[i]))return!0;return!1}function ah(r,e,i,a){const u=a[0]-i[0],p=a[1]-i[1],g=(r[0]-i[0])*p-u*(r[1]-i[1]),y=(e[0]-i[0])*p-u*(e[1]-i[1]);return g>0&&y<0||g<0&&y>0}function sa(r,e,i){for(const E of i)for(let A=0;A<E.length-1;++A)if((y=[(g=E[A+1])[0]-(p=E[A])[0],g[1]-p[1]])[0]*(w=[(u=e)[0]-(a=r)[0],u[1]-a[1]])[1]-y[1]*w[0]!=0&&ah(a,u,p,g)&&ah(p,g,a,u))return!0;var a,u,p,g,y,w;return!1}function fn(r,e){for(let i=0;i<r.length;++i)if(!mc(r[i],e))return!1;for(let i=0;i<r.length-1;++i)if(sa(r[i],r[i+1],e))return!1;return!0}function Km(r,e){for(let i=0;i<e.length;i++)if(fn(r,e[i]))return!0;return!1}function lh(r,e,i){const a=[];for(let u=0;u<r.length;u++){const p=[];for(let g=0;g<r[u].length;g++){const y=dl(r[u][g],i);fc(e,y),p.push(y)}a.push(p)}return a}function Mp(r,e,i){const a=[];for(let u=0;u<r.length;u++){const p=lh(r[u],e,i);a.push(p)}return a}function ch(r,e,i,a){if(r[0]<i[0]||r[0]>i[2]){const u=.5*a;let p=r[0]-i[0]>u?-a:i[0]-r[0]>u?a:0;p===0&&(p=r[0]-i[2]>u?-a:i[2]-r[0]>u?a:0),r[0]+=p}fc(e,r)}function Dp(r,e,i,a){const u=Math.pow(2,a.z)*Do,p=[a.x*Do,a.y*Do],g=[];if(!r)return g;for(const y of r)for(const w of y){const E=[w.x+p[0],w.y+p[1]];ch(E,e,i,u),g.push(E)}return g}function uh(r,e,i,a){const u=Math.pow(2,a.z)*Do,p=[a.x*Do,a.y*Do],g=[];if(!r)return g;for(const w of r){const E=[];for(const A of w){const M=[A.x+p[0],A.y+p[1]];fc(e,M),E.push(M)}g.push(E)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const w of g)for(const E of w)ch(E,e,i,u)}var y;return g}class aa{constructor(e,i){this.type=Kt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(cl(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let u=0;u<a.features.length;++u){const p=a.features[u].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new aa(a,a.features[u].geometry)}else if(a.type==="Feature"){const u=a.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new aa(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new aa(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,a){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(!g)return!1;if(a.type==="Polygon"){const y=lh(a.coordinates,p,g),w=Dp(i.geometry(),u,p,g);if(!oa(u,p))return!1;for(const E of w)if(!mc(E,y))return!1}if(a.type==="MultiPolygon"){const y=Mp(a.coordinates,p,g),w=Dp(i.geometry(),u,p,g);if(!oa(u,p))return!1;for(const E of w)if(!sh(E,y))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,a){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(!g)return!1;if(a.type==="Polygon"){const y=lh(a.coordinates,p,g),w=uh(i.geometry(),u,p,g);if(!oa(u,p))return!1;for(const E of w)if(!fn(E,y))return!1}if(a.type==="MultiPolygon"){const y=Mp(a.coordinates,p,g),w=uh(i.geometry(),u,p,g);if(!oa(u,p))return!1;for(const E of w)if(!Km(E,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var gc=aa;function la(r){if(r instanceof Mo&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof gc)return!1;let e=!0;return r.eachChild(i=>{e&&!la(i)&&(e=!1)}),e}function Po(r){if(r instanceof Mo&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(i=>{e&&!Po(i)&&(e=!1)}),e}function ks(r,e){if(r instanceof Mo&&e.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(a=>{i&&!ks(a,e)&&(i=!1)}),i}class _c{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new _c(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Pp=_c;class pl{constructor(e,i=[],a,u=new Sp,p=[]){this.registry=e,this.path=i,this.key=i.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=p,this.expectedType=a}parse(e,i,a,u,p={}){return i?this.concat(i,a,u)._parse(e,p):this._parse(e,p)}_parse(e,i){function a(u,p,g){return g==="assert"?new ko(p,[u]):g==="coerce"?new ia(p,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[u];if(p){let g=p.parse(e,this);if(!g)return null;if(this.expectedType){const y=this.expectedType,w=g.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||w.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(y,w))return null}else g=a(g,y,i.typeAnnotation||"coerce");else g=a(g,y,i.typeAnnotation||"assert")}if(!(g instanceof As)&&g.type.kind!=="resolvedImage"&&dh(g)){const y=new oh;try{g=new As(g.type,g.evaluate(y))}catch(w){return this.error(w.message),null}}return g}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const u=typeof e=="number"?this.path.concat(e):this.path,p=a?this.scope.concat(a):this.scope;return new pl(this.registry,u,i||null,p,this.errors)}error(e,...i){const a=`${this.key}${i.map(u=>`[${u}]`).join("")}`;this.errors.push(new so(a,e))}checkSubtype(e,i){const a=Io(e,i);return a&&this.error(a),a}}var hh=pl;function dh(r){if(r instanceof Pp)return dh(r.boundExpression);if(r instanceof Mo&&r.name==="error"||r instanceof hl||r instanceof gc)return!1;const e=r instanceof ia||r instanceof ko;let i=!0;return r.eachChild(a=>{i=e?i&&dh(a):i&&a instanceof As}),!!i&&la(r)&&ks(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function yc(r,e){const i=r.length-1;let a,u,p=0,g=i,y=0;for(;p<=g;)if(y=Math.floor((p+g)/2),a=r[y],u=r[y+1],a<=e){if(y===i||e<u)return y;p=y+1}else{if(!(a>e))throw new Mr("Input is not a number.");g=y-1}return 0}class xc{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,p]of a)this.labels.push(u),this.outputs.push(p)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,yt);if(!a)return null;const u=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let g=1;g<e.length;g+=2){const y=g===1?-1/0:e[g],w=e[g+1],E=g,A=g+1;if(typeof y!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(u.length&&u[u.length-1][0]>=y)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const M=i.parse(w,A,p);if(!M)return null;p=p||M.type,u.push([y,M])}return new xc(p,a,u)}evaluate(e){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return a[0].evaluate(e);const p=i.length;return u>=i[p-1]?a[p-1].evaluate(e):a[yc(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var ph=xc;function rn(r,e,i){return r*(1-i)+e*i}var fl=Object.freeze({__proto__:null,array:function(r,e,i){return r.map((a,u)=>rn(a,e[u],i))},color:function(r,e,i){return new Kn(rn(r.r,e.r,i),rn(r.g,e.g,i),rn(r.b,e.b,i),rn(r.a,e.a,i))},number:rn});const zp=.95047,fh=1.08883,Bp=4/29,Ms=6/29,mh=3*Ms*Ms,Ym=Ms*Ms*Ms,Jm=Math.PI/180,Qm=180/Math.PI;function gh(r){return r>Ym?Math.pow(r,1/3):r/mh+Bp}function _h(r){return r>Ms?r*r*r:mh*(r-Bp)}function yh(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function vc(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Lp(r){const e=vc(r.r),i=vc(r.g),a=vc(r.b),u=gh((.4124564*e+.3575761*i+.1804375*a)/zp),p=gh((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*p-16,a:500*(u-p),b:200*(p-gh((.0193339*e+.119192*i+.9503041*a)/fh)),alpha:r.a}}function Rp(r){let e=(r.l+16)/116,i=isNaN(r.a)?e:e+r.a/500,a=isNaN(r.b)?e:e-r.b/200;return e=1*_h(e),i=zp*_h(i),a=fh*_h(a),new Kn(yh(3.2404542*i-1.5371385*e-.4985314*a),yh(-.969266*i+1.8760108*e+.041556*a),yh(.0556434*i-.2040259*e+1.0572252*a),r.alpha)}function eg(r,e,i){const a=e-r;return r+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const ml={forward:Lp,reverse:Rp,interpolate:function(r,e,i){return{l:rn(r.l,e.l,i),a:rn(r.a,e.a,i),b:rn(r.b,e.b,i),alpha:rn(r.alpha,e.alpha,i)}}},ca={forward:function(r){const{l:e,a:i,b:a}=Lp(r),u=Math.atan2(a,i)*Qm;return{h:u<0?u+360:u,c:Math.sqrt(i*i+a*a),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Jm,i=r.c;return Rp({l:r.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:r.alpha})},interpolate:function(r,e,i){return{h:eg(r.h,e.h,i),c:rn(r.c,e.c,i),l:rn(r.l,e.l,i),alpha:rn(r.alpha,e.alpha,i)}}};var xh=Object.freeze({__proto__:null,hcl:ca,lab:ml});class gl{constructor(e,i,a,u,p){this.type=e,this.operator=i,this.interpolation=a,this.input=u,this.labels=[],this.outputs=[];for(const[g,y]of p)this.labels.push(g),this.outputs.push(y)}static interpolationFactor(e,i,a,u){let p=0;if(e.name==="exponential")p=vh(i,e.base,a,u);else if(e.name==="linear")p=vh(i,1,a,u);else if(e.name==="cubic-bezier"){const g=e.controlPoints;p=new fe(g[0],g[1],g[2],g[3]).solve(vh(i,1,a,u))}return p}static parse(e,i){let[a,u,p,...g]=e;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const E=u[1];if(typeof E!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:E}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const E=u.slice(1);if(E.length!==4||E.some(A=>typeof A!="number"||A<0||A>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:E}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,yt),!p)return null;const y=[];let w=null;a==="interpolate-hcl"||a==="interpolate-lab"?w=pi:i.expectedType&&i.expectedType.kind!=="value"&&(w=i.expectedType);for(let E=0;E<g.length;E+=2){const A=g[E],M=g[E+1],D=E+3,L=E+4;if(typeof A!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(y.length&&y[y.length-1][0]>=A)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const R=i.parse(M,L,w);if(!R)return null;w=w||R.type,y.push([A,R])}return w.kind==="number"||w.kind==="color"||w.kind==="array"&&w.itemType.kind==="number"&&typeof w.N=="number"?new gl(w,a,u,p,y):i.error(`Type ${Rn(w)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return a[0].evaluate(e);const p=i.length;if(u>=i[p-1])return a[p-1].evaluate(e);const g=yc(i,u),y=gl.interpolationFactor(this.interpolation,u,i[g],i[g+1]),w=a[g].evaluate(e),E=a[g+1].evaluate(e);return this.operator==="interpolate"?fl[this.type.kind.toLowerCase()](w,E,y):this.operator==="interpolate-hcl"?ca.reverse(ca.interpolate(ca.forward(w),ca.forward(E),y)):ml.reverse(ml.interpolate(ml.forward(w),ml.forward(E),y))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)i.push(this.labels[a],this.outputs[a].serialize());return i}}function vh(r,e,i,a){const u=a-i,p=r-i;return u===0?0:e===1?p/u:(Math.pow(e,p)-1)/(Math.pow(e,u)-1)}var lo=gl;class wc{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const u=i.expectedType;u&&u.kind!=="value"&&(a=u);const p=[];for(const y of e.slice(1)){const w=i.parse(y,1+p.length,a,void 0,{typeAnnotation:"omit"});if(!w)return null;a=a||w.type,p.push(w)}const g=u&&p.some(y=>Io(u,y.type));return new wc(g?Yt:a,p)}evaluate(e){let i,a=null,u=0;for(const p of this.args){if(u++,a=p.evaluate(e),a&&a instanceof wi&&!a.available&&(i||(i=a),a=null,u===this.args.length))return i;if(a!==null)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var wh=wc;class bc{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let p=1;p<e.length-1;p+=2){const g=e[p];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,p);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const y=i.parse(e[p+1],p+1);if(!y)return null;a.push([g,y])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return u?new bc(a,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,a]of this.bindings)e.push(i,a.serialize());return e.push(this.result.serialize()),e}}var Fp=bc;class bh{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,yt),u=i.parse(e[2],2,vi(i.expectedType||Yt));return a&&u?new bh(u.type.itemType,a,u):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new Mr(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Mr(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Mr(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var tg=bh;class Eh{constructor(e,i){this.type=Kt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Yt),u=i.parse(e[2],2,Yt);return a&&u?ol(a.type,[Kt,Qt,yt,na,Yt])?new Eh(a,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(a==null)return!1;if(!sl(i,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${Rn($n(i))} instead.`);if(!sl(a,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${Rn($n(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ec=Eh;class _l{constructor(e,i,a){this.type=yt,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Yt),u=i.parse(e[2],2,Yt);if(!a||!u)return null;if(!ol(a.type,[Kt,Qt,yt,na,Yt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(a.type)} instead`);if(e.length===4){const p=i.parse(e[3],3,yt);return p?new _l(a,u,p):null}return new _l(a,u)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!sl(i,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${Rn($n(i))} instead.`);if(!sl(a,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${Rn($n(a))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return a.indexOf(i,u)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Op=_l;class Th{constructor(e,i,a,u,p,g){this.inputType=e,this.type=i,this.input=a,this.cases=u,this.outputs=p,this.otherwise=g}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const p={},g=[];for(let E=2;E<e.length-1;E+=2){let A=e[E];const M=e[E+1];Array.isArray(A)||(A=[A]);const D=i.concat(E);if(A.length===0)return D.error("Expected at least one branch label.");for(const R of A){if(typeof R!="number"&&typeof R!="string")return D.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return D.error("Numeric branch labels must be integer values.");if(a){if(D.checkSubtype(a,$n(R)))return null}else a=$n(R);if(p[String(R)]!==void 0)return D.error("Branch labels must be unique.");p[String(R)]=g.length}const L=i.parse(M,E,u);if(!L)return null;u=u||L.type,g.push(L)}const y=i.parse(e[1],1,Yt);if(!y)return null;const w=i.parse(e[e.length-1],e.length-1,u);return w?y.type.kind!=="value"&&i.concat(1).checkSubtype(a,y.type)?null:new Th(a,u,y,p,g,w):null}evaluate(e){const i=this.input.evaluate(e);return($n(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),a=[],u={};for(const g of i){const y=u[this.cases[g]];y===void 0?(u[this.cases[g]]=a.length,a.push([this.cases[g],[g]])):a[y][1].push(g)}const p=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,y]of a)e.push(y.length===1?p(y[0]):y.map(p)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}var ng=Th;class Sh{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&i.expectedType.kind!=="value"&&(a=i.expectedType);const u=[];for(let g=1;g<e.length-1;g+=2){const y=i.parse(e[g],g,Kt);if(!y)return null;const w=i.parse(e[g+1],g+1,a);if(!w)return null;u.push([y,w]),a=a||w.type}const p=i.parse(e[e.length-1],e.length-1,a);return p?new Sh(a,u,p):null}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Np=Sh;class yl{constructor(e,i,a,u){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Yt),u=i.parse(e[2],2,yt);if(!a||!u)return null;if(!ol(a.type,[vi(Yt),Qt,Yt]))return i.error(`Expected first argument to be of type array or string, but found ${Rn(a.type)} instead`);if(e.length===4){const p=i.parse(e[3],3,yt);return p?new yl(a.type,a,u,p):null}return new yl(a.type,a,u)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!sl(i,["string","array"]))throw new Mr(`Expected first argument to be of type array or string, but found ${Rn($n(i))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return i.slice(a,u)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Up=yl;function Tc(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function jp(r,e,i,a){return a.compare(e,i)===0}function ua(r,e,i){const a=r!=="=="&&r!=="!=";return class q4{constructor(p,g,y){this.type=Kt,this.lhs=p,this.rhs=g,this.collator=y,this.hasUntypedArgument=p.type.kind==="value"||g.type.kind==="value"}static parse(p,g){if(p.length!==3&&p.length!==4)return g.error("Expected two or three arguments.");const y=p[0];let w=g.parse(p[1],1,Yt);if(!w)return null;if(!Tc(y,w.type))return g.concat(1).error(`"${y}" comparisons are not supported for type '${Rn(w.type)}'.`);let E=g.parse(p[2],2,Yt);if(!E)return null;if(!Tc(y,E.type))return g.concat(2).error(`"${y}" comparisons are not supported for type '${Rn(E.type)}'.`);if(w.type.kind!==E.type.kind&&w.type.kind!=="value"&&E.type.kind!=="value")return g.error(`Cannot compare types '${Rn(w.type)}' and '${Rn(E.type)}'.`);a&&(w.type.kind==="value"&&E.type.kind!=="value"?w=new ko(E.type,[w]):w.type.kind!=="value"&&E.type.kind==="value"&&(E=new ko(w.type,[E])));let A=null;if(p.length===4){if(w.type.kind!=="string"&&E.type.kind!=="string"&&w.type.kind!=="value"&&E.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(A=g.parse(p[3],3,fi),!A)return null}return new q4(w,E,A)}evaluate(p){const g=this.lhs.evaluate(p),y=this.rhs.evaluate(p);if(a&&this.hasUntypedArgument){const w=$n(g),E=$n(y);if(w.kind!==E.kind||w.kind!=="string"&&w.kind!=="number")throw new Mr(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${w.kind}, ${E.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const w=$n(g),E=$n(y);if(w.kind!=="string"||E.kind!=="string")return e(p,g,y)}return this.collator?i(p,g,y,this.collator.evaluate(p)):e(p,g,y)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[r];return this.eachChild(g=>{p.push(g.serialize())}),p}}}const rg=ua("==",function(r,e,i){return e===i},jp),ig=ua("!=",function(r,e,i){return e!==i},function(r,e,i,a){return!jp(0,e,i,a)}),og=ua("<",function(r,e,i){return e<i},function(r,e,i,a){return a.compare(e,i)<0}),sg=ua(">",function(r,e,i){return e>i},function(r,e,i,a){return a.compare(e,i)>0}),ag=ua("<=",function(r,e,i){return e<=i},function(r,e,i,a){return a.compare(e,i)<=0}),Vp=ua(">=",function(r,e,i){return e>=i},function(r,e,i,a){return a.compare(e,i)>=0});class Sc{constructor(e,i,a,u,p,g){this.type=Qt,this.number=e,this.locale=i,this.currency=a,this.unit=u,this.minFractionDigits=p,this.maxFractionDigits=g}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const a=i.parse(e[1],1,yt);if(!a)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let p=null;if(u.locale&&(p=i.parse(u.locale,1,Qt),!p))return null;let g=null;if(u.currency&&(g=i.parse(u.currency,1,Qt),!g))return null;let y=null;if(u.unit&&(y=i.parse(u.unit,1,Qt),!y))return null;let w=null;if(u["min-fraction-digits"]&&(w=i.parse(u["min-fraction-digits"],1,yt),!w))return null;let E=null;return u["max-fraction-digits"]&&(E=i.parse(u["max-fraction-digits"],1,yt),!E)?null:new Sc(a,p,g,y,w,E)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class ha{constructor(e){this.type=yt,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Rn(a.type)} instead.`):new ha(a):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Mr(`Expected value to be of type string or array, but found ${Rn($n(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Gp={"==":rg,"!=":ig,">":sg,"<":og,">=":Vp,"<=":ag,array:ko,at:tg,boolean:ko,case:Np,coalesce:wh,collator:hl,format:rs,image:pc,in:Ec,"index-of":Op,interpolate:lo,"interpolate-hcl":lo,"interpolate-lab":lo,length:ha,let:Fp,literal:As,match:ng,number:ko,"number-format":Sc,object:ko,slice:Up,step:ph,string:ko,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,var:Pp,within:gc};function qp(r,[e,i,a,u]){e=e.evaluate(r),i=i.evaluate(r),a=a.evaluate(r);const p=u?u.evaluate(r):1,g=Ip(e,i,a,p);if(g)throw new Mr(g);return new Kn(e/255*p,i/255*p,a/255*p,p)}function zo(r,e){return r in e}function Cc(r,e){const i=e[r];return i===void 0?null:i}function bi(r){return{type:r}}Mo.register(Gp,{error:[{kind:"error"},[Qt],(r,[e])=>{throw new Mr(e.evaluate(r))}],typeof:[Qt,[Yt],(r,[e])=>Rn($n(e.evaluate(r)))],"to-rgba":[vi(yt,4),[pi],(r,[e])=>e.evaluate(r).toArray()],rgb:[pi,[yt,yt,yt],qp],rgba:[pi,[yt,yt,yt,yt],qp],has:{type:Kt,overloads:[[[Qt],(r,[e])=>zo(e.evaluate(r),r.properties())],[[Qt,ji],(r,[e,i])=>zo(e.evaluate(r),i.evaluate(r))]]},get:{type:Yt,overloads:[[[Qt],(r,[e])=>Cc(e.evaluate(r),r.properties())],[[Qt,ji],(r,[e,i])=>Cc(e.evaluate(r),i.evaluate(r))]]},"feature-state":[Yt,[Qt],(r,[e])=>Cc(e.evaluate(r),r.featureState||{})],properties:[ji,[],r=>r.properties()],"geometry-type":[Qt,[],r=>r.geometryType()],id:[Yt,[],r=>r.id()],zoom:[yt,[],r=>r.globals.zoom],pitch:[yt,[],r=>r.globals.pitch||0],"distance-from-center":[yt,[],r=>r.distanceFromCenter()],"heatmap-density":[yt,[],r=>r.globals.heatmapDensity||0],"line-progress":[yt,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[yt,[],r=>r.globals.skyRadialProgress||0],accumulated:[Yt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[yt,bi(yt),(r,e)=>{let i=0;for(const a of e)i+=a.evaluate(r);return i}],"*":[yt,bi(yt),(r,e)=>{let i=1;for(const a of e)i*=a.evaluate(r);return i}],"-":{type:yt,overloads:[[[yt,yt],(r,[e,i])=>e.evaluate(r)-i.evaluate(r)],[[yt],(r,[e])=>-e.evaluate(r)]]},"/":[yt,[yt,yt],(r,[e,i])=>e.evaluate(r)/i.evaluate(r)],"%":[yt,[yt,yt],(r,[e,i])=>e.evaluate(r)%i.evaluate(r)],ln2:[yt,[],()=>Math.LN2],pi:[yt,[],()=>Math.PI],e:[yt,[],()=>Math.E],"^":[yt,[yt,yt],(r,[e,i])=>Math.pow(e.evaluate(r),i.evaluate(r))],sqrt:[yt,[yt],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[yt,[yt],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[yt,[yt],(r,[e])=>Math.log(e.evaluate(r))],log2:[yt,[yt],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[yt,[yt],(r,[e])=>Math.sin(e.evaluate(r))],cos:[yt,[yt],(r,[e])=>Math.cos(e.evaluate(r))],tan:[yt,[yt],(r,[e])=>Math.tan(e.evaluate(r))],asin:[yt,[yt],(r,[e])=>Math.asin(e.evaluate(r))],acos:[yt,[yt],(r,[e])=>Math.acos(e.evaluate(r))],atan:[yt,[yt],(r,[e])=>Math.atan(e.evaluate(r))],min:[yt,bi(yt),(r,e)=>Math.min(...e.map(i=>i.evaluate(r)))],max:[yt,bi(yt),(r,e)=>Math.max(...e.map(i=>i.evaluate(r)))],abs:[yt,[yt],(r,[e])=>Math.abs(e.evaluate(r))],round:[yt,[yt],(r,[e])=>{const i=e.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[yt,[yt],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[yt,[yt],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Kt,[Qt,Yt],(r,[e,i])=>r.properties()[e.value]===i.value],"filter-id-==":[Kt,[Yt],(r,[e])=>r.id()===e.value],"filter-type-==":[Kt,[Qt],(r,[e])=>r.geometryType()===e.value],"filter-<":[Kt,[Qt,Yt],(r,[e,i])=>{const a=r.properties()[e.value],u=i.value;return typeof a==typeof u&&a<u}],"filter-id-<":[Kt,[Yt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[Kt,[Qt,Yt],(r,[e,i])=>{const a=r.properties()[e.value],u=i.value;return typeof a==typeof u&&a>u}],"filter-id->":[Kt,[Yt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[Kt,[Qt,Yt],(r,[e,i])=>{const a=r.properties()[e.value],u=i.value;return typeof a==typeof u&&a<=u}],"filter-id-<=":[Kt,[Yt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[Kt,[Qt,Yt],(r,[e,i])=>{const a=r.properties()[e.value],u=i.value;return typeof a==typeof u&&a>=u}],"filter-id->=":[Kt,[Yt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[Kt,[Yt],(r,[e])=>e.value in r.properties()],"filter-has-id":[Kt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Kt,[vi(Qt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Kt,[vi(Yt)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Kt,[Qt,vi(Yt)],(r,[e,i])=>i.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Kt,[Qt,vi(Yt)],(r,[e,i])=>function(a,u,p,g){for(;p<=g;){const y=p+g>>1;if(u[y]===a)return!0;u[y]>a?g=y-1:p=y+1}return!1}(r.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Kt,overloads:[[[Kt,Kt],(r,[e,i])=>e.evaluate(r)&&i.evaluate(r)],[bi(Kt),(r,e)=>{for(const i of e)if(!i.evaluate(r))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],(r,[e,i])=>e.evaluate(r)||i.evaluate(r)],[bi(Kt),(r,e)=>{for(const i of e)if(i.evaluate(r))return!0;return!1}]]},"!":[Kt,[Kt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Kt,[Qt],(r,[e])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(e.evaluate(r))}],upcase:[Qt,[Qt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Qt,[Qt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Qt,bi(Yt),(r,e)=>e.map(i=>ul(i.evaluate(r))).join("")],"resolved-locale":[Qt,[fi],(r,[e])=>e.evaluate(r).resolvedLocale()]});var xl=Gp;function $p(r){return{result:"success",value:r}}function Ds(r){return{result:"error",value:r}}function da(r){return r["property-type"]==="data-driven"}function Ac(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Ic(r){return!!r.expression&&r.expression.interpolated}function sn(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function vl(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Wp(r){return r}function kc(r,e){const i=e.type==="color",a=r.stops&&typeof r.stops[0][0]=="object",u=a||!(a||r.property!==void 0),p=r.type||(Ic(e)?"exponential":"interval");if(i&&((r=Ao({},r)).stops&&(r.stops=r.stops.map(E=>[E[0],Kn.parse(E[1])])),r.default=Kn.parse(r.default?r.default:e.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!xh[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let g,y,w;if(p==="exponential")g=Bo;else if(p==="interval")g=Mc;else if(p==="categorical"){g=Hp,y=Object.create(null);for(const E of r.stops)y[E[0]]=E[1];w=typeof r.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);g=Zp}if(a){const E={},A=[];for(let L=0;L<r.stops.length;L++){const R=r.stops[L],G=R[0].zoom;E[G]===void 0&&(E[G]={zoom:G,type:r.type,property:r.property,default:r.default,stops:[]},A.push(G)),E[G].stops.push([R[0].value,R[1]])}const M=[];for(const L of A)M.push([E[L].zoom,kc(E[L],e)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:lo.interpolationFactor.bind(void 0,D),zoomStops:M.map(L=>L[0]),evaluate:({zoom:L},R)=>Bo({stops:M,base:r.base},e,L).evaluate(L,R)}}if(u){const E=p==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:lo.interpolationFactor.bind(void 0,E),zoomStops:r.stops.map(A=>A[0]),evaluate:({zoom:A})=>g(r,e,A,y,w)}}return{kind:"source",evaluate(E,A){const M=A&&A.properties?A.properties[r.property]:void 0;return M===void 0?pa(r.default,e.default):g(r,e,M,y,w)}}}function pa(r,e,i){return r!==void 0?r:e!==void 0?e:i!==void 0?i:void 0}function Hp(r,e,i,a,u){return pa(typeof i===u?a[i]:void 0,r.default,e.default)}function Mc(r,e,i){if(sn(i)!=="number")return pa(r.default,e.default);const a=r.stops.length;if(a===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[a-1][0])return r.stops[a-1][1];const u=yc(r.stops.map(p=>p[0]),i);return r.stops[u][1]}function Bo(r,e,i){const a=r.base!==void 0?r.base:1;if(sn(i)!=="number")return pa(r.default,e.default);const u=r.stops.length;if(u===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[u-1][0])return r.stops[u-1][1];const p=yc(r.stops.map(A=>A[0]),i),g=function(A,M,D,L){const R=L-D,G=A-D;return R===0?0:M===1?G/R:(Math.pow(M,G)-1)/(Math.pow(M,R)-1)}(i,a,r.stops[p][0],r.stops[p+1][0]),y=r.stops[p][1],w=r.stops[p+1][1];let E=fl[e.type]||Wp;if(r.colorSpace&&r.colorSpace!=="rgb"){const A=xh[r.colorSpace];E=(M,D)=>A.reverse(A.interpolate(A.forward(M),A.forward(D),g))}return typeof y.evaluate=="function"?{evaluate(...A){const M=y.evaluate.apply(void 0,A),D=w.evaluate.apply(void 0,A);if(M!==void 0&&D!==void 0)return E(M,D,g)}}:E(y,w,g)}function Zp(r,e,i){return e.type==="color"?i=Kn.parse(i):e.type==="formatted"?i=Qr.fromString(i.toString()):e.type==="resolvedImage"?i=wi.fromString(i.toString()):sn(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),pa(i,r.default,e.default)}class Dc{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new oh,this._defaultValue=i?function(a){return a.type==="color"&&(vl(a.default)||Array.isArray(a.default))?new Kn(0,0,0,0):a.type==="color"?Kn.parse(a.default)||null:a.default===void 0?null:a.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,a,u,p,g,y,w){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=u||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,u,p,g,y,w){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=w||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Mr(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function fa(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in xl}function ma(r,e){const i=new hh(xl,[],e?function(u){const p={color:pi,string:Qt,number:yt,enum:Qt,boolean:Kt,formatted:il,resolvedImage:Cs};return u.type==="array"?vi(p[u.value]||Yt,u.length):p[u.type]}(e):void 0),a=i.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?$p(new Dc(a,e)):Ds(i.errors)}class Ch{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!Po(i.expression)}evaluateWithoutErrorHandling(e,i,a,u,p,g){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,u,p,g)}evaluate(e,i,a,u,p,g){return this._styleExpression.evaluate(e,i,a,u,p,g)}}class wl{constructor(e,i,a,u){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Po(i.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,i,a,u,p,g){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,u,p,g)}evaluate(e,i,a,u,p,g){return this._styleExpression.evaluate(e,i,a,u,p,g)}interpolationFactor(e,i,a){return this.interpolationType?lo.interpolationFactor(this.interpolationType,e,i,a):0}}function bl(r,e){if((r=ma(r,e)).result==="error")return r;const i=r.value.expression,a=la(i);if(!a&&!da(e))return Ds([new so("","data expressions not supported")]);const u=ks(i,["zoom","pitch","distance-from-center"]);if(!u&&!Ac(e))return Ds([new so("","zoom expressions not supported")]);const p=zc(i);return p||u?p instanceof so?Ds([p]):p instanceof lo&&!Ic(e)?Ds([new so("",'"interpolate" expressions cannot be used with this property')]):$p(p?new wl(a?"camera":"composite",r.value,p.labels,p instanceof lo?p.interpolation:void 0):new Ch(a?"constant":"source",r.value)):Ds([new so("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Pc{constructor(e,i){this._parameters=e,this._specification=i,Ao(this,kc(this._parameters,this._specification))}static deserialize(e){return new Pc(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function zc(r){let e=null;if(r instanceof Fp)e=zc(r.result);else if(r instanceof wh){for(const i of r.args)if(e=zc(i),e)break}else(r instanceof ph||r instanceof lo)&&r.input instanceof Mo&&r.input.name==="zoom"&&(e=r);return e instanceof so||r.eachChild(i=>{const a=zc(i);a instanceof so?e=a:!e&&a?e=new so("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new so("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class vt{constructor(e,i,a,u){this.message=(e?`${e}: `:"")+a,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}function Vi(r){const e=r.key,i=r.value,a=r.valueSpec||{},u=r.objectElementValidators||{},p=r.style,g=r.styleSpec;let y=[];const w=sn(i);if(w!=="object")return[new vt(e,i,`object expected, ${w} found`)];for(const E in i){const A=E.split(".")[0];let M;u[A]?M=u[A]:a[A]?M=Fr:u["*"]?M=u["*"]:a["*"]&&(M=Fr),M?y=y.concat(M({key:(e&&`${e}.`)+E,value:i[E],valueSpec:a[A]||a["*"],style:p,styleSpec:g,object:i,objectKey:E},i)):y.push(new vt(e,i[E],`unknown property "${E}"`))}for(const E in a)u[E]||a[E].required&&a[E].default===void 0&&i[E]===void 0&&y.push(new vt(e,i,`missing required property "${E}"`));return y}function Xp(r){const e=r.value,i=r.valueSpec,a=r.style,u=r.styleSpec,p=r.key,g=r.arrayElementValidator||Fr;if(sn(e)!=="array")return[new vt(p,e,`array expected, ${sn(e)} found`)];if(i.length&&e.length!==i.length)return[new vt(p,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new vt(p,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let y={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};u.$version<7&&(y.function=i.function),sn(i.value)==="object"&&(y=i.value);let w=[];for(let E=0;E<e.length;E++)w=w.concat(g({array:e,arrayIndex:E,value:e[E],valueSpec:y,style:a,styleSpec:u,key:`${p}[${E}]`}));return w}function El(r){const e=r.key,i=r.value,a=r.valueSpec;let u=sn(i);if(u==="number"&&i!=i&&(u="NaN"),u!=="number")return[new vt(e,i,`number expected, ${u} found`)];if("minimum"in a){let p=a.minimum;if(sn(a.minimum)==="array"&&(p=a.minimum[r.arrayIndex]),i<p)return[new vt(e,i,`${i} is less than the minimum value ${p}`)]}if("maximum"in a){let p=a.maximum;if(sn(a.maximum)==="array"&&(p=a.maximum[r.arrayIndex]),i>p)return[new vt(e,i,`${i} is greater than the maximum value ${p}`)]}return[]}function Tl(r){const e=r.valueSpec,i=er(r.value.type);let a,u,p,g={};const y=i!=="categorical"&&r.value.property===void 0,w=!y,E=sn(r.value.stops)==="array"&&sn(r.value.stops[0])==="array"&&sn(r.value.stops[0][0])==="object",A=Vi({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(L){if(i==="identity")return[new vt(L.key,L.value,'identity function may not have a "stops" property')];let R=[];const G=L.value;return R=R.concat(Xp({key:L.key,value:G,valueSpec:L.valueSpec,style:L.style,styleSpec:L.styleSpec,arrayElementValidator:M})),sn(G)==="array"&&G.length===0&&R.push(new vt(L.key,G,"array must have at least one stop")),R},default:function(L){return Fr({key:L.key,value:L.value,valueSpec:e,style:L.style,styleSpec:L.styleSpec})}}});return i==="identity"&&y&&A.push(new vt(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||A.push(new vt(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!Ic(r.valueSpec)&&A.push(new vt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(w&&!da(r.valueSpec)?A.push(new vt(r.key,r.value,"property functions not supported")):y&&!Ac(r.valueSpec)&&A.push(new vt(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!E||r.value.property!==void 0||A.push(new vt(r.key,r.value,'"property" property is required')),A;function M(L){let R=[];const G=L.value,J=L.key;if(sn(G)!=="array")return[new vt(J,G,`array expected, ${sn(G)} found`)];if(G.length!==2)return[new vt(J,G,`array length 2 expected, length ${G.length} found`)];if(E){if(sn(G[0])!=="object")return[new vt(J,G,`object expected, ${sn(G[0])} found`)];if(G[0].zoom===void 0)return[new vt(J,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new vt(J,G,"object stop key must have value")];const oe=er(G[0].zoom);if(typeof oe!="number")return[new vt(J,G[0].zoom,"stop zoom values must be numbers")];if(p&&p>oe)return[new vt(J,G[0].zoom,"stop zoom values must appear in ascending order")];oe!==p&&(p=oe,u=void 0,g={}),R=R.concat(Vi({key:`${J}[0]`,value:G[0],valueSpec:{zoom:{}},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{zoom:El,value:D}}))}else R=R.concat(D({key:`${J}[0]`,value:G[0],valueSpec:{},style:L.style,styleSpec:L.styleSpec},G));return fa(wr(G[1]))?R.concat([new vt(`${J}[1]`,G[1],"expressions are not allowed in function stops.")]):R.concat(Fr({key:`${J}[1]`,value:G[1],valueSpec:e,style:L.style,styleSpec:L.styleSpec}))}function D(L,R){const G=sn(L.value),J=er(L.value),oe=L.value!==null?L.value:R;if(a){if(G!==a)return[new vt(L.key,oe,`${G} stop domain type must match previous stop domain type ${a}`)]}else a=G;if(G!=="number"&&G!=="string"&&G!=="boolean"&&typeof J!="number"&&typeof J!="string"&&typeof J!="boolean")return[new vt(L.key,oe,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&i!=="categorical"){let pe=`number expected, ${G} found`;return da(e)&&i===void 0&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vt(L.key,oe,pe)]}return i!=="categorical"||G!=="number"||typeof J=="number"&&isFinite(J)&&Math.floor(J)===J?i!=="categorical"&&G==="number"&&typeof J=="number"&&typeof u=="number"&&u!==void 0&&J<u?[new vt(L.key,oe,"stop domain values must appear in ascending order")]:(u=J,i==="categorical"&&J in g?[new vt(L.key,oe,"stop domain values must be unique")]:(g[J]=!0,[])):[new vt(L.key,oe,`integer expected, found ${String(J)}`)]}}function br(r){const e=(r.expressionContext==="property"?bl:ma)(wr(r.value),r.valueSpec);if(e.result==="error")return e.value.map(a=>new vt(`${r.key}${a.key}`,r.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new vt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Po(i))return[new vt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return Sl(i,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ks(i,["zoom","feature-state"]))return[new vt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!la(i))return[new vt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Sl(r,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)i.delete(u);if(i.size===0)return[];const a=[];return r instanceof Mo&&i.has(r.name)?[new vt(e.key,e.value,`["${r.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(r.eachChild(u=>{a.push(...Sl(u,e))}),a)}function Bc(r){const e=r.key,i=r.value,a=r.valueSpec,u=[];return Array.isArray(a.values)?a.values.indexOf(er(i))===-1&&u.push(new vt(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(a.values).indexOf(er(i))===-1&&u.push(new vt(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Ah(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Ah(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Lc(r,e="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ah(r)||(r=_a(r));const i=r;let a=!0;try{a=function(E){if(!ga(E))return E;let A=wr(E);return Rc(A),A=Kp(A),A}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const u=qe[`filter_${e}`],p=ma(a,u);let g=null;if(p.result==="error")throw new Error(p.value.map(E=>`${E.key}: ${E.message}`).join(", "));g=(E,A,M)=>p.value.evaluate(E,A,{},M);let y=null,w=null;if(a!==i){const E=ma(i,u);if(E.result==="error")throw new Error(E.value.map(A=>`${A.key}: ${A.message}`).join(", "));y=(A,M,D,L,R)=>E.value.evaluate(A,M,{},D,void 0,void 0,L,R),w=!la(E.value.expression)}return{filter:g,dynamicFilter:y||void 0,needGeometry:Yp(a),needFeature:!!w}}function Kp(r){if(!Array.isArray(r))return r;const e=function(i){if(Ih.has(i[0])){for(let a=1;a<i.length;a++)if(ga(i[a]))return!0}return i}(r);return e===!0?e:e.map(i=>Kp(i))}function Rc(r){let e=!1;const i=[];if(r[0]==="case"){for(let a=1;a<r.length-1;a+=2)e=e||ga(r[a]),i.push(r[a+1]);i.push(r[r.length-1])}else if(r[0]==="match"){e=e||ga(r[1]);for(let a=2;a<r.length-1;a+=2)i.push(r[a+1]);i.push(r[r.length-1])}else if(r[0]==="step"){e=e||ga(r[1]);for(let a=1;a<r.length-1;a+=2)i.push(r[a+1])}e&&(r.length=0,r.push("any",...i));for(let a=1;a<r.length;a++)Rc(r[a])}function ga(r){if(!Array.isArray(r))return!1;if((e=r[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<r.length;i++)if(ga(r[i]))return!0;return!1}const Ih=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function lg(r,e){return r<e?-1:r>e?1:0}function Yp(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(Yp(r[e]))return!0;return!1}function _a(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?kh(r[1],r[2],"=="):e==="!="?Fc(kh(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?kh(r[1],r[2],e):e==="any"?(i=r.slice(1),["any"].concat(i.map(_a))):e==="all"?["all"].concat(r.slice(1).map(_a)):e==="none"?["all"].concat(r.slice(1).map(_a).map(Fc)):e==="in"?Mh(r[1],r.slice(2)):e==="!in"?Fc(Mh(r[1],r.slice(2))):e==="has"?Dh(r[1]):e==="!has"?Fc(Dh(r[1])):e!=="within"||r;var i}function kh(r,e,i){switch(r){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,r,e]}}function Mh(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",r,["literal",e.sort(lg)]]:["filter-in-small",r,["literal",e]]}}function Dh(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Fc(r){return["!",r]}function Cl(r){return Ah(wr(r.value))?br(Ao({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):Al(r)}function Al(r){const e=r.value,i=r.key;if(sn(e)!=="array")return[new vt(i,e,`array expected, ${sn(e)} found`)];const a=r.styleSpec;let u,p=[];if(e.length<1)return[new vt(i,e,"filter array must have at least 1 element")];switch(p=p.concat(Bc({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),er(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&er(e[1])==="$type"&&p.push(new vt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&p.push(new vt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=sn(e[1]),u!=="string"&&p.push(new vt(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let g=2;g<e.length;g++)u=sn(e[g]),er(e[1])==="$type"?p=p.concat(Bc({key:`${i}[${g}]`,value:e[g],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&p.push(new vt(`${i}[${g}]`,e[g],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)p=p.concat(Al({key:`${i}[${g}]`,value:e[g],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":u=sn(e[1]),e.length!==2?p.push(new vt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&p.push(new vt(`${i}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=sn(e[1]),e.length!==2?p.push(new vt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&p.push(new vt(`${i}[1]`,e[1],`object expected, ${u} found`))}return p}function Ph(r,e){const i=r.key,a=r.style,u=r.styleSpec,p=r.value,g=r.objectKey,y=u[`${e}_${r.layerType}`];if(!y)return[];const w=g.match(/^(.*)-transition$/);if(e==="paint"&&w&&y[w[1]]&&y[w[1]].transition)return Fr({key:i,value:p,valueSpec:u.transition,style:a,styleSpec:u});const E=r.valueSpec||y[g];if(!E)return[new vt(i,p,`unknown property "${g}"`)];let A;if(sn(p)==="string"&&da(E)&&!E.tokens&&(A=/^{([^}]+)}$/.exec(p))){const D=`\`{ "type": "identity", "property": ${A?JSON.stringify(A[1]):'"_"'} }\``;return[new vt(i,p,`"${g}" does not support interpolation syntax
Use an identity property function instead: ${D}.`)]}const M=[];return r.layerType==="symbol"&&(g==="text-field"&&a&&!a.glyphs&&M.push(new vt(i,p,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&vl(wr(p))&&er(p.type)==="identity"&&M.push(new vt(i,p,'"text-font" does not support identity functions'))),M.concat(Fr({key:r.key,value:p,valueSpec:E,style:a,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:g}))}function Jp(r){return Ph(r,"paint")}function zh(r){return Ph(r,"layout")}function Qp(r){let e=[];const i=r.value,a=r.key,u=r.style,p=r.styleSpec;i.type||i.ref||e.push(new vt(a,i,'either "type" or "ref" is required'));let g=er(i.type);const y=er(i.ref);if(i.id){const w=er(i.id);for(let E=0;E<r.arrayIndex;E++){const A=u.layers[E];er(A.id)===w&&e.push(new vt(a,i.id,`duplicate layer id "${i.id}", previously used at line ${A.id.__line__}`))}}if("ref"in i){let w;["type","source","source-layer","filter","layout"].forEach(E=>{E in i&&e.push(new vt(a,i[E],`"${E}" is prohibited for ref layers`))}),u.layers.forEach(E=>{er(E.id)===y&&(w=E)}),w?w.ref?e.push(new vt(a,i.ref,"ref cannot reference another ref layer")):g=er(w.type):typeof y=="string"&&e.push(new vt(a,i.ref,`ref layer "${y}" not found`))}else if(g!=="background"&&g!=="sky")if(i.source){const w=u.sources&&u.sources[i.source],E=w&&er(w.type);w?E==="vector"&&g==="raster"?e.push(new vt(a,i.source,`layer "${i.id}" requires a raster source`)):E==="raster"&&g!=="raster"?e.push(new vt(a,i.source,`layer "${i.id}" requires a vector source`)):E!=="vector"||i["source-layer"]?E==="raster-dem"&&g!=="hillshade"?e.push(new vt(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||E==="geojson"&&w.lineMetrics||e.push(new vt(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new vt(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new vt(a,i.source,`source "${i.source}" not found`))}else e.push(new vt(a,i,'missing required property "source"'));return e=e.concat(Vi({key:a,value:i,valueSpec:p.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Fr({key:`${a}.type`,value:i.type,valueSpec:p.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:w=>Cl(Ao({layerType:g},w)),layout:w=>Vi({layer:i,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":E=>zh(Ao({layerType:g},E))}}),paint:w=>Vi({layer:i,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":E=>Jp(Ao({layerType:g},E))}})}})),e}function is(r){const e=r.value,i=r.key,a=sn(e);return a!=="string"?[new vt(i,e,`string expected, ${a} found`)]:[]}const ef={promoteId:function({key:r,value:e}){if(sn(e)==="string")return is({key:r,value:e});{const i=[];for(const a in e)i.push(...is({key:`${r}.${a}`,value:e[a]}));return i}}};function tf(r){const e=r.value,i=r.key,a=r.styleSpec,u=r.style;if(!e.type)return[new vt(i,e,'"type" is required')];const p=er(e.type);let g;switch(p){case"vector":case"raster":case"raster-dem":return g=Vi({key:i,value:e,valueSpec:a[`source_${p.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:ef}),g;case"geojson":if(g=Vi({key:i,value:e,valueSpec:a.source_geojson,style:u,styleSpec:a,objectElementValidators:ef}),e.cluster)for(const y in e.clusterProperties){const[w,E]=e.clusterProperties[y],A=typeof w=="string"?[w,["accumulated"],["get",y]]:w;g.push(...br({key:`${i}.${y}.map`,value:E,expressionContext:"cluster-map"})),g.push(...br({key:`${i}.${y}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return g;case"video":return Vi({key:i,value:e,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return Vi({key:i,value:e,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return[new vt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bc({key:`${i}.type`,value:e.type,valueSpec:{values:cg(a)},style:u,styleSpec:a})}}function cg(r){return r.source.reduce((e,i)=>{const a=r[i];return a.type.type==="enum"&&(e=e.concat(Object.keys(a.type.values))),e},[])}function nf(r){const e=r.value,i=r.styleSpec,a=i.light,u=r.style;let p=[];const g=sn(e);if(e===void 0)return p;if(g!=="object")return p=p.concat([new vt("light",e,`object expected, ${g} found`)]),p;for(const y in e){const w=y.match(/^(.*)-transition$/);p=p.concat(w&&a[w[1]]&&a[w[1]].transition?Fr({key:y,value:e[y],valueSpec:i.transition,style:u,styleSpec:i}):a[y]?Fr({key:y,value:e[y],valueSpec:a[y],style:u,styleSpec:i}):[new vt(y,e[y],`unknown property "${y}"`)])}return p}function Bh(r){const e=r.value,i=r.key,a=r.style,u=r.styleSpec,p=u.terrain;let g=[];const y=sn(e);if(e===void 0)return g;if(y!=="object")return g=g.concat([new vt("terrain",e,`object expected, ${y} found`)]),g;for(const w in e){const E=w.match(/^(.*)-transition$/);g=g.concat(E&&p[E[1]]&&p[E[1]].transition?Fr({key:w,value:e[w],valueSpec:u.transition,style:a,styleSpec:u}):p[w]?Fr({key:w,value:e[w],valueSpec:p[w],style:a,styleSpec:u}):[new vt(w,e[w],`unknown property "${w}"`)])}if(e.source){const w=a.sources&&a.sources[e.source],E=w&&er(w.type);w?E!=="raster-dem"&&g.push(new vt(i,e.source,`terrain cannot be used with a source of type ${String(E)}, it only be used with a "raster-dem" source type`)):g.push(new vt(i,e.source,`source "${e.source}" not found`))}else g.push(new vt(i,e,'terrain is missing required property "source"'));return g}function rf(r){const e=r.value,i=r.style,a=r.styleSpec,u=a.fog;let p=[];const g=sn(e);if(e===void 0)return p;if(g!=="object")return p=p.concat([new vt("fog",e,`object expected, ${g} found`)]),p;for(const y in e){const w=y.match(/^(.*)-transition$/);p=p.concat(w&&u[w[1]]&&u[w[1]].transition?Fr({key:y,value:e[y],valueSpec:a.transition,style:i,styleSpec:a}):u[y]?Fr({key:y,value:e[y],valueSpec:u[y],style:i,styleSpec:a}):[new vt(y,e[y],`unknown property "${y}"`)])}return p}const of={"*":()=>[],array:Xp,boolean:function(r){const e=r.value,i=r.key,a=sn(e);return a!=="boolean"?[new vt(i,e,`boolean expected, ${a} found`)]:[]},number:El,color:function(r){const e=r.key,i=r.value,a=sn(i);return a!=="string"?[new vt(e,i,`color expected, ${a} found`)]:Ju(i)===null?[new vt(e,i,`color expected, "${i}" found`)]:[]},enum:Bc,filter:Cl,function:Tl,layer:Qp,object:Vi,source:tf,light:nf,terrain:Bh,fog:rf,string:is,formatted:function(r){return is(r).length===0?[]:br(r)},resolvedImage:function(r){return is(r).length===0?[]:br(r)},projection:function(r){const e=r.value,i=r.styleSpec,a=i.projection,u=r.style;let p=[];const g=sn(e);if(g==="object")for(const y in e)p=p.concat(Fr({key:y,value:e[y],valueSpec:a[y],style:u,styleSpec:i}));else g!=="string"&&(p=p.concat([new vt("projection",e,`object or string expected, ${g} found`)]));return p}};function Fr(r){const e=r.value,i=r.valueSpec,a=r.styleSpec;return i.expression&&vl(er(e))?Tl(r):i.expression&&fa(wr(e))?br(r):i.type&&of[i.type]?of[i.type](r):Vi(Ao({},r,{valueSpec:i.type?a[i.type]:i}))}function ug(r){const e=r.value,i=r.key,a=is(r);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new vt(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new vt(i,e,'"glyphs" url must include a "{range}" token'))),a}function sf(r,e=qe){return Ei(Fr({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:ug,"*":()=>[]}}))}const hg=r=>Ei(Jp(r)),dg=r=>Ei(zh(r));function Ei(r){return r.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function af(r,e){let i=!1;if(e&&e.length)for(const a of e)r.fire(new Co(new Error(a.message))),i=!0;return i}var pg=co,Gi=3;function co(r,e,i){var a=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var u=new Int32Array(this.arrayBuffer);r=u[0],this.d=(e=u[1])+2*(i=u[2]);for(var p=0;p<this.d*this.d;p++){var g=u[Gi+p],y=u[Gi+p+1];a.push(g===y?null:u.subarray(g,y))}var w=u[Gi+a.length+1];this.keys=u.subarray(u[Gi+a.length],w),this.bboxes=u.subarray(w),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var E=0;E<this.d*this.d;E++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=i,this.scale=e/r,this.uid=0;var A=i/e*r;this.min=-A,this.max=r+A}co.prototype.insert=function(r,e,i,a,u){this._forEachCell(e,i,a,u,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(u)},co.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},co.prototype._insertCell=function(r,e,i,a,u,p){this.cells[u].push(p)},co.prototype.query=function(r,e,i,a,u){var p=this.min,g=this.max;if(r<=p&&e<=p&&g<=i&&g<=a&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(r,e,i,a,this._queryCell,y,{},u),y},co.prototype._queryCell=function(r,e,i,a,u,p,g,y){var w=this.cells[u];if(w!==null)for(var E=this.keys,A=this.bboxes,M=0;M<w.length;M++){var D=w[M];if(g[D]===void 0){var L=4*D;(y?y(A[L+0],A[L+1],A[L+2],A[L+3]):r<=A[L+2]&&e<=A[L+3]&&i>=A[L+0]&&a>=A[L+1])?(g[D]=!0,p.push(E[D])):g[D]=!1}}},co.prototype._forEachCell=function(r,e,i,a,u,p,g,y){for(var w=this._convertToCellCoord(r),E=this._convertToCellCoord(e),A=this._convertToCellCoord(i),M=this._convertToCellCoord(a),D=w;D<=A;D++)for(var L=E;L<=M;L++){var R=this.d*L+D;if((!y||y(this._convertFromCellCoord(D),this._convertFromCellCoord(L),this._convertFromCellCoord(D+1),this._convertFromCellCoord(L+1)))&&u.call(this,r,e,i,a,R,p,g,y))return}},co.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},co.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},co.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=Gi+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var u=new Int32Array(e+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var p=e,g=0;g<r.length;g++){var y=r[g];u[Gi+g]=p,u.set(y,p),p+=y.length}return u[Gi+r.length]=p,u.set(this.keys,p),u[Gi+r.length+1]=p+=this.keys.length,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer};var Ps=V(pg);const Oc={};function wt(r,e,i={}){Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),Oc[e]={klass:r,omit:i.omit||[]}}wt(Object,"Object"),Ps.serialize=function(r,e){const i=r.toArrayBuffer();return e&&e.push(i),{buffer:i}},Ps.deserialize=function(r){return new Ps(r.buffer)},Object.defineProperty(Ps,"name",{value:"Grid"}),wt(Ps,"Grid"),wt(Kn,"Color"),wt(Error,"Error"),wt(Ui,"AJAXError"),wt(wi,"ResolvedImage"),wt(Pc,"StylePropertyFunction"),wt(Dc,"StyleExpression",{omit:["_evaluator"]}),wt(wl,"ZoomDependentExpression"),wt(Ch,"ZoomConstantExpression"),wt(Mo,"CompoundExpression",{omit:["_evaluate"]});for(const r in xl)Oc[xl[r]._classRegistryKey]||wt(xl[r],`Expression${r}`);function Lh(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Rh(r){return C.ImageBitmap&&r instanceof C.ImageBitmap}function ya(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(Lh(r)||Rh(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const i=r;return e&&e.push(i.buffer),i}if(r instanceof C.ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const a of r)i.push(ya(a,e));return i}if(typeof r=="object"){const i=r.constructor,a=i._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const u=i.serialize?i.serialize(r,e):{};if(!i.serialize){for(const p in r)r.hasOwnProperty(p)&&(Oc[a].omit.indexOf(p)>=0||(u[p]=ya(r[p],e)));r instanceof Error&&(u.message=r.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(u.$name=a),u}throw new Error("can't serialize object of type "+typeof r)}function zs(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||Lh(r)||Rh(r)||ArrayBuffer.isView(r)||r instanceof C.ImageData)return r;if(Array.isArray(r))return r.map(zs);if(typeof r=="object"){const e=r.$name||"Object",{klass:i}=Oc[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(r);const a=Object.create(i.prototype);for(const u of Object.keys(r))u!=="$name"&&(a[u]=zs(r[u]));return a}throw new Error("can't deserialize object of type "+typeof r)}const _t={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Fh(r){for(const e of r)if(Oh(e.charCodeAt(0)))return!0;return!1}function fg(r){for(const e of r)if(!lf(e.charCodeAt(0)))return!1;return!0}function lf(r){return!(_t.Arabic(r)||_t["Arabic Supplement"](r)||_t["Arabic Extended-A"](r)||_t["Arabic Presentation Forms-A"](r)||_t["Arabic Presentation Forms-B"](r))}function Oh(r){return!(r!==746&&r!==747&&(r<4352||!(_t["Bopomofo Extended"](r)||_t.Bopomofo(r)||_t["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||_t["CJK Compatibility Ideographs"](r)||_t["CJK Compatibility"](r)||_t["CJK Radicals Supplement"](r)||_t["CJK Strokes"](r)||!(!_t["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||_t["CJK Unified Ideographs Extension A"](r)||_t["CJK Unified Ideographs"](r)||_t["Enclosed CJK Letters and Months"](r)||_t["Hangul Compatibility Jamo"](r)||_t["Hangul Jamo Extended-A"](r)||_t["Hangul Jamo Extended-B"](r)||_t["Hangul Jamo"](r)||_t["Hangul Syllables"](r)||_t.Hiragana(r)||_t["Ideographic Description Characters"](r)||_t.Kanbun(r)||_t["Kangxi Radicals"](r)||_t["Katakana Phonetic Extensions"](r)||_t.Katakana(r)&&r!==12540||!(!_t["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!_t["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||_t["Unified Canadian Aboriginal Syllabics"](r)||_t["Unified Canadian Aboriginal Syllabics Extended"](r)||_t["Vertical Forms"](r)||_t["Yijing Hexagram Symbols"](r)||_t["Yi Syllables"](r)||_t["Yi Radicals"](r))))}function cf(r){return!(Oh(r)||function(e){return!!(_t["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||_t["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||_t["Letterlike Symbols"](e)||_t["Number Forms"](e)||_t["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||_t["Control Pictures"](e)&&e!==9251||_t["Optical Character Recognition"](e)||_t["Enclosed Alphanumerics"](e)||_t["Geometric Shapes"](e)||_t["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||_t["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||_t["CJK Symbols and Punctuation"](e)||_t.Katakana(e)||_t["Private Use Area"](e)||_t["CJK Compatibility Forms"](e)||_t["Small Form Variants"](e)||_t["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function uf(r){return r>=1424&&r<=2303||_t["Arabic Presentation Forms-A"](r)||_t["Arabic Presentation Forms-B"](r)}function mg(r,e){return!(!e&&uf(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||_t.Khmer(r))}function gg(r){for(const e of r)if(uf(e.charCodeAt(0)))return!0;return!1}const Nh="deferred",Uh="loading",jh="loaded";let xa=null,d="unavailable",o=null;const c=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(d="error"),xa&&xa(r)};function f(){_.fire(new Ss("pluginStateChange",{pluginStatus:d,pluginURL:o}))}const _=new rl,v=function(){return d},T=function(){if(d!==Nh||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");d=Uh,f(),o&&ns({url:o},r=>{r?c(r):(d=jh,f())})},S={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>d===jh||S.applyArabicShaping!=null,isLoading:()=>d===Uh,setState(r){d=r.pluginStatus,o=r.pluginURL},isParsed:()=>S.applyArabicShaping!=null&&S.processBidirectionalText!=null&&S.processStyledBidirectionalText!=null,getPluginURL:()=>o};class I{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,a){for(const u of i)if(!mg(u.charCodeAt(0),a))return!1;return!0}(e,S.isLoaded())}}class z{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,u){if(vl(a))return new Pc(a,u);if(fa(a)){const p=bl(a,u);if(p.result==="error")throw new Error(p.value.map(g=>`${g.key}: ${g.message}`).join(", "));return p.value}{let p=a;return typeof a=="string"&&u.type==="color"&&(p=Kn.parse(a)),{kind:"constant",evaluate:()=>p}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class P{constructor(e){this.property=e,this.value=new z(e,void 0)}transitioned(e,i){return new X(this.property,this.value,i,et({},e.transition,this.transition),e.now)}untransitioned(){return new X(this.property,this.value,null,{},0)}}class N{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return zn(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new P(this._values[e].property)),this._values[e].value=new z(this._values[e].property,i===null?void 0:zn(i))}getTransition(e){return zn(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new P(this._values[e].property)),this._values[e].transition=zn(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(e[i]=a);const u=this.getTransition(i);u!==void 0&&(e[`${i}-transition`]=u)}return e}transitioned(e,i){const a=new te(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].transitioned(e,i._values[u]);return a}untransitioned(){const e=new te(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class X{constructor(e,i,a,u,p){const g=u.delay||0,y=u.duration||0;p=p||0,this.property=e,this.value=i,this.begin=p+g,this.end=this.begin+y,e.specification.transition&&(u.delay||u.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const u=e.now||0,p=this.value.possiblyEvaluate(e,i,a),g=this.prior;if(g){if(u>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(u<this.begin)return g.possiblyEvaluate(e,i,a);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,i,a),p,kt(y))}}return p}}class te{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const u=new ie(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,i,a);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class re{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return zn(this._values[e].value)}setValue(e,i){this._values[e]=new z(this._values[e].property,i===null?void 0:zn(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const u=new ie(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,i,a);return u}}class ne{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,a,u){return this.property.evaluate(this.value,this.parameters,e,i,a,u)}}class ie{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class j{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,a){const u=fl[this.specification.type];return u?u(e,i,a):e}}class ee{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,u){return new ne(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},a,u)}:e.expression,i)}interpolate(e,i,a){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new ne(this,{kind:"constant",value:void 0},e.parameters);const u=fl[this.specification.type];return u?new ne(this,{kind:"constant",value:u(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,u,p,g){return e.kind==="constant"?e.value:e.evaluate(i,a,u,p,g)}}class ae{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,u){return!!e.expression.evaluate(i,null,{},a,u)}interpolate(){return!1}}class le{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new I(0,{});for(const a in e){const u=e[a];u.specification.overridable&&this.overridableProperties.push(a);const p=this.defaultPropertyValues[a]=new z(u,void 0),g=this.defaultTransitionablePropertyValues[a]=new P(u);this.defaultTransitioningPropertyValues[a]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=p.possiblyEvaluate(i)}}}function ye(r,e){return 256*(r=We(Math.floor(r),0,255))+We(Math.floor(e),0,255)}wt(ee,"DataDrivenProperty"),wt(j,"DataConstantProperty"),wt(ae,"ColorRampProperty");const ve={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xe{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ie{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ae(r,e=1){let i=0,a=0;return{members:r.map(u=>{const p=ve[u.type].BYTES_PER_ELEMENT,g=i=Be(i,Math.max(e,p)),y=u.components||1;return a=Math.max(a,p),i+=p*y,{name:u.name,type:u.type,components:y,offset:g}}),size:Be(i,Math.max(a,e)),alignment:e}}function Be(r,e){return Math.ceil(r/e)*e}class it extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=a,e}}it.prototype.bytesPerElement=4,wt(it,"StructArrayLayout2i4");class De extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const p=3*e;return this.int16[p+0]=i,this.int16[p+1]=a,this.int16[p+2]=u,e}}De.prototype.bytesPerElement=6,wt(De,"StructArrayLayout3i6");class Ze extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,a,u)}emplace(e,i,a,u,p){const g=4*e;return this.int16[g+0]=i,this.int16[g+1]=a,this.int16[g+2]=u,this.int16[g+3]=p,e}}Ze.prototype.bytesPerElement=8,wt(Ze,"StructArrayLayout4i8");class Fe extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,a,u,p,g,y)}emplace(e,i,a,u,p,g,y,w){const E=6*e,A=12*e,M=3*e;return this.int16[E+0]=i,this.int16[E+1]=a,this.uint8[A+4]=u,this.uint8[A+5]=p,this.uint8[A+6]=g,this.uint8[A+7]=y,this.float32[M+2]=w,e}}Fe.prototype.bytesPerElement=12,wt(Fe,"StructArrayLayout2i4ub1f12");class rt extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,a,u)}emplace(e,i,a,u,p){const g=4*e;return this.float32[g+0]=i,this.float32[g+1]=a,this.float32[g+2]=u,this.float32[g+3]=p,e}}rt.prototype.bytesPerElement=16,wt(rt,"StructArrayLayout4f16");class ze extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,u,p)}emplace(e,i,a,u,p,g){const y=6*e,w=3*e;return this.uint16[y+0]=i,this.uint16[y+1]=a,this.uint16[y+2]=u,this.uint16[y+3]=p,this.float32[w+2]=g,e}}ze.prototype.bytesPerElement=12,wt(ze,"StructArrayLayout4ui1f12");class He extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,a,u)}emplace(e,i,a,u,p){const g=4*e;return this.uint16[g+0]=i,this.uint16[g+1]=a,this.uint16[g+2]=u,this.uint16[g+3]=p,e}}He.prototype.bytesPerElement=8,wt(He,"StructArrayLayout4ui8");class at extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,a,u,p,g)}emplace(e,i,a,u,p,g,y){const w=6*e;return this.int16[w+0]=i,this.int16[w+1]=a,this.int16[w+2]=u,this.int16[w+3]=p,this.int16[w+4]=g,this.int16[w+5]=y,e}}at.prototype.bytesPerElement=12,wt(at,"StructArrayLayout6i12");class Qe extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g,y,w,E,A,M,D){const L=this.length;return this.resize(L+1),this.emplace(L,e,i,a,u,p,g,y,w,E,A,M,D)}emplace(e,i,a,u,p,g,y,w,E,A,M,D,L){const R=12*e;return this.int16[R+0]=i,this.int16[R+1]=a,this.int16[R+2]=u,this.int16[R+3]=p,this.uint16[R+4]=g,this.uint16[R+5]=y,this.uint16[R+6]=w,this.uint16[R+7]=E,this.int16[R+8]=A,this.int16[R+9]=M,this.int16[R+10]=D,this.int16[R+11]=L,e}}Qe.prototype.bytesPerElement=24,wt(Qe,"StructArrayLayout4i4ui4i24");class lt extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,a,u,p,g)}emplace(e,i,a,u,p,g,y){const w=10*e,E=5*e;return this.int16[w+0]=i,this.int16[w+1]=a,this.int16[w+2]=u,this.float32[E+2]=p,this.float32[E+3]=g,this.float32[E+4]=y,e}}lt.prototype.bytesPerElement=20,wt(lt,"StructArrayLayout3i3f20");class At extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}At.prototype.bytesPerElement=4,wt(At,"StructArrayLayout1ul4");class Ft extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g,y,w,E,A,M,D,L){const R=this.length;return this.resize(R+1),this.emplace(R,e,i,a,u,p,g,y,w,E,A,M,D,L)}emplace(e,i,a,u,p,g,y,w,E,A,M,D,L,R){const G=20*e,J=10*e;return this.int16[G+0]=i,this.int16[G+1]=a,this.int16[G+2]=u,this.int16[G+3]=p,this.int16[G+4]=g,this.float32[J+3]=y,this.float32[J+4]=w,this.float32[J+5]=E,this.float32[J+6]=A,this.int16[G+14]=M,this.uint32[J+8]=D,this.uint16[G+18]=L,this.uint16[G+19]=R,e}}Ft.prototype.bytesPerElement=40,wt(Ft,"StructArrayLayout5i4f1i1ul2ui40");class Et extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,a,u,p,g,y)}emplace(e,i,a,u,p,g,y,w){const E=8*e;return this.int16[E+0]=i,this.int16[E+1]=a,this.int16[E+2]=u,this.int16[E+4]=p,this.int16[E+5]=g,this.int16[E+6]=y,this.int16[E+7]=w,e}}Et.prototype.bytesPerElement=16,wt(Et,"StructArrayLayout3i2i2i16");class zt extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,u,p)}emplace(e,i,a,u,p,g){const y=4*e,w=8*e;return this.float32[y+0]=i,this.float32[y+1]=a,this.float32[y+2]=u,this.int16[w+6]=p,this.int16[w+7]=g,e}}zt.prototype.bytesPerElement=16,wt(zt,"StructArrayLayout2f1f2i16");class Jt extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,a,u)}emplace(e,i,a,u,p){const g=12*e,y=3*e;return this.uint8[g+0]=i,this.uint8[g+1]=a,this.float32[y+1]=u,this.float32[y+2]=p,e}}Jt.prototype.bytesPerElement=12,wt(Jt,"StructArrayLayout2ub2f12");class Xt extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const p=3*e;return this.float32[p+0]=i,this.float32[p+1]=a,this.float32[p+2]=u,e}}Xt.prototype.bytesPerElement=12,wt(Xt,"StructArrayLayout3f12");class Ct extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const p=3*e;return this.uint16[p+0]=i,this.uint16[p+1]=a,this.uint16[p+2]=u,e}}Ct.prototype.bytesPerElement=6,wt(Ct,"StructArrayLayout3ui6");class gn extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J,oe,pe,se,he,ge){const me=this.length;return this.resize(me+1),this.emplace(me,e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J,oe,pe,se,he,ge)}emplace(e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J,oe,pe,se,he,ge,me){const Le=30*e,Pe=15*e,$e=60*e;return this.int16[Le+0]=i,this.int16[Le+1]=a,this.int16[Le+2]=u,this.float32[Pe+2]=p,this.float32[Pe+3]=g,this.uint16[Le+8]=y,this.uint16[Le+9]=w,this.uint32[Pe+5]=E,this.uint32[Pe+6]=A,this.uint32[Pe+7]=M,this.uint16[Le+16]=D,this.uint16[Le+17]=L,this.uint16[Le+18]=R,this.float32[Pe+10]=G,this.float32[Pe+11]=J,this.uint8[$e+48]=oe,this.uint8[$e+49]=pe,this.uint8[$e+50]=se,this.uint32[Pe+13]=he,this.int16[Le+28]=ge,this.uint8[$e+58]=me,e}}gn.prototype.bytesPerElement=60,wt(gn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class vn extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J,oe,pe,se,he,ge,me,Le,Pe,$e,ot,Oe,Ke,Ye,nt){const ut=this.length;return this.resize(ut+1),this.emplace(ut,e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J,oe,pe,se,he,ge,me,Le,Pe,$e,ot,Oe,Ke,Ye,nt)}emplace(e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J,oe,pe,se,he,ge,me,Le,Pe,$e,ot,Oe,Ke,Ye,nt,ut){const Ge=38*e,mt=19*e;return this.int16[Ge+0]=i,this.int16[Ge+1]=a,this.int16[Ge+2]=u,this.float32[mt+2]=p,this.float32[mt+3]=g,this.int16[Ge+8]=y,this.int16[Ge+9]=w,this.int16[Ge+10]=E,this.int16[Ge+11]=A,this.int16[Ge+12]=M,this.int16[Ge+13]=D,this.uint16[Ge+14]=L,this.uint16[Ge+15]=R,this.uint16[Ge+16]=G,this.uint16[Ge+17]=J,this.uint16[Ge+18]=oe,this.uint16[Ge+19]=pe,this.uint16[Ge+20]=se,this.uint16[Ge+21]=he,this.uint16[Ge+22]=ge,this.uint16[Ge+23]=me,this.uint16[Ge+24]=Le,this.uint16[Ge+25]=Pe,this.uint16[Ge+26]=$e,this.uint16[Ge+27]=ot,this.uint16[Ge+28]=Oe,this.uint32[mt+15]=Ke,this.float32[mt+16]=Ye,this.float32[mt+17]=nt,this.float32[mt+18]=ut,e}}vn.prototype.bytesPerElement=76,wt(vn,"StructArrayLayout3i2f6i15ui1ul3f76");class wn extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}wn.prototype.bytesPerElement=4,wt(wn,"StructArrayLayout1f4");class bn extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,u,p)}emplace(e,i,a,u,p,g){const y=5*e;return this.float32[y+0]=i,this.float32[y+1]=a,this.float32[y+2]=u,this.float32[y+3]=p,this.float32[y+4]=g,e}}bn.prototype.bytesPerElement=20,wt(bn,"StructArrayLayout5f20");class Or extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,a,u)}emplace(e,i,a,u,p){const g=6*e;return this.uint32[3*e+0]=i,this.uint16[g+2]=a,this.uint16[g+3]=u,this.uint16[g+4]=p,e}}Or.prototype.bytesPerElement=12,wt(Or,"StructArrayLayout1ul3ui12");class Er extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=a,e}}Er.prototype.bytesPerElement=4,wt(Er,"StructArrayLayout2ui4");class Ti extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}Ti.prototype.bytesPerElement=2,wt(Ti,"StructArrayLayout1ui2");class uo extends Ie{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=a,e}}uo.prototype.bytesPerElement=8,wt(uo,"StructArrayLayout2f8");class Fn extends xe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Fn.prototype.size=40;class En extends Ft{get(e){return new Fn(this,e)}}wt(En,"CollisionBoxArray");class cn extends xe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}cn.prototype.size=60;class tr extends gn{get(e){return new cn(this,e)}}wt(tr,"PlacedSymbolArray");class Wr extends xe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Wr.prototype.size=76;class Bn extends vn{get(e){return new Wr(this,e)}}wt(Bn,"SymbolInstanceArray");class ei extends wn{getoffsetX(e){return this.float32[1*e+0]}}wt(ei,"GlyphOffsetArray");class Nc extends it{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}wt(Nc,"SymbolLineVertexArray");class Bs extends xe{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Bs.prototype.size=12;class Il extends Or{get(e){return new Bs(this,e)}}wt(Il,"FeatureIndexArray");class Lo extends Er{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}wt(Lo,"FillExtrusionCentroidArray");const os=Ae([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ls=Ae([{name:"a_dash",components:4,type:"Uint16"}]);var Uc={exports:{}},kl={exports:{}};kl.exports=function(r,e){var i,a,u,p,g,y,w,E;for(a=r.length-(i=3&r.length),u=e,g=3432918353,y=461845907,E=0;E<a;)w=255&r.charCodeAt(E)|(255&r.charCodeAt(++E))<<8|(255&r.charCodeAt(++E))<<16|(255&r.charCodeAt(++E))<<24,++E,u=27492+(65535&(p=5*(65535&(u=(u^=w=(65535&(w=(w=(65535&w)*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*y+(((w>>>16)*y&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(w=0,i){case 3:w^=(255&r.charCodeAt(E+2))<<16;case 2:w^=(255&r.charCodeAt(E+1))<<8;case 1:u^=w=(65535&(w=(w=(65535&(w^=255&r.charCodeAt(E)))*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*y+(((w>>>16)*y&65535)<<16)&4294967295}return u^=r.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0};var Vh=kl.exports,yv={exports:{}};yv.exports=function(r,e){for(var i,a=r.length,u=e^a,p=0;a>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(p)|(255&r.charCodeAt(++p))<<8|(255&r.charCodeAt(++p))<<16|(255&r.charCodeAt(++p))<<24))+((1540483477*(i>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++p;switch(a){case 3:u^=(255&r.charCodeAt(p+2))<<16;case 2:u^=(255&r.charCodeAt(p+1))<<8;case 1:u=1540483477*(65535&(u^=255&r.charCodeAt(p)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};var xv=Vh,Z4=yv.exports;Uc.exports=xv,Uc.exports.murmur3=xv,Uc.exports.murmur2=Z4;var _g=V(Uc.exports);class hf{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,u){this.ids.push(vv(e)),this.positions.push(i,a,u)}getPositions(e){const i=vv(e);let a=0,u=this.ids.length-1;for(;a<u;){const g=a+u>>1;this.ids[g]>=i?u=g:a=g+1}const p=[];for(;this.ids[a]===i;)p.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return p}static serialize(e,i){const a=new Float64Array(e.ids),u=new Uint32Array(e.positions);return yg(a,u,0,a.length-1),i&&i.push(a.buffer,u.buffer),{ids:a,positions:u}}static deserialize(e){const i=new hf;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function vv(r){const e=+r;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:_g(String(r))}function yg(r,e,i,a){for(;i<a;){const u=r[i+a>>1];let p=i-1,g=a+1;for(;;){do p++;while(r[p]<u);do g--;while(r[g]>u);if(p>=g)break;df(r,p,g),df(e,3*p,3*g),df(e,3*p+1,3*g+1),df(e,3*p+2,3*g+2)}g-i<a-g?(yg(r,e,i,g),i=g+1):(yg(r,e,g+1,a),a=g)}}function df(r,e,i){const a=r[e];r[e]=r[i],r[i]=a}wt(hf,"FeaturePositionMap");class Rs{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class pf extends Rs{constructor(e){super(e),this.current=0}set(e,i,a){this.fetchUniformLocation(e,i)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class wv extends Rs{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,a){this.fetchUniformLocation(e,i)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class bv extends Rs{constructor(e){super(e),this.current=Kn.transparent}set(e,i,a){this.fetchUniformLocation(e,i)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const X4=new Float32Array(16),K4=new Float32Array(9),Y4=new Float32Array(4);function xg(r){return[ye(255*r.r,255*r.g),ye(255*r.b,255*r.a)]}class Gh{constructor(e,i,a){this.value=e,this.uniformNames=i.map(u=>`u_${u}`),this.type=a}setUniform(e,i,a,u,p){i.set(e,p,u.constantOr(this.value))}getBinding(e,i){return this.type==="color"?new bv(e):new pf(e)}}class jc{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,a,u,p){const g=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;g&&i.set(e,p,g)}getBinding(e,i){return i==="u_pattern"||i==="u_dash"?new wv(e):new pf(e)}}class Fs{constructor(e,i,a,u){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,i,a,u,p,g){const y=this.paintVertexArray.length,w=this.expression.evaluate(new I(0),i,{},p,u,g);this.paintVertexArray.resize(e),this._setPaintValue(y,e,w)}updatePaintArray(e,i,a,u,p){const g=this.expression.evaluate({zoom:0},a,u,void 0,p);this._setPaintValue(e,i,g)}_setPaintValue(e,i,a){if(this.type==="color"){const u=xg(a);for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ro{constructor(e,i,a,u,p,g){this.expression=e,this.uniformNames=i.map(y=>`u_${y}_t`),this.type=a,this.useIntegerZoom=u,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map(y=>({name:`a_${y}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,i,a,u,p,g){const y=this.expression.evaluate(new I(this.zoom),i,{},p,u,g),w=this.expression.evaluate(new I(this.zoom+1),i,{},p,u,g),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,y,w)}updatePaintArray(e,i,a,u,p){const g=this.expression.evaluate({zoom:this.zoom},a,u,void 0,p),y=this.expression.evaluate({zoom:this.zoom+1},a,u,void 0,p);this._setPaintValue(e,i,g,y)}_setPaintValue(e,i,a,u){if(this.type==="color"){const p=xg(a),g=xg(u);for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,p[0],p[1],g[0],g[1])}else{for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,a,u);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,a,u,p){const g=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,y=We(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);i.set(e,p,y)}getBinding(e,i){return new pf(e)}}class va{constructor(e,i,a,u,p){this.expression=e,this.layerId=p,this.paintVertexAttributes=(a==="array"?Ls:os).members;for(let g=0;g<i.length;++g);this.paintVertexArray=new u}populatePaintArray(e,i,a){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,u,p,g){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],g)}_setPaintValues(e,i,a,u){if(!u||!a)return;const p=u[a];if(!p)return;const{tl:g,br:y,pixelRatio:w}=p;for(let E=e;E<i;E++)this.paintVertexArray.emplace(E,g[0],g[1],y[0],y[1],w)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class wa{constructor(e,i,a=()=>!0){this.binders={},this._buffers=[];const u=[];for(const p in e.paint._values){if(!a(p))continue;const g=e.paint.get(p);if(!(g instanceof ne&&da(g.property.specification)))continue;const y=Q4(p,e.type),w=g.value,E=g.property.specification.type,A=!!g.property.useIntegerZoom,M=p==="line-dasharray"||p.endsWith("pattern"),D=p==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(w.kind!=="constant"||D)if(w.kind==="source"||D||M){const L=Ev(p,E,"source");this.binders[p]=M?new va(w,y,E,L,e.id):new Fs(w,y,E,L),u.push(`/a_${p}`)}else{const L=Ev(p,E,"composite");this.binders[p]=new Ro(w,y,E,A,i,L),u.push(`/z_${p}`)}else this.binders[p]=M?new jc(w.value,y):new Gh(w.value,y,E),u.push(`/u_${p}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Fs||i instanceof Ro?i.maxValue:0}populatePaintArrays(e,i,a,u,p,g){for(const y in this.binders){const w=this.binders[y];(w instanceof Fs||w instanceof Ro||w instanceof va)&&w.populatePaintArray(e,i,a,u,p,g)}}setConstantPatternPositions(e){for(const i in this.binders){const a=this.binders[i];a instanceof jc&&a.setConstantPatternPositions(e)}}updatePaintArrays(e,i,a,u,p,g){let y=!1;for(const w in e){const E=i.getPositions(w);for(const A of E){const M=a.feature(A.index);for(const D in this.binders){const L=this.binders[D];if((L instanceof Fs||L instanceof Ro||L instanceof va)&&L.expression.isStateDependent===!0){const R=u.paint.get(D);L.expression=R.value,L.updatePaintArray(A.start,A.end,M,e[w],p,g),y=!0}}}}return y}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof Gh||a instanceof jc)&&e.push(...a.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Fs||a instanceof Ro||a instanceof va)for(let u=0;u<a.paintVertexAttributes.length;u++)e.push(a.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Gh||a instanceof jc||a instanceof Ro)for(const u of a.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Gh||u instanceof jc||u instanceof Ro)for(const p of u.uniformNames)i.push({name:p,property:a,binding:u.getBinding(e,p)})}return i}setUniforms(e,i,a,u,p){for(const{name:g,property:y,binding:w}of a)this.binders[y].setUniform(e,w,p,u.get(y),g)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof Fs||i instanceof Ro||i instanceof va)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof Fs||a instanceof Ro||a instanceof va)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Fs||i instanceof Ro||i instanceof va)&&i.destroy()}}}class Ml{constructor(e,i,a=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new wa(u,i,a);this.needsUpload=!1,this._featureMap=new hf,this._bufferOffset=0}populatePaintArrays(e,i,a,u,p,g,y){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,i,u,p,g,y);i.id!==void 0&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,u,p){for(const g of a)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,i,g,u,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const J4={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Q4(r,e){return J4[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const eI={"line-pattern":{source:ze,composite:ze},"fill-pattern":{source:ze,composite:ze},"fill-extrusion-pattern":{source:ze,composite:ze},"line-dasharray":{source:He,composite:He}},tI={color:{source:uo,composite:rt},number:{source:wn,composite:uo}};function Ev(r,e,i){const a=eI[r];return a&&a[i]||tI[e][i]}wt(Gh,"ConstantBinder"),wt(jc,"PatternConstantBinder"),wt(Fs,"SourceExpressionBinder"),wt(va,"PatternCompositeBinder"),wt(Ro,"CompositeExpressionBinder"),wt(wa,"ProgramConfiguration",{omit:["_buffers"]}),wt(Ml,"ProgramConfigurationSet");const Tv="-transition";class Fo extends rl{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new re(i.layout)),i.paint)){this._transitionablePaint=new N(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ie(i.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){i!=null&&this._validate(dg,`layers.${this.id}.layout.${e}`,e,i,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return ln(e,Tv)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(i!=null&&this._validate(hg,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(ln(e,Tv))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const u=this._transitionablePaint._values[e],p=u.value.isDataDriven(),g=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const y=this._transitionablePaint._values[e].value,w=y.isDataDriven(),E=ln(e,"pattern")||e==="line-dasharray";return w||p||E||this._handleOverridablePaintPropertyUpdate(e,g,y)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Yr(e,(i,a)=>!(i===void 0||a==="layout"&&!Object.keys(i).length||a==="paint"&&!Object.keys(i).length))}_validate(e,i,a,u,p={}){return(!p||p.validate!==!1)&&af(this,e.call(sf,{key:i,layerType:this.type,objectKey:a,value:u,styleSpec:qe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof ne&&da(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Lc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const nI=Ae([{name:"a_pos",components:2,type:"Int16"}],4),rI=Ae([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class nr{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,u){let p=this.segments[this.segments.length-1];return e>nr.MAX_VERTEX_ARRAY_LENGTH&&mn(`Max vertices per segment is ${nr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!p||p.vertexLength+e>nr.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==u)&&(p={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},u!==void 0&&(p.sortKey=u),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,u){return new nr([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:u,vaos:{},sortKey:0}])}}nr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wt(nr,"SegmentVector");var Dt=8192;class ba{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Tn?new Tn(e.lng,e.lat):Tn.convert(e),this}setSouthWest(e){return this._sw=e instanceof Tn?new Tn(e.lng,e.lat):Tn.convert(e),this}extend(e){const i=this._sw,a=this._ne;let u,p;if(e instanceof Tn)u=e,p=e;else{if(!(e instanceof ba))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ba.convert(e)):this.extend(Tn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Tn.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return i||a?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),a.lng=Math.max(p.lng,a.lng),a.lat=Math.max(p.lat,a.lat)):(this._sw=new Tn(u.lng,u.lat),this._ne=new Tn(p.lng,p.lat)),this}getCenter(){return new Tn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Tn(this.getWest(),this.getNorth())}getSouthEast(){return new Tn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=Tn.convert(e);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&u}static convert(e){return!e||e instanceof ba?e:new ba(e)}}var ff=1e-6,Si=typeof Float32Array<"u"?Float32Array:Array;function Sv(){var r=new Si(9);return Si!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Cv(r,e,i){var a=e[0],u=e[1],p=e[2],g=e[3],y=e[4],w=e[5],E=e[6],A=e[7],M=e[8],D=i[0],L=i[1],R=i[2],G=i[3],J=i[4],oe=i[5],pe=i[6],se=i[7],he=i[8];return r[0]=D*a+L*g+R*E,r[1]=D*u+L*y+R*A,r[2]=D*p+L*w+R*M,r[3]=G*a+J*g+oe*E,r[4]=G*u+J*y+oe*A,r[5]=G*p+J*w+oe*M,r[6]=pe*a+se*g+he*E,r[7]=pe*u+se*y+he*A,r[8]=pe*p+se*w+he*M,r}function Oo(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function vg(r,e){var i=e[0],a=e[1],u=e[2],p=e[3],g=e[4],y=e[5],w=e[6],E=e[7],A=e[8],M=e[9],D=e[10],L=e[11],R=e[12],G=e[13],J=e[14],oe=e[15],pe=i*y-a*g,se=i*w-u*g,he=i*E-p*g,ge=a*w-u*y,me=a*E-p*y,Le=u*E-p*w,Pe=A*G-M*R,$e=A*J-D*R,ot=A*oe-L*R,Oe=M*J-D*G,Ke=M*oe-L*G,Ye=D*oe-L*J,nt=pe*Ye-se*Ke+he*Oe+ge*ot-me*$e+Le*Pe;return nt?(r[0]=(y*Ye-w*Ke+E*Oe)*(nt=1/nt),r[1]=(u*Ke-a*Ye-p*Oe)*nt,r[2]=(G*Le-J*me+oe*ge)*nt,r[3]=(D*me-M*Le-L*ge)*nt,r[4]=(w*ot-g*Ye-E*$e)*nt,r[5]=(i*Ye-u*ot+p*$e)*nt,r[6]=(J*he-R*Le-oe*se)*nt,r[7]=(A*Le-D*he+L*se)*nt,r[8]=(g*Ke-y*ot+E*Pe)*nt,r[9]=(a*ot-i*Ke-p*Pe)*nt,r[10]=(R*me-G*he+oe*pe)*nt,r[11]=(M*he-A*me-L*pe)*nt,r[12]=(y*$e-g*Oe-w*Pe)*nt,r[13]=(i*Oe-a*$e+u*Pe)*nt,r[14]=(G*se-R*ge-J*pe)*nt,r[15]=(A*ge-M*se+D*pe)*nt,r):null}function Dl(r,e,i){var a=e[0],u=e[1],p=e[2],g=e[3],y=e[4],w=e[5],E=e[6],A=e[7],M=e[8],D=e[9],L=e[10],R=e[11],G=e[12],J=e[13],oe=e[14],pe=e[15],se=i[0],he=i[1],ge=i[2],me=i[3];return r[0]=se*a+he*y+ge*M+me*G,r[1]=se*u+he*w+ge*D+me*J,r[2]=se*p+he*E+ge*L+me*oe,r[3]=se*g+he*A+ge*R+me*pe,r[4]=(se=i[4])*a+(he=i[5])*y+(ge=i[6])*M+(me=i[7])*G,r[5]=se*u+he*w+ge*D+me*J,r[6]=se*p+he*E+ge*L+me*oe,r[7]=se*g+he*A+ge*R+me*pe,r[8]=(se=i[8])*a+(he=i[9])*y+(ge=i[10])*M+(me=i[11])*G,r[9]=se*u+he*w+ge*D+me*J,r[10]=se*p+he*E+ge*L+me*oe,r[11]=se*g+he*A+ge*R+me*pe,r[12]=(se=i[12])*a+(he=i[13])*y+(ge=i[14])*M+(me=i[15])*G,r[13]=se*u+he*w+ge*D+me*J,r[14]=se*p+he*E+ge*L+me*oe,r[15]=se*g+he*A+ge*R+me*pe,r}function qh(r,e,i){var a,u,p,g,y,w,E,A,M,D,L,R,G=i[0],J=i[1],oe=i[2];return e===r?(r[12]=e[0]*G+e[4]*J+e[8]*oe+e[12],r[13]=e[1]*G+e[5]*J+e[9]*oe+e[13],r[14]=e[2]*G+e[6]*J+e[10]*oe+e[14],r[15]=e[3]*G+e[7]*J+e[11]*oe+e[15]):(u=e[1],p=e[2],g=e[3],y=e[4],w=e[5],E=e[6],A=e[7],M=e[8],D=e[9],L=e[10],R=e[11],r[0]=a=e[0],r[1]=u,r[2]=p,r[3]=g,r[4]=y,r[5]=w,r[6]=E,r[7]=A,r[8]=M,r[9]=D,r[10]=L,r[11]=R,r[12]=a*G+y*J+M*oe+e[12],r[13]=u*G+w*J+D*oe+e[13],r[14]=p*G+E*J+L*oe+e[14],r[15]=g*G+A*J+R*oe+e[15]),r}function Pl(r,e,i){var a=i[0],u=i[1],p=i[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*u,r[5]=e[5]*u,r[6]=e[6]*u,r[7]=e[7]*u,r[8]=e[8]*p,r[9]=e[9]*p,r[10]=e[10]*p,r[11]=e[11]*p,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function wg(r,e,i){var a=Math.sin(i),u=Math.cos(i),p=e[4],g=e[5],y=e[6],w=e[7],E=e[8],A=e[9],M=e[10],D=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=p*u+E*a,r[5]=g*u+A*a,r[6]=y*u+M*a,r[7]=w*u+D*a,r[8]=E*u-p*a,r[9]=A*u-g*a,r[10]=M*u-y*a,r[11]=D*u-w*a,r}function mf(r,e,i){var a=Math.sin(i),u=Math.cos(i),p=e[0],g=e[1],y=e[2],w=e[3],E=e[8],A=e[9],M=e[10],D=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=p*u-E*a,r[1]=g*u-A*a,r[2]=y*u-M*a,r[3]=w*u-D*a,r[8]=p*a+E*u,r[9]=g*a+A*u,r[10]=y*a+M*u,r[11]=w*a+D*u,r}function Av(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Iv(r,e,i){var a,u,p,g=i[0],y=i[1],w=i[2],E=Math.hypot(g,y,w);return E<ff?null:(g*=E=1/E,y*=E,w*=E,a=Math.sin(e),u=Math.cos(e),r[0]=g*g*(p=1-u)+u,r[1]=y*g*p+w*a,r[2]=w*g*p-y*a,r[3]=0,r[4]=g*y*p-w*a,r[5]=y*y*p+u,r[6]=w*y*p+g*a,r[7]=0,r[8]=g*w*p+y*a,r[9]=y*w*p-g*a,r[10]=w*w*p+u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var iI=Dl;function bg(){var r=new Si(3);return Si!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function kv(r){var e=new Si(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function $h(r){return Math.hypot(r[0],r[1],r[2])}function Vc(r,e,i){var a=new Si(3);return a[0]=r,a[1]=e,a[2]=i,a}function Os(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r}function Eg(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r}function Mv(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r}function Wh(r,e,i){return r[0]=Math.min(e[0],i[0]),r[1]=Math.min(e[1],i[1]),r[2]=Math.min(e[2],i[2]),r}function Hh(r,e,i){return r[0]=Math.max(e[0],i[0]),r[1]=Math.max(e[1],i[1]),r[2]=Math.max(e[2],i[2]),r}function qi(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r}function Zh(r,e,i,a){return r[0]=e[0]+i[0]*a,r[1]=e[1]+i[1]*a,r[2]=e[2]+i[2]*a,r}function ti(r,e){var i=e[0],a=e[1],u=e[2],p=i*i+a*a+u*u;return p>0&&(p=1/Math.sqrt(p)),r[0]=e[0]*p,r[1]=e[1]*p,r[2]=e[2]*p,r}function ho(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Tg(r,e,i){var a=e[0],u=e[1],p=e[2],g=i[0],y=i[1],w=i[2];return r[0]=u*w-p*y,r[1]=p*g-a*w,r[2]=a*y-u*g,r}function Yn(r,e,i){var a=e[0],u=e[1],p=e[2],g=i[3]*a+i[7]*u+i[11]*p+i[15];return r[0]=(i[0]*a+i[4]*u+i[8]*p+i[12])/(g=g||1),r[1]=(i[1]*a+i[5]*u+i[9]*p+i[13])/g,r[2]=(i[2]*a+i[6]*u+i[10]*p+i[14])/g,r}function Dv(r,e,i){var a=i[0],u=i[1],p=i[2],g=e[0],y=e[1],w=e[2],E=u*w-p*y,A=p*g-a*w,M=a*y-u*g,D=u*M-p*A,L=p*E-a*M,R=a*A-u*E,G=2*i[3];return A*=G,M*=G,L*=2,R*=2,r[0]=g+(E*=G)+(D*=2),r[1]=y+A+L,r[2]=w+M+R,r}var Xh,No=Eg,oI=Mv,sI=$h;function Pv(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r}function zv(r,e){var i=e[0],a=e[1],u=e[2],p=e[3],g=i*i+a*a+u*u+p*p;return g>0&&(g=1/Math.sqrt(g)),r[0]=i*g,r[1]=a*g,r[2]=u*g,r[3]=p*g,r}function zl(r,e,i){var a=e[0],u=e[1],p=e[2],g=e[3];return r[0]=i[0]*a+i[4]*u+i[8]*p+i[12]*g,r[1]=i[1]*a+i[5]*u+i[9]*p+i[13]*g,r[2]=i[2]*a+i[6]*u+i[10]*p+i[14]*g,r[3]=i[3]*a+i[7]*u+i[11]*p+i[15]*g,r}function Bv(){var r=new Si(4);return Si!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Lv(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function Rv(r,e,i){i*=.5;var a=e[0],u=e[1],p=e[2],g=e[3],y=Math.sin(i),w=Math.cos(i);return r[0]=a*w+g*y,r[1]=u*w+p*y,r[2]=p*w-u*y,r[3]=g*w-a*y,r}function Fv(r,e,i){i*=.5;var a=e[0],u=e[1],p=e[2],g=e[3],y=Math.sin(i),w=Math.cos(i);return r[0]=a*w-p*y,r[1]=u*w+g*y,r[2]=p*w+a*y,r[3]=g*w-u*y,r}bg(),Xh=new Si(4),Si!=Float32Array&&(Xh[0]=0,Xh[1]=0,Xh[2]=0,Xh[3]=0);var aI=zv;bg(),Vc(1,0,0),Vc(0,1,0),Bv(),Bv(),Sv();const lI=Ae([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ov}=lI,Nv=Ae([{name:"a_pos_3",components:3,type:"Int16"}]);var Kh=Ae([{name:"a_pos",type:"Int16",components:2}]);class Sg{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,a){const u=ho(i,this.dir);if(Math.abs(u)<1e-6)return!1;const p=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/u;return a[0]=this.pos[0]+this.dir[0]*p,a[1]=this.pos[1]+this.dir[1]*p,a[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(e,i,a){if(function(L,R){var G=L[0],J=L[1],oe=L[2],pe=R[0],se=R[1],he=R[2];return Math.abs(G-pe)<=ff*Math.max(1,Math.abs(G),Math.abs(pe))&&Math.abs(J-se)<=ff*Math.max(1,Math.abs(J),Math.abs(se))&&Math.abs(oe-he)<=ff*Math.max(1,Math.abs(oe),Math.abs(he))}(this.pos,e)||i===0)return a[0]=a[1]=a[2]=0,!1;const[u,p,g]=this.dir,y=this.pos[0]-e[0],w=this.pos[1]-e[1],E=this.pos[2]-e[2],A=u*u+p*p+g*g,M=2*(y*u+w*p+E*g),D=M*M-4*A*(y*y+w*w+E*E-i*i);if(D<0){const L=Math.max(-M/2,0),R=y+u*L,G=w+p*L,J=E+g*L,oe=Math.hypot(R,G,J);return a[0]=R*i/oe,a[1]=G*i/oe,a[2]=J*i/oe,!1}{const L=(-M-Math.sqrt(D))/(2*A);if(L<0){const R=Math.hypot(y,w,E);return a[0]=y*i/R,a[1]=w*i/R,a[2]=E*i/R,!1}return a[0]=y+u*L,a[1]=w+p*L,a[2]=E+g*L,!0}}}class Cg{constructor(e,i,a,u,p){this.TL=e,this.TR=i,this.BR=a,this.BL=u,this.horizon=p}static fromInvProjectionMatrix(e,i,a){const u=[-1,1,1],p=[1,1,1],g=[1,-1,1],y=[-1,-1,1],w=Yn(u,u,e),E=Yn(p,p,e),A=Yn(g,g,e),M=Yn(y,y,e);return new Cg(w,E,A,M,i/a)}}class Ag{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,a,u){const p=Math.pow(2,a),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const E=zl([],w,e),A=1/E[3]/i*p;return function(M,D,L){return M[0]=D[0]*L[0],M[1]=D[1]*L[1],M[2]=D[2]*L[2],M[3]=D[3]*L[3],M}(E,E,[A,A,u?1/E[3]:A,A])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const E=ti([],Tg([],No([],g[w[0]],g[w[1]]),No([],g[w[2]],g[w[1]]))),A=-ho(E,g[w[1]]);return E.concat(A)});return new Ag(g,y)}}class ni{static fromPoints(e){const i=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const u of e)Wh(i,i,u),Hh(a,a,u);return new ni(i,a)}static applyTransform(e,i){const a=e.getCorners();for(let u=0;u<a.length;++u)Yn(a[u],a[u],i);return ni.fromPoints(a)}constructor(e,i){this.min=e,this.max=i,this.center=qi([],Os([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],a=kv(this.min),u=kv(this.max);for(let p=0;p<i.length;p++)a[p]=i[p]?this.min[p]:this.center[p],u[p]=i[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new ni(a,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let a=!0;for(let u=0;u<e.planes.length;u++){const p=e.planes[u];let g=0;for(let y=0;y<i.length;y++)g+=ho(p,i[y])+p[3]>=0;if(g===0)return 0;g!==i.length&&(a=!1)}if(a)return 2;for(let u=0;u<3;u++){let p=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let y=0;y<e.points.length;y++){const w=e.points[y][u]-this.min[u];p=Math.min(p,w),g=Math.max(g,w)}if(g<0||p>this.max[u]-this.min[u])return 0}return 1}}const Ig=5,Uv=6,ss=Dt/Math.PI/2,cI=16383,Bl=64,Yh=[Bl,32,16],po=-ss,fo=ss,uI=[new ni([po,po,po],[fo,fo,fo]),new ni([po,po,po],[0,0,fo]),new ni([0,po,po],[fo,0,fo]),new ni([po,0,po],[0,fo,fo]),new ni([0,0,po],[fo,fo,fo])];function gf(r){return r*ss/ed}function jv(r,e,i,a=!0){const u=qi([],r._camera.position,r.worldSize),p=[e,i,1,1];zl(p,p,r.pixelMatrixInverse),Pv(p,p,1/p[3]);const g=ti([],No([],p,u)),y=r.globeMatrix,w=[y[12],y[13],y[14]],E=No([],w,u),A=$h(E),M=ti([],E),D=r.worldSize/(2*Math.PI),L=ho(M,g),R=Math.asin(D/A);if(R<Math.acos(L)){if(!a)return null;const ot=[],Oe=[];qi(ot,g,A/L),ti(Oe,No(Oe,ot,E)),ti(g,Os(g,E,qi(g,Oe,Math.tan(R)*A)))}const G=[];new Sg(u,g).closestPointOnSphere(w,D,G);const J=ti([],kr(y,0)),oe=ti([],kr(y,1)),pe=ti([],kr(y,2)),se=ho(J,G),he=ho(oe,G),ge=ho(pe,G),me=Ve(Math.asin(-he/D));let Le=Ve(Math.atan2(se,ge));Le=r.center.lng+function(ot,Oe){const Ke=(Oe-ot+180)%360-180;return Ke<-180?Ke+360:Ke}(r.center.lng,Le);const Pe=ls(Le),$e=We(cs(me),0,1);return new Wc(Pe,$e)}class hI{constructor(e,i,a){this.a=No([],e,a),this.b=No([],i,a),this.center=a;const u=ti([],this.a),p=ti([],this.b);this.angle=Math.acos(ho(u,p))}}function kg(r,e){if(r.angle===0)return null;let i;return i=r.a[e]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[e]/r.a[e]/Math.sin(r.angle)-1/Math.tan(r.angle)),i<0||i>1?null:function(a,u,p,g){const y=Math.sin(p);return a*(Math.sin((1-g)*p)/y)+u*(Math.sin(g*p)/y)}(r.a[e],r.b[e],r.angle,We(i,0,1))+r.center[e]}function as(r){if(r.z<=1)return uI[r.z+2*r.y+r.x];const e=Mg(_f(r));return ni.fromPoints(e)}function Ll(r,e,i){return qi(r,r,1-i),Zh(r,r,e,i)}function Vv(r,e){const i=$c(e.zoom);if(i===0)return as(r);const a=_f(r),u=Mg(a),p=ls(a.getWest())*e.worldSize,g=ls(a.getEast())*e.worldSize,y=cs(a.getNorth())*e.worldSize,w=cs(a.getSouth())*e.worldSize,E=[p,y,0],A=[g,y,0],M=[p,w,0],D=[g,w,0],L=vg([],e.globeMatrix);return Yn(E,E,L),Yn(A,A,L),Yn(M,M,L),Yn(D,D,L),u[0]=Ll(u[0],M,i),u[1]=Ll(u[1],D,i),u[2]=Ll(u[2],A,i),u[3]=Ll(u[3],E,i),ni.fromPoints(u)}function Gv(r,e,i){for(const a of r)Yn(a,a,e),qi(a,a,i)}function dI(r,e,i){const a=e/r.worldSize,u=r.globeMatrix;if(i.z<=1){const Pe=as(i).getCorners();return Gv(Pe,u,a),ni.fromPoints(Pe)}const p=_f(i),g=Mg(p);Gv(g,u,a);const y=Number.MAX_VALUE,w=[-y,-y,-y],E=[y,y,y];if(p.contains(r.center)){for(const ot of g)Wh(E,E,ot),Hh(w,w,ot);w[2]=0;const Pe=r.point,$e=[Pe.x*a,Pe.y*a,0];return Wh(E,E,$e),Hh(w,w,$e),new ni(E,w)}const A=[u[12]*a,u[13]*a,u[14]*a],M=p.getCenter(),D=We(r.center.lat,-Ur,Ur),L=We(M.lat,-Ur,Ur),R=ls(r.center.lng),G=cs(D);let J=R-ls(M.lng);const oe=G-cs(L);J>.5?J-=1:J<-.5&&(J+=1);let pe=0;Math.abs(J)>Math.abs(oe)?pe=J>=0?1:3:(pe=oe>=0?0:2,Zh(A,A,[u[4]*a,u[5]*a,u[6]*a],-Math.sin(Ue(oe>=0?p.getSouth():p.getNorth()))*ss));const se=g[pe],he=g[(pe+1)%4],ge=new hI(se,he,A),me=[kg(ge,0)||se[0],kg(ge,1)||se[1],kg(ge,2)||se[2]],Le=$c(r.zoom);if(Le>0){const Pe=function({x:ot,y:Oe,z:Ke},Ye,nt,ut,Ge){const mt=1/(1<<Ke);let Tt=ot*mt,gt=Tt+mt,Ut=Oe*mt,ht=Ut+mt,It=0;const jt=(Tt+gt)/2-ut;return jt>.5?It=-1:jt<-.5&&(It=1),Tt=((Tt+It)*Ye-(ut*=Ye))*nt+ut,gt=((gt+It)*Ye-ut)*nt+ut,Ut=(Ut*Ye-(Ge*=Ye))*nt+Ge,ht=(ht*Ye-Ge)*nt+Ge,[[Tt,ht,0],[gt,ht,0],[gt,Ut,0],[Tt,Ut,0]]}(i,e,r._pixelsPerMercatorPixel,R,G);for(let ot=0;ot<g.length;ot++)Ll(g[ot],Pe[ot],Le);const $e=Os([],Pe[pe],Pe[(pe+1)%4]);qi($e,$e,.5),Ll(me,$e,Le)}for(const Pe of g)Wh(E,E,Pe),Hh(w,w,Pe);return E[2]=Math.min(se[2],he[2]),Wh(E,E,me),Hh(w,w,me),new ni(E,w)}function _f({x:r,y:e,z:i}){const a=1/(1<<i),u=new Tn($i(r*a),Nr((e+1)*a)),p=new Tn($i((r+1)*a),Nr(e*a));return new ba(u,p)}function Mg(r){const e=Ue(r.getNorth()),i=Ue(r.getSouth()),a=Math.cos(e),u=Math.cos(i),p=Math.sin(e),g=Math.sin(i),y=r.getWest(),w=r.getEast();return[Gc(u,g,y),Gc(u,g,w),Gc(a,p,w),Gc(a,p,y)]}function Gc(r,e,i,a=ss){return i=Ue(i),[r*Math.sin(i)*a,-e*a,r*Math.cos(i)*a]}function qc(r,e,i){return Gc(Math.cos(Ue(r)),Math.sin(Ue(r)),e,i)}function Jh(r,e,i,a){const u=1<<i.z,p=(r/Dt+i.x)/u;return qc(Nr((e/Dt+i.y)/u),$i(p),a)}function yf({min:r,max:e}){return cI/Math.max(e[0]-r[0],e[1]-r[1],e[2]-r[2])}const qv=new Float64Array(16);function Qh(r){const e=yf(r),i=Av(qv,[e,e,e]);return qh(i,i,((a=[])[0]=-(u=r.min)[0],a[1]=-u[1],a[2]=-u[2],a));var a,u}function Dg(r){const e=(a=r.min,(i=qv)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=a[0],i[13]=a[1],i[14]=a[2],i[15]=1,i);var i,a;const u=1/yf(r);return Pl(e,e,[u,u,u])}function $v(r,e,i,a,u){const p=function(w){const E=Dt/(2*Math.PI);return w/(2*Math.PI)/E}(i),g=[r,e,-i/(2*Math.PI)],y=Oo(new Float64Array(16));return qh(y,y,g),Pl(y,y,[p,p,p]),wg(y,y,Ue(-u)),mf(y,y,Ue(-a)),y}function $c(r){return bt(Ig,Uv,r)}function Wv(r,e){const i=qc(e.lat,e.lng),a=function(R){const G=qc(R._center.lat,R._center.lng);let J=Tg([],Vc(0,1,0),G);const oe=Iv([],-R.angle,G);J=Yn(J,J,oe),Iv(oe,-R._pitch,J);const pe=ti([],G);return qi(pe,pe,gf(R.cameraToCenterDistance/R.pixelsPerMeter)),Yn(pe,pe,oe),Os([],G,pe)}(r);return g=(u=Eg([],a,i))[0],y=u[1],w=u[2],E=(p=i)[0],A=p[1],M=p[2],L=(D=Math.sqrt(g*g+y*y+w*w)*Math.sqrt(E*E+A*A+M*M))&&ho(u,p)/D,Math.acos(Math.min(Math.max(L,-1),1));var u,p,g,y,w,E,A,M,D,L}function Pg(r,e){return Wv(r,e)>Math.PI/2*1.01}const Hv=Ue(85),pI=Math.cos(Hv),fI=Math.sin(Hv),ed=63710088e-1,Zv=2*Math.PI*ed;class Ea{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ea(ft(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,u=e.lat*i,p=Math.sin(a)*Math.sin(u)+Math.cos(a)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return ed*Math.acos(Math.min(p,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new ba(new Ea(this.lng-a,this.lat-i),new Ea(this.lng+a,this.lat+i))}toEcef(e){const i=gf(e);return qc(this.lat,this.lng,ss+i)}static convert(e){if(e instanceof Ea)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ea(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ea(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Tn=Ea;function zg(r){return Zv*Math.cos(r*Math.PI/180)}function ls(r){return(180+r)/360}function cs(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Uo(r,e){return r/zg(e)}function $i(r){return 360*r-180}function Nr(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Xv(r,e){return r*zg(Nr(e))}const Ur=85.051129;function Kv(r){return 1/Math.cos(r*Math.PI/180)}class Wc{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=Tn.convert(e);return new Wc(ls(a.lng),cs(a.lat),Uo(i,a.lat))}toLngLat(){return new Tn($i(this.x),Nr(this.y))}toAltitude(){return Xv(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Zv*Kv(Nr(this.y))}}function Bg(r,e,i,a,u,p,g,y,w){const E=(e+a)/2,A=(i+u)/2,M=new Te(E,A);y(M),function(D,L,R,G,J,oe){const pe=R-J,se=G-oe;return Math.abs((G-L)*pe-(R-D)*se)/Math.hypot(pe,se)}(M.x,M.y,p.x,p.y,g.x,g.y)>=w?(Bg(r,e,i,E,A,p,M,y,w),Bg(r,E,A,a,u,M,g,y,w)):r.push(g)}function Yv(r,e,i){let a=r[0],u=a.x,p=a.y;e(a);const g=[a];for(let y=1;y<r.length;y++){const w=r[y],{x:E,y:A}=w;e(w),Bg(g,u,p,E,A,a,w,e,i),u=E,p=A,a=w}return g}function Lg(r,e,i,a){if(a(e,i)){const u=e.add(i)._mult(.5);Lg(r,e,u,a),Lg(r,u,i,a)}else r.push(i)}function mI(r,e){let i=r[0];const a=[i];for(let u=1;u<r.length;u++){const p=r[u];Lg(a,i,p,e),i=p}return a}const Rg=Math.pow(2,14)-1,Jv=-Rg-1;function gI(r,e){const i=Math.round(r.x*e),a=Math.round(r.y*e);return r.x=We(i,Jv,Rg),r.y=We(a,Jv,Rg),(i<r.x||i>r.x+1||a<r.y||a>r.y+1)&&mn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Ns(r,e,i){const a=r.loadGeometry(),u=r.extent,p=Dt/u;if(e&&i&&i.projection.isReprojectedInTileSpace){const g=1<<e.z,{scale:y,x:w,y:E,projection:A}=i,M=D=>{const L=$i((e.x+D.x/u)/g),R=Nr((e.y+D.y/u)/g),G=A.project(L,R);D.x=(G.x*y-w)*u,D.y=(G.y*y-E)*u};for(let D=0;D<a.length;D++)if(r.type!==1)a[D]=Yv(a[D],M,1);else{const L=[];for(const R of a[D])R.x<0||R.x>=u||R.y<0||R.y>=u||(M(R),L.push(R));a[D]=L}}for(const g of a)for(const y of g)gI(y,p);return a}function Rl(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Ns(r):[]}}function xf(r,e,i,a,u){r.emplaceBack(2*e+(a+1)/2,2*i+(u+1)/2)}function vf(r,e,i){r.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Fg{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new it,this.indexArray=new Ct,this.segments=new nr,this.programConfigurations=new Ml(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,u){const p=this.layers[0],g=[];let y=null;p.type==="circle"&&(y=p.layout.get("circle-sort-key"));for(const{feature:E,id:A,index:M,sourceLayerIndex:D}of e){const L=this.layers[0]._featureFilter.needGeometry,R=Rl(E,L);if(!this.layers[0]._featureFilter.filter(new I(this.zoom),R,a))continue;const G=y?y.evaluate(R,{},a):void 0,J={id:A,properties:E.properties,type:E.type,sourceLayerIndex:D,index:M,geometry:L?R.geometry:Ns(E,a,u),patterns:{},sortKey:G};g.push(J)}y&&g.sort((E,A)=>E.sortKey-A.sortKey);let w=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new at,w=u.projection);for(const E of g){const{geometry:A,index:M,sourceLayerIndex:D}=E,L=e[M].feature;this.addFeature(E,A,M,i.availableImages,a,w),i.featureIndex.insert(L,A,M,D,this.index)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nI.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,rI.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,a,u,p,g){for(const y of i)for(const w of y){const E=w.x,A=w.y;if(E<0||E>=Dt||A<0||A>=Dt)continue;if(g){const L=g.projectTilePoint(E,A,p),R=g.upVector(p,E,A),G=this.globeExtVertexArray;vf(G,L,R),vf(G,L,R),vf(G,L,R),vf(G,L,R)}const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),D=M.vertexLength;xf(this.layoutVertexArray,E,A,-1,-1),xf(this.layoutVertexArray,E,A,1,-1),xf(this.layoutVertexArray,E,A,1,1),xf(this.layoutVertexArray,E,A,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+2,D+3),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},u,p)}}function Qv(r,e){for(let i=0;i<r.length;i++)if(Fl(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Fl(r,e[i]))return!0;return!!Og(r,e)}function _I(r,e,i){return!!Fl(r,e)||!!Ng(e,r,i)}function ew(r,e){if(r.length===1)return nw(e,r[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let u=0;u<a.length;u++)if(Fl(r,a[u]))return!0}for(let i=0;i<r.length;i++)if(nw(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Og(r,e[i]))return!0;return!1}function yI(r,e,i){if(r.length>1){if(Og(r,e))return!0;for(let a=0;a<e.length;a++)if(Ng(e[a],r,i))return!0}for(let a=0;a<r.length;a++)if(Ng(r[a],e,i))return!0;return!1}function Og(r,e){if(r.length===0||e.length===0)return!1;for(let i=0;i<r.length-1;i++){const a=r[i],u=r[i+1];for(let p=0;p<e.length-1;p++)if(xI(a,u,e[p],e[p+1]))return!0}return!1}function xI(r,e,i,a){return gr(r,i,a)!==gr(e,i,a)&&gr(r,e,i)!==gr(r,e,a)}function Ng(r,e,i){const a=i*i;if(e.length===1)return r.distSqr(e[0])<a;for(let u=1;u<e.length;u++)if(tw(r,e[u-1],e[u])<a)return!0;return!1}function tw(r,e,i){const a=e.distSqr(i);if(a===0)return r.distSqr(e);const u=((r.x-e.x)*(i.x-e.x)+(r.y-e.y)*(i.y-e.y))/a;return r.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function nw(r,e){let i,a,u,p=!1;for(let g=0;g<r.length;g++){i=r[g];for(let y=0,w=i.length-1;y<i.length;w=y++)a=i[y],u=i[w],a.y>e.y!=u.y>e.y&&e.x<(u.x-a.x)*(e.y-a.y)/(u.y-a.y)+a.x&&(p=!p)}return p}function Fl(r,e){let i=!1;for(let a=0,u=r.length-1;a<r.length;u=a++){const p=r[a],g=r[u];p.y>e.y!=g.y>e.y&&e.x<(g.x-p.x)*(e.y-p.y)/(g.y-p.y)+p.x&&(i=!i)}return i}function rw(r,e,i,a,u){for(const g of r)if(e<=g.x&&i<=g.y&&a>=g.x&&u>=g.y)return!0;const p=[new Te(e,i),new Te(e,u),new Te(a,u),new Te(a,i)];if(r.length>2){for(const g of p)if(Fl(r,g))return!0}for(let g=0;g<r.length-1;g++)if(vI(r[g],r[g+1],p))return!0;return!1}function vI(r,e,i){const a=i[0],u=i[2];if(r.x<a.x&&e.x<a.x||r.x>u.x&&e.x>u.x||r.y<a.y&&e.y<a.y||r.y>u.y&&e.y>u.y)return!1;const p=gr(r,e,i[0]);return p!==gr(r,e,i[1])||p!==gr(r,e,i[2])||p!==gr(r,e,i[3])}function Hc(r,e,i){const a=e.paint.get(r).value;return a.kind==="constant"?a.value:i.programConfigurations.get(e.id).getMaxValue(r)}function wf(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function iw(r,e,i,a,u){if(!e[0]&&!e[1])return r;const p=Te.convert(e)._mult(u);i==="viewport"&&p._rotate(-a);const g=[];for(let y=0;y<r.length;y++)g.push(r[y].sub(p));return g}function ow(r,e,i,a){const u=Te.convert(r)._mult(a);return e==="viewport"&&u._rotate(-i),u}wt(Fg,"CircleBucket",{omit:["layers"]});const wI=new le({"circle-sort-key":new ee(qe.layout_circle["circle-sort-key"])});var bI={paint:new le({"circle-radius":new ee(qe.paint_circle["circle-radius"]),"circle-color":new ee(qe.paint_circle["circle-color"]),"circle-blur":new ee(qe.paint_circle["circle-blur"]),"circle-opacity":new ee(qe.paint_circle["circle-opacity"]),"circle-translate":new j(qe.paint_circle["circle-translate"]),"circle-translate-anchor":new j(qe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new j(qe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new j(qe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ee(qe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ee(qe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ee(qe.paint_circle["circle-stroke-opacity"])}),layout:wI};function sw(r,e,i,a,u,p,g,y,w){if(p&&r.queryGeometry.isAboveHorizon)return!1;p&&(w*=r.pixelToTileUnitsFactor);const E=r.tileID.canonical,A=i.projection.upVectorScale(E,i.center.lat,i.worldSize).metersToTile;for(const M of e)for(const D of M){const L=D.add(y),R=u&&i.elevation?i.elevation.exaggeration()*u.getElevationAt(L.x,L.y,!0):0,G=i.projection.projectTilePoint(L.x,L.y,E);if(R>0){const se=i.projection.upVector(E,L.x,L.y);G.x+=se[0]*A*R,G.y+=se[1]*A*R,G.z+=se[2]*A*R}const J=p?L:EI(G.x,G.y,G.z,a),oe=p?r.tilespaceRays.map(se=>SI(se,R)):r.queryGeometry.screenGeometry,pe=zl([],[G.x,G.y,G.z,1],a);if(!g&&p?w*=pe[3]/i.cameraToCenterDistance:g&&!p&&(w*=i.cameraToCenterDistance/pe[3]),p){const se=Nr((D.y/Dt+E.y)/(1<<E.z));w/=i.projection.pixelsPerMeter(se,1)/Uo(1,se)}if(_I(oe,J,w))return!0}return!1}function EI(r,e,i,a){const u=zl([],[r,e,i,1],a);return new Te(u[0]/u[3],u[1]/u[3])}const aw=Vc(0,0,0),TI=Vc(0,0,1);function SI(r,e){const i=bg();return aw[2]=e,r.intersectsPlane(aw,TI,i),new Te(i[0],i[1])}class lw extends Fg{}function cw(r,{width:e,height:i},a,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*a)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*i*a);return r.width=e,r.height=i,r.data=u,r}function uw(r,e,i){const{width:a,height:u}=e;a===r.width&&u===r.height||(Ug(r,e,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,a),height:Math.min(r.height,u)},i),r.width=a,r.height=u,r.data=e.data)}function Ug(r,e,i,a,u,p){if(u.width===0||u.height===0)return e;if(u.width>r.width||u.height>r.height||i.x>r.width-u.width||i.y>r.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||a.x>e.width-u.width||a.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const g=r.data,y=e.data;for(let w=0;w<u.height;w++){const E=((i.y+w)*r.width+i.x)*p,A=((a.y+w)*e.width+a.x)*p;for(let M=0;M<u.width*p;M++)y[A+M]=g[E+M]}return e}wt(lw,"HeatmapBucket",{omit:["layers"]});class Us{constructor(e,i){cw(this,e,1,i)}resize(e){uw(this,new Us(e),1)}clone(){return new Us({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,u,p){Ug(e,i,a,u,p,1)}}class Ci{constructor(e,i){cw(this,e,4,i)}resize(e){uw(this,new Ci(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ci({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,u,p){Ug(e,i,a,u,p,4)}}wt(Us,"AlphaImage"),wt(Ci,"RGBAImage");var CI={paint:new le({"heatmap-radius":new ee(qe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ee(qe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new j(qe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ae(qe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new j(qe.paint_heatmap["heatmap-opacity"])})};function jg(r){const e={},i=r.resolution||256,a=r.clips?r.clips.length:1,u=r.image||new Ci({width:i,height:a}),p=(g,y,w)=>{e[r.evaluationKey]=w;const E=r.expression.evaluate(e);u.data[g+y+0]=Math.floor(255*E.r/E.a),u.data[g+y+1]=Math.floor(255*E.g/E.a),u.data[g+y+2]=Math.floor(255*E.b/E.a),u.data[g+y+3]=Math.floor(255*E.a)};if(r.clips)for(let g=0,y=0;g<a;++g,y+=4*i)for(let w=0,E=0;w<i;w++,E+=4){const A=w/(i-1),{start:M,end:D}=r.clips[g];p(y,E,M*(1-A)+D*A)}else for(let g=0,y=0;g<i;g++,y+=4)p(0,y,g/(i-1));return u}var AI={paint:new le({"hillshade-illumination-direction":new j(qe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new j(qe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new j(qe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new j(qe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new j(qe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new j(qe.paint_hillshade["hillshade-accent-color"])})};const II=Ae([{name:"a_pos",components:2,type:"Int16"}],4),{members:kI}=II;var Vg={exports:{}};function bf(r,e,i){i=i||2;var a,u,p,g,y,w,E,A=e&&e.length,M=A?e[0]*i:r.length,D=hw(r,0,M,i,!0),L=[];if(!D||D.next===D.prev)return L;if(A&&(D=function(G,J,oe,pe){var se,he,ge,me=[];for(se=0,he=J.length;se<he;se++)(ge=hw(G,J[se]*pe,se<he-1?J[se+1]*pe:G.length,pe,!1))===ge.next&&(ge.steiner=!0),me.push(FI(ge));for(me.sort(BI),se=0;se<me.length;se++)oe=LI(me[se],oe);return oe}(r,e,D,i)),r.length>80*i){a=p=r[0],u=g=r[1];for(var R=i;R<M;R+=i)(y=r[R])<a&&(a=y),(w=r[R+1])<u&&(u=w),y>p&&(p=y),w>g&&(g=w);E=(E=Math.max(p-a,g-u))!==0?32767/E:0}return td(D,L,i,a,u,E,0),L}function hw(r,e,i,a,u){var p,g;if(u===$g(r,e,i,a)>0)for(p=e;p<i;p+=a)g=fw(p,r[p],r[p+1],g);else for(p=i-a;p>=e;p-=a)g=fw(p,r[p],r[p+1],g);return g&&Ef(g,g.next)&&(rd(g),g=g.next),g}function Ol(r,e){if(!r)return r;e||(e=r);var i,a=r;do if(i=!1,a.steiner||!Ef(a,a.next)&&rr(a.prev,a,a.next)!==0)a=a.next;else{if(rd(a),(a=e=a.prev)===a.next)break;i=!0}while(i||a!==e);return e}function td(r,e,i,a,u,p,g){if(r){!g&&p&&function(A,M,D,L){var R=A;do R.z===0&&(R.z=Gg(R.x,R.y,M,D,L)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==A);R.prevZ.nextZ=null,R.prevZ=null,function(G){var J,oe,pe,se,he,ge,me,Le,Pe=1;do{for(oe=G,G=null,he=null,ge=0;oe;){for(ge++,pe=oe,me=0,J=0;J<Pe&&(me++,pe=pe.nextZ);J++);for(Le=Pe;me>0||Le>0&&pe;)me!==0&&(Le===0||!pe||oe.z<=pe.z)?(se=oe,oe=oe.nextZ,me--):(se=pe,pe=pe.nextZ,Le--),he?he.nextZ=se:G=se,se.prevZ=he,he=se;oe=pe}he.nextZ=null,Pe*=2}while(ge>1)}(R)}(r,a,u,p);for(var y,w,E=r;r.prev!==r.next;)if(y=r.prev,w=r.next,p?DI(r,a,u,p):MI(r))e.push(y.i/i|0),e.push(r.i/i|0),e.push(w.i/i|0),rd(r),r=w.next,E=w.next;else if((r=w)===E){g?g===1?td(r=PI(Ol(r),e,i),e,i,a,u,p,2):g===2&&zI(r,e,i,a,u,p):td(Ol(r),e,i,a,u,p,1);break}}}function MI(r){var e=r.prev,i=r,a=r.next;if(rr(e,i,a)>=0)return!1;for(var u=e.x,p=i.x,g=a.x,y=e.y,w=i.y,E=a.y,A=u<p?u<g?u:g:p<g?p:g,M=y<w?y<E?y:E:w<E?w:E,D=u>p?u>g?u:g:p>g?p:g,L=y>w?y>E?y:E:w>E?w:E,R=a.next;R!==e;){if(R.x>=A&&R.x<=D&&R.y>=M&&R.y<=L&&Zc(u,y,p,w,g,E,R.x,R.y)&&rr(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function DI(r,e,i,a){var u=r.prev,p=r,g=r.next;if(rr(u,p,g)>=0)return!1;for(var y=u.x,w=p.x,E=g.x,A=u.y,M=p.y,D=g.y,L=y<w?y<E?y:E:w<E?w:E,R=A<M?A<D?A:D:M<D?M:D,G=y>w?y>E?y:E:w>E?w:E,J=A>M?A>D?A:D:M>D?M:D,oe=Gg(L,R,e,i,a),pe=Gg(G,J,e,i,a),se=r.prevZ,he=r.nextZ;se&&se.z>=oe&&he&&he.z<=pe;){if(se.x>=L&&se.x<=G&&se.y>=R&&se.y<=J&&se!==u&&se!==g&&Zc(y,A,w,M,E,D,se.x,se.y)&&rr(se.prev,se,se.next)>=0||(se=se.prevZ,he.x>=L&&he.x<=G&&he.y>=R&&he.y<=J&&he!==u&&he!==g&&Zc(y,A,w,M,E,D,he.x,he.y)&&rr(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;se&&se.z>=oe;){if(se.x>=L&&se.x<=G&&se.y>=R&&se.y<=J&&se!==u&&se!==g&&Zc(y,A,w,M,E,D,se.x,se.y)&&rr(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;he&&he.z<=pe;){if(he.x>=L&&he.x<=G&&he.y>=R&&he.y<=J&&he!==u&&he!==g&&Zc(y,A,w,M,E,D,he.x,he.y)&&rr(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function PI(r,e,i){var a=r;do{var u=a.prev,p=a.next.next;!Ef(u,p)&&dw(u,a,a.next,p)&&nd(u,p)&&nd(p,u)&&(e.push(u.i/i|0),e.push(a.i/i|0),e.push(p.i/i|0),rd(a),rd(a.next),a=r=p),a=a.next}while(a!==r);return Ol(a)}function zI(r,e,i,a,u,p){var g=r;do{for(var y=g.next.next;y!==g.prev;){if(g.i!==y.i&&OI(g,y)){var w=pw(g,y);return g=Ol(g,g.next),w=Ol(w,w.next),td(g,e,i,a,u,p,0),void td(w,e,i,a,u,p,0)}y=y.next}g=g.next}while(g!==r)}function BI(r,e){return r.x-e.x}function LI(r,e){var i=function(u,p){var g,y=p,w=u.x,E=u.y,A=-1/0;do{if(E<=y.y&&E>=y.next.y&&y.next.y!==y.y){var M=y.x+(E-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(M<=w&&M>A&&(A=M,g=y.x<y.next.x?y:y.next,M===w))return g}y=y.next}while(y!==p);if(!g)return null;var D,L=g,R=g.x,G=g.y,J=1/0;y=g;do w>=y.x&&y.x>=R&&w!==y.x&&Zc(E<G?w:A,E,R,G,E<G?A:w,E,y.x,y.y)&&(D=Math.abs(E-y.y)/(w-y.x),nd(y,u)&&(D<J||D===J&&(y.x>g.x||y.x===g.x&&RI(g,y)))&&(g=y,J=D)),y=y.next;while(y!==L);return g}(r,e);if(!i)return e;var a=pw(i,r);return Ol(a,a.next),Ol(i,i.next)}function RI(r,e){return rr(r.prev,r,e.prev)<0&&rr(e.next,r,r.next)<0}function Gg(r,e,i,a,u){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*u|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function FI(r){var e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function Zc(r,e,i,a,u,p,g,y){return(u-g)*(e-y)>=(r-g)*(p-y)&&(r-g)*(a-y)>=(i-g)*(e-y)&&(i-g)*(p-y)>=(u-g)*(a-y)}function OI(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(i,a){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==a.i&&u.next.i!==a.i&&dw(u,u.next,i,a))return!0;u=u.next}while(u!==i);return!1}(r,e)&&(nd(r,e)&&nd(e,r)&&function(i,a){var u=i,p=!1,g=(i.x+a.x)/2,y=(i.y+a.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&g<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next;while(u!==i);return p}(r,e)&&(rr(r.prev,r,e.prev)||rr(r,e.prev,e))||Ef(r,e)&&rr(r.prev,r,r.next)>0&&rr(e.prev,e,e.next)>0)}function rr(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function Ef(r,e){return r.x===e.x&&r.y===e.y}function dw(r,e,i,a){var u=Sf(rr(r,e,i)),p=Sf(rr(r,e,a)),g=Sf(rr(i,a,r)),y=Sf(rr(i,a,e));return u!==p&&g!==y||!(u!==0||!Tf(r,i,e))||!(p!==0||!Tf(r,a,e))||!(g!==0||!Tf(i,r,a))||!(y!==0||!Tf(i,e,a))}function Tf(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function Sf(r){return r>0?1:r<0?-1:0}function nd(r,e){return rr(r.prev,r,r.next)<0?rr(r,e,r.next)>=0&&rr(r,r.prev,e)>=0:rr(r,e,r.prev)<0||rr(r,r.next,e)<0}function pw(r,e){var i=new qg(r.i,r.x,r.y),a=new qg(e.i,e.x,e.y),u=r.next,p=e.prev;return r.next=e,e.prev=r,i.next=u,u.prev=i,a.next=i,i.prev=a,p.next=a,a.prev=p,a}function fw(r,e,i,a){var u=new qg(r,e,i);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function rd(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function qg(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $g(r,e,i,a){for(var u=0,p=e,g=i-a;p<i;p+=a)u+=(r[g]-r[p])*(r[p+1]+r[g+1]),g=p;return u}Vg.exports=bf,Vg.exports.default=bf,bf.deviation=function(r,e,i,a){var u=e&&e.length,p=Math.abs($g(r,0,u?e[0]*i:r.length,i));if(u)for(var g=0,y=e.length;g<y;g++)p-=Math.abs($g(r,e[g]*i,g<y-1?e[g+1]*i:r.length,i));var w=0;for(g=0;g<a.length;g+=3){var E=a[g]*i,A=a[g+1]*i,M=a[g+2]*i;w+=Math.abs((r[E]-r[M])*(r[A+1]-r[E+1])-(r[E]-r[A])*(r[M+1]-r[E+1]))}return p===0&&w===0?0:Math.abs((w-p)/p)},bf.flatten=function(r){for(var e=r[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,u=0;u<r.length;u++){for(var p=0;p<r[u].length;p++)for(var g=0;g<e;g++)i.vertices.push(r[u][p][g]);u>0&&i.holes.push(a+=r[u-1].length)}return i};var Wg=V(Vg.exports);function NI(r,e,i,a,u){mw(r,e,i||0,a||r.length-1,u||UI)}function mw(r,e,i,a,u){for(;a>i;){if(a-i>600){var p=a-i+1,g=e-i+1,y=Math.log(p),w=.5*Math.exp(2*y/3),E=.5*Math.sqrt(y*w*(p-w)/p)*(g-p/2<0?-1:1);mw(r,e,Math.max(i,Math.floor(e-g*w/p+E)),Math.min(a,Math.floor(e+(p-g)*w/p+E)),u)}var A=r[e],M=i,D=a;for(id(r,i,e),u(r[a],A)>0&&id(r,i,a);M<D;){for(id(r,M,D),M++,D--;u(r[M],A)<0;)M++;for(;u(r[D],A)>0;)D--}u(r[i],A)===0?id(r,i,D):id(r,++D,a),D<=e&&(i=D+1),e<=D&&(a=D-1)}}function id(r,e,i){var a=r[e];r[e]=r[i],r[i]=a}function UI(r,e){return r<e?-1:r>e?1:0}function Hg(r,e){const i=r.length;if(i<=1)return[r];const a=[];let u,p;for(let g=0;g<i;g++){const y=bo(r[g]);y!==0&&(r[g].area=Math.abs(y),p===void 0&&(p=y<0),p===y<0?(u&&a.push(u),u=[r[g]]):u.push(r[g]))}if(u&&a.push(u),e>1)for(let g=0;g<a.length;g++)a[g].length<=e||(NI(a[g],e,1,a[g].length-1,jI),a[g]=a[g].slice(0,e));return a}function jI(r,e){return e.area-r.area}function Zg(r,e,i){const a=i.patternDependencies;let u=!1;for(const p of e){const g=p.paint.get(`${r}-pattern`);g.isConstant()||(u=!0);const y=g.constantOr(null);y&&(u=!0,a[y]=!0)}return u}function Xg(r,e,i,a,u){const p=u.patternDependencies;for(const g of e){const y=g.paint.get(`${r}-pattern`).value;if(y.kind!=="constant"){let w=y.evaluate({zoom:a},i,{},u.availableImages);w=w&&w.name?w.name:w,p[w]=!0,i.patterns[g.id]=w}}return i}class Cf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new it,this.indexArray=new Ct,this.indexArray2=new Er,this.programConfigurations=new Ml(e.layers,e.zoom),this.segments=new nr,this.segments2=new nr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,a,u){this.hasPattern=Zg("fill",this.layers,i);const p=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:y,id:w,index:E,sourceLayerIndex:A}of e){const M=this.layers[0]._featureFilter.needGeometry,D=Rl(y,M);if(!this.layers[0]._featureFilter.filter(new I(this.zoom),D,a))continue;const L=p?p.evaluate(D,{},a,i.availableImages):void 0,R={id:w,properties:y.properties,type:y.type,sourceLayerIndex:A,index:E,geometry:M?D.geometry:Ns(y,a,u),patterns:{},sortKey:L};g.push(R)}p&&g.sort((y,w)=>y.sortKey-w.sortKey);for(const y of g){const{geometry:w,index:E,sourceLayerIndex:A}=y;if(this.hasPattern){const M=Xg("fill",this.layers,y,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(y,w,E,a,{},i.availableImages);i.featureIndex.insert(e[E].feature,w,E,A,this.index)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}addFeatures(e,i,a,u,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,i,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kI),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,u,p,g=[]){for(const y of Hg(i,500)){let w=0;for(const R of y)w+=R.length;const E=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),A=E.vertexLength,M=[],D=[];for(const R of y){if(R.length===0)continue;R!==y[0]&&D.push(M.length/2);const G=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),J=G.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(J+R.length-1,J),M.push(R[0].x),M.push(R[0].y);for(let oe=1;oe<R.length;oe++)this.layoutVertexArray.emplaceBack(R[oe].x,R[oe].y),this.indexArray2.emplaceBack(J+oe-1,J+oe),M.push(R[oe].x),M.push(R[oe].y);G.vertexLength+=R.length,G.primitiveLength+=R.length}const L=Wg(M,D);for(let R=0;R<L.length;R+=3)this.indexArray.emplaceBack(A+L[R],A+L[R+1],A+L[R+2]);E.vertexLength+=w,E.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,p,g,u)}}wt(Cf,"FillBucket",{omit:["layers","patternFeatures"]});const VI=new le({"fill-sort-key":new ee(qe.layout_fill["fill-sort-key"])});var GI={paint:new le({"fill-antialias":new j(qe.paint_fill["fill-antialias"]),"fill-opacity":new ee(qe.paint_fill["fill-opacity"]),"fill-color":new ee(qe.paint_fill["fill-color"]),"fill-outline-color":new ee(qe.paint_fill["fill-outline-color"]),"fill-translate":new j(qe.paint_fill["fill-translate"]),"fill-translate-anchor":new j(qe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ee(qe.paint_fill["fill-pattern"])}),layout:VI};const qI=Ae([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),$I=Ae([{name:"a_centroid_pos",components:2,type:"Uint16"}]),WI=Ae([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:HI}=qI;var Af={},ZI=we,gw=Xc;function Xc(r,e,i,a,u){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=a,this._values=u,r.readFields(XI,this,e)}function XI(r,e,i){r==1?e.id=i.readVarint():r==2?function(a,u){for(var p=a.readVarint()+a.pos;a.pos<p;){var g=u._keys[a.readVarint()],y=u._values[a.readVarint()];u.properties[g]=y}}(i,e):r==3?e.type=i.readVarint():r==4&&(e._geometry=i.pos)}function KI(r){for(var e,i,a=0,u=0,p=r.length,g=p-1;u<p;g=u++)a+=((i=r[g]).x-(e=r[u]).x)*(e.y+i.y);return a}Xc.types=["Unknown","Point","LineString","Polygon"],Xc.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,i=r.readVarint()+r.pos,a=1,u=0,p=0,g=0,y=[];r.pos<i;){if(u<=0){var w=r.readVarint();a=7&w,u=w>>3}if(u--,a===1||a===2)p+=r.readSVarint(),g+=r.readSVarint(),a===1&&(e&&y.push(e),e=[]),e.push(new ZI(p,g));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&y.push(e),y},Xc.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,i=1,a=0,u=0,p=0,g=1/0,y=-1/0,w=1/0,E=-1/0;r.pos<e;){if(a<=0){var A=r.readVarint();i=7&A,a=A>>3}if(a--,i===1||i===2)(u+=r.readSVarint())<g&&(g=u),u>y&&(y=u),(p+=r.readSVarint())<w&&(w=p),p>E&&(E=p);else if(i!==7)throw new Error("unknown command "+i)}return[g,w,y,E]},Xc.prototype.toGeoJSON=function(r,e,i){var a,u,p=this.extent*Math.pow(2,i),g=this.extent*r,y=this.extent*e,w=this.loadGeometry(),E=Xc.types[this.type];function A(L){for(var R=0;R<L.length;R++){var G=L[R];L[R]=[360*(G.x+g)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+y)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(a=0;a<w.length;a++)M[a]=w[a][0];A(w=M);break;case 2:for(a=0;a<w.length;a++)A(w[a]);break;case 3:for(w=function(L){var R=L.length;if(R<=1)return[L];for(var G,J,oe=[],pe=0;pe<R;pe++){var se=KI(L[pe]);se!==0&&(J===void 0&&(J=se<0),J===se<0?(G&&oe.push(G),G=[L[pe]]):G.push(L[pe]))}return G&&oe.push(G),oe}(w),a=0;a<w.length;a++)for(u=0;u<w[a].length;u++)A(w[a][u])}w.length===1?w=w[0]:E="Multi"+E;var D={type:"Feature",geometry:{type:E,coordinates:w},properties:this.properties};return"id"in this&&(D.id=this.id),D};var YI=gw,_w=yw;function yw(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(JI,this,e),this.length=this._features.length}function JI(r,e,i){r===15?e.version=i.readVarint():r===1?e.name=i.readString():r===5?e.extent=i.readVarint():r===2?e._features.push(i.pos):r===3?e._keys.push(i.readString()):r===4&&e._values.push(function(a){for(var u=null,p=a.readVarint()+a.pos;a.pos<p;){var g=a.readVarint()>>3;u=g===1?a.readString():g===2?a.readFloat():g===3?a.readDouble():g===4?a.readVarint64():g===5?a.readVarint():g===6?a.readSVarint():g===7?a.readBoolean():null}return u}(i))}yw.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new YI(this._pbf,e,this.extent,this._keys,this._values)};var QI=_w;function e3(r,e,i){if(r===3){var a=new QI(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}var Kg=Af.VectorTile=function(r,e){this.layers=r.readFields(e3,{},e)},If=Af.VectorTileFeature=gw;function kf(r,e,i,a){const u=[],p=a===0?(g,y,w,E,A,M)=>{g.push(new Te(M,w+(M-y)/(E-y)*(A-w)))}:(g,y,w,E,A,M)=>{g.push(new Te(y+(M-w)/(A-w)*(E-y),M))};for(const g of r){const y=[];for(const w of g){if(w.length<=2)continue;const E=[];for(let D=0;D<w.length-1;D++){const L=w[D].x,R=w[D].y,G=w[D+1].x,J=w[D+1].y,oe=a===0?L:R,pe=a===0?G:J;oe<e?pe>e&&p(E,L,R,G,J,e):oe>i?pe<i&&p(E,L,R,G,J,i):E.push(w[D]),pe<e&&oe>=e&&p(E,L,R,G,J,e),pe>i&&oe<=i&&p(E,L,R,G,J,i)}let A=w[w.length-1];const M=a===0?A.x:A.y;M>=e&&M<=i&&E.push(A),E.length&&(A=E[E.length-1],E[0].x===A.x&&E[0].y===A.y||E.push(E[0]),y.push(E))}y.length&&u.push(y)}return u}Af.VectorTileLayer=_w;const t3=If.types,n3=Math.pow(2,13);function od(r,e,i,a,u,p,g,y){r.emplaceBack((e<<1)+g,(i<<1)+p,(Math.floor(a*n3)<<1)+u,Math.round(y))}function sd(r,e,i){r.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class xw{constructor(){this.acc=new Te(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Te(e.x,e.y),this.max=new Te(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,u=this.max;e.x<a.x?a.x=e.x:e.x>u.x&&(u.x=e.x),e.y<a.y?a.y=e.y:e.y>u.y&&(u.y=e.y),((e.x===0||e.x===Dt)&&e.x===i.x)!=((e.y===0||e.y===Dt)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,rn(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Dt!=e.x>Dt&&this.addBorderIntersection(1,rn(i.y,e.y,(Dt-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,rn(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Dt!=e.y>Dt&&this.addBorderIntersection(3,rn(i.x,e.x,(Dt-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];i<a[0]&&(a[0]=i),i>a[1]&&(a[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const a=e.x===0?0:1;this.addBorderIntersection(a,i.y),this.addBorderIntersection(a,e.y)}else{const a=e.y===0?2:3;this.addBorderIntersection(a,i.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((i,a)=>i+a.edges,0);return e!==0?this.acc.div(e)._round():new Te(0,0)}span(){return new Te(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class ad{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Ze,this.centroidVertexArray=new Lo,this.indexArray=new Ct,this.programConfigurations=new Ml(e.layers,e.zoom),this.segments=new nr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,a,u){this.features=[],this.hasPattern=Zg("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const g=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*g/(g*g+1)/Dt/(1<<p.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:g,index:y,sourceLayerIndex:w}of e){const E=this.layers[0]._featureFilter.needGeometry,A=Rl(p,E);if(!this.layers[0]._featureFilter.filter(new I(this.zoom),A,a))continue;const M={id:g,sourceLayerIndex:w,index:y,geometry:E?A.geometry:Ns(p,a,u),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(Xg("fill-extrusion",this.layers,M,this.zoom,i)):this.addFeature(M,M.geometry,y,a,{},i.availableImages,u),i.featureIndex.insert(p,M.geometry,y,w,this.index,D)}this.sortBorders()}addFeatures(e,i,a,u,p){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,i,a,u,p)}this.sortBorders()}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,HI),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,WI.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,$I.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,u,p,g,y){const w=[new Te(0,0),new Te(Dt,Dt)],E=y.projection,A=E.name==="globe",M=this.enableTerrain&&!A?new xw:null,D=t3[e.type]==="Polygon";A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new at);const L=Hg(i,500);for(let oe=L.length-1;oe>=0;oe--){const pe=L[oe];(pe.length===0||(R=pe[0]).every(se=>se.x<=0)||R.every(se=>se.x>=Dt)||R.every(se=>se.y<=0)||R.every(se=>se.y>=Dt))&&L.splice(oe,1)}var R;let G;if(A)G=Cw(L,w,u);else{G=[];for(const oe of L)G.push({polygon:oe,bounds:w})}const J=D?this.edgeRadius:0;for(const{polygon:oe,bounds:pe}of G){let se=0,he=0;for(const me of oe)D&&!me[0].equals(me[me.length-1])&&me.push(me[0]),he+=D?me.length-1:me.length;const ge=this.segments.prepareSegment((D?5:4)*he,this.layoutVertexArray,this.indexArray);if(D){const me=[],Le=[];se=ge.vertexLength;for(const $e of oe){let ot,Oe;$e.length&&$e!==oe[0]&&Le.push(me.length/2),ot=$e[1].sub($e[0])._perp()._unit();for(let Ke=1;Ke<$e.length;Ke++){const Ye=$e[Ke],nt=$e[Ke===$e.length-1?1:Ke+1];let{x:ut,y:Ge}=Ye;if(J){Oe=nt.sub(Ye)._perp()._unit();const mt=ot.add(Oe)._unit(),Tt=J*Math.min(4,1/(ot.x*mt.x+ot.y*mt.y));ut+=Tt*mt.x,Ge+=Tt*mt.y,ot=Oe}od(this.layoutVertexArray,ut,Ge,0,0,1,1,0),ge.vertexLength++,me.push(Ye.x,Ye.y),A&&sd(this.layoutVertexExtArray,E.projectTilePoint(ut,Ge,u),E.upVector(u,ut,Ge))}}const Pe=Wg(me,Le);for(let $e=0;$e<Pe.length;$e+=3)this.indexArray.emplaceBack(se+Pe[$e],se+Pe[$e+2],se+Pe[$e+1]),ge.primitiveLength++}for(const me of oe){M&&me.length&&M.startRing(me[0]);let Le,Pe,$e,ot=me.length>4&&Ew(me[me.length-2],me[0],me[1]),Oe=J?r3(me[me.length-2],me[0],me[1],J):0;Pe=me[1].sub(me[0])._perp()._unit();let Ke=!0;for(let Ye=1,nt=0;Ye<me.length;Ye++){let ut=me[Ye-1],Ge=me[Ye];const mt=me[Ye===me.length-1?1:Ye+1];if(M&&D&&M.currentPolyCount.top++,bw(Ge,ut,pe)){J&&(Pe=mt.sub(Ge)._perp()._unit(),Ke=!Ke);continue}M&&M.append(Ge,ut);const Tt=Ge.sub(ut)._perp(),gt=Tt.x/(Math.abs(Tt.x)+Math.abs(Tt.y)),Ut=Tt.y>0?1:0,ht=ut.dist(Ge);if(nt+ht>32768&&(nt=0),J){$e=mt.sub(Ge)._perp()._unit();let Vt=ww(ut,Ge,mt,vw(Pe,$e),J);isNaN(Vt)&&(Vt=0);const Bt=Ge.sub(ut)._unit();ut=ut.add(Bt.mult(Oe))._round(),Ge=Ge.add(Bt.mult(-Vt))._round(),Oe=Vt,Pe=$e}const It=ge.vertexLength,jt=me.length>4&&Ew(ut,Ge,mt);let an=Tw(nt,ot,Ke);if(od(this.layoutVertexArray,ut.x,ut.y,gt,Ut,0,0,an),od(this.layoutVertexArray,ut.x,ut.y,gt,Ut,0,1,an),nt+=ht,an=Tw(nt,jt,!Ke),ot=jt,od(this.layoutVertexArray,Ge.x,Ge.y,gt,Ut,0,0,an),od(this.layoutVertexArray,Ge.x,Ge.y,gt,Ut,0,1,an),ge.vertexLength+=4,this.indexArray.emplaceBack(It+0,It+1,It+2),this.indexArray.emplaceBack(It+1,It+3,It+2),ge.primitiveLength+=2,J){const Vt=se+(Ye===1?me.length-2:Ye-2),Bt=Ye===1?se:Vt+1;if(this.indexArray.emplaceBack(It+1,Vt,It+3),this.indexArray.emplaceBack(Vt,Bt,It+3),ge.primitiveLength+=2,Le===void 0&&(Le=It),!bw(mt,me[Ye],pe)){const Pn=Ye===me.length-1?Le:ge.vertexLength;this.indexArray.emplaceBack(It+2,It+3,Pn),this.indexArray.emplaceBack(It+3,Pn+1,Pn),this.indexArray.emplaceBack(It+3,Bt,Pn+1),ge.primitiveLength+=3}Ke=!Ke}if(A){const Vt=this.layoutVertexExtArray,Bt=E.projectTilePoint(ut.x,ut.y,u),Pn=E.projectTilePoint(Ge.x,Ge.y,u),Gt=E.upVector(u,ut.x,ut.y),qt=E.upVector(u,Ge.x,Ge.y);sd(Vt,Bt,Gt),sd(Vt,Bt,Gt),sd(Vt,Pn,qt),sd(Vt,Pn,qt)}}D&&(se+=me.length-1)}}if(M&&M.polyCount.length>0){if(M.borders){M.vertexArrayOffset=this.centroidVertexArray.length;const oe=M.borders,pe=this.featuresOnBorder.push(M)-1;for(let se=0;se<4;se++)oe[se][0]!==Number.MAX_VALUE&&this.borders[se].push(pe)}this.encodeCentroid(M.borders?void 0:M.centroid(),M)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,p,g,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,a)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,i,a=!0){let u,p;if(e)if(e.y!==0){const y=i.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),p=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else u=Math.ceil(7*(e.x+450)),p=0;else u=0,p=+a;let g=a?this.centroidVertexArray.length:i.vertexArrayOffset;for(const y of i.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let w=0;w<y.top;w++)this.centroidVertexArray.emplace(g++,u,p);for(let w=0;w<2*y.edges;w++)this.centroidVertexArray.emplace(g++,0,p),this.centroidVertexArray.emplace(g++,u,p)}}}function vw(r,e){const i=r.add(e)._unit();return r.x*i.x+r.y*i.y}function r3(r,e,i,a){const u=e.sub(r)._perp()._unit(),p=i.sub(e)._perp()._unit();return ww(r,e,i,vw(u,p),a)}function ww(r,e,i,a,u){const p=Math.sqrt(1-a*a);return Math.min(r.dist(e)/3,e.dist(i)/3,u*p/a)}function bw(r,e,i){return r.x<i[0].x&&e.x<i[0].x||r.x>i[1].x&&e.x>i[1].x||r.y<i[0].y&&e.y<i[0].y||r.y>i[1].y&&e.y>i[1].y}function Ew(r,e,i){if(r.x<0||r.x>=Dt||e.x<0||e.x>=Dt||i.x<0||i.x>=Dt)return!1;const a=i.sub(e),u=a.perp(),p=r.sub(e);return(a.x*p.x+a.y*p.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(p.x*p.x+p.y*p.y))>-.866&&u.x*p.x+u.y*p.y<0}function Tw(r,e,i){const a=e?2|r:-3&r;return i?1|a:-2&a}function Sw(){const r=Math.PI/32,e=Math.tan(r),i=ed;return i*Math.sqrt(1+2*e*e)-i}function Cw(r,e,i){const a=1<<i.z,u=$i(i.x/a),p=$i((i.x+1)/a),g=Nr(i.y/a),y=Nr((i.y+1)/a);return function(w,E,A,M,D=0,L){const R=[];if(!w.length||!A||!M)return R;const G=(me,Le)=>{for(const Pe of me)R.push({polygon:Pe,bounds:Le})},J=Math.ceil(Math.log2(A)),oe=Math.ceil(Math.log2(M)),pe=J-oe,se=[];for(let me=0;me<Math.abs(pe);me++)se.push(pe>0?0:1);for(let me=0;me<Math.min(J,oe);me++)se.push(0),se.push(1);let he=w;if(he=kf(he,E[0].y-D,E[1].y+D,1),he=kf(he,E[0].x-D,E[1].x+D,0),!he.length)return R;const ge=[];for(se.length?ge.push({polygons:he,bounds:E,depth:0}):G(he,E);ge.length;){const me=ge.pop(),Le=me.depth,Pe=se[Le],$e=me.bounds[0],ot=me.bounds[1],Oe=Pe===0?$e.x:$e.y,Ke=Pe===0?ot.x:ot.y,Ye=L?L(Pe,Oe,Ke):.5*(Oe+Ke),nt=kf(me.polygons,Oe-D,Ye+D,Pe),ut=kf(me.polygons,Ye-D,Ke+D,Pe);if(nt.length){const Ge=[$e,new Te(Pe===0?Ye:ot.x,Pe===1?Ye:ot.y)];se.length>Le+1?ge.push({polygons:nt,bounds:Ge,depth:Le+1}):G(nt,Ge)}if(ut.length){const Ge=[new Te(Pe===0?Ye:$e.x,Pe===1?Ye:$e.y),ot];se.length>Le+1?ge.push({polygons:ut,bounds:Ge,depth:Le+1}):G(ut,Ge)}}return R}(r,e,Math.ceil((p-u)/11.25),Math.ceil((g-y)/11.25),1,(w,E,A)=>{if(w===0)return .5*(E+A);{const M=Nr((i.y+E/Dt)/a);return(cs(.5*(Nr((i.y+A/Dt)/a)+M))*a-i.y)*Dt}})}wt(ad,"FillExtrusionBucket",{omit:["layers","features"]}),wt(xw,"PartMetadata");const i3=new le({"fill-extrusion-edge-radius":new j(qe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var o3={paint:new le({"fill-extrusion-opacity":new j(qe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ee(qe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new j(qe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new j(qe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ee(qe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ee(qe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ee(qe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new j(qe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new j(qe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new j(qe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new j(qe["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:i3};function Aw(r,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[r*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Mf{constructor(e,i,a){this.z=e,this.x=i,this.y=a,this.key=ld(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const a=function(p,g,y){var w=Aw(256*p,256*(g=Math.pow(2,y)-g-1),y),E=Aw(256*(p+1),256*(g+1),y);return w[0]+","+w[1]+","+E[0]+","+E[1]}(this.x,this.y,this.z),u=function(p,g,y){let w,E="";for(let A=p;A>0;A--)w=1<<A-1,E+=(g&w?1:0)+(y&w?2:0);return E}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Iw{constructor(e,i){this.wrap=e,this.canonical=i,this.key=ld(e,i.z,i.z,i.x,i.y)}}class ri{constructor(e,i,a,u,p){this.overscaledZ=e,this.wrap=i,this.canonical=new Mf(a,+u,+p),this.key=i===0&&e===a?this.canonical.key:ld(i,e,a,u,p)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new ri(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ri(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return ld(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return ld(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new ri(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,u=2*this.canonical.y;return[new ri(i,this.wrap,i,a,u),new ri(i,this.wrap,i,a+1,u),new ri(i,this.wrap,i,a,u+1),new ri(i,this.wrap,i,a+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ri(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ri(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Iw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ld(r,e,i,a,u){const p=1<<Math.min(i,22);let g=p*(u%p)+a%p;return r&&i<22&&(g+=p*p*((r<0?-2*r-1:2*r)%(1<<2*(22-i)))),16*(32*g+i)+(e-i)}wt(Mf,"CanonicalTileID"),wt(ri,"OverscaledTileID",{omit:["projMatrix"]});class Kc extends Te{constructor(e,i,a){super(e,i),this.z=a}}function cd(r,e){return r.x*e.x+r.y*e.y}function kw(r,e){if(r.length===1){let i=0;const a=e[i++];let u;for(;!u||a.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const p=e[i],g=r[0],y=u.sub(a),w=p.sub(a),E=g.sub(a),A=cd(y,y),M=cd(y,w),D=cd(w,w),L=cd(E,y),R=cd(E,w),G=A*D-M*M,J=(D*L-M*R)/G,oe=(A*R-M*L)/G,pe=a.z*(1-J-oe)+u.z*J+p.z*oe;if(isFinite(pe))return pe}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}function Mw(r,e,i,a,u,p,g,y){const w=g*u.getElevationAt(r,e,!0,!0),E=p[0]!==0,A=E?p[1]===0?g*(p[0]/7-450):g*function(M,D,L){const R=Math.floor(D[0]/8),G=Math.floor(D[1]/8),J=10*(D[0]-8*R),oe=10*(D[1]-8*G),pe=M.getElevationAt(R,G,!0,!0),se=M.getMeterToDEM(L),he=Math.floor(.5*(J*se-1)),ge=Math.floor(.5*(oe*se-1)),me=M.tileCoordToPixel(R,G),Le=2*he+1,Pe=2*ge+1,$e=function(ut,Ge,mt,Tt,gt){return[ut.getElevationAtPixel(Ge,mt,!0),ut.getElevationAtPixel(Ge+gt,mt,!0),ut.getElevationAtPixel(Ge,mt+gt,!0),ut.getElevationAtPixel(Ge+Tt,mt+gt,!0)]}(M,me.x-he,me.y-ge,Le,Pe),ot=Math.abs($e[0]-$e[1]),Oe=Math.abs($e[2]-$e[3]),Ke=Math.abs($e[0]-$e[2])+Math.abs($e[1]-$e[3]),Ye=Math.min(.25,.5*se*(ot+Oe)/Le),nt=Math.min(.25,.5*se*Ke/Pe);return pe+Math.max(Ye*J,nt*oe)}(u,p,y):w;return{base:w+(i===0)?-1:i,top:E?Math.max(A+a,w+i+2):w+a}}const s3=Ae([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:a3}=s3,l3=Ae([{name:"a_packed",components:4,type:"Float32"}]),{members:c3}=l3,u3=If.types,h3=Math.cos(Math.PI/180*37.5);class Df{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Fe,this.layoutVertexArray2=new rt,this.indexArray=new Ct,this.programConfigurations=new Ml(e.layers,e.zoom),this.segments=new nr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,u){this.hasPattern=Zg("line",this.layers,i);const p=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:A,id:M,index:D,sourceLayerIndex:L}of e){const R=this.layers[0]._featureFilter.needGeometry,G=Rl(A,R);if(!this.layers[0]._featureFilter.filter(new I(this.zoom),G,a))continue;const J=p?p.evaluate(G,{},a):void 0,oe={id:M,properties:A.properties,type:A.type,sourceLayerIndex:L,index:D,geometry:R?G.geometry:Ns(A,a,u),patterns:{},sortKey:J};g.push(oe)}p&&g.sort((A,M)=>A.sortKey-M.sortKey);const{lineAtlas:y,featureIndex:w}=i,E=this.addConstantDashes(y);for(const A of g){const{geometry:M,index:D,sourceLayerIndex:L}=A;if(E&&this.addFeatureDashes(A,y),this.hasPattern){const R=Xg("line",this.layers,A,this.zoom,i);this.patternFeatures.push(R)}else this.addFeature(A,M,D,a,y.positions,i.availableImages);w.insert(e[D].feature,M,D,L,this.index)}}addConstantDashes(e){let i=!1;for(const a of this.layers){const u=a.paint.get("line-dasharray").value,p=a.layout.get("line-cap").value;if(u.kind!=="constant"||p.kind!=="constant")i=!0;else{const g=p.value,y=u.value;if(!y)continue;e.addDash(y,g)}}return i}addFeatureDashes(e,i){const a=this.zoom;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if(p.kind==="constant"&&g.kind==="constant")continue;let y,w;if(p.kind==="constant"){if(y=p.value,!y)continue}else y=p.evaluate({zoom:a},e);w=g.kind==="constant"?g.value:g.evaluate({zoom:a},e),i.addDash(y,w),e.patterns[u.id]=i.getKey(y,w)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}addFeatures(e,i,a,u,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,i,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,c3)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,a3),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,u,p,g){const y=this.layers[0].layout,w=y.get("line-join").evaluate(e,{}),E=y.get("line-cap").evaluate(e,{}),A=y.get("line-miter-limit"),M=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const D of i)this.addLine(D,e,w,E,A,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,p,g,u)}addLine(e,i,a,u,p,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<e.length-1;oe++)this.totalDistance+=e[oe].dist(e[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=u3[i.type]==="Polygon";let w=e.length;for(;w>=2&&e[w-1].equals(e[w-2]);)w--;let E=0;for(;E<w-1&&e[E].equals(e[E+1]);)E++;if(w<(y?3:2))return;a==="bevel"&&(p=1.05);const A=this.overscaling<=16?15*Dt/(512*this.overscaling):0,M=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let D,L,R,G,J;this.e1=this.e2=-1,y&&(D=e[w-2],J=e[E].sub(D)._unit()._perp());for(let oe=E;oe<w;oe++){if(R=oe===w-1?y?e[E+1]:void 0:e[oe+1],R&&e[oe].equals(R))continue;J&&(G=J),D&&(L=D),D=e[oe],J=R?R.sub(D)._unit()._perp():G,G=G||J;let pe=G.add(J);pe.x===0&&pe.y===0||pe._unit();const se=G.x*J.x+G.y*J.y,he=pe.x*J.x+pe.y*J.y,ge=he!==0?1/he:1/0,me=2*Math.sqrt(2-2*he),Le=he<h3&&L&&R,Pe=G.x*J.y-G.y*J.x>0;if(Le&&oe>E){const Oe=D.dist(L);if(Oe>2*A){const Ke=D.sub(D.sub(L)._mult(A/Oe)._round());this.updateDistance(L,Ke),this.addCurrentVertex(Ke,G,0,0,M),L=Ke}}const $e=L&&R;let ot=$e?a:y?"butt":u;if($e&&ot==="round"&&(ge<g?ot="miter":ge<=2&&(ot="fakeround")),ot==="miter"&&ge>p&&(ot="bevel"),ot==="bevel"&&(ge>2&&(ot="flipbevel"),ge<p&&(ot="miter")),L&&this.updateDistance(L,D),ot==="miter")pe._mult(ge),this.addCurrentVertex(D,pe,0,0,M);else if(ot==="flipbevel"){if(ge>100)pe=J.mult(-1);else{const Oe=ge*G.add(J).mag()/G.sub(J).mag();pe._perp()._mult(Oe*(Pe?-1:1))}this.addCurrentVertex(D,pe,0,0,M),this.addCurrentVertex(D,pe.mult(-1),0,0,M)}else if(ot==="bevel"||ot==="fakeround"){const Oe=-Math.sqrt(ge*ge-1),Ke=Pe?Oe:0,Ye=Pe?0:Oe;if(L&&this.addCurrentVertex(D,G,Ke,Ye,M),ot==="fakeround"){const nt=Math.round(180*me/Math.PI/20);for(let ut=1;ut<nt;ut++){let Ge=ut/nt;if(Ge!==.5){const Tt=Ge-.5;Ge+=Ge*Tt*(Ge-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*Tt*Tt+(.848013+se*(.215638*se-1.06021)))}const mt=J.sub(G)._mult(Ge)._add(G)._unit()._mult(Pe?-1:1);this.addHalfVertex(D,mt.x,mt.y,!1,Pe,0,M)}}R&&this.addCurrentVertex(D,J,-Ke,-Ye,M)}else if(ot==="butt")this.addCurrentVertex(D,pe,0,0,M);else if(ot==="square"){const Oe=L?1:-1;L||this.addCurrentVertex(D,pe,Oe,Oe,M),this.addCurrentVertex(D,pe,0,0,M),L&&this.addCurrentVertex(D,pe,Oe,Oe,M)}else ot==="round"&&(L&&(this.addCurrentVertex(D,G,0,0,M),this.addCurrentVertex(D,G,1,1,M,!0)),R&&(this.addCurrentVertex(D,J,-1,-1,M,!0),this.addCurrentVertex(D,J,0,0,M)));if(Le&&oe<w-1){const Oe=D.dist(R);if(Oe>2*A){const Ke=D.add(R.sub(D)._mult(A/Oe)._round());this.updateDistance(D,Ke),this.addCurrentVertex(Ke,J,0,0,M),D=Ke}}}}addCurrentVertex(e,i,a,u,p,g=!1){const y=i.y*u-i.x,w=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,g,!1,a,p),this.addHalfVertex(e,y,w,g,!0,-u,p)}addHalfVertex({x:e,y:i},a,u,p,g,y,w){this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(i<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*u)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const E=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),w.primitiveLength++),g?this.e2=E:this.e1=E}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}wt(Df,"LineBucket",{omit:["layers","patternFeatures"]});const d3=new le({"line-cap":new ee(qe.layout_line["line-cap"]),"line-join":new ee(qe.layout_line["line-join"]),"line-miter-limit":new j(qe.layout_line["line-miter-limit"]),"line-round-limit":new j(qe.layout_line["line-round-limit"]),"line-sort-key":new ee(qe.layout_line["line-sort-key"])});var Dw={paint:new le({"line-opacity":new ee(qe.paint_line["line-opacity"]),"line-color":new ee(qe.paint_line["line-color"]),"line-translate":new j(qe.paint_line["line-translate"]),"line-translate-anchor":new j(qe.paint_line["line-translate-anchor"]),"line-width":new ee(qe.paint_line["line-width"]),"line-gap-width":new ee(qe.paint_line["line-gap-width"]),"line-offset":new ee(qe.paint_line["line-offset"]),"line-blur":new ee(qe.paint_line["line-blur"]),"line-dasharray":new ee(qe.paint_line["line-dasharray"]),"line-pattern":new ee(qe.paint_line["line-pattern"]),"line-gradient":new ae(qe.paint_line["line-gradient"]),"line-trim-offset":new j(qe.paint_line["line-trim-offset"])}),layout:d3};const Pw=new class extends ee{possiblyEvaluate(r,e){return e=new I(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,i,a){return e=et({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,i,a)}}(Dw.paint.properties["line-width"].specification);function zw(r,e){return e>0?e+2*r:r}Pw.useIntegerZoom=!0;const p3=Ae([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),f3=Ae([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),m3=Ae([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ae([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const g3=Ae([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),_3=Ae([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ae([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Bw=Ae([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),y3=Ae([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ae([{name:"triangle",components:3,type:"Uint16"}]),Ae([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ae([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ae([{type:"Float32",name:"offsetX"}]),Ae([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Dr=24;const jo=128;function Yg(r,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new I(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:u}=i;let p=0;for(;p<a.length&&a[p]<=r;)p++;p=Math.max(0,p-1);let g=p;for(;g<a.length&&a[g]<r+1;)g++;g=Math.min(a.length-1,g);const y=a[p],w=a[g];return i.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:w,minSize:i.evaluate(new I(y)),maxSize:i.evaluate(new I(w)),interpolationType:u}}}function Pf(r,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:u}){return r.kind==="source"?a/jo:r.kind==="composite"?rn(a/jo,u/jo,i):e}function Yc(r,e){let i=0,a=0;if(r.kind==="constant")a=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:u,minZoom:p,maxZoom:g}=r,y=u?We(lo.interpolationFactor(u,e,p,g),0,1):0;r.kind==="camera"?a=rn(r.minSize,r.maxSize,y):i=y}return{uSizeT:i,uSize:a}}var x3=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:jo,evaluateSizeForFeature:Pf,evaluateSizeForZoom:Yc,getSizeData:Yg});function v3(r,e,i){return r.sections.forEach(a=>{a.text=function(u,p,g){const y=p.layout.get("text-transform").evaluate(g,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),S.applyArabicShaping&&(u=S.applyArabicShaping(u)),u}(a.text,e,i)}),r}const ud={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function w3(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}function b3(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}var Lw=In,Rw=function(r,e,i,a,u){var p,g,y=8*u-a-1,w=(1<<y)-1,E=w>>1,A=-7,M=i?u-1:0,D=i?-1:1,L=r[e+M];for(M+=D,p=L&(1<<-A)-1,L>>=-A,A+=y;A>0;p=256*p+r[e+M],M+=D,A-=8);for(g=p&(1<<-A)-1,p>>=-A,A+=a;A>0;g=256*g+r[e+M],M+=D,A-=8);if(p===0)p=1-E;else{if(p===w)return g?NaN:1/0*(L?-1:1);g+=Math.pow(2,a),p-=E}return(L?-1:1)*g*Math.pow(2,p-a)},Fw=function(r,e,i,a,u,p){var g,y,w,E=8*p-u-1,A=(1<<E)-1,M=A>>1,D=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=a?0:p-1,R=a?1:-1,G=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,g=A):(g=Math.floor(Math.log(e)/Math.LN2),e*(w=Math.pow(2,-g))<1&&(g--,w*=2),(e+=g+M>=1?D/w:D*Math.pow(2,1-M))*w>=2&&(g++,w/=2),g+M>=A?(y=0,g=A):g+M>=1?(y=(e*w-1)*Math.pow(2,u),g+=M):(y=e*Math.pow(2,M-1)*Math.pow(2,u),g=0));u>=8;r[i+L]=255&y,L+=R,y/=256,u-=8);for(g=g<<u|y,E+=u;E>0;r[i+L]=255&g,L+=R,g/=256,E-=8);r[i+L-R]|=128*G};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function In(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}In.Varint=0,In.Fixed64=1,In.Bytes=2,In.Fixed32=5;var Jg=4294967296,Ow=1/Jg,Nw=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function js(r){return r.type===In.Bytes?r.readVarint()+r.pos:r.pos+1}function Jc(r,e,i){return i?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function Uw(r,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var u=i.pos-1;u>=r;u--)i.buf[u+a]=i.buf[u]}function E3(r,e){for(var i=0;i<r.length;i++)e.writeVarint(r[i])}function T3(r,e){for(var i=0;i<r.length;i++)e.writeSVarint(r[i])}function S3(r,e){for(var i=0;i<r.length;i++)e.writeFloat(r[i])}function C3(r,e){for(var i=0;i<r.length;i++)e.writeDouble(r[i])}function A3(r,e){for(var i=0;i<r.length;i++)e.writeBoolean(r[i])}function I3(r,e){for(var i=0;i<r.length;i++)e.writeFixed32(r[i])}function k3(r,e){for(var i=0;i<r.length;i++)e.writeSFixed32(r[i])}function M3(r,e){for(var i=0;i<r.length;i++)e.writeFixed64(r[i])}function D3(r,e){for(var i=0;i<r.length;i++)e.writeSFixed64(r[i])}function zf(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Qc(r,e,i){r[i]=e,r[i+1]=e>>>8,r[i+2]=e>>>16,r[i+3]=e>>>24}function jw(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}In.prototype={destroy:function(){this.buf=null},readFields:function(r,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),u=a>>3,p=this.pos;this.type=7&a,r(u,e,this),this.pos===p&&this.skip(a)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=zf(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=jw(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=zf(this.buf,this.pos)+zf(this.buf,this.pos+4)*Jg;return this.pos+=8,r},readSFixed64:function(){var r=zf(this.buf,this.pos)+jw(this.buf,this.pos+4)*Jg;return this.pos+=8,r},readFloat:function(){var r=Rw(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Rw(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(u,p,g){var y,w,E=g.buf;if(y=(112&(w=E[g.pos++]))>>4,w<128||(y|=(127&(w=E[g.pos++]))<<3,w<128)||(y|=(127&(w=E[g.pos++]))<<10,w<128)||(y|=(127&(w=E[g.pos++]))<<17,w<128)||(y|=(127&(w=E[g.pos++]))<<24,w<128)||(y|=(1&(w=E[g.pos++]))<<31,w<128))return Jc(u,y,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&Nw?function(i,a,u){return Nw.decode(i.subarray(a,u))}(this.buf,e,r):function(i,a,u){for(var p="",g=a;g<u;){var y,w,E,A=i[g],M=null,D=A>239?4:A>223?3:A>191?2:1;if(g+D>u)break;D===1?A<128&&(M=A):D===2?(192&(y=i[g+1]))==128&&(M=(31&A)<<6|63&y)<=127&&(M=null):D===3?(w=i[g+2],(192&(y=i[g+1]))==128&&(192&w)==128&&((M=(15&A)<<12|(63&y)<<6|63&w)<=2047||M>=55296&&M<=57343)&&(M=null)):D===4&&(w=i[g+2],E=i[g+3],(192&(y=i[g+1]))==128&&(192&w)==128&&(192&E)==128&&((M=(15&A)<<18|(63&y)<<12|(63&w)<<6|63&E)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,D=1):M>65535&&(M-=65536,p+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),p+=String.fromCharCode(M),g+=D}return p}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==In.Bytes)return r.push(this.readVarint(e));var i=js(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==In.Bytes)return r.push(this.readSVarint());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==In.Bytes)return r.push(this.readBoolean());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==In.Bytes)return r.push(this.readFloat());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==In.Bytes)return r.push(this.readDouble());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==In.Bytes)return r.push(this.readFixed32());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==In.Bytes)return r.push(this.readSFixed32());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==In.Bytes)return r.push(this.readFixed64());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==In.Bytes)return r.push(this.readSFixed64());var e=js(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===In.Varint)for(;this.buf[this.pos++]>127;);else if(e===In.Bytes)this.pos=this.readVarint()+this.pos;else if(e===In.Fixed32)this.pos+=4;else{if(e!==In.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Qc(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Qc(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Qc(this.buf,-1&r,this.pos),Qc(this.buf,Math.floor(r*Ow),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Qc(this.buf,-1&r,this.pos),Qc(this.buf,Math.floor(r*Ow),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,i){var a,u;if(e>=0?(a=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,g,y){y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,y.buf[y.pos]=127&(p>>>=7)}(a,0,i),function(p,g){var y=(7&p)<<4;g.buf[g.pos++]|=y|((p>>>=3)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p)))))}(u,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(a,u,p){for(var g,y,w=0;w<u.length;w++){if((g=u.charCodeAt(w))>55295&&g<57344){if(!y){g>56319||w+1===u.length?(a[p++]=239,a[p++]=191,a[p++]=189):y=g;continue}if(g<56320){a[p++]=239,a[p++]=191,a[p++]=189,y=g;continue}g=y-55296<<10|g-56320|65536,y=null}else y&&(a[p++]=239,a[p++]=191,a[p++]=189,y=null);g<128?a[p++]=g:(g<2048?a[p++]=g>>6|192:(g<65536?a[p++]=g>>12|224:(a[p++]=g>>18|240,a[p++]=g>>12&63|128),a[p++]=g>>6&63|128),a[p++]=63&g|128)}return p}(this.buf,r,this.pos);var i=this.pos-e;i>=128&&Uw(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),Fw(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Fw(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,e){this.pos++;var i=this.pos;r(e,this);var a=this.pos-i;a>=128&&Uw(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(r,e,i){this.writeTag(r,In.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,E3,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,T3,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,A3,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,S3,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,C3,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,I3,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,k3,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,M3,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,D3,e)},writeBytesField:function(r,e){this.writeTag(r,In.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,In.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,In.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,In.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,In.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,In.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,In.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,In.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,In.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,In.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};var Bf=V(Lw);const Qg=3;function P3(r,e,i){e.glyphs=[],r===1&&i.readMessage(z3,e)}function z3(r,e,i){if(r===3){const{id:a,bitmap:u,width:p,height:g,left:y,top:w,advance:E}=i.readMessage(B3,{});e.glyphs.push({id:a,bitmap:new Us({width:p+2*Qg,height:g+2*Qg},u),metrics:{width:p,height:g,left:y,top:w,advance:E}})}else r===4?e.ascender=i.readSVarint():r===5&&(e.descender=i.readSVarint())}function B3(r,e,i){r===1?e.id=i.readVarint():r===2?e.bitmap=i.readBytes():r===3?e.width=i.readVarint():r===4?e.height=i.readVarint():r===5?e.left=i.readSVarint():r===6?e.top=i.readSVarint():r===7&&(e.advance=i.readVarint())}const Vw=Qg;function e_(r){let e=0,i=0;for(const g of r)e+=g.w*g.h,i=Math.max(i,g.w);r.sort((g,y)=>y.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,p=0;for(const g of r)for(let y=a.length-1;y>=0;y--){const w=a[y];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,p=Math.max(p,g.y+g.h),u=Math.max(u,g.x+g.w),g.w===w.w&&g.h===w.h){const E=a.pop();y<a.length&&(a[y]=E)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(a.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:u,h:p,fill:e/(u*p)||0}}const mi=1;class t_{constructor(e,{pixelRatio:i,version:a,stretchX:u,stretchY:p,content:g}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=p,this.content=g,this.version=a}get tl(){return[this.paddedRect.x+mi,this.paddedRect.y+mi]}get br(){return[this.paddedRect.x+this.paddedRect.w-mi,this.paddedRect.y+this.paddedRect.h-mi]}get displaySize(){return[(this.paddedRect.w-2*mi)/this.pixelRatio,(this.paddedRect.h-2*mi)/this.pixelRatio]}}class Gw{constructor(e,i){const a={},u={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,a,p),this.addImages(i,u,p);const{w:g,h:y}=e_(p),w=new Ci({width:g||1,height:y||1});for(const E in e){const A=e[E],M=a[E].paddedRect;Ci.copy(A.data,w,{x:0,y:0},{x:M.x+mi,y:M.y+mi},A.data)}for(const E in i){const A=i[E],M=u[E].paddedRect,D=M.x+mi,L=M.y+mi,R=A.data.width,G=A.data.height;Ci.copy(A.data,w,{x:0,y:0},{x:D,y:L},A.data),Ci.copy(A.data,w,{x:0,y:G-1},{x:D,y:L-1},{width:R,height:1}),Ci.copy(A.data,w,{x:0,y:0},{x:D,y:L+G},{width:R,height:1}),Ci.copy(A.data,w,{x:R-1,y:0},{x:D-1,y:L},{width:1,height:G}),Ci.copy(A.data,w,{x:0,y:0},{x:D+R,y:L},{width:1,height:G})}this.image=w,this.iconPositions=a,this.patternPositions=u}addImages(e,i,a){for(const u in e){const p=e[u],g={x:0,y:0,w:p.data.width+2*mi,h:p.data.height+2*mi};a.push(g),i[u]=new t_(g,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,p]=e.tl;a.update(i.data,void 0,{x:u,y:p})}}wt(t_,"ImagePosition"),wt(Gw,"ImageAtlas");const Wi={horizontal:1,vertical:2,horizontalOnly:3},qw=-17;class hd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new hd;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new hd;return i.imageName=e,i}}class eu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new eu;for(let u=0;u<e.sections.length;u++){const p=e.sections[u];p.image?a.addImageSection(p):a.addTextSection(p,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,a){let u="";for(let p=0;p<i.length;p++){const g=i.charCodeAt(p+1)||null,y=i.charCodeAt(p-1)||null;u+=!a&&(g&&cf(g)&&!ud[i[p+1]]||y&&cf(y)&&!ud[i[p-1]])||!ud[i[p]]?i[p]:ud[i[p]]}return u}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&Lf[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Lf[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new eu;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(hd.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void mn("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(hd.forImage(i)),this.sectionIndex.push(this.sections.length-1)):mn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function n_(r,e,i,a,u,p,g,y,w,E,A,M,D,L,R){const G=eu.fromFeature(r,u);M===Wi.vertical&&G.verticalizePunctuation(D);let J=[];const oe=function(me,Le,Pe,$e,ot,Oe){if(!me)return[];const Ke=[],Ye=function(mt,Tt,gt,Ut,ht,It){let jt=0;for(let an=0;an<mt.length();an++){const Vt=mt.getSection(an);jt+=$w(mt.getCharCode(an),Vt,Ut,ht,Tt,It)}return jt/Math.max(1,Math.ceil(jt/gt))}(me,Le,Pe,$e,ot,Oe),nt=me.text.indexOf("")>=0;let ut=0;for(let mt=0;mt<me.length();mt++){const Tt=me.getSection(mt),gt=me.getCharCode(mt);if(Lf[gt]||(ut+=$w(gt,Tt,$e,ot,Le,Oe)),mt<me.length()-1){const Ut=!((Ge=gt)<11904||!(_t["Bopomofo Extended"](Ge)||_t.Bopomofo(Ge)||_t["CJK Compatibility Forms"](Ge)||_t["CJK Compatibility Ideographs"](Ge)||_t["CJK Compatibility"](Ge)||_t["CJK Radicals Supplement"](Ge)||_t["CJK Strokes"](Ge)||_t["CJK Symbols and Punctuation"](Ge)||_t["CJK Unified Ideographs Extension A"](Ge)||_t["CJK Unified Ideographs"](Ge)||_t["Enclosed CJK Letters and Months"](Ge)||_t["Halfwidth and Fullwidth Forms"](Ge)||_t.Hiragana(Ge)||_t["Ideographic Description Characters"](Ge)||_t["Kangxi Radicals"](Ge)||_t["Katakana Phonetic Extensions"](Ge)||_t.Katakana(Ge)||_t["Vertical Forms"](Ge)||_t["Yi Radicals"](Ge)||_t["Yi Syllables"](Ge)));(L3[gt]||Ut||Tt.imageName)&&Ke.push(Hw(mt+1,ut,Ye,Ke,R3(gt,me.getCharCode(mt+1),Ut&&nt),!1))}}var Ge;return Zw(Hw(me.length(),ut,Ye,Ke,0,!0))}(G,E,p,e,a,L),{processBidirectionalText:pe,processStyledBidirectionalText:se}=S;if(pe&&G.sections.length===1){const me=pe(G.toString(),oe);for(const Le of me){const Pe=new eu;Pe.text=Le,Pe.sections=G.sections;for(let $e=0;$e<Le.length;$e++)Pe.sectionIndex.push(0);J.push(Pe)}}else if(se){const me=se(G.text,G.sectionIndex,oe);for(const Le of me){const Pe=new eu;Pe.text=Le[0],Pe.sectionIndex=Le[1],Pe.sections=G.sections,J.push(Pe)}}else J=function(me,Le){const Pe=[],$e=me.text;let ot=0;for(const Oe of Le)Pe.push(me.substring(ot,Oe)),ot=Oe;return ot<$e.length&&Pe.push(me.substring(ot,$e.length)),Pe}(G,oe);const he=[],ge={positionedLines:he,text:G.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(me,Le,Pe,$e,ot,Oe,Ke,Ye,nt,ut,Ge,mt){let Tt=0,gt=0,Ut=0;const ht=Ye==="right"?1:Ye==="left"?0:.5;let It=!1;for(const Gt of ot){const qt=Gt.getSections();for(const Sn of qt){if(Sn.imageName)continue;const kn=Le[Sn.fontStack];if(kn&&(It=kn.ascender!==void 0&&kn.descender!==void 0,!It))break}if(!It)break}let jt=0;for(const Gt of ot){Gt.trim();const qt=Gt.getMaxScale(),Sn=(qt-1)*Dr,kn={positionedGlyphs:[],lineOffset:0};me.positionedLines[jt]=kn;const Mn=kn.positionedGlyphs;let Cn=0;if(!Gt.length()){gt+=Oe,++jt;continue}let Un=0,Wn=0;for(let An=0;An<Gt.length();An++){const dr=Gt.getSection(An),or=Gt.getSectionIndex(An),jn=Gt.getCharCode(An);let un=dr.scale,sr=null,Dn=null,ii=null,ar=Dr,Pr=0;const Tr=!(nt===Wi.horizontal||!Ge&&!Oh(jn)||Ge&&(Lf[jn]||(an=jn,_t.Arabic(an)||_t["Arabic Supplement"](an)||_t["Arabic Extended-A"](an)||_t["Arabic Presentation Forms-A"](an)||_t["Arabic Presentation Forms-B"](an))));if(dr.imageName){const oi=$e[dr.imageName];if(!oi)continue;ii=dr.imageName,me.iconsInText=me.iconsInText||!0,Dn=oi.paddedRect;const Sr=oi.displaySize;un=un*Dr/mt,sr={width:Sr[0],height:Sr[1],left:mi,top:-Vw,advance:Tr?Sr[1]:Sr[0],localGlyph:!1},Pr=It?-sr.height*un:qw+qt*Dr-Sr[1]*un,ar=sr.advance;const qo=(Tr?Sr[0]:Sr[1])*un-Dr*qt;qo>0&&qo>Cn&&(Cn=qo)}else{const oi=Pe[dr.fontStack];if(!oi)continue;oi[jn]&&(Dn=oi[jn]);const Sr=Le[dr.fontStack];if(!Sr)continue;const qo=Sr.glyphs[jn];if(!qo)continue;if(sr=qo.metrics,ar=jn!==8203?Dr:0,It){const au=Sr.ascender!==void 0?Math.abs(Sr.ascender):0,wd=Sr.descender!==void 0?Math.abs(Sr.descender):0,bd=(au+wd)*un;Un<bd&&(Un=bd,Wn=(au-wd)/2*un),Pr=-au*un}else Pr=qw+(qt-un)*Dr}Tr?(me.verticalizable=!0,Mn.push({glyph:jn,imageName:ii,x:Tt,y:gt+Pr,vertical:Tr,scale:un,localGlyph:sr.localGlyph,fontStack:dr.fontStack,sectionIndex:or,metrics:sr,rect:Dn}),Tt+=ar*un+ut):(Mn.push({glyph:jn,imageName:ii,x:Tt,y:gt+Pr,vertical:Tr,scale:un,localGlyph:sr.localGlyph,fontStack:dr.fontStack,sectionIndex:or,metrics:sr,rect:Dn}),Tt+=sr.advance*un+ut)}Mn.length!==0&&(Ut=Math.max(Tt-ut,Ut),It?Xw(Mn,ht,Cn,Wn,Oe*qt/2):Xw(Mn,ht,Cn,0,Oe/2)),Tt=0;const ir=Oe*qt+Cn;kn.lineOffset=Math.max(Cn,Sn),gt+=ir,++jt}var an;const Vt=gt,{horizontalAlign:Bt,verticalAlign:Pn}=r_(Ke);(function(Gt,qt,Sn,kn,Mn,Cn){const Un=(qt-Sn)*Mn,Wn=-Cn*kn;for(const ir of Gt)for(const An of ir.positionedGlyphs)An.x+=Un,An.y+=Wn})(me.positionedLines,ht,Bt,Pn,Ut,Vt),me.top+=-Pn*Vt,me.bottom=me.top+Vt,me.left+=-Bt*Ut,me.right=me.left+Ut,me.hasBaseline=It}(ge,e,i,a,J,g,y,w,M,E,D,R),!function(me){for(const Le of me)if(Le.positionedGlyphs.length!==0)return!1;return!0}(he)&&ge}const Lf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},L3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function $w(r,e,i,a,u,p){if(e.imageName){const g=a[e.imageName];return g?g.displaySize[0]*e.scale*Dr/p+u:0}{const g=i[e.fontStack],y=g&&g.glyphs[r];return y?y.metrics.advance*e.scale+u:0}}function Ww(r,e,i,a){const u=Math.pow(r-e,2);return a?r<e?u/2:2*u:u+Math.abs(i)*i}function R3(r,e,i){let a=0;return r===10&&(a-=1e4),i&&(a+=150),r!==40&&r!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function Hw(r,e,i,a,u,p){let g=null,y=Ww(e,i,u,p);for(const w of a){const E=Ww(e-w.x,i,u,p)+w.badness;E<=y&&(g=w,y=E)}return{index:r,x:e,priorBreak:g,badness:y}}function Zw(r){return r?Zw(r.priorBreak).concat(r.index):[]}function r_(r){let e=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Xw(r,e,i,a,u){if(!(e||i||a||u))return;const p=r.length-1,g=r[p],y=(g.x+g.metrics.advance*g.scale)*e;for(let w=0;w<=p;w++)r[w].x-=y,r[w].y+=i+a+u}function F3(r,e,i){const{horizontalAlign:a,verticalAlign:u}=r_(i),p=e[0]-r.displaySize[0]*a,g=e[1]-r.displaySize[1]*u;return{image:r,top:g,bottom:g+r.displaySize[1],left:p,right:p+r.displaySize[0]}}function Kw(r,e,i,a,u,p){const g=r.image;let y;if(g.content){const J=g.content,oe=g.pixelRatio||1;y=[J[0]/oe,J[1]/oe,g.displaySize[0]-J[2]/oe,g.displaySize[1]-J[3]/oe]}const w=e.left*p,E=e.right*p;let A,M,D,L;i==="width"||i==="both"?(L=u[0]+w-a[3],M=u[0]+E+a[1]):(L=u[0]+(w+E-g.displaySize[0])/2,M=L+g.displaySize[0]);const R=e.top*p,G=e.bottom*p;return i==="height"||i==="both"?(A=u[1]+R-a[0],D=u[1]+G+a[2]):(A=u[1]+(R+G-g.displaySize[1])/2,D=A+g.displaySize[1]),{image:g,top:A,right:M,bottom:D,left:L,collisionPadding:y}}class Vs extends Te{constructor(e,i,a,u,p){super(e,i),this.angle=u,this.z=a,p!==void 0&&(this.segment=p)}clone(){return new Vs(this.x,this.y,this.z,this.angle,this.segment)}}function Yw(r,e,i,a,u){if(e.segment===void 0)return!0;let p=e,g=e.segment+1,y=0;for(;y>-i/2;){if(g--,g<0)return!1;y-=r[g].dist(p),p=r[g]}y+=r[g].dist(r[g+1]),g++;const w=[];let E=0;for(;y<i/2;){const A=r[g],M=r[g+1];if(!M)return!1;let D=r[g-1].angleTo(A)-A.angleTo(M);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:y,angleDelta:D}),E+=D;y-w[0].distance>a;)E-=w.shift().angleDelta;if(E>u)return!1;g++,y+=A.dist(M)}return!0}function Jw(r){let e=0;for(let i=0;i<r.length-1;i++)e+=r[i].dist(r[i+1]);return e}function Qw(r,e,i){return r?.6*e*i:0}function eb(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function O3(r,e,i,a,u,p){const g=Qw(i,u,p),y=eb(i,a)*p;let w=0;const E=Jw(r)/2;for(let A=0;A<r.length-1;A++){const M=r[A],D=r[A+1],L=M.dist(D);if(w+L>E){const R=(E-w)/L,G=rn(M.x,D.x,R),J=rn(M.y,D.y,R),oe=new Vs(G,J,0,D.angleTo(M),A);return!g||Yw(r,oe,y,g,e)?oe:void 0}w+=L}}function N3(r,e,i,a,u,p,g,y,w){const E=Qw(a,p,g),A=eb(a,u),M=A*g,D=r[0].x===0||r[0].x===w||r[0].y===0||r[0].y===w;return e-M<e/4&&(e=M+e/4),tb(r,D?e/2*y%e:(A/2+2*p)*g*y%e,e,E,i,M,D,!1,w)}function tb(r,e,i,a,u,p,g,y,w){const E=p/2,A=Jw(r);let M=0,D=e-i,L=[];for(let R=0;R<r.length-1;R++){const G=r[R],J=r[R+1],oe=G.dist(J),pe=J.angleTo(G);for(;D+i<M+oe;){D+=i;const se=(D-M)/oe,he=rn(G.x,J.x,se),ge=rn(G.y,J.y,se);if(he>=0&&he<w&&ge>=0&&ge<w&&D-E>=0&&D+E<=A){const me=new Vs(he,ge,0,pe,R);me._round(),a&&!Yw(r,me,p,a,u)||L.push(me)}}M+=oe}return y||L.length||g||(L=tb(r,M/2,i,a,u,p,g,!0,w)),L}function nb(r,e,i,a,u){const p=[];for(let g=0;g<r.length;g++){const y=r[g];let w;for(let E=0;E<y.length-1;E++){let A=y[E],M=y[E+1];A.x<e&&M.x<e||(A.x<e?A=new Te(e,A.y+(e-A.x)/(M.x-A.x)*(M.y-A.y))._round():M.x<e&&(M=new Te(e,A.y+(e-A.x)/(M.x-A.x)*(M.y-A.y))._round()),A.y<i&&M.y<i||(A.y<i?A=new Te(A.x+(i-A.y)/(M.y-A.y)*(M.x-A.x),i)._round():M.y<i&&(M=new Te(A.x+(i-A.y)/(M.y-A.y)*(M.x-A.x),i)._round()),A.x>=a&&M.x>=a||(A.x>=a?A=new Te(a,A.y+(a-A.x)/(M.x-A.x)*(M.y-A.y))._round():M.x>=a&&(M=new Te(a,A.y+(a-A.x)/(M.x-A.x)*(M.y-A.y))._round()),A.y>=u&&M.y>=u||(A.y>=u?A=new Te(A.x+(u-A.y)/(M.y-A.y)*(M.x-A.x),u)._round():M.y>=u&&(M=new Te(A.x+(u-A.y)/(M.y-A.y)*(M.x-A.x),u)._round()),w&&A.equals(w[w.length-1])||(w=[A],p.push(w)),w.push(M)))))}}return p}wt(Vs,"Anchor");const dd=1e20;function rb(r,e,i,a,u,p,g,y,w){for(let E=e;E<e+a;E++)ib(r,i*p+E,p,u,g,y,w);for(let E=i;E<i+u;E++)ib(r,E*p+e,1,a,g,y,w)}function ib(r,e,i,a,u,p,g){p[0]=0,g[0]=-dd,g[1]=dd,u[0]=r[e];for(let y=1,w=0,E=0;y<a;y++){u[y]=r[e+y*i];const A=y*y;do{const M=p[w];E=(u[y]-u[M]+A-M*M)/(y-M)/2}while(E<=g[w]&&--w>-1);w++,p[w]=y,g[w]=E,g[w+1]=dd}for(let y=0,w=0;y<a;y++){for(;g[w+1]<y;)w++;const E=p[w],A=y-E;r[e+y*i]=u[E]+A*A}}const Vo=2,i_={none:0,ideographs:1,all:2};class tu{constructor(e,i,a){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const a=[];for(const u in e)for(const p of e[u])a.push({stack:u,id:p});je(a,({stack:u,id:p},g)=>{let y=this.entries[u];y||(y=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=y.glyphs[p];if(w!==void 0)return void g(null,{stack:u,id:p,glyph:w});if(w=this._tinySDF(y,u,p),w)return y.glyphs[p]=w,void g(null,{stack:u,id:p,glyph:w});const E=Math.floor(p/256);if(256*E>65535)return void g(new Error("glyphs > 65535 not supported"));if(y.ranges[E])return void g(null,{stack:u,id:p,glyph:w});let A=y.requests[E];A||(A=y.requests[E]=[],tu.loadGlyphRange(u,E,this.url,this.requestManager,(M,D)=>{if(D){y.ascender=D.ascender,y.descender=D.descender;for(const L in D.glyphs)this._doesCharSupportLocalGlyph(+L)||(y.glyphs[+L]=D.glyphs[+L]);y.ranges[E]=!0}for(const L of A)L(M,D);delete y.requests[E]})),A.push((M,D)=>{M?g(M):D&&g(null,{stack:u,id:p,glyph:D.glyphs[p]||null})})},(u,p)=>{if(u)i(u);else if(p){const g={};for(const{stack:y,id:w,glyph:E}of p)g[y]===void 0&&(g[y]={}),g[y].glyphs===void 0&&(g[y].glyphs={}),g[y].glyphs[w]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},g[y].ascender=this.entries[y].ascender,g[y].descender=this.entries[y].descender;i(null,g)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==i_.none&&(this.localGlyphMode===i_.all?!!this.localFontFamily:!!this.localFontFamily&&(_t["CJK Unified Ideographs"](e)||_t["Hangul Syllables"](e)||_t.Hiragana(e)||_t.Katakana(e)||_t["CJK Symbols and Punctuation"](e)))}_tinySDF(e,i,a){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(a))return;let p=e.tinySDF;if(!p){let G="400";/bold/i.test(i)?G="900":/medium/i.test(i)?G="500":/light/i.test(i)&&(G="200"),p=e.tinySDF=new tu.TinySDF({fontFamily:u,fontWeight:G,fontSize:24*Vo,buffer:3*Vo,radius:8*Vo}),p.fontWeight=G}if(this.localGlyphs[p.fontWeight][a])return this.localGlyphs[p.fontWeight][a];const g=String.fromCharCode(a),{data:y,width:w,height:E,glyphWidth:A,glyphHeight:M,glyphLeft:D,glyphTop:L,glyphAdvance:R}=p.draw(g);return this.localGlyphs[p.fontWeight][a]={id:a,bitmap:new Us({width:w,height:E},y),metrics:{width:A/Vo,height:M/Vo,left:D/Vo,top:L/Vo-27,advance:R/Vo,localGlyph:!0}}}}tu.loadGlyphRange=function(r,e,i,a,u){const p=256*e,g=p+255,y=a.transformRequest(a.normalizeGlyphsURL(i).replace("{fontstack}",r).replace("{range}",`${p}-${g}`),Eo.Glyphs);ns(y,(w,E)=>{if(w)u(w);else if(E){const A={},M=function(D){return new Bf(D).readFields(P3,{})}(E);for(const D of M.glyphs)A[D.id]=D;u(null,{glyphs:A,ascender:M.ascender,descender:M.descender})}})},tu.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:i=8,cutoff:a=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:g="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=i;const y=this.size=r+4*e,w=this._createCanvas(y),E=this.ctx=w.getContext("2d",{willReadFrequently:!0});E.font=`${g} ${p} ${r}px ${u}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(r),g=Math.ceil(i),y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-u))),w=Math.min(this.size-this.buffer,g+Math.ceil(a)),E=y+2*this.buffer,A=w+2*this.buffer,M=Math.max(E*A,0),D=new Uint8ClampedArray(M),L={data:D,width:E,height:A,glyphWidth:y,glyphHeight:w,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(y===0||w===0)return L;const{ctx:R,buffer:G,gridInner:J,gridOuter:oe}=this;R.clearRect(G,G,y,w),R.fillText(r,G,G+g);const pe=R.getImageData(G,G,y,w);oe.fill(dd,0,M),J.fill(0,0,M);for(let se=0;se<w;se++)for(let he=0;he<y;he++){const ge=pe.data[4*(se*y+he)+3]/255;if(ge===0)continue;const me=(se+G)*E+he+G;if(ge===1)oe[me]=0,J[me]=dd;else{const Le=.5-ge;oe[me]=Le>0?Le*Le:0,J[me]=Le<0?Le*Le:0}}rb(oe,0,0,E,A,E,this.f,this.v,this.z),rb(J,G,G,y,w,E,this.f,this.v,this.z);for(let se=0;se<M;se++){const he=Math.sqrt(oe[se])-Math.sqrt(J[se]);D[se]=Math.round(255-255*(he/this.radius+this.cutoff))}return L}};const nu=mi;function ob(r,e,i,a){const u=[],p=r.image,g=p.pixelRatio,y=p.paddedRect.w-2*nu,w=p.paddedRect.h-2*nu,E=r.right-r.left,A=r.bottom-r.top,M=p.stretchX||[[0,y]],D=p.stretchY||[[0,w]],L=(Oe,Ke)=>Oe+Ke[1]-Ke[0],R=M.reduce(L,0),G=D.reduce(L,0),J=y-R,oe=w-G;let pe=0,se=R,he=0,ge=G,me=0,Le=J,Pe=0,$e=oe;if(p.content&&a){const Oe=p.content;pe=Rf(M,0,Oe[0]),he=Rf(D,0,Oe[1]),se=Rf(M,Oe[0],Oe[2]),ge=Rf(D,Oe[1],Oe[3]),me=Oe[0]-pe,Pe=Oe[1]-he,Le=Oe[2]-Oe[0]-se,$e=Oe[3]-Oe[1]-ge}const ot=(Oe,Ke,Ye,nt)=>{const ut=Ff(Oe.stretch-pe,se,E,r.left),Ge=Of(Oe.fixed-me,Le,Oe.stretch,R),mt=Ff(Ke.stretch-he,ge,A,r.top),Tt=Of(Ke.fixed-Pe,$e,Ke.stretch,G),gt=Ff(Ye.stretch-pe,se,E,r.left),Ut=Of(Ye.fixed-me,Le,Ye.stretch,R),ht=Ff(nt.stretch-he,ge,A,r.top),It=Of(nt.fixed-Pe,$e,nt.stretch,G),jt=new Te(ut,mt),an=new Te(gt,mt),Vt=new Te(gt,ht),Bt=new Te(ut,ht),Pn=new Te(Ge/g,Tt/g),Gt=new Te(Ut/g,It/g),qt=e*Math.PI/180;if(qt){const Mn=Math.sin(qt),Cn=Math.cos(qt),Un=[Cn,-Mn,Mn,Cn];jt._matMult(Un),an._matMult(Un),Bt._matMult(Un),Vt._matMult(Un)}const Sn=Oe.stretch+Oe.fixed,kn=Ke.stretch+Ke.fixed;return{tl:jt,tr:an,bl:Bt,br:Vt,tex:{x:p.paddedRect.x+nu+Sn,y:p.paddedRect.y+nu+kn,w:Ye.stretch+Ye.fixed-Sn,h:nt.stretch+nt.fixed-kn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pn,pixelOffsetBR:Gt,minFontScaleX:Le/g/E,minFontScaleY:$e/g/A,isSDF:i}};if(a&&(p.stretchX||p.stretchY)){const Oe=sb(M,J,R),Ke=sb(D,oe,G);for(let Ye=0;Ye<Oe.length-1;Ye++){const nt=Oe[Ye],ut=Oe[Ye+1];for(let Ge=0;Ge<Ke.length-1;Ge++)u.push(ot(nt,Ke[Ge],ut,Ke[Ge+1]))}}else u.push(ot({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:w+1}));return u}function Rf(r,e,i){let a=0;for(const u of r)a+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return a}function sb(r,e,i){const a=[{fixed:-nu,stretch:0}];for(const[u,p]of r){const g=a[a.length-1];a.push({fixed:u-g.stretch,stretch:g.stretch}),a.push({fixed:u-g.stretch,stretch:g.stretch+(p-u)})}return a.push({fixed:e+nu,stretch:i}),a}function Ff(r,e,i,a){return r/e*i+a}function Of(r,e,i,a){return r-e*i/a}function U3(r,e,i,a){const u=e+r.positionedLines[a].lineOffset;return a===0?i+u/2:i+(u+(e+r.positionedLines[a-1].lineOffset))/2}class j3{constructor(e=[],i=V3){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,u=i[e];for(;e>0;){const p=e-1>>1,g=i[p];if(a(u,g)>=0)break;i[e]=g,e=p}i[e]=u}_down(e){const{data:i,compare:a}=this,u=this.length>>1,p=i[e];for(;e<u;){let g=1+(e<<1),y=i[g];const w=g+1;if(w<this.length&&a(i[w],y)<0&&(g=w,y=i[w]),a(y,p)>=0)break;i[e]=y,e=g}i[e]=p}}function V3(r,e){return r<e?-1:r>e?1:0}function G3(r,e=1,i=!1){let a=1/0,u=1/0,p=-1/0,g=-1/0;const y=r[0];for(let L=0;L<y.length;L++){const R=y[L];(!L||R.x<a)&&(a=R.x),(!L||R.y<u)&&(u=R.y),(!L||R.x>p)&&(p=R.x),(!L||R.y>g)&&(g=R.y)}const w=Math.min(p-a,g-u);let E=w/2;const A=new j3([],q3);if(w===0)return new Te(a,u);for(let L=a;L<p;L+=w)for(let R=u;R<g;R+=w)A.push(new ru(L+E,R+E,E,r));let M=function(L){let R=0,G=0,J=0;const oe=L[0];for(let pe=0,se=oe.length,he=se-1;pe<se;he=pe++){const ge=oe[pe],me=oe[he],Le=ge.x*me.y-me.x*ge.y;G+=(ge.x+me.x)*Le,J+=(ge.y+me.y)*Le,R+=3*Le}return new ru(G/R,J/R,0,L)}(r),D=A.length;for(;A.length;){const L=A.pop();(L.d>M.d||!M.d)&&(M=L,i&&console.log("found best %d after %d probes",Math.round(1e4*L.d)/1e4,D)),L.max-M.d<=e||(E=L.h/2,A.push(new ru(L.p.x-E,L.p.y-E,E,r)),A.push(new ru(L.p.x+E,L.p.y-E,E,r)),A.push(new ru(L.p.x-E,L.p.y+E,E,r)),A.push(new ru(L.p.x+E,L.p.y+E,E,r)),D+=4)}return i&&(console.log(`num probes: ${D}`),console.log(`best distance: ${M.d}`)),M.p}function q3(r,e){return e.max-r.max}class ru{constructor(e,i,a,u){this.p=new Te(e,i),this.h=a,this.d=function(p,g){let y=!1,w=1/0;for(let E=0;E<g.length;E++){const A=g[E];for(let M=0,D=A.length,L=D-1;M<D;L=M++){const R=A[M],G=A[L];R.y>p.y!=G.y>p.y&&p.x<(G.x-R.x)*(p.y-R.y)/(G.y-R.y)+R.x&&(y=!y),w=Math.min(w,tw(p,R,G))}}return(y?1:-1)*Math.sqrt(w)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const iu=7,o_=Number.POSITIVE_INFINITY,$3=Math.sqrt(2);function ab(r,[e,i]){let a=0,u=0;if(i===o_){e<0&&(e=0);const p=e/$3;switch(r){case"top-right":case"top-left":u=p-iu;break;case"bottom-right":case"bottom-left":u=-p+iu;break;case"bottom":u=-e+iu;break;case"top":u=e-iu}switch(r){case"top-right":case"bottom-right":a=-p;break;case"top-left":case"bottom-left":a=p;break;case"left":a=e;break;case"right":a=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),r){case"top-right":case"top-left":case"top":u=i-iu;break;case"bottom-right":case"bottom-left":case"bottom":u=-i+iu}switch(r){case"top-right":case"bottom-right":case"right":a=-e;break;case"top-left":case"bottom-left":case"left":a=e}}return[a,u]}function W3(r,e,i,a,u,p,g,y,w,E){r.createArrays(),r.tilePixelRatio=Dt/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const A=r.layers[0].layout,M=r.layers[0]._unevaluatedLayout._values,D={};if(r.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:J}=r.textSizeData;D.compositeTextSizes=[M["text-size"].possiblyEvaluate(new I(G),y),M["text-size"].possiblyEvaluate(new I(J),y)]}if(r.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:J}=r.iconSizeData;D.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new I(G),y),M["icon-size"].possiblyEvaluate(new I(J),y)]}D.layoutTextSize=M["text-size"].possiblyEvaluate(new I(w+1),y),D.layoutIconSize=M["icon-size"].possiblyEvaluate(new I(w+1),y),D.textMaxSize=M["text-size"].possiblyEvaluate(new I(18),y);const L=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",R=A.get("text-size");for(const G of r.features){const J=A.get("text-font").evaluate(G,{},y).join(","),oe=R.evaluate(G,{},y),pe=D.layoutTextSize.evaluate(G,{},y),se=(D.layoutIconSize.evaluate(G,{},y),{horizontal:{},vertical:void 0}),he=G.text;let ge,me=[0,0];if(he){const $e=he.toString(),ot=A.get("text-letter-spacing").evaluate(G,{},y)*Dr,Oe=A.get("text-line-height").evaluate(G,{},y)*Dr,Ke=fg($e)?ot:0,Ye=A.get("text-anchor").evaluate(G,{},y),nt=A.get("text-variable-anchor");if(!nt){const gt=A.get("text-radial-offset").evaluate(G,{},y);me=gt?ab(Ye,[gt*Dr,o_]):A.get("text-offset").evaluate(G,{},y).map(Ut=>Ut*Dr)}let ut=L?"center":A.get("text-justify").evaluate(G,{},y);const Ge=A.get("symbol-placement")==="point",mt=Ge?A.get("text-max-width").evaluate(G,{},y)*Dr:1/0,Tt=gt=>{r.allowVerticalPlacement&&Fh($e)&&(se.vertical=n_(he,e,i,u,J,mt,Oe,Ye,gt,Ke,me,Wi.vertical,!0,pe,oe))};if(!L&&nt){const gt=ut==="auto"?nt.map(ht=>s_(ht)):[ut];let Ut=!1;for(let ht=0;ht<gt.length;ht++){const It=gt[ht];if(!se.horizontal[It])if(Ut)se.horizontal[It]=se.horizontal[0];else{const jt=n_(he,e,i,u,J,mt,Oe,"center",It,Ke,me,Wi.horizontal,!1,pe,oe);jt&&(se.horizontal[It]=jt,Ut=jt.positionedLines.length===1)}}Tt("left")}else{if(ut==="auto"&&(ut=s_(Ye)),Ge||A.get("text-writing-mode").indexOf("horizontal")>=0||!Fh($e)){const gt=n_(he,e,i,u,J,mt,Oe,Ye,ut,Ke,me,Wi.horizontal,!1,pe,oe);gt&&(se.horizontal[ut]=gt)}Tt(Ge?"left":ut)}}let Le=!1;if(G.icon&&G.icon.name){const $e=a[G.icon.name];$e&&(ge=F3(u[G.icon.name],A.get("icon-offset").evaluate(G,{},y),A.get("icon-anchor").evaluate(G,{},y)),Le=$e.sdf,r.sdfIcons===void 0?r.sdfIcons=$e.sdf:r.sdfIcons!==$e.sdf&&mn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($e.pixelRatio!==r.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Pe=cb(se.horizontal)||se.vertical;r.iconsInText||(r.iconsInText=!!Pe&&Pe.iconsInText),(Pe||ge)&&H3(r,G,se,ge,a,D,pe,0,me,Le,g,y,E)}p&&r.generateCollisionDebugBuffers(w,r.collisionBoxArray)}function s_(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function H3(r,e,i,a,u,p,g,y,w,E,A,M,D){let L=p.textMaxSize.evaluate(e,{},M);L===void 0&&(L=g);const R=r.layers[0].layout,G=R.get("icon-offset").evaluate(e,{},M),J=cb(i.horizontal)||i.vertical,oe=D.name==="globe",pe=Dr,se=g/pe,he=r.tilePixelRatio*L/pe,ge=(Ye=r.overscaling,r.zoom>18&&Ye>2&&(Ye>>=1),Math.max(Dt/(512*Ye),1)*R.get("symbol-spacing")),me=R.get("text-padding")*r.tilePixelRatio,Le=R.get("icon-padding")*r.tilePixelRatio,Pe=Ue(R.get("text-max-angle")),$e=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",ot=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",Oe=R.get("symbol-placement"),Ke=ge/2;var Ye;const nt=R.get("icon-text-fit");let ut;a&&nt!=="none"&&(r.allowVerticalPlacement&&i.vertical&&(ut=Kw(a,i.vertical,nt,R.get("icon-text-fit-padding"),G,se)),J&&(a=Kw(a,J,nt,R.get("icon-text-fit-padding"),G,se)));const Ge=(mt,Tt,gt)=>{if(Tt.x<0||Tt.x>=Dt||Tt.y<0||Tt.y>=Dt)return;let Ut=null;if(oe){const{x:ht,y:It,z:jt}=D.projectTilePoint(Tt.x,Tt.y,gt);Ut={anchor:new Vs(ht,It,jt,0,void 0),up:D.upVector(gt,Tt.x,Tt.y)}}(function(ht,It,jt,an,Vt,Bt,Pn,Gt,qt,Sn,kn,Mn,Cn,Un,Wn,ir,An,dr,or,jn,un,sr,Dn,ii,ar){const Pr=ht.addToLineVertexArray(It,an);let Tr,oi,Sr,qo,au,wd,bd,Vb=0,Gb=0,qb=0,$b=0,w_=-1,b_=-1;const ps={};let Wb=_g("");const jl=jt?jt.anchor:It;let E_=0,T_=0;if(qt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[E_,T_]=qt.layout.get("text-offset").evaluate(un,{},ar).map(Ai=>Ai*Dr):(E_=qt.layout.get("text-radial-offset").evaluate(un,{},ar)*Dr,T_=o_),ht.allowVerticalPlacement&&Vt.vertical){const Ai=Vt.vertical;if(Wn)wd=a_(Ai),Gt&&(bd=a_(Gt));else{const Ii=qt.layout.get("text-rotate").evaluate(un,{},ar)+90;Sr=Nf(Sn,jl,It,kn,Mn,Cn,Ai,Un,Ii,ir),Gt&&(qo=Nf(Sn,jl,It,kn,Mn,Cn,Gt,dr,Ii))}}if(Bt){const Ai=qt.layout.get("icon-rotate").evaluate(un,{},ar),Ii=qt.layout.get("icon-text-fit")!=="none",Ed=ob(Bt,Ai,Dn,Ii),C_=Gt?ob(Gt,Ai,Dn,Ii):void 0;oi=Nf(Sn,jl,It,kn,Mn,Cn,Bt,dr,Ai),Vb=4*Ed.length;const Hb=ht.iconSizeData;let Vl=null;Hb.kind==="source"?(Vl=[jo*qt.layout.get("icon-size").evaluate(un,{},ar)],Vl[0]>Ta&&mn(`${ht.layerIds[0]}: Value for "icon-size" is >= ${pd}. Reduce your "icon-size".`)):Hb.kind==="composite"&&(Vl=[jo*sr.compositeIconSizes[0].evaluate(un,{},ar),jo*sr.compositeIconSizes[1].evaluate(un,{},ar)],(Vl[0]>Ta||Vl[1]>Ta)&&mn(`${ht.layerIds[0]}: Value for "icon-size" is >= ${pd}. Reduce your "icon-size".`)),ht.addSymbols(ht.icon,Ed,Vl,jn,or,un,!1,jt,It,Pr.lineStartIndex,Pr.lineLength,-1,ii,ar),w_=ht.icon.placedSymbolArray.length-1,C_&&(Gb=4*C_.length,ht.addSymbols(ht.icon,C_,Vl,jn,or,un,Wi.vertical,jt,It,Pr.lineStartIndex,Pr.lineLength,-1,ii,ar),b_=ht.icon.placedSymbolArray.length-1)}for(const Ai in Vt.horizontal){const Ii=Vt.horizontal[Ai];Tr||(Wb=_g(Ii.text),Wn?au=a_(Ii):Tr=Nf(Sn,jl,It,kn,Mn,Cn,Ii,Un,qt.layout.get("text-rotate").evaluate(un,{},ar),ir));const Ed=Ii.positionedLines.length===1;if(qb+=lb(ht,jt,It,Ii,Pn,qt,Wn,un,ir,Pr,Vt.vertical?Wi.horizontal:Wi.horizontalOnly,Ed?Object.keys(Vt.horizontal):[Ai],ps,w_,sr,ii,ar),Ed)break}Vt.vertical&&($b+=lb(ht,jt,It,Vt.vertical,Pn,qt,Wn,un,ir,Pr,Wi.vertical,["vertical"],ps,b_,sr,ii,ar));let Ma=-1;const S_=(Ai,Ii)=>Ai?Math.max(Ai,Ii):Ii;Ma=S_(au,Ma),Ma=S_(wd,Ma),Ma=S_(bd,Ma);const wk=Ma>-1?1:0;ht.glyphOffsetArray.length>=Ca.MAX_GLYPHS&&mn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),un.sortKey!==void 0&&ht.addToSortKeyRanges(ht.symbolInstances.length,un.sortKey),ht.symbolInstances.emplaceBack(jl.x,jl.y,jl.z,It.x,It.y,ps.right>=0?ps.right:-1,ps.center>=0?ps.center:-1,ps.left>=0?ps.left:-1,ps.vertical>=0?ps.vertical:-1,w_,b_,Wb,Tr!==void 0?Tr:ht.collisionBoxArray.length,Tr!==void 0?Tr+1:ht.collisionBoxArray.length,Sr!==void 0?Sr:ht.collisionBoxArray.length,Sr!==void 0?Sr+1:ht.collisionBoxArray.length,oi!==void 0?oi:ht.collisionBoxArray.length,oi!==void 0?oi+1:ht.collisionBoxArray.length,qo||ht.collisionBoxArray.length,qo?qo+1:ht.collisionBoxArray.length,kn,qb,$b,Vb,Gb,wk,0,E_,T_,Ma)})(r,Tt,Ut,mt,i,a,u,ut,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,me,$e,w,0,Le,ot,G,e,p,E,A,M)};if(Oe==="line")for(const mt of nb(e.geometry,0,0,Dt,Dt)){const Tt=N3(mt,ge,Pe,i.vertical||J,a,pe,he,r.overscaling,Dt);for(const gt of Tt)J&&Z3(r,J.text,Ke,gt)||Ge(mt,gt,M)}else if(Oe==="line-center"){for(const mt of e.geometry)if(mt.length>1){const Tt=O3(mt,Pe,i.vertical||J,a,pe,he);Tt&&Ge(mt,Tt,M)}}else if(e.type==="Polygon")for(const mt of Hg(e.geometry,0)){const Tt=G3(mt,16);Ge(mt[0],new Vs(Tt.x,Tt.y,0,0,void 0),M)}else if(e.type==="LineString")for(const mt of e.geometry)Ge(mt,new Vs(mt[0].x,mt[0].y,0,0,void 0),M);else if(e.type==="Point")for(const mt of e.geometry)for(const Tt of mt)Ge([Tt],new Vs(Tt.x,Tt.y,0,0,void 0),M)}const pd=255,Ta=pd*jo;function lb(r,e,i,a,u,p,g,y,w,E,A,M,D,L,R,G,J){const oe=function(he,ge,me,Le,Pe,$e,ot,Oe){const Ke=[];if(ge.positionedLines.length===0)return Ke;const Ye=Le.layout.get("text-rotate").evaluate($e,{})*Math.PI/180,nt=function(gt){const Ut=gt[0],ht=gt[1],It=Ut*ht;return It>0?[Ut,-ht]:It<0?[-Ut,ht]:Ut===0?[ht,Ut]:[ht,-Ut]}(me);let ut=Math.abs(ge.top-ge.bottom);for(const gt of ge.positionedLines)ut-=gt.lineOffset;const Ge=ge.positionedLines.length,mt=ut/Ge;let Tt=ge.top-me[1];for(let gt=0;gt<Ge;++gt){const Ut=ge.positionedLines[gt];Tt=U3(ge,mt,Tt,gt);for(const ht of Ut.positionedGlyphs){if(!ht.rect)continue;const It=ht.rect||{};let jt=Vw+1,an=!0,Vt=1,Bt=0;if(ht.imageName){const Dn=ot[ht.imageName];if(!Dn)continue;if(Dn.sdf){mn("SDF images are not supported in formatted text and will be ignored.");continue}an=!1,Vt=Dn.pixelRatio,jt=mi/Vt}const Pn=(Pe||Oe)&&ht.vertical,Gt=ht.metrics.advance*ht.scale/2,qt=ht.metrics,Sn=ht.rect;if(Sn===null)continue;Oe&&ge.verticalizable&&(Bt=ht.imageName?Gt-ht.metrics.width*ht.scale/2:0);const kn=Pe?[ht.x+Gt,ht.y]:[0,0];let Mn=[0,0],Cn=[0,0],Un=!1;Pe||(Pn?(Cn=[ht.x+Gt+nt[0],ht.y+nt[1]-Bt],Un=!0):Mn=[ht.x+Gt+me[0],ht.y+me[1]-Bt]);const Wn=Sn.w*ht.scale/(Vt*(ht.localGlyph?Vo:1)),ir=Sn.h*ht.scale/(Vt*(ht.localGlyph?Vo:1));let An,dr,or,jn;if(Pn){const Dn=ht.y-Tt,ii=new Te(-Gt,Gt-Dn),ar=-Math.PI/2,Pr=new Te(...Cn);An=new Te(-Gt+Mn[0],Mn[1]),An._rotateAround(ar,ii)._add(Pr),An.x+=-Dn+Gt,An.y-=(qt.left-jt)*ht.scale;const Tr=ht.imageName?qt.advance*ht.scale:Dr*ht.scale,oi=String.fromCharCode(ht.glyph);w3(oi)?An.x+=(1-jt)*ht.scale:b3(oi)?An.x+=Tr-qt.height*ht.scale+(-jt-1)*ht.scale:An.x+=ht.imageName||qt.width+2*jt===Sn.w&&qt.height+2*jt===Sn.h?(Tr-ir)/2:(Tr-(qt.height+2*jt)*ht.scale)/2,dr=new Te(An.x,An.y-Wn),or=new Te(An.x+ir,An.y),jn=new Te(An.x+ir,An.y-Wn)}else{const Dn=(qt.left-jt)*ht.scale-Gt+Mn[0],ii=(-qt.top-jt)*ht.scale+Mn[1],ar=Dn+Wn,Pr=ii+ir;An=new Te(Dn,ii),dr=new Te(ar,ii),or=new Te(Dn,Pr),jn=new Te(ar,Pr)}if(Ye){let Dn;Dn=Pe?new Te(0,0):Un?new Te(nt[0],nt[1]):new Te(me[0],me[1]),An._rotateAround(Ye,Dn),dr._rotateAround(Ye,Dn),or._rotateAround(Ye,Dn),jn._rotateAround(Ye,Dn)}const un=new Te(0,0),sr=new Te(0,0);Ke.push({tl:An,tr:dr,bl:or,br:jn,tex:It,writingMode:ge.writingMode,glyphOffset:kn,sectionIndex:ht.sectionIndex,isSDF:an,pixelOffsetTL:un,pixelOffsetBR:sr,minFontScaleX:0,minFontScaleY:0})}}return Ke}(0,a,w,p,g,y,u,r.allowVerticalPlacement),pe=r.textSizeData;let se=null;pe.kind==="source"?(se=[jo*p.layout.get("text-size").evaluate(y,{},J)],se[0]>Ta&&mn(`${r.layerIds[0]}: Value for "text-size" is >= ${pd}. Reduce your "text-size".`)):pe.kind==="composite"&&(se=[jo*R.compositeTextSizes[0].evaluate(y,{},J),jo*R.compositeTextSizes[1].evaluate(y,{},J)],(se[0]>Ta||se[1]>Ta)&&mn(`${r.layerIds[0]}: Value for "text-size" is >= ${pd}. Reduce your "text-size".`)),r.addSymbols(r.text,oe,se,w,g,y,A,e,i,E.lineStartIndex,E.lineLength,L,G,J);for(const he of M)D[he]=r.text.placedSymbolArray.length-1;return 4*oe.length}function cb(r){for(const e in r)return r[e];return null}function Nf(r,e,i,a,u,p,g,y,w,E){let A=g.top,M=g.bottom,D=g.left,L=g.right;const R=g.collisionPadding;if(R&&(D-=R[0],A-=R[1],L+=R[2],M+=R[3]),w){const G=new Te(D,A),J=new Te(L,A),oe=new Te(D,M),pe=new Te(L,M),se=Ue(w);let he=new Te(0,0);E&&(he=new Te(E[0],E[1])),G._rotateAround(se,he),J._rotateAround(se,he),oe._rotateAround(se,he),pe._rotateAround(se,he),D=Math.min(G.x,J.x,oe.x,pe.x),L=Math.max(G.x,J.x,oe.x,pe.x),A=Math.min(G.y,J.y,oe.y,pe.y),M=Math.max(G.y,J.y,oe.y,pe.y)}return r.emplaceBack(e.x,e.y,e.z,i.x,i.y,D,A,L,M,y,a,u,p),r.length-1}function a_(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function Z3(r,e,i,a){const u=r.compareText;if(e in u){const p=u[e];for(let g=p.length-1;g>=0;g--)if(a.dist(p[g])<i)return!0}else u[e]=[];return u[e].push(a),!1}function ub(r,e){const i=r.fovAboveCenter,a=r.elevation?r.elevation.getMinElevationBelowMSL()*e:0,u=(r._camera.position[2]*r.worldSize-a)/Math.cos(r._pitch),p=Math.sin(i)*u/Math.sin(Math.max(Math.PI/2-r._pitch-i,.01)),g=Math.sin(r._pitch)*p+u;return Math.min(1.01*g,u*(1/r._horizonShift))}function Nl(r,e){if(!e.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:e};const i=Math.pow(2,-r.z),a=r.x*i,u=(r.x+1)*i,p=r.y*i,g=(r.y+1)*i,y=$i(a),w=$i(u),E=Nr(p),A=Nr(g),M=e.project(y,E),D=e.project(w,E),L=e.project(w,A),R=e.project(y,A);let G=Math.min(M.x,D.x,L.x,R.x),J=Math.min(M.y,D.y,L.y,R.y),oe=Math.max(M.x,D.x,L.x,R.x),pe=Math.max(M.y,D.y,L.y,R.y);const se=i/16;function he(me,Le,Pe,$e,ot,Oe){const Ke=(Pe+ot)/2,Ye=($e+Oe)/2,nt=e.project($i(Ke),Nr(Ye)),ut=Math.max(0,G-nt.x,J-nt.y,nt.x-oe,nt.y-pe);G=Math.min(G,nt.x),oe=Math.max(oe,nt.x),J=Math.min(J,nt.y),pe=Math.max(pe,nt.y),ut>se&&(he(me,nt,Pe,$e,Ke,Ye),he(nt,Le,Ke,Ye,ot,Oe))}he(M,D,a,p,u,p),he(D,L,u,p,u,g),he(L,R,u,g,a,g),he(R,M,a,g,a,p),G-=se,J-=se,oe+=se,pe+=se;const ge=1/Math.max(oe-G,pe-J);return{scale:ge,x:G*ge,y:J*ge,x2:oe*ge,y2:pe*ge,projection:e}}const X3=Oo(new Float32Array(16));class Sa{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Tn(0,0)}projectTilePoint(e,i,a){return{x:e,y:i,z:0}}locationPoint(e,i,a=!0){return e._coordinatePoint(e.locationCoordinate(i),a)}pixelsPerMeter(e,i){return Uo(1,e)*i}pixelSpaceConversion(e,i,a){return 1}farthestPixelDistance(e){return ub(e,e.pixelsPerMeter)}pointCoordinate(e,i,a,u){const p=e.horizonLineFromTop(!1),g=new Te(i,Math.max(p,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(g,u))}pointCoordinate3D(e,i,a){const u=new Te(i,a);if(e.elevation)return e.elevation.pointCoordinate(u);{const p=this.pointCoordinate(e,u.x,u.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const a=e.horizonLineFromTop();return i.y<a}createInversionMatrix(e,i){return X3}createTileMatrix(e,i,a){let u,p,g;const y=a.canonical,w=Oo(new Float64Array(16));if(this.isReprojectedInTileSpace){const E=Nl(y,this);u=1,p=E.x+a.wrap*E.scale,g=E.y,Pl(w,w,[u/E.scale,u/E.scale,e.pixelsPerMeter/i])}else u=i/e.zoomScale(y.z),p=(y.x+Math.pow(2,y.z)*a.wrap)*u,g=y.y*u;return qh(w,w,[p,g,0]),Pl(w,w,[u/Dt,u/Dt,1]),w}upVector(e,i,a){return[0,0,1]}upVectorScale(e,i,a){return{metersToTile:1}}}class K3 extends Sa{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,a]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Ue(i));this.n=(u+Math.sin(Ue(a)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:a,c:u,r0:p}=this,g=Ue(e-this.center[0]),y=Ue(i),w=Math.sqrt(u-2*a*Math.sin(y))/a;return{x:w*Math.sin(g*a),y:w*Math.cos(g*a)-p,z:0}}unproject(e,i){const{n:a,c:u,r0:p}=this,g=p+i;let y=Math.atan2(e,Math.abs(g))*Math.sign(g);g*a<0&&(y-=Math.PI*Math.sign(e)*Math.sign(g));const w=Ue(this.center[0])*a;y=ft(y,-Math.PI-w,Math.PI-w);const E=We(Ve(y/a)+this.center[0],-180,180),A=Math.asin(We((u-(e*e+g*g)*a*a)/(2*a),-1,1)),M=We(Ve(A),-Ur,Ur);return new Tn(E,M)}}const fd=1.340264,md=-.081106,gd=893e-6,_d=.003796,Uf=Math.sqrt(3)/2;class Y3 extends Sa{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(Uf*Math.sin(i)),u=a*a,p=u*u*u;return{x:.5*(e*Math.cos(a)/(Uf*(fd+3*md*u+p*(7*gd+9*_d*u)))/Math.PI+.5),y:1-.5*(a*(fd+md*u+p*(gd+_d*u))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,u=a*a,p=u*u*u;for(let A,M,D,L=0;L<12&&(M=a*(fd+md*u+p*(gd+_d*u))-i,D=fd+3*md*u+p*(7*gd+9*_d*u),A=M/D,a=We(a-A,-Math.PI/3,Math.PI/3),u=a*a,p=u*u*u,!(Math.abs(A)<1e-12));++L);const g=Uf*e*(fd+3*md*u+p*(7*gd+9*_d*u))/Math.cos(a),y=Math.asin(Math.sin(a)/Uf),w=We(180*g/Math.PI,-180,180),E=We(180*y/Math.PI,-Ur,Ur);return new Tn(w,E)}}class J3 extends Sa{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const a=360*(e-.5),u=We(360*(.5-i),-Ur,Ur);return new Tn(a,u)}}const ou=Math.PI/2;function jf(r){return Math.tan((ou+r)/2)}class Q3 extends Sa{constructor(e){super(e),this.center=e.center||[0,30];const[i,a]=this.parallels=e.parallels||[30,30];let u=Ue(i),p=Ue(a);this.southernCenter=u+p<0,this.southernCenter&&(u=-u,p=-p);const g=Math.cos(u),y=jf(u);this.n=u===p?Math.sin(u):Math.log(g/Math.cos(p))/Math.log(jf(p)/y),this.f=g*Math.pow(jf(u),this.n)/this.n}project(e,i){i=Ue(i),this.southernCenter&&(i=-i),e=Ue(e-this.center[0]);const a=1e-6,{n:u,f:p}=this;p>0?i<-ou+a&&(i=-ou+a):i>ou-a&&(i=ou-a);const g=p/Math.pow(jf(i),u);let y=g*Math.sin(u*e),w=p-g*Math.cos(u*e);return y=.5*(y/Math.PI+.5),w=.5*(w/Math.PI+.5),{x:y,y:this.southernCenter?w:1-w,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:a,f:u}=this,p=u-i,g=Math.sign(p),y=Math.sign(a)*Math.sqrt(e*e+p*p);let w=Math.atan2(e,Math.abs(p))*g;p*a<0&&(w-=Math.PI*Math.sign(e)*g);const E=We(Ve(w/a)+this.center[0],-180,180),A=We(Ve(2*Math.atan(Math.pow(u/y,1/a))-ou),-Ur,Ur);return new Tn(E,this.southernCenter?-A:A)}}class hb extends Sa{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:ls(e),y:cs(i),z:0}}unproject(e,i){const a=$i(e),u=Nr(i);return new Tn(a,u)}}const db=Ue(Ur);class ek extends Sa{project(e,i){const a=(i=Ue(i))*i,u=a*a;return{x:.5*((e=Ue(e))*(.8707-.131979*a+u*(u*(.003971*a-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+a*(.015085+u*(.028874*a-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,u=25,p=0,g=a*a;do{g=a*a;const E=g*g;p=(a*(1.007226+g*(.015085+E*(.028874*g-.044475-.005916*E)))-i)/(1.007226+g*(.045255+E*(.259866*g-.311325-.005916*11*E))),a=We(a-p,-db,db)}while(Math.abs(p)>1e-6&&--u>0);g=a*a;const y=We(Ve(e/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),w=Ve(a);return new Tn(y,w)}}const pb=Ue(Ur);class tk extends Sa{project(e,i){i=Ue(i),e=Ue(e);const a=Math.cos(i),u=2/Math.PI,p=Math.acos(a*Math.cos(e/2)),g=Math.sin(p)/p,y=.5*(e*u+2*a*Math.sin(e/2)/g)||0,w=.5*(i+Math.sin(i)/g)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(w/Math.PI+1),z:0}}unproject(e,i){let a=e=(2*e-.5)*Math.PI,u=i=(2*(1-i)-1)*Math.PI,p=25;const g=1e-6;let y=0,w=0;do{const E=Math.cos(u),A=Math.sin(u),M=2*A*E,D=A*A,L=E*E,R=Math.cos(a/2),G=Math.sin(a/2),J=2*R*G,oe=G*G,pe=1-L*R*R,se=pe?1/pe:0,he=pe?Math.acos(E*R)*Math.sqrt(1/pe):0,ge=.5*(2*he*E*G+2*a/Math.PI)-e,me=.5*(he*A+u)-i,Le=.5*se*(L*oe+he*E*R*D)+1/Math.PI,Pe=se*(J*M/4-he*A*G),$e=.125*se*(M*G-he*A*L*J),ot=.5*se*(D*R+he*oe*E)+.5,Oe=Pe*$e-ot*Le;y=(me*Pe-ge*ot)/Oe,w=(ge*$e-me*Le)/Oe,a=We(a-y,-Math.PI,Math.PI),u=We(u-w,-pb,pb)}while((Math.abs(y)>g||Math.abs(w)>g)&&--p>0);return new Tn(Ve(a),Ve(u))}}class fb extends Sa{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ue(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:a,cosPhi:u}=this;return{x:Ue(e)*u*a+.5,y:-Math.sin(Ue(i))/u*a+.5,z:0}}unproject(e,i){const{scale:a,cosPhi:u}=this,p=-(i-.5)/a,g=We(Ve((e-.5)/a)/u,-180,180),y=Math.asin(We(p*u,-1,1)),w=We(Ve(y),-Ur,Ur);return new Tn(g,w)}}class nk extends hb{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,a){const u=Jh(e,i,a);return Yn(u,u,Qh(as(a))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,i){const a=qc(i.lat,i.lng),u=ti([],a),p=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;Zh(a,a,u,Uo(1,0)*Dt*p);const g=Oo(new Float64Array(16));return Dl(g,e.pixelMatrix,e.globeMatrix),Yn(a,a,g),new Te(a[0],a[1])}pixelsPerMeter(e,i){return Uo(1,0)*i}pixelSpaceConversion(e,i,a){const u=Uo(1,e)*i,p=rn(Uo(1,45)*i,u,a);return this.pixelsPerMeter(e,i)/p}createTileMatrix(e,i,a){const u=Dg(as(a.canonical));return Dl(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,i){const{center:a}=e,u=Qh(as(i));return mf(u,u,Ue(a.lng)),wg(u,u,Ue(a.lat)),Pl(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,i,a,u){return jv(e,i,a,!0)||new Wc(0,0)}pointCoordinate3D(e,i,a){const u=this.pointCoordinate(e,i,a,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,i){return!jv(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(u,p){const g=u.cameraToCenterDistance,y=u._centerAltitude*p,w=u._camera,E=u._camera.forward(),A=Os([],qi([],E,-g),[0,0,y]),M=u.worldSize/(2*Math.PI),D=[0,0,-M],L=u.width/u.height,R=Math.tan(u.fovAboveCenter),G=qi([],w.up(),R),J=qi([],w.right(),R*L),oe=ti([],Os([],Os([],E,G),J)),pe=[];let se;if(new Sg(A,oe).closestPointOnSphere(D,M,pe)){const he=Os([],pe,D),ge=No([],he,A);se=Math.cos(u.fovAboveCenter)*$h(ge)}else{const he=No([],A,D),ge=No([],D,A);ti(ge,ge);const me=$h(he)-M;se=Math.sqrt(me*(me+2*M));const Le=Math.acos(se/(M+me))-Math.acos(ho(E,ge));se*=Math.cos(Le)}return 1.01*se}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=$c(e.zoom);if(a>0){const u=ub(e,Uo(1,e.center.lat)*e.worldSize),p=e.worldSize/(2*Math.PI),g=Math.max(e.width,e.height)/e.worldSize*Math.PI;return rn(i,u+p*(1-Math.cos(g)),Math.pow(a,10))}return i}upVector(e,i,a){return Jh(i,a,e,1)}upVectorScale(e){return{metersToTile:gf(yf(as(e)))}}}function mb(r){const e=r.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(r.name){case"mercator":return new hb(r);case"equirectangular":return new J3(r);case"naturalEarth":return new ek(r);case"equalEarth":return new Y3(r);case"winkelTripel":return new tk(r);case"albers":return i?new fb(r):new K3(r);case"lambertConformalConic":return i?new fb(r):new Q3(r);case"globe":return new nk(r)}throw new Error(`Invalid projection name: ${r.name}`)}const rk=If.types,ik=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vf(r,e,i,a,u,p,g,y,w,E,A,M,D){const L=y?Math.min(Ta,Math.round(y[0])):0,R=y?Math.min(Ta,Math.round(y[1])):0;r.emplaceBack(e,i,Math.round(32*a),Math.round(32*u),p,g,(L<<1)+(w?1:0),R,16*E,16*A,256*M,256*D)}function Gf(r,e,i,a,u,p,g){r.emplaceBack(e,i,a,u,p,g)}function qf(r,e,i,a,u){r.emplaceBack(e,i,a,u),r.emplaceBack(e,i,a,u),r.emplaceBack(e,i,a,u),r.emplaceBack(e,i,a,u)}function ok(r){for(const e of r.sections)if(gg(e.text))return!0;return!1}class l_{constructor(e){this.layoutVertexArray=new Qe,this.indexArray=new Ct,this.programConfigurations=e,this.segments=new nr,this.dynamicLayoutVertexArray=new rt,this.opacityVertexArray=new At,this.placedSymbolArray=new tr,this.globeExtVertexArray=new lt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,a,u){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,p3.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,m3.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ik,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,f3.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}wt(l_,"SymbolBuffers");class c_{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new nr,this.collisionVertexArray=new Jt,this.collisionVertexArrayExt=new Xt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,g3.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,_3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}wt(c_,"CollisionBuffers");class Ca{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Oo([]),this.placementViewportMatrix=Oo([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Yg(this.zoom,i["text-size"]),this.iconSizeData=Yg(this.zoom,i["icon-size"]);const a=this.layers[0].layout,u=a.get("symbol-sort-key"),p=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(g=>Wi[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new l_(new Ml(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new l_(new Ml(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ei,this.lineVertexArray=new Nc,this.symbolInstances=new Bn}calculateGlyphDependencies(e,i,a,u,p){for(let g=0;g<e.length;g++)if(i[e.charCodeAt(g)]=!0,u&&p){const y=ud[e.charAt(g)];y&&(i[y.charCodeAt(0)]=!0)}}populate(e,i,a,u){const p=this.layers[0],g=p.layout,y=this.projection.name==="globe",w=g.get("text-font"),E=g.get("text-field"),A=g.get("icon-image"),M=(E.value.kind!=="constant"||E.value.value instanceof Qr&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),D=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,L=g.get("symbol-sort-key");if(this.features=[],!M&&!D)return;const R=i.iconDependencies,G=i.glyphDependencies,J=i.availableImages,oe=new I(this.zoom);for(const{feature:pe,id:se,index:he,sourceLayerIndex:ge}of e){const me=p._featureFilter.needGeometry,Le=Rl(pe,me);if(!p._featureFilter.filter(oe,Le,a))continue;if(me||(Le.geometry=Ns(pe,a,u)),y&&pe.type!==1&&a.z<=5){const Oe=Le.geometry,Ke=.98078528056,Ye=(nt,ut)=>ho(Jh(nt.x,nt.y,a,1),Jh(ut.x,ut.y,a,1))<Ke;for(let nt=0;nt<Oe.length;nt++)Oe[nt]=mI(Oe[nt],Ye)}let Pe,$e;if(M){const Oe=p.getValueAndResolveTokens("text-field",Le,a,J),Ke=Qr.factory(Oe);ok(Ke)&&(this.hasRTLText=!0),(!this.hasRTLText||v()==="unavailable"||this.hasRTLText&&S.isParsed())&&(Pe=v3(Ke,p,Le))}if(D){const Oe=p.getValueAndResolveTokens("icon-image",Le,a,J);$e=Oe instanceof wi?Oe:wi.fromString(Oe)}if(!Pe&&!$e)continue;const ot=this.sortFeaturesByKey?L.evaluate(Le,{},a):void 0;if(this.features.push({id:se,text:Pe,icon:$e,index:he,sourceLayerIndex:ge,geometry:Le.geometry,properties:pe.properties,type:rk[pe.type],sortKey:ot}),$e&&(R[$e.name]=!0),Pe){const Oe=w.evaluate(Le,{},a).join(","),Ke=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Wi.vertical)>=0;for(const Ye of Pe.sections)if(Ye.image)R[Ye.image.name]=!0;else{const nt=Fh(Pe.toString()),ut=Ye.fontStack||Oe,Ge=G[ut]=G[ut]||{};this.calculateGlyphDependencies(Ye.text,Ge,Ke,this.allowVerticalPlacement,nt)}}}g.get("symbol-placement")==="line"&&(this.features=function(pe){const se={},he={},ge=[];let me=0;function Le(Oe){ge.push(pe[Oe]),me++}function Pe(Oe,Ke,Ye){const nt=he[Oe];return delete he[Oe],he[Ke]=nt,ge[nt].geometry[0].pop(),ge[nt].geometry[0]=ge[nt].geometry[0].concat(Ye[0]),nt}function $e(Oe,Ke,Ye){const nt=se[Ke];return delete se[Ke],se[Oe]=nt,ge[nt].geometry[0].shift(),ge[nt].geometry[0]=Ye[0].concat(ge[nt].geometry[0]),nt}function ot(Oe,Ke,Ye){const nt=Ye?Ke[0][Ke[0].length-1]:Ke[0][0];return`${Oe}:${nt.x}:${nt.y}`}for(let Oe=0;Oe<pe.length;Oe++){const Ke=pe[Oe],Ye=Ke.geometry,nt=Ke.text?Ke.text.toString():null;if(!nt){Le(Oe);continue}const ut=ot(nt,Ye),Ge=ot(nt,Ye,!0);if(ut in he&&Ge in se&&he[ut]!==se[Ge]){const mt=$e(ut,Ge,Ye),Tt=Pe(ut,Ge,ge[mt].geometry);delete se[ut],delete he[Ge],he[ot(nt,ge[Tt].geometry,!0)]=Tt,ge[mt].geometry=null}else ut in he?Pe(ut,Ge,Ye):Ge in se?$e(ut,Ge,Ye):(Le(Oe),se[ut]=me-1,he[Ge]=me-1)}return ge.filter(Oe=>Oe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,se)=>pe.sortKey-se.sortKey)}update(e,i,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a,u),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=mb(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:u,y:p}of i)this.lineVertexArray.emplaceBack(u,p);return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,u,p,g,y,w,E,A,M,D,L,R){const G=e.indexArray,J=e.layoutVertexArray,oe=e.globeExtVertexArray,pe=e.segments.prepareSegment(4*i.length,J,G,this.canOverlap?g.sortKey:void 0),se=this.glyphOffsetArray.length,he=pe.vertexLength,ge=this.allowVerticalPlacement&&y===Wi.vertical?Math.PI/2:0,me=g.text&&g.text.sections;for(let Pe=0;Pe<i.length;Pe++){const{tl:$e,tr:ot,bl:Oe,br:Ke,tex:Ye,pixelOffsetTL:nt,pixelOffsetBR:ut,minFontScaleX:Ge,minFontScaleY:mt,glyphOffset:Tt,isSDF:gt,sectionIndex:Ut}=i[Pe],ht=pe.vertexLength,It=Tt[1];if(Vf(J,E.x,E.y,$e.x,It+$e.y,Ye.x,Ye.y,a,gt,nt.x,nt.y,Ge,mt),Vf(J,E.x,E.y,ot.x,It+ot.y,Ye.x+Ye.w,Ye.y,a,gt,ut.x,nt.y,Ge,mt),Vf(J,E.x,E.y,Oe.x,It+Oe.y,Ye.x,Ye.y+Ye.h,a,gt,nt.x,ut.y,Ge,mt),Vf(J,E.x,E.y,Ke.x,It+Ke.y,Ye.x+Ye.w,Ye.y+Ye.h,a,gt,ut.x,ut.y,Ge,mt),w){const{x:jt,y:an,z:Vt}=w.anchor,[Bt,Pn,Gt]=w.up;Gf(oe,jt,an,Vt,Bt,Pn,Gt),Gf(oe,jt,an,Vt,Bt,Pn,Gt),Gf(oe,jt,an,Vt,Bt,Pn,Gt),Gf(oe,jt,an,Vt,Bt,Pn,Gt),qf(e.dynamicLayoutVertexArray,jt,an,Vt,ge)}else qf(e.dynamicLayoutVertexArray,E.x,E.y,E.z,ge);G.emplaceBack(ht,ht+1,ht+2),G.emplaceBack(ht+1,ht+2,ht+3),pe.vertexLength+=4,pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),Pe!==i.length-1&&Ut===i[Pe+1].sectionIndex||e.programConfigurations.populatePaintArrays(J.length,g,g.index,{},L,R,me&&me[Ut])}const Le=w?w.anchor:E;e.placedSymbolArray.emplaceBack(Le.x,Le.y,Le.z,E.x,E.y,se,this.glyphOffsetArray.length-se,he,A,M,E.segment,a?a[0]:0,a?a[1]:0,u[0],u[1],y,0,!1,0,D,0)}_commitLayoutVertex(e,i,a,u,p,g,y){e.emplaceBack(i,a,u,p,g,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,i,a,u,p,g,y){const w=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),E=w.vertexLength,A=y.tileAnchorX,M=y.tileAnchorY;for(let L=0;L<4;L++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,u,p,g,A,M,new Te(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,p,g,A,M,new Te(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,p,g,A,M,new Te(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,u,p,g,A,M,new Te(e.x1,e.y2)),w.vertexLength+=4;const D=a.indexArray;D.emplaceBack(E,E+1),D.emplaceBack(E+1,E+2),D.emplaceBack(E+2,E+3),D.emplaceBack(E+3,E),w.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,a,u,p,g){for(let y=u;y<p;y++){const w=a.get(y),E=this.getSymbolInstanceTextSize(e,g,i,y);this._addCollisionDebugVertices(w,E,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,i,a,u,p,g){for(let y=u;y<p;y++){const w=a.get(y),E=this.getSymbolInstanceIconSize(e,i,g.placedIconSymbolIndex);this._addCollisionDebugVertices(w,E,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new c_(Et,Bw.members,Er),this.iconCollisionBox=new c_(Et,Bw.members,Er);const a=Yc(this.iconSizeData,e),u=Yc(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(u,e,i,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(u,e,i,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(a,e,i,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(a,e,i,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(e,i,a,u){const p=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:u),g=Pf(this.textSizeData,e,p)/Dr;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,i,a){const u=this.icon.placedSymbolArray.get(a),p=Pf(this.iconSizeData,e,u);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(e,i,a){e.emplaceBack(i,-a,-a),e.emplaceBack(i,a,-a),e.emplaceBack(i,a,a),e.emplaceBack(i,-a,a)}_updateTextDebugCollisionBoxes(e,i,a,u,p,g){for(let y=u;y<p;y++){const w=a.get(y),E=this.getSymbolInstanceTextSize(e,g,i,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,w.padding)}}_updateIconDebugCollisionBoxes(e,i,a,u,p,g){for(let y=u;y<p;y++){const w=a.get(y),E=this.getSymbolInstanceIconSize(e,i,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,E,w.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=Yc(this.iconSizeData,e),u=Yc(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(u,e,i,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(u,e,i,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(a,e,i,g.iconBoxStartIndex,g.iconBoxEndIndex,g.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,i,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,a,u,p,g,y,w,E){const A={};if(i<a){const{x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he,featureIndex:ge}=e.get(i);A.textBox={x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he},A.textFeatureIndex=ge}if(u<p){const{x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he,featureIndex:ge}=e.get(u);A.verticalTextBox={x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he},A.verticalTextFeatureIndex=ge}if(g<y){const{x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he,featureIndex:ge}=e.get(g);A.iconBox={x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he},A.iconFeatureIndex=ge}if(w<E){const{x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he,featureIndex:ge}=e.get(w);A.verticalIconBox={x1:M,y1:D,x2:L,y2:R,padding:G,projectedAnchorX:J,projectedAnchorY:oe,projectedAnchorZ:pe,tileAnchorX:se,tileAnchorY:he},A.verticalIconFeatureIndex=ge}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),u=a.vertexStartIndex+4*a.numGlyphs;for(let p=a.vertexStartIndex;p<u;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),u=[],p=[],g=[];for(let y=0;y<this.symbolInstances.length;++y){g.push(y);const w=this.symbolInstances.get(y);u.push(0|Math.round(i*w.tileAnchorX+a*w.tileAnchorY)),p.push(w.featureIndex)}return g.sort((y,w)=>u[y]-u[w]||p[w]-p[y]),g}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:y,placedIconSymbolIndex:w,verticalPlacedIconSymbolIndex:E}=a;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),p>=0&&p!==u&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&g!==p&&g!==u&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}wt(Ca,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Ca.MAX_GLYPHS=65535,Ca.addDynamicAttributes=qf;const sk=new le({"symbol-placement":new j(qe.layout_symbol["symbol-placement"]),"symbol-spacing":new j(qe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new j(qe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ee(qe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new j(qe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new j(qe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new j(qe.layout_symbol["icon-ignore-placement"]),"icon-optional":new j(qe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new j(qe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ee(qe.layout_symbol["icon-size"]),"icon-text-fit":new j(qe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new j(qe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ee(qe.layout_symbol["icon-image"]),"icon-rotate":new ee(qe.layout_symbol["icon-rotate"]),"icon-padding":new j(qe.layout_symbol["icon-padding"]),"icon-keep-upright":new j(qe.layout_symbol["icon-keep-upright"]),"icon-offset":new ee(qe.layout_symbol["icon-offset"]),"icon-anchor":new ee(qe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new j(qe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new j(qe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new j(qe.layout_symbol["text-rotation-alignment"]),"text-field":new ee(qe.layout_symbol["text-field"]),"text-font":new ee(qe.layout_symbol["text-font"]),"text-size":new ee(qe.layout_symbol["text-size"]),"text-max-width":new ee(qe.layout_symbol["text-max-width"]),"text-line-height":new ee(qe.layout_symbol["text-line-height"]),"text-letter-spacing":new ee(qe.layout_symbol["text-letter-spacing"]),"text-justify":new ee(qe.layout_symbol["text-justify"]),"text-radial-offset":new ee(qe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new j(qe.layout_symbol["text-variable-anchor"]),"text-anchor":new ee(qe.layout_symbol["text-anchor"]),"text-max-angle":new j(qe.layout_symbol["text-max-angle"]),"text-writing-mode":new j(qe.layout_symbol["text-writing-mode"]),"text-rotate":new ee(qe.layout_symbol["text-rotate"]),"text-padding":new j(qe.layout_symbol["text-padding"]),"text-keep-upright":new j(qe.layout_symbol["text-keep-upright"]),"text-transform":new ee(qe.layout_symbol["text-transform"]),"text-offset":new ee(qe.layout_symbol["text-offset"]),"text-allow-overlap":new j(qe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new j(qe.layout_symbol["text-ignore-placement"]),"text-optional":new j(qe.layout_symbol["text-optional"])});var u_={paint:new le({"icon-opacity":new ee(qe.paint_symbol["icon-opacity"]),"icon-color":new ee(qe.paint_symbol["icon-color"]),"icon-halo-color":new ee(qe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ee(qe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ee(qe.paint_symbol["icon-halo-blur"]),"icon-translate":new j(qe.paint_symbol["icon-translate"]),"icon-translate-anchor":new j(qe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ee(qe.paint_symbol["text-opacity"]),"text-color":new ee(qe.paint_symbol["text-color"],{runtimeType:pi,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ee(qe.paint_symbol["text-halo-color"]),"text-halo-width":new ee(qe.paint_symbol["text-halo-width"]),"text-halo-blur":new ee(qe.paint_symbol["text-halo-blur"]),"text-translate":new j(qe.paint_symbol["text-translate"]),"text-translate-anchor":new j(qe.paint_symbol["text-translate-anchor"])}),layout:sk};class gb{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:na,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}wt(gb,"FormatSectionOverride",{omit:["defaultValue"]});class $f extends Fo{constructor(e){super(e,u_)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const u=[];for(const p of a)u.indexOf(p)<0&&u.push(p);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,u){const p=this.layout.get(e).evaluate(i,{},a,u),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||fa(g.value)||!p?p:function(y,w){return w.replace(/{([^{}]+)}/g,(E,A)=>A in y?String(y[A]):"")}(i.properties,p)}createBucket(e){return new Ca(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of u_.paint.overridableProperties){if(!$f.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new gb(i),u=new Dc(a,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new Ch("source",u):new wl("composite",u,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new ne(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&$f.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),u=u_.paint.properties[i];let p=!1;const g=y=>{for(const w of y)if(u.overrides&&u.overrides.hasOverride(w))return void(p=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Qr)g(a.value.value.sections);else if(a.value.kind==="source"){const y=E=>{p||(E instanceof As&&$n(E.value)===il?g(E.value.sections):E instanceof rs?g(E.sections):E.eachChild(y))},w=a.value;w._styleExpression&&y(w._styleExpression.expression)}return p}getProgramConfiguration(e){return new wa(this,e)}}var ak={paint:new le({"background-color":new j(qe.paint_background["background-color"]),"background-pattern":new j(qe.paint_background["background-pattern"]),"background-opacity":new j(qe.paint_background["background-opacity"])})},lk={paint:new le({"raster-opacity":new j(qe.paint_raster["raster-opacity"]),"raster-hue-rotate":new j(qe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new j(qe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new j(qe.paint_raster["raster-brightness-max"]),"raster-saturation":new j(qe.paint_raster["raster-saturation"]),"raster-contrast":new j(qe.paint_raster["raster-contrast"]),"raster-resampling":new j(qe.paint_raster["raster-resampling"]),"raster-fade-duration":new j(qe.paint_raster["raster-fade-duration"])})};class ck extends Fo{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var uk={paint:new le({"sky-type":new j(qe.paint_sky["sky-type"]),"sky-atmosphere-sun":new j(qe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new j(qe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new j(qe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new j(qe.paint_sky["sky-gradient-radius"]),"sky-gradient":new ae(qe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new j(qe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new j(qe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new j(qe.paint_sky["sky-opacity"])})};function h_(r,e,i){const a=[0,0,1],u=Lv([]);return Fv(u,u,i?-Ue(r)+Math.PI:Ue(r)),Rv(u,u,-Ue(e)),Dv(a,a,u),ti(a,a)}const hk={circle:class extends Fo{constructor(r){super(r,bI)}createBucket(r){return new Fg(r)}queryRadius(r){const e=r;return Hc("circle-radius",this,e)+Hc("circle-stroke-width",this,e)+wf(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,i,a,u,p,g,y){const w=ow(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),E=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return sw(r,a,p,g,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",w,E)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new wa(this,r)}},heatmap:class extends Fo{createBucket(r){return new lw(r)}constructor(r){super(r,CI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return Hc("heatmap-radius",this,r)}queryIntersectsFeature(r,e,i,a,u,p,g,y){const w=this.paint.get("heatmap-radius").evaluate(e,i);return sw(r,a,p,g,y,!0,!0,new Te(0,0),w)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new wa(this,r)}},hillshade:class extends Fo{constructor(r){super(r,AI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Fo{constructor(r){super(r,GI)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(r){return new wa(this,r)}recalculate(r,e){super.recalculate(r,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Cf(r)}queryRadius(){return wf(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,i,a,u,p){return!r.queryGeometry.isAboveHorizon&&ew(iw(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends Fo{constructor(r){super(r,o3)}createBucket(r){return new ad(r)}queryRadius(){return wf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new wa(this,r)}queryIntersectsFeature(r,e,i,a,u,p,g,y,w){const E=ow(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(e,i),M=this.paint.get("fill-extrusion-base").evaluate(e,i),D=[0,0],L=y&&p.elevation,R=p.elevation?p.elevation.exaggeration():1,G=r.tile.getBucket(this);if(L&&G instanceof ad){const he=G.centroidVertexArray,ge=w+1;ge<he.length&&(D[0]=he.geta_centroid_pos0(ge),D[1]=he.geta_centroid_pos1(ge))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(a=Cw([a],[new Te(0,0),new Te(Dt,Dt)],r.tileID.canonical).map(he=>he.polygon).flat());const J=L?y:null,[oe,pe]=function(he,ge,me,Le,Pe,$e,ot,Oe,Ke,Ye,nt){return he.projection.name==="globe"?function(ut,Ge,mt,Tt,gt,Ut,ht,It,jt,an,Vt){const Bt=[],Pn=[],Gt=ut.projection.upVectorScale(Vt,ut.center.lat,ut.worldSize).metersToTile,qt=[0,0,0,1],Sn=[0,0,0,1],kn=(Cn,Un,Wn,ir)=>{Cn[0]=Un,Cn[1]=Wn,Cn[2]=ir,Cn[3]=1},Mn=Sw();mt>0&&(mt+=Mn),Tt+=Mn;for(const Cn of Ge){const Un=[],Wn=[];for(const ir of Cn){const An=ir.x+gt.x,dr=ir.y+gt.y,or=ut.projection.projectTilePoint(An,dr,Vt),jn=ut.projection.upVector(Vt,ir.x,ir.y);let un=mt,sr=Tt;if(ht){const Dn=Mw(An,dr,mt,Tt,ht,It,jt,an);un+=Dn.base,sr+=Dn.top}mt!==0?kn(qt,or.x+jn[0]*Gt*un,or.y+jn[1]*Gt*un,or.z+jn[2]*Gt*un):kn(qt,or.x,or.y,or.z),kn(Sn,or.x+jn[0]*Gt*sr,or.y+jn[1]*Gt*sr,or.z+jn[2]*Gt*sr),Yn(qt,qt,Ut),Yn(Sn,Sn,Ut),Un.push(new Kc(qt[0],qt[1],qt[2])),Wn.push(new Kc(Sn[0],Sn[1],Sn[2]))}Bt.push(Un),Pn.push(Wn)}return[Bt,Pn]}(he,ge,me,Le,Pe,$e,ot,Oe,Ke,Ye,nt):ot?function(ut,Ge,mt,Tt,gt,Ut,ht,It,jt){const an=[],Vt=[],Bt=[0,0,0,1];for(const Pn of ut){const Gt=[],qt=[];for(const Sn of Pn){const kn=Sn.x+Tt.x,Mn=Sn.y+Tt.y,Cn=Mw(kn,Mn,Ge,mt,Ut,ht,It,jt);Bt[0]=kn,Bt[1]=Mn,Bt[2]=Cn.base,Bt[3]=1,zl(Bt,Bt,gt),Bt[3]=Math.max(Bt[3],1e-5);const Un=new Kc(Bt[0]/Bt[3],Bt[1]/Bt[3],Bt[2]/Bt[3]);Bt[0]=kn,Bt[1]=Mn,Bt[2]=Cn.top,Bt[3]=1,zl(Bt,Bt,gt),Bt[3]=Math.max(Bt[3],1e-5);const Wn=new Kc(Bt[0]/Bt[3],Bt[1]/Bt[3],Bt[2]/Bt[3]);Gt.push(Un),qt.push(Wn)}an.push(Gt),Vt.push(qt)}return[an,Vt]}(ge,me,Le,Pe,$e,ot,Oe,Ke,Ye):function(ut,Ge,mt,Tt,gt){const Ut=[],ht=[],It=gt[8]*Ge,jt=gt[9]*Ge,an=gt[10]*Ge,Vt=gt[11]*Ge,Bt=gt[8]*mt,Pn=gt[9]*mt,Gt=gt[10]*mt,qt=gt[11]*mt;for(const Sn of ut){const kn=[],Mn=[];for(const Cn of Sn){const Un=Cn.x+Tt.x,Wn=Cn.y+Tt.y,ir=gt[0]*Un+gt[4]*Wn+gt[12],An=gt[1]*Un+gt[5]*Wn+gt[13],dr=gt[2]*Un+gt[6]*Wn+gt[14],or=gt[3]*Un+gt[7]*Wn+gt[15],jn=ir+It,un=An+jt,sr=dr+an,Dn=Math.max(or+Vt,1e-5),ii=ir+Bt,ar=An+Pn,Pr=dr+Gt,Tr=Math.max(or+qt,1e-5);kn.push(new Kc(jn/Dn,un/Dn,sr/Dn)),Mn.push(new Kc(ii/Tr,ar/Tr,Pr/Tr))}Ut.push(kn),ht.push(Mn)}return[Ut,ht]}(ge,me,Le,Pe,$e)}(p,a,M,A,E,g,J,D,R,p.center.lat,r.tileID.canonical),se=r.queryGeometry;return function(he,ge,me){let Le=1/0;ew(me,ge)&&(Le=kw(me,ge[0]));for(let Pe=0;Pe<ge.length;Pe++){const $e=ge[Pe],ot=he[Pe];for(let Oe=0;Oe<$e.length-1;Oe++){const Ke=$e[Oe],Ye=[Ke,$e[Oe+1],ot[Oe+1],ot[Oe],Ke];Qv(me,Ye)&&(Le=Math.min(Le,kw(me,Ye)))}}return Le!==1/0&&Le}(oe,pe,se.isPointQuery()?se.screenBounds:se.screenGeometry)}},line:class extends Fo{constructor(r){super(r,Dw),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ph,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=Pw.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Df(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new wa(this,r)}queryRadius(r){const e=r,i=zw(Hc("line-width",this,e),Hc("line-gap-width",this,e)),a=Hc("line-offset",this,e);return i/2+Math.abs(a)+wf(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,i,a,u,p){if(r.queryGeometry.isAboveHorizon)return!1;const g=iw(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),y=r.pixelToTileUnitsFactor/2*zw(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),w=this.paint.get("line-offset").evaluate(e,i);return w&&(a=function(E,A){const M=[],D=new Te(0,0);for(let L=0;L<E.length;L++){const R=E[L],G=[];for(let J=0;J<R.length;J++){const oe=R[J],pe=R[J+1],se=J===0?D:oe.sub(R[J-1])._unit()._perp(),he=J===R.length-1?D:pe.sub(oe)._unit()._perp(),ge=se._add(he)._unit();ge._mult(1/(ge.x*he.x+ge.y*he.y)),G.push(ge._mult(A)._add(oe))}M.push(G)}return M}(a,w*r.pixelToTileUnitsFactor)),function(E,A,M){for(let D=0;D<A.length;D++){const L=A[D];if(E.length>=3){for(let R=0;R<L.length;R++)if(Fl(E,L[R]))return!0}if(yI(E,L,M))return!0}return!1}(g,a,y)}isTileClipped(){return!0}},symbol:$f,background:class extends Fo{constructor(r){super(r,ak)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Fo{constructor(r){super(r,lk)}getProgramIds(){return["raster"]}},sky:class extends Fo{constructor(r){super(r,uk),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=jg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(r,e){if(this.paint.get("sky-type")==="atmosphere"){const a=this.paint.get("sky-atmosphere-sun"),u=!a,p=r.style.light,g=p.properties.get("position");return u&&p.properties.get("anchor")==="viewport"&&mn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?h_(g.azimuthal,90-g.polar,e):h_(a[0],90-a[1],e)}const i=this.paint.get("sky-gradient-center");return h_(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}};class yd{constructor(e,i,a,u){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,a){const{width:u,height:p}=e,{context:g}=this,{gl:y}=g,{HTMLImageElement:w,HTMLCanvasElement:E,HTMLVideoElement:A,ImageData:M,ImageBitmap:D}=C;if(y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!i||i.premultiply!==!1)),a||this.size&&this.size[0]===u&&this.size[1]===p){const{x:L,y:R}=a||{x:0,y:0};e instanceof w||e instanceof E||e instanceof A||e instanceof M||D&&e instanceof D?y.texSubImage2D(y.TEXTURE_2D,0,L,R,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,L,R,u,p,y.RGBA,y.UNSIGNED_BYTE,e.data)}else this.size=[u,p],e instanceof w||e instanceof E||e instanceof A||e instanceof M||D&&e instanceof D?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,u,p,0,this.format,y.UNSIGNED_BYTE,e.data);this.useMipmap=!!(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,i){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,i),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class dk{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class pk{constructor(){this.tasks={},this.taskQueue=[],Lr(["process"],this),this.invoker=new dk(this.process),this.nextId=0}add(e,i){const a=this.nextId++,u=function({type:p,isSymbolTile:g,zoom:y}){return y=y||0,p==="message"?0:p!=="maybePrepare"||g?p!=="parseTile"||g?p==="parseTile"&&g?300-y:p==="maybePrepare"&&g?400-y:500:200-y:100-y}(i);if(u===0){qr();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:i,priority:u,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){qr();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let u=0;u<this.taskQueue.length;u++){const p=this.tasks[this.taskQueue[u]];p.priority<i&&(i=p.priority,e=u)}if(e===null)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class _b{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const fk=["tile","layer","source","sourceLayer","state"];class yb{constructor(e,i,a,u,p){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=a,this._y=u,this.properties=e.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const i of fk)this[i]!==void 0&&(e[i]=this[i]);return e}}const mo=32,us=33,Aa=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,i=0,a=0,u=0,p=0,g=0,y=0;for(1&e?u=p=g=mo:i=a=y=mo;(e>>=1)>1;){const E=i+u>>1,A=a+p>>1;1&e?(u=i,p=a,i=g,a=y):(i=u,a=p,u=g,p=y),g=E,y=A}const w=4*r;Aa[w+0]=i,Aa[w+1]=a,Aa[w+2]=u,Aa[w+3]=p}const hs=new Uint16Array(2178),Ia=new Uint8Array(1089),Wf=new Uint16Array(1089);function xb(r){return r===0?-.03125:r===32?.03125:0}var vb=Ae([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const wb={type:2,extent:Dt,loadGeometry:()=>[[new Te(0,0),new Te(Dt+1,0),new Te(Dt+1,Dt+1),new Te(0,Dt+1),new Te(0,0)]]};class d_{constructor(e,i,a,u,p){this.tileID=e,this.uid=nn(),this.uses=0,this.tileSize=i,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<So.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Nl(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const g={};if(!p)return g;for(const y of u){const w=y.layerIds.map(E=>p.getLayer(E)).filter(Boolean);if(w.length!==0){y.layers=w,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(E=>w.filter(A=>A.id===E)[0]));for(const E of w)g[E.id]=y}}return g}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof Ca){if(this.hasSymbolBuckets=!0,!a)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof Ca&&p.hasRTLText){this.hasRTLText=!0,S.isLoading()||S.isLoaded()||v()!=="deferred"||T();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new En}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const u=this.buckets[a];u.uploadPending()&&u.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new yd(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new yd(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new yd(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,a,u,p,g,y,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:y,transform:g,params:p,tileTransform:this.tileTransform},e,i,a):{}}querySourceFeatures(e,i){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const u=a.loadVTLayers(),p=i?i.sourceLayer:"",g=u._geojsonTileLayer||u[p];if(!g)return;const y=Lc(i&&i.filter),{z:w,x:E,y:A}=this.tileID.canonical,M={z:w,x:E,y:A};for(let D=0;D<g.length;D++){const L=g.feature(D);if(y.needGeometry){const J=Rl(L,!0);if(!y.filter(new I(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!y.filter(new I(this.tileID.overscaledZ),L))continue;const R=a.getId(L,p),G=new yb(L,w,E,A,R);G.tile=M,e.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const a=Ir(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let u=!1;if(this.expirationTime>a)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const p=this.expirationTime-i;p?this.expirationTime=a+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!i)return;const a=this.latestFeatureIndex.loadVTLayers(),u=i.style.listImages();for(const p in this.buckets){if(!i.style.hasLayer(p))continue;const g=this.buckets[p],y=g.layers[0].sourceLayer||"_geojsonTileLayer",w=a[y],E=e[y];if(!w||!E||Object.keys(E).length===0)continue;if(g.update(E,w,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof Df||g instanceof Cf){const M=i.style._getSourceCache(g.layers[0].source);i._terrain&&i._terrain.enabled&&M&&g.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(M.id,this.tileID)}const A=i&&i.style&&i.style.getLayer(p);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<So.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=So.now()+e}setTexture(e,i){const a=i.context,u=a.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new yd(a,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,i){const a={};for(const u of i)a[u]=!0;this.dependencies[e]=a}hasDependency(e,i){for(const a of e){const u=this.dependencies[a];if(u){for(const p of i)if(u[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const a=Ns(wb,this.tileID.canonical,this.tileTransform)[0],u=new it,p=new Ti;for(let g=0;g<a.length;g++){const{x:y,y:w}=a[g];u.emplaceBack(y,w),p.emplaceBack(g)}p.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(p),this._tileDebugBuffer=e.createVertexBuffer(u,Kh.members),this._tileDebugSegments=nr.simpleSegment(0,0,u.length,p.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const a=Ns(wb,this.tileID.canonical,this.tileTransform)[0];let u,p;if(this.isRaster){const g=function(y,w){const E=Nl(y,w),A=Math.pow(2,y.z);for(let J=0;J<us;J++)for(let oe=0;oe<us;oe++){const pe=$i((y.x+(oe+xb(oe))/mo)/A),se=Nr((y.y+(J+xb(J))/mo)/A),he=w.project(pe,se),ge=J*us+oe;hs[2*ge+0]=Math.round((he.x*E.scale-E.x)*Dt),hs[2*ge+1]=Math.round((he.y*E.scale-E.y)*Dt)}Ia.fill(0),Wf.fill(0);for(let J=2045;J>=0;J--){const oe=4*J,pe=Aa[oe+0],se=Aa[oe+1],he=Aa[oe+2],ge=Aa[oe+3],me=pe+he>>1,Le=se+ge>>1,Pe=me+Le-se,$e=Le+pe-me,ot=se*us+pe,Oe=ge*us+he,Ke=Le*us+me,Ye=Math.hypot((hs[2*ot+0]+hs[2*Oe+0])/2-hs[2*Ke+0],(hs[2*ot+1]+hs[2*Oe+1])/2-hs[2*Ke+1])>=16;Ia[Ke]=Ia[Ke]||(Ye?1:0),J<1022&&(Ia[Ke]=Ia[Ke]||Ia[(se+$e>>1)*us+(pe+Pe>>1)]||Ia[(ge+$e>>1)*us+(he+Pe>>1)])}const M=new Ze,D=new Ct;let L=0;function R(J,oe){const pe=oe*us+J;return Wf[pe]===0&&(M.emplaceBack(hs[2*pe+0],hs[2*pe+1],J*Dt/mo,oe*Dt/mo),Wf[pe]=++L),Wf[pe]-1}function G(J,oe,pe,se,he,ge){const me=J+pe>>1,Le=oe+se>>1;if(Math.abs(J-he)+Math.abs(oe-ge)>1&&Ia[Le*us+me])G(he,ge,J,oe,me,Le),G(pe,se,he,ge,me,Le);else{const Pe=R(J,oe),$e=R(pe,se),ot=R(he,ge);D.emplaceBack(Pe,$e,ot)}}return G(0,0,mo,mo,mo,0),G(mo,mo,0,0,0,mo),{vertices:M,indices:D}}(this.tileID.canonical,i);u=g.vertices,p=g.indices}else{u=new Ze,p=new Ct;for(const{x:y,y:w}of a)u.emplaceBack(y,w,0,0);const g=Wg(u.int16,void 0,4);for(let y=0;y<g.length;y+=3)p.emplaceBack(g[y],g[y+1],g[y+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,vb.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(p),this._tileBoundsSegments=nr.simpleSegment(0,0,u.length,p.length)}_makeGlobeTileDebugBuffers(e,i){const a=i.projection;if(!a||a.name!=="globe"||i.freezeTileCoverage)return;const u=this.tileID.canonical,p=Qh(Vv(u,i)),g=$c(i.zoom);let y;g>0&&(y=vg(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,i,p,y,g),this._makeGlobeTileDebugTextBuffer(e,u,i,p,y,g)}_globePoint(e,i,a,u,p,g,y){let w=Jh(e,i,a);if(g){const E=1<<a.z,A=ls(u.center.lng),M=cs(u.center.lat),D=(a.x+.5)/E-A;let L=0;D>.5?L=-1:D<-.5&&(L=1);let R=(e/Dt+a.x)/E+L,G=(i/Dt+a.y)/E;R=(R-A)*u._pixelsPerMercatorPixel+A,G=(G-M)*u._pixelsPerMercatorPixel+M;const J=[R*u.worldSize,G*u.worldSize,0];Yn(J,J,g),w=Ll(w,J,y)}return Yn(w,w,p)}_makeGlobeTileDebugBorderBuffer(e,i,a,u,p,g){const y=new it,w=new Ti,E=new De,A=(D,L,R,G,J)=>{const oe=(R-D)/(J-1),pe=(G-L)/(J-1),se=y.length;for(let he=0;he<J;he++){const ge=D+he*oe,me=L+he*pe;y.emplaceBack(ge,me);const Le=this._globePoint(ge,me,i,a,u,p,g);E.emplaceBack(Le[0],Le[1],Le[2]),w.emplaceBack(se+he)}},M=Dt;A(0,0,M,0,16),A(M,0,M,M,16),A(M,M,0,M,16),A(0,M,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(w),this._tileDebugBuffer=e.createVertexBuffer(y,Kh.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(E,Nv.members),this._tileDebugSegments=nr.simpleSegment(0,0,y.length,w.length)}_makeGlobeTileDebugTextBuffer(e,i,a,u,p,g){const y=Dt/4,w=new it,E=new Ct,A=new De,M=25;E.reserve(32),w.reserve(M),A.reserve(M);const D=(L,R)=>M*L+R;for(let L=0;L<M;L++){const R=L*y;for(let G=0;G<M;G++){const J=G*y;w.emplaceBack(J,R);const oe=this._globePoint(J,R,i,a,u,p,g);A.emplaceBack(oe[0],oe[1],oe[2])}}for(let L=0;L<4;L++)for(let R=0;R<4;R++){const G=D(L,R),J=D(L,R+1),oe=D(L+1,R),pe=D(L+1,R+1);E.emplaceBack(G,J,oe),E.emplaceBack(oe,J,pe)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(E),this._tileDebugTextBuffer=e.createVertexBuffer(w,Kh.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(A,Nv.members),this._tileDebugTextSegments=nr.simpleSegment(0,0,M,32)}}class mk{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,a){const u=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},et(this.stateChanges[e][u],a),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])a[p]||(this.deletedStates[e][u][p]=null)}else for(const p in a)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,i,a){if(this.deletedStates[e]===null)return;const u=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&i!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][a]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(a in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][a]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,i){const a=String(i),u=et({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][i];if(p===null)return{};for(const g in p)delete u[g]}return u}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const a={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),et(this.state[u][g],this.stateChanges[u][g]),p[g]=this.state[u][g];a[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const g in this.state[u])p[g]={},this.state[u][g]={};else for(const g in this.deletedStates[u]){if(this.deletedStates[u][g]===null)this.state[u][g]={};else if(this.state[u][g])for(const y of Object.keys(this.deletedStates[u][g]))delete this.state[u][g][y];p[g]=this.state[u][g]}a[u]=a[u]||{},et(a[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(const u in e)e[u].setFeatureState(a,i)}}class bb{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const a=this.toIdx(e,i);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Eb(r,e,i,a){let u=0,p=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(a[g])<1e-15){if(i[g]<r[g]||i[g]>e[g])return null}else{const y=1/a[g];let w=(r[g]-i[g])*y,E=(e[g]-i[g])*y;if(w>E){const A=w;w=E,E=A}if(w>u&&(u=w),E<p&&(p=E),u>p)return null}return u}function Tb(r,e,i,a,u,p,g,y,w,E,A){const M=a-r,D=u-e,L=p-i,R=g-r,G=y-e,J=w-i,oe=A[1]*J-A[2]*G,pe=A[2]*R-A[0]*J,se=A[0]*G-A[1]*R,he=M*oe+D*pe+L*se;if(Math.abs(he)<1e-15)return null;const ge=1/he,me=E[0]-r,Le=E[1]-e,Pe=E[2]-i,$e=(me*oe+Le*pe+Pe*se)*ge;if($e<0||$e>1)return null;const ot=Le*L-Pe*D,Oe=Pe*M-me*L,Ke=me*D-Le*M,Ye=(A[0]*ot+A[1]*Oe+A[2]*Ke)*ge;return Ye<0||$e+Ye>1?null:(R*ot+G*Oe+J*Ke)*ge}function Sb(r,e,i){return(r-e)/(i-e)}function Cb(r,e,i,a,u,p,g,y,w){const E=1<<i,A=p-a,M=g-u,D=(r+1)/E*A+a,L=(e+0)/E*M+u,R=(e+1)/E*M+u;y[0]=(r+0)/E*A+a,y[1]=L,w[0]=D,w[1]=R}class Ab{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(p){const g=Math.ceil(Math.log2(p.dim/8)),y=[];let w=Math.ceil(Math.pow(2,g));const E=1/w,A=(L,R,G,J,oe)=>{const pe=J?1:0,se=(L+1)*G-pe,he=R*G,ge=(R+1)*G-pe;oe[0]=L*G,oe[1]=he,oe[2]=se,oe[3]=ge};let M=new bb(w);const D=[];for(let L=0;L<w*w;L++){A(L%w,Math.floor(L/w),E,!1,D);const R=ka(D[0],D[1],p),G=ka(D[2],D[1],p),J=ka(D[2],D[3],p),oe=ka(D[0],D[3],p);M.minimums.push(Math.min(R,G,J,oe)),M.maximums.push(Math.max(R,G,J,oe)),M.leaves.push(1)}for(y.push(M),w/=2;w>=1;w/=2){const L=y[y.length-1];M=new bb(w);for(let R=0;R<w*w;R++){A(R%w,Math.floor(R/w),2,!0,D);const G=L.getElevation(D[0],D[1]),J=L.getElevation(D[2],D[1]),oe=L.getElevation(D[2],D[3]),pe=L.getElevation(D[0],D[3]),se=L.isLeaf(D[0],D[1]),he=L.isLeaf(D[2],D[1]),ge=L.isLeaf(D[2],D[3]),me=L.isLeaf(D[0],D[3]),Le=Math.min(G.min,J.min,oe.min,pe.min),Pe=Math.max(G.max,J.max,oe.max,pe.max),$e=se&&he&&ge&&me;M.maximums.push(Pe),M.minimums.push(Le),M.leaves.push(Pe-Le<=5&&$e?1:0)}y.push(M)}return y}(this.dem),a=i.length-1,u=i[a];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(i,0,0,a,0)}raycastRoot(e,i,a,u,p,g,y=1){return Eb([e,i,-100],[a,u,this.maximums[0]*y],p,g)}raycast(e,i,a,u,p,g,y=1){if(!this.nodeCount)return null;const w=this.raycastRoot(e,i,a,u,p,g,y);if(w==null)return null;const E=[],A=[],M=[],D=[],L=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;L.length>0;){const{idx:R,t:G,nodex:J,nodey:oe,depth:pe}=L.pop();if(this.leaves[R]){Cb(J,oe,pe,e,i,a,u,M,D);const he=1<<pe,ge=(J+0)/he,me=(J+1)/he,Le=(oe+0)/he,Pe=(oe+1)/he,$e=ka(ge,Le,this.dem)*y,ot=ka(me,Le,this.dem)*y,Oe=ka(me,Pe,this.dem)*y,Ke=ka(ge,Pe,this.dem)*y,Ye=Tb(M[0],M[1],$e,D[0],M[1],ot,D[0],D[1],Oe,p,g),nt=Tb(D[0],D[1],Oe,M[0],D[1],Ke,M[0],M[1],$e,p,g),ut=Math.min(Ye!==null?Ye:Number.MAX_VALUE,nt!==null?nt:Number.MAX_VALUE);if(ut!==Number.MAX_VALUE)return ut;{const Ge=Zh([],p,g,G);if(Ib($e,ot,Ke,Oe,Sb(Ge[0],M[0],D[0]),Sb(Ge[1],M[1],D[1]))>=Ge[2])return G}continue}let se=0;for(let he=0;he<this._siblingOffset.length;he++){Cb((J<<1)+this._siblingOffset[he][0],(oe<<1)+this._siblingOffset[he][1],pe+1,e,i,a,u,M,D),M[2]=-100,D[2]=this.maximums[this.childOffsets[R]+he]*y;const ge=Eb(M,D,p,g);if(ge!=null){const me=ge;E[he]=me;let Le=!1;for(let Pe=0;Pe<se&&!Le;Pe++)me>=E[A[Pe]]&&(A.splice(Pe,0,he),Le=!0);Le||(A[se]=he),se++}}for(let he=0;he<se;he++){const ge=A[he];L.push({idx:this.childOffsets[R]+ge,t:E[ge],nodex:(J<<1)+this._siblingOffset[ge][0],nodey:(oe<<1)+this._siblingOffset[ge][1],depth:pe+1})}}return null}_addNode(e,i,a){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,a,u,p){if(e[u].isLeaf(i,a)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const g=u-1,y=e[g];let w=0,E=0;for(let A=0;A<this._siblingOffset.length;A++){const M=2*i+this._siblingOffset[A][0],D=2*a+this._siblingOffset[A][1],L=y.getElevation(M,D),R=y.isLeaf(M,D),G=this._addNode(L.min,L.max,R);R&&(w|=1<<A),E||(E=G)}for(let A=0;A<this._siblingOffset.length;A++)w&1<<A||this._construct(e,2*i+this._siblingOffset[A][0],2*a+this._siblingOffset[A][1],g,E+A)}}function Ib(r,e,i,a,u,p){return rn(rn(r,i,p),rn(e,a,p),u)}function ka(r,e,i){const a=i.dim,u=We(r*a-.5,0,a-1),p=We(e*a-.5,0,a-1),g=Math.floor(u),y=Math.floor(p),w=Math.min(g+1,a-1),E=Math.min(y+1,a-1);return Ib(i.get(g,y),i.get(w,y),i.get(g,E),i.get(w,E),u-g,p-y)}const kb={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function gk(r,e,i){return(256*r*256+256*e+i)/10-1e4}function _k(r,e,i){return 256*r+e+i/256-32768}class Hf{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,a,u=!1,p=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return mn(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const g=this.dim=i.height-2,y=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=a||"mapbox",this.borderReady=u,!u){for(let w=0;w<g;w++)y[this._idx(-1,w)]=y[this._idx(0,w)],y[this._idx(g,w)]=y[this._idx(g-1,w)],y[this._idx(w,-1)]=y[this._idx(w,0)],y[this._idx(w,g)]=y[this._idx(w,g-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(g,-1)]=y[this._idx(g-1,0)],y[this._idx(-1,g)]=y[this._idx(0,g-1)],y[this._idx(g,g)]=y[this._idx(g-1,g-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ab(this)}get(e,i,a=!1){a&&(e=We(e,-1,this.dim),i=We(i,-1,this.dim));const u=4*this._idx(e,i);return(this.encoding==="terrarium"?_k:gk)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return kb[e]}get unpackVector(){return kb[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const a=[0,0,0,0],u=Hf.getUnpackVector(i);let p=Math.floor((e+u[3])/u[2]);return a[2]=p%256,p=Math.floor(p/256),a[1]=p%256,p=Math.floor(p/256),a[0]=p,a}getPixels(){return new Ci({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,p=i*this.dim+this.dim,g=a*this.dim,y=a*this.dim+this.dim;switch(i){case-1:u=p-1;break;case 1:p=u+1}switch(a){case-1:g=y-1;break;case 1:y=g+1}const w=-i*this.dim,E=-a*this.dim;for(let A=g;A<y;A++)for(let M=u;M<p;M++){const D=4*this._idx(M,A),L=4*this._idx(M+w,A+E);this.pixels[D+0]=e.pixels[L+0],this.pixels[D+1]=e.pixels[L+1],this.pixels[D+2]=e.pixels[L+2],this.pixels[D+3]=e.pixels[L+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}wt(Hf,"DEMData"),wt(Ab,"DemMinMaxQuadTree",{omit:["dem"]});class yk{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,a){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:i,timeout:void 0};if(a!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},a)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const a=e.wrapped().key,u=i===void 0?0:this.data[a].indexOf(i),p=this.data[a][u];return this.data[a].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(p.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const a in this.data)for(const u of this.data[a])e(u.value)||i.push(u);for(const a of i)this.remove(a.value.tileID,a)}}class su{constructor(e,i,a){this.func=e,this.mask=i,this.range=a}}su.ReadOnly=!1,su.ReadWrite=!0,su.disabled=new su(519,su.ReadOnly,[0,1]);const p_=7680;class f_{constructor(e,i,a,u,p,g){this.test=e,this.ref=i,this.mask=a,this.fail=u,this.depthFail=p,this.pass=g}}f_.disabled=new f_({func:519,mask:0},0,0,p_,p_,p_);class ds{constructor(e,i,a){this.blendFunction=e,this.blendColor=i,this.mask=a}}ds.Replace=[1,0],ds.disabled=new ds(ds.Replace,Kn.transparent,[!1,!1,!1,!1]),ds.unblended=new ds(ds.Replace,Kn.transparent,[!0,!0,!0,!0]),ds.alphaBlended=new ds([1,771],Kn.transparent,[!0,!0,!0,!0]);const m_=1029,g_=2305;class Go{constructor(e,i,a){this.enable=e,this.mode=i,this.frontFace=a}}Go.disabled=new Go(!1,m_,g_),Go.backCCW=new Go(!0,m_,g_),Go.backCW=new Go(!0,m_,2304),Go.frontCW=new Go(!0,1028,2304),Go.frontCCW=new Go(!0,1028,g_);class Ul extends rl{constructor(e,i,a){super(),this.id=e,this._onlySymbols=a,i.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new yk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new mk,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const a=this._tiles[i];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return Je(this._tiles).map(e=>e.tileID).sort(Mb).map(e=>e.key)}getRenderableIds(e){const i=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&i.push(this._tiles[a]);return e?i.sort((a,u)=>{const p=a.tileID,g=u.tileID,y=new Te(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),w=new Te(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-g.overscaledZ||w.y-y.y||w.x-y.x}).map(a=>a.tileID.key):i.map(a=>a.tileID).sort(Mb).map(a=>a.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const a=this._tiles[e];a&&(a.state!=="loading"&&(a.state=i),this._loadTile(a,this._tileLoaded.bind(this,a,e,i)))}_tileLoaded(e,i,a,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new Co(u,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=So.now(),a==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ss("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const p=i[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const g=this.getTileByID(p);a(e,g),a(g,e)}}function a(u,p){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let g=p.tileID.canonical.x-u.tileID.canonical.x;const y=p.tileID.canonical.y-u.tileID.canonical.y,w=Math.pow(2,u.tileID.canonical.z),E=p.tileID.key;g===0&&y===0||Math.abs(y)>1||(Math.abs(g)>1&&(Math.abs(g+w)===1?g+=w:Math.abs(g-w)===1&&(g-=w)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,g,y),u.neighboringTiles&&u.neighboringTiles[E]&&(u.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,a,u){for(const p in this._tiles){let g=this._tiles[p];if(u[p]||!g.hasData()||g.tileID.overscaledZ<=i||g.tileID.overscaledZ>a)continue;let y=g.tileID;for(;g&&g.tileID.overscaledZ>i+1;){const E=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[E.key],g&&g.hasData()&&(y=E)}let w=y;for(;w.overscaledZ>i;)if(w=w.scaledTo(w.overscaledZ-1),e[w.key]){u[y.key]=y;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=i?a:null}for(let a=e.overscaledZ-1;a>=i;a--){const u=e.scaledTo(a),p=this._getLoadedTile(u);if(p)return p}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const a=Math.ceil(e.width/i)+1,u=Math.ceil(e.height/i)+1,p=Math.floor(a*u*5),g=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(y)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const a={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),a[p.tileID.key]=p}this._tiles=a;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,i,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let u;this.updateCacheSize(e,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new ri(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(u=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(y=>this._source.hasTile(y)))):u=[];const p=this._updateRetainedTiles(u);if(Db(this._source.type)&&u.length!==0){const y={},w={},E=Object.keys(p);for(const M of E){const D=p[M],L=this._tiles[M];if(!L||L.fadeEndTime&&L.fadeEndTime<=So.now())continue;const R=this.findLoadedParent(D,Math.max(D.overscaledZ-Ul.maxOverzooming,this._source.minzoom));R&&(this._addTile(R.tileID),y[R.tileID.key]=R.tileID),w[M]=D}const A=u[u.length-1].overscaledZ;for(const M in this._tiles){const D=this._tiles[M];if(p[M]||!D.hasData())continue;let L=D.tileID;for(;L.overscaledZ>A;){L=L.scaledTo(L.overscaledZ-1);const R=this._tiles[L.key];if(R&&R.hasData()&&w[L.key]){p[M]=D.tileID;break}}}for(const M in y)p[M]||(this._coveredTiles[M]=!0,p[M]=y[M])}for(const y in p)this._tiles[y].clearFadeHold();const g=function(y,w){const E=[];for(const A in y)A in w||E.push(A);return E}(this._tiles,p);for(const y of g){const w=this._tiles[y];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const a={},u=e.reduce((E,A)=>Math.min(E,A.overscaledZ),1/0),p=e[0].overscaledZ,g=Math.max(p-Ul.maxOverzooming,this._source.minzoom),y=Math.max(p+Ul.maxUnderzooming,this._source.minzoom),w={};for(const E of e){const A=this._addTile(E);i[E.key]=E,A.hasData()||u<this._source.maxzoom&&(w[E.key]=E)}this._retainLoadedChildren(w,u,y,i);for(const E of e){let A=this._tiles[E.key];if(A.hasData())continue;if(E.canonical.z>=this._source.maxzoom){const D=E.children(this._source.maxzoom)[0],L=this.getTile(D);if(L&&L.hasData()){i[D.key]=D;continue}}else{const D=E.children(this._source.maxzoom);if(i[D[0].key]&&i[D[1].key]&&i[D[2].key]&&i[D[3].key])continue}let M=A.wasRequested();for(let D=E.overscaledZ-1;D>=g;--D){const L=E.scaledTo(D);if(a[L.key]||(a[L.key]=!0,A=this.getTile(L),!A&&M&&(A=this._addTile(L)),A&&(i[L.key]=L,M=A.wasRequested(),A.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let a,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){a=this._loadedParentTiles[u.key];break}i.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(a=this._getLoadedTile(p),a)break;u=p}for(const p of i)this._loadedParentTiles[p]=a}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const a=!!i;if(!a){const u=this.map?this.map.painter:null;i=new d_(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,a||this._source.fire(new Ss("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=i.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,a){const u=[],p=this.transform;if(!p)return u;const g=p.projection.name==="globe",y=ls(p.center.lng);for(const w in this._tiles){const E=this._tiles[w];if(a&&E.clearQueryDebugViz(),E.holdingForFade())continue;let A;if(g){const M=E.tileID.canonical;if(M.z===0){const D=[Math.abs(We(y,...xd(M,-1))-y),Math.abs(We(y,...xd(M,1))-y)];A=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(We(y,...xd(M,-1))-y),Math.abs(We(y,...xd(M,0))-y),Math.abs(We(y,...xd(M,1))-y)];A=[D.indexOf(Math.min(...D))-1]}}else A=[0];for(const M of A){const D=e.containsTile(E,p,i,M);D&&u.push(D)}}return u}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of i)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Db(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=So.now())return!0}return!1}setFeatureState(e,i,a){this._state.updateState(e=e||"_geojsonTileLayer",i,a)}removeFeatureState(e,i,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,a)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,a){const u=this._tiles[e];u&&u.setDependencies(i,a)}reloadTilesForDependencies(e,i){for(const a in this._tiles)this._tiles[a].hasDependency(e,i)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,i))}_preloadTiles(e,i){if(!this._sourceLoaded){const y=()=>{this._sourceLoaded&&(this._source.off("data",y),this._preloadTiles(e,i))};return void this._source.on("data",y)}const a=new Map,u=Array.isArray(e)?e:[e],p=this.map.painter.terrain,g=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const y of u){const w=y.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const E of w)a.set(E.key,E);this.usedForTerrain&&y.updateElevation(!1)}je(Array.from(a.values()),(y,w)=>{const E=new d_(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(E,A=>{this._source.type==="raster-dem"&&E.dem&&this._backfillDEM(E),w(A,E)})},i)}}function Mb(r,e){const i=Math.abs(2*r.wrap)-+(r.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||a-i||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function Db(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function xd(r,e){const i=1<<r.z;return[r.x/i+e,(r.x+1)/i+e]}Ul.maxOverzooming=10,Ul.maxUnderzooming=3;class Zf{constructor(e,i,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=a}static create(e,i,a){const u=a||e.findDEMTileFor(i);if(!u||!u.dem)return;const p=u.dem,g=u.tileID,y=1<<i.canonical.z-g.canonical.z;return new Zf(u,u.tileSize/Dt/y,[(i.canonical.x/y-g.canonical.x)*p.dim,(i.canonical.y/y-g.canonical.y)*p.dim])}tileCoordToPixel(e,i){const a=i*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),p=Math.floor(a);return new Te(u,p)}getElevationAt(e,i,a,u){const p=e*this._scale+this._offset[0],g=i*this._scale+this._offset[1],y=Math.floor(p),w=Math.floor(g),E=this._dem;return u=!!u,a?rn(rn(E.get(y,w,u),E.get(y,w+1,u),g-w),rn(E.get(y+1,w,u),E.get(y+1,w+1,u),g-w),p-y):E.get(y,w,u)}getElevationAtPixel(e,i,a){return this._dem.get(e,i,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Uo(1,e)*this._dem.stride}}class Pb{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ps(Dt,16,0),this.featureIndexArray=new Il,this.promoteId=i}insert(e,i,a,u,p,g=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,u,p,g);const w=this.grid;for(let E=0;E<i.length;E++){const A=i[E],M=[1/0,1/0,-1/0,-1/0];for(let D=0;D<A.length;D++){const L=A[D];M[0]=Math.min(M[0],L.x),M[1]=Math.min(M[1],L.y),M[2]=Math.max(M[2],L.x),M[3]=Math.max(M[3],L.y)}M[0]<Dt&&M[1]<Dt&&M[2]>=0&&M[3]>=0&&w.insert(y,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Kg(new Bf(this.rawTileData)).layers,this.sourceLayerCoder=new _b(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,a,u){this.loadVTLayers();const p=e.params||{},g=Lc(p.filter),y=e.tileResult,w=e.transform,E=y.bufferedTilespaceBounds,A=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(R,G,J,oe)=>rw(y.bufferedTilespaceGeometry,R,G,J,oe));A.sort(xk);let M=null;w.elevation&&A.length>0&&(M=Zf.create(w.elevation,this.tileID));const D={};let L;for(let R=0;R<A.length;R++){const G=A[R];if(G===L)continue;L=G;const J=this.featureIndexArray.get(G);let oe=null;this.loadMatchingFeature(D,J,g,p.layers,p.availableImages,i,a,u,(pe,se,he,ge=0)=>(oe||(oe=Ns(pe,this.tileID.canonical,e.tileTransform)),se.queryIntersectsFeature(y,pe,he,oe,this.z,e.transform,e.pixelPosMatrix,M,ge)))}return D}loadMatchingFeature(e,i,a,u,p,g,y,w,E){const{featureIndex:A,bucketIndex:M,sourceLayerIndex:D,layoutVertexArrayOffset:L}=i,R=this.bucketLayerIDs[M];if(u&&!function(pe,se){for(let he=0;he<pe.length;he++)if(se.indexOf(pe[he])>=0)return!0;return!1}(u,R))return;const G=this.sourceLayerCoder.decode(D),J=this.vtLayers[G].feature(A);if(a.needGeometry){const pe=Rl(J,!0);if(!a.filter(new I(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!a.filter(new I(this.tileID.overscaledZ),J))return;const oe=this.getId(J,G);for(let pe=0;pe<R.length;pe++){const se=R[pe];if(u&&u.indexOf(se)<0)continue;const he=g[se];if(!he)continue;let ge={};oe!==void 0&&w&&(ge=w.getState(he.sourceLayer||"_geojsonTileLayer",oe));const me=et({},y[se]);me.paint=zb(me.paint,he.paint,J,ge,p),me.layout=zb(me.layout,he.layout,J,ge,p);const Le=!E||E(J,he,ge,L);if(!Le)continue;const Pe=new yb(J,this.z,this.x,this.y,oe);Pe.layer=me;let $e=e[se];$e===void 0&&($e=e[se]=[]),$e.push({featureIndex:A,feature:Pe,intersectionZ:Le})}}lookupSymbolFeatures(e,i,a,u,p,g,y,w){const E={};this.loadVTLayers();const A=Lc(p);for(const M of e)this.loadMatchingFeature(E,{bucketIndex:a,sourceLayerIndex:u,featureIndex:M,layoutVertexArrayOffset:0},A,g,y,w,i);return E}loadFeature(e){const{featureIndex:i,sourceLayerIndex:a}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(a),p=this.vtFeatures[u];if(p[i])return p[i];const g=this.vtLayers[u].feature(i);return p[i]=g,g}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];u!=null&&(a=e.properties[u]),typeof a=="boolean"&&(a=Number(a))}return a}}function zb(r,e,i,a,u){return Rt(r,(p,g)=>{const y=e instanceof ie?e.get(g):null;return y&&y.evaluate?y.evaluate(i,a,u):y})}function xk(r,e){return e-r}wt(Pb,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Bb{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Us({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const a=this.getKey(e,i);return this.positions[a]}trim(){const e=this.width,i=this.height=yn(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,a){const u=[];let p=e.length%2==1?-e[e.length-1]*a:0,g=e[0]*a,y=!0;u.push({left:p,right:g,isDash:y,zeroLength:e[0]===0});let w=e[0];for(let E=1;E<e.length;E++){y=!y;const A=e[E];p=w*a,w+=A,g=w*a,u.push({left:p,right:g,isDash:y,zeroLength:A===0})}return u}addRoundDash(e,i,a){const u=i/2;for(let p=-a;p<=a;p++){const g=this.width*(this.nextRow+a+p);let y=0,w=e[y];for(let E=0;E<this.width;E++){E/w.right>1&&(w=e[++y]);const A=Math.abs(E-w.left),M=Math.abs(E-w.right),D=Math.min(A,M);let L;const R=p/a*(u+1);if(w.isDash){const G=u-Math.abs(R);L=Math.sqrt(D*D+G*G)}else L=u-Math.sqrt(D*D+R*R);this.image.data[g+E]=Math.max(0,Math.min(255,L+128))}}}addRegularDash(e,i){for(let w=e.length-1;w>=0;--w){const E=e[w],A=e[w+1];E.zeroLength?e.splice(w,1):A&&A.isDash===E.isDash&&(A.left=E.left,e.splice(w,1))}const a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const p=this.width*this.nextRow;let g=0,y=e[g];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++g]);const E=Math.abs(w-y.left),A=Math.abs(w-y.right),M=Math.min(E,A);this.image.data[p+w]=Math.max(0,Math.min(255,(y.isDash?M:-M)+i+128))}}addDash(e,i){const a=this.getKey(e,i);if(this.positions[a])return this.positions[a];const u=i==="round",p=u?7:0,g=2*p+1;if(this.nextRow+g>this.height)return mn("LineAtlas out of space"),null;e.length===0&&e.push(1);let y=0;for(let A=0;A<e.length;A++)e[A]<0&&(mn("Negative value is found in line dasharray, replacing values with 0"),e[A]=0),y+=e[A];if(y!==0){const A=this.width/y,M=this.getDashRanges(e,this.width,A);u?this.addRoundDash(M,A,p):this.addRegularDash(M,i==="square"?.5*A:0)}const w=this.nextRow+p;this.nextRow+=g;const E={tl:[w,p],br:[y,0]};return this.positions[a]=E,E}}wt(Bb,"LineAtlas");const Lb=1*Vo;class Rb{constructor(e){const i={},a=[];for(const y in e){const w=e[y],E=i[y]={};for(const A in w.glyphs){const M=w.glyphs[+A];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const D=M.metrics.localGlyph?Lb:1,L={x:0,y:0,w:M.bitmap.width+2*D,h:M.bitmap.height+2*D};a.push(L),E[A]=L}}const{w:u,h:p}=e_(a),g=new Us({width:u||1,height:p||1});for(const y in e){const w=e[y];for(const E in w.glyphs){const A=w.glyphs[+E];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const M=i[y][E],D=A.metrics.localGlyph?Lb:1;Us.copy(A.bitmap,g,{x:0,y:0},{x:M.x+D,y:M.y+D},A.bitmap)}}this.image=g,this.positions=i}}wt(Rb,"GlyphAtlas");class vk{constructor(e){this.tileID=new ri(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Nl(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,a,u,p){this.status="parsing",this.data=e,this.collisionBoxArray=new En;const g=new _b(Object.keys(e.layers).sort()),y=new Pb(this.tileID,this.promoteId);y.bucketLayerIDs=[];const w={},E=new Bb(256,256),A={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:E,availableImages:a},M=i.familiesBySource[this.source];for(const ge in M){const me=e.layers[ge];if(!me)continue;let Le=!1,Pe=!1;for(const Oe of M[ge])Oe[0].type==="symbol"?Le=!0:Pe=!0;if(this.isSymbolTile===!0&&!Le||this.isSymbolTile===!1&&!Pe)continue;me.version===1&&mn(`Vector tile source "${this.source}" layer "${ge}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const $e=g.encode(ge),ot=[];for(let Oe=0;Oe<me.length;Oe++){const Ke=me.feature(Oe),Ye=y.getId(Ke,ge);ot.push({feature:Ke,id:Ye,index:Oe,sourceLayerIndex:$e})}for(const Oe of M[ge]){const Ke=Oe[0];this.isSymbolTile!==void 0&&Ke.type==="symbol"!==this.isSymbolTile||Ke.minzoom&&this.zoom<Math.floor(Ke.minzoom)||Ke.maxzoom&&this.zoom>=Ke.maxzoom||Ke.visibility!=="none"&&(__(Oe,this.zoom,a),(w[Ke.id]=Ke.createBucket({index:y.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:$e,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(ot,A,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(Oe.map(Ye=>Ye.id)))}}let D,L,R,G;E.trim();const J={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},oe=()=>{if(D)return p(D);if(L&&R&&G){const ge=new Rb(L),me=new Gw(R,G);for(const Le in w){const Pe=w[Le];Pe instanceof Ca?(__(Pe.layers,this.zoom,a),W3(Pe,L,ge.positions,R,me.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):Pe.hasPattern&&(Pe instanceof Df||Pe instanceof Cf||Pe instanceof ad)&&(__(Pe.layers,this.zoom,a),Pe.addFeatures(A,this.tileID.canonical,me.patternPositions,a,this.tileTransform))}this.status="done",p(null,{buckets:Je(w).filter(Le=>!Le.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ge.image,lineAtlas:E,imageAtlas:me,glyphMap:this.returnDependencies?L:null,iconMap:this.returnDependencies?R:null,glyphPositions:this.returnDependencies?ge.positions:null})}},pe=Rt(A.glyphDependencies,ge=>Object.keys(ge).map(Number));Object.keys(pe).length?u.send("getGlyphs",{uid:this.uid,stacks:pe},(ge,me)=>{D||(D=ge,L=me,oe())},void 0,!1,J):L={};const se=Object.keys(A.iconDependencies);se.length?u.send("getImages",{icons:se,source:this.source,tileID:this.tileID,type:"icons"},(ge,me)=>{D||(D=ge,R=me,oe())},void 0,!1,J):R={};const he=Object.keys(A.patternDependencies);he.length?u.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"patterns"},(ge,me)=>{D||(D=ge,G=me,oe())},void 0,!1,J):G={},oe()}}function __(r,e,i){const a=new I(e);for(const u of r)u.recalculate(a,i)}class Fb{constructor(e){this.entries={},this.scheduler=e}request(e,i,a,u){const p=this.entries[e]=this.entries[e]||{callbacks:[]};if(p.result){const[g,y]=p.result;return this.scheduler?this.scheduler.add(()=>{u(g,y)},i):u(g,y),()=>{}}return p.callbacks.push(u),p.cancel||(p.cancel=a((g,y)=>{p.result=[g,y];for(const w of p.callbacks)this.scheduler?this.scheduler.add(()=>{w(g,y)},i):w(g,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(g=>g!==u),p.callbacks.length||(p.cancel(),delete this.entries[e]))}}}function Ob(r,e,i){const a=JSON.stringify(r.request);return r.data&&(this.deduped.entries[a]={result:[null,r.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},u=>{const p=ns(r.request,(g,y,w,E)=>{g?u(g):y&&u(null,{vectorTile:i?void 0:new Kg(new Bf(y)),rawData:y,cacheControl:w,expires:E})});return()=>{p.cancel(),u()}},e)}const Nb=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class y_{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,a]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=a>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const p=Nb[15&a];if(!p)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[y]=new Uint32Array(e,4,1);return new y_(y,g,p,e)}constructor(e,i=64,a=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const p=Nb.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,y=e*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-y%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${a}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+y+w,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+y+w),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+y+w,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=i,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return x_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:g,nodeSize:y}=this,w=[0,p.length-1,0],E=[];for(;w.length;){const A=w.pop()||0,M=w.pop()||0,D=w.pop()||0;if(M-D<=y){for(let J=D;J<=M;J++){const oe=g[2*J],pe=g[2*J+1];oe>=e&&oe<=a&&pe>=i&&pe<=u&&E.push(p[J])}continue}const L=D+M>>1,R=g[2*L],G=g[2*L+1];R>=e&&R<=a&&G>=i&&G<=u&&E.push(p[L]),(A===0?e<=R:i<=G)&&(w.push(D),w.push(L-1),w.push(1-A)),(A===0?a>=R:u>=G)&&(w.push(L+1),w.push(M),w.push(1-A))}return E}within(e,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:p,nodeSize:g}=this,y=[0,u.length-1,0],w=[],E=a*a;for(;y.length;){const A=y.pop()||0,M=y.pop()||0,D=y.pop()||0;if(M-D<=g){for(let J=D;J<=M;J++)jb(p[2*J],p[2*J+1],e,i)<=E&&w.push(u[J]);continue}const L=D+M>>1,R=p[2*L],G=p[2*L+1];jb(R,G,e,i)<=E&&w.push(u[L]),(A===0?e-a<=R:i-a<=G)&&(y.push(D),y.push(L-1),y.push(1-A)),(A===0?e+a>=R:i+a>=G)&&(y.push(L+1),y.push(M),y.push(1-A))}return w}}function x_(r,e,i,a,u,p){if(u-a<=i)return;const g=a+u>>1;Ub(r,e,g,a,u,p),x_(r,e,i,a,g-1,1-p),x_(r,e,i,g+1,u,1-p)}function Ub(r,e,i,a,u,p){for(;u>a;){if(u-a>600){const E=u-a+1,A=i-a+1,M=Math.log(E),D=.5*Math.exp(2*M/3),L=.5*Math.sqrt(M*D*(E-D)/E)*(A-E/2<0?-1:1);Ub(r,e,i,Math.max(a,Math.floor(i-A*D/E+L)),Math.min(u,Math.floor(i+(E-A)*D/E+L)),p)}const g=e[2*i+p];let y=a,w=u;for(vd(r,e,a,i),e[2*u+p]>g&&vd(r,e,a,u);y<w;){for(vd(r,e,y,w),y++,w--;e[2*y+p]<g;)y++;for(;e[2*w+p]>g;)w--}e[2*a+p]===g?vd(r,e,a,w):(w++,vd(r,e,w,u)),w<=i&&(a=w+1),i<=w&&(u=w-1)}}function vd(r,e,i,a){v_(r,i,a),v_(e,2*i,2*a),v_(e,2*i+1,2*a+1)}function v_(r,e,i){const a=r[e];r[e]=r[i],r[i]=a}function jb(r,e,i,a){const u=r-i,p=e-a;return u*u+p*p}s.ARRAY_TYPE=Si,s.AUTH_ERR_MSG=_e,s.Aabb=ni,s.Actor=class{constructor(r,e,i){this.target=r,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Lr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=qr()?r:C,this.scheduler=new pk}send(r,e,i,a,u=!1,p){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=p,this.callbacks[g]=i);const y=_r(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:r,hasCallback:!!i,targetMapId:a,mustQueue:u,sourceMapId:this.mapId,data:ya(e,y)},y),{cancel:()=>{i&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(r){const e=r.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a.cancel()}else if(e.mustQueue||qr()){const a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),a&&a.metadata||{type:"message"})}else this.processTask(i,e)}processTask(r,e){if(e.type==="<response>"){const i=this.callbacks[r];delete this.callbacks[r],i&&(e.error?i(zs(e.error)):i(null,zs(e.data)))}else{const i=_r(this.globalScope)?void 0:[],a=e.hasCallback?(p,g)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:p?ya(p):null,data:ya(g,i)},i)}:p=>{},u=zs(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){const p=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,p[0],u.source)[p[1]](u,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Mf,s.Color=Kn,s.ColorMode=ds,s.CullFaceMode=Go,s.DEMData=Hf,s.DataConstantProperty=j,s.DedupedRequest=Fb,s.DepthMode=su,s.EXTENT=Dt,s.Elevation=class{isDataAvailableAtPoint(r){const e=this._source();if(this.isUsingMockSource()||!e||r.y<0||r.y>1)return!1;const i=e.getSource().maxzoom,a=1<<i,u=Math.floor(r.x),p=Math.floor((r.x-u)*a),g=Math.floor(r.y*a),y=this.findDEMTileFor(new ri(i,u,i,p,g));return!(!y||!y.dem)}getAtPointOrZero(r,e=0){return this.getAtPoint(r,e)||0}getAtPoint(r,e,i=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const a=this._source();if(!a||r.y<0||r.y>1)return e;const u=a.getSource().maxzoom,p=1<<u,g=Math.floor(r.x),y=r.x-g,w=new ri(u,g,u,Math.floor(y*p),Math.floor(r.y*p)),E=this.findDEMTileFor(w);if(!E||!E.dem)return e;const A=E.dem,M=1<<E.tileID.canonical.z,D=(y*M-E.tileID.canonical.x)*A.dim,L=(r.y*M-E.tileID.canonical.y)*A.dim,R=Math.floor(D),G=Math.floor(L);return(i?this.exaggeration():1)*rn(rn(A.get(R,G),A.get(R,G+1),L-G),rn(A.get(R+1,G),A.get(R+1,G+1),L-G),D-R)}getAtTileOffset(r,e,i){const a=1<<r.canonical.z;return this.getAtPointOrZero(new Wc(r.wrap+(r.canonical.x+e/Dt)/a,(r.canonical.y+i/Dt)/a))}getAtTileOffsetFunc(r,e,i,a){return u=>{const p=this.getAtTileOffset(r,u.x,u.y),g=a.upVector(r.canonical,u.x,u.y);return qi(g,g,p*a.upVectorScale(r.canonical,e,i).metersToTile),g}}getForTilePoints(r,e,i,a){if(this.isUsingMockSource())return!1;const u=Zf.create(this,r,a);return!!u&&(e.forEach(p=>{p[2]=this.exaggeration()*u.getElevationAt(p[0],p[1],i)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(r);if(!e||!e.dem)return null;const i=e.dem.tree,a=e.tileID,u=1<<r.canonical.z-a.canonical.z;let p=r.canonical.x/u-a.canonical.x,g=r.canonical.y/u-a.canonical.y,y=0;for(let w=0;w<r.canonical.z-a.canonical.z&&!i.leaves[y];w++){p*=2,g*=2;const E=2*Math.floor(g)+Math.floor(p);y=i.childOffsets[y]+E,p%=1,g%=1}return{min:this.exaggeration()*i.minimums[y],max:this.exaggeration()*i.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Co,s.EvaluationParameters=I,s.Event=Ss,s.Evented=rl,s.FillExtrusionBucket=ad,s.Frustum=Ag,s.FrustumCorners=Cg,s.GLOBE_RADIUS=ss,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=Uv,s.GLOBE_ZOOM_THRESHOLD_MIN=Ig,s.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_fillGridMeshWithLods(r,e){const i=new it,a=new Ct,u=[],p=r+1+2,g=e[0]+1,y=e[0]+1+(1+e.length),w=(E,A,M)=>{let D=E===p-1?E-2:E===0?E:E-1;return D+=M?24575:0,[D,A]};for(let E=0;E<p;++E)i.emplaceBack(...w(E,0,!0));for(let E=0;E<g;++E)for(let A=0;A<p;++A)i.emplaceBack(...w(A,E,(A===0||A===p-1)&&!0));for(let E=0;E<e.length;++E){const A=e[E];for(let M=0;M<p;++M)i.emplaceBack(...w(M,A,!0))}for(let E=0;E<e.length;++E){const A=a.length,M=e[E]+1+2,D=new Ct;for(let G=0;G<M-1;G++){const J=G===M-2,oe=J?p*(y-e.length+E-G):p;for(let pe=0;pe<p-1;pe++){const se=G*p+pe;G===0||J||pe===0||pe===p-2?(D.emplaceBack(se+1,se,se+oe),D.emplaceBack(se+oe,se+oe+1,se+1)):(a.emplaceBack(se+1,se,se+oe),a.emplaceBack(se+oe,se+oe+1,se+1))}}const L=nr.simpleSegment(0,A,i.length,a.length-A);for(let G=0;G<D.uint16.length;G+=3)a.emplaceBack(D.uint16[G],D.uint16[G+1],D.uint16[G+2]);const R=nr.simpleSegment(0,A,i.length,a.length-A);u.push({withoutSkirts:L,withSkirts:R})}return{vertices:i,indices:a,segments:u}}_createGrid(r){const e=this._fillGridMeshWithLods(Bl,Yh);this._gridSegments=e.segments,this._gridBuffer=r.createVertexBuffer(e.vertices,Kh.members),this._gridIndexBuffer=r.createIndexBuffer(e.indices,!0)}_createPoles(r){const e=new Ct;for(let u=0;u<=Bl;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=r.createIndexBuffer(e,!0);const i=new bn,a=new bn;this._poleSegments=[];for(let u=0,p=0;u<Ig;u++){const g=360/(1<<u);i.emplaceBack(0,-ss,0,.5,0),a.emplaceBack(0,-ss,0,.5,1);for(let y=0;y<=Bl;y++){const w=y/Bl,E=rn(0,g,w),[A,M,D]=Gc(pI,fI,E,ss);i.emplaceBack(A,M,D,w,0),a.emplaceBack(A,M,D,w,1)}this._poleSegments.push(nr.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(i,Ov,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(a,Ov,!1)}getGridBuffers(r,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,e){if(!this._wireframeSegments){const i=new Er,a=Bl,u=a+1+2,p=1;this._wireframeSegments=[];for(let g=0,y=0;g<Yh.length;g++){const w=Yh[g];for(let A=p;A<w+p;A++)for(let M=p;M<a+p;M++){const D=A*u+M;i.emplaceBack(D,D+1),i.emplaceBack(D,D+u),i.emplaceBack(D,D+u+1)}const E=w*a*3;this._wireframeSegments.push(nr.simpleSegment(0,y,(w+1)*u,E)),y+=E}this._wireframeIndexBuffer=r.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=tu,s.ImagePosition=t_,s.KDBush=y_,s.LivePerformanceUtils=Zm,s.LngLat=Tn,s.LngLatBounds=ba,s.LocalGlyphMode=i_,s.MAX_MERCATOR_LATITUDE=Ur,s.MercatorCoordinate=Wc,s.ONE_EM=Dr,s.OverscaledTileID=ri,s.PerformanceMarkers=ta,s.Point=Te,s.Properties=le,s.RGBAImage=Ci,s.Ray=Sg,s.RequestManager=class{constructor(r,e,i){this._transformRequestFn=r,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const r=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,e){return this._transformRequestFn&&this._transformRequestFn(r,e)||{url:r}}normalizeStyleURL(r,e){if(!Ee(r))return r;const i=dt(r);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(r,e){if(!Ee(r))return r;const i=dt(r);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(r,e,i,a){if(!Ee(r))return r;const u=dt(r);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),i&&u.params.push(`language=${i}`),a&&u.params.push(`worldview=${a}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(r,e,i,a){const u=dt(r);return Ee(r)?(u.path=`/styles/v1${u.path}/sprite${e}${i}`,this._makeAPIURL(u,this._customAccessToken||a)):(u.path+=`${e}${i}`,st(u))}normalizeTileURL(r,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!Ee(r))return r;const a=dt(r);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&a.authority!=="raster"&&i===512?"@2x":""}${F.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${U.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${U.TILE_URL_VERSION}${a.path}`);const u=this._customAccessToken||function(p){for(const g of p){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(a.params)||U.ACCESS_TOKEN;return U.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,u)}canonicalizeTileURL(r,e){const i=dt(r);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return r;let a="mapbox://";i.path.match(/^\/raster\/v1\//)?a+=`raster/${i.path.replace(`/${U.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${i.path.replace(`/${U.TILE_URL_VERSION}/`,"")}`;let u=i.params;return e&&(u=u.filter(p=>!p.match(/^access_token=/))),u.length&&(a+=`?${u.join("&")}`),a}canonicalizeTileset(r,e){const i=!!e&&Ee(e),a=[];for(const u of r.tiles||[])Me(u)?a.push(this.canonicalizeTileURL(u,i)):a.push(u);return a}_makeAPIURL(r,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=dt(U.API_URL);if(r.protocol=a.protocol,r.authority=a.authority,r.protocol==="http"){const u=r.params.indexOf("secure");u>=0&&r.params.splice(u,1)}if(a.path!=="/"&&(r.path=`${a.path}${r.path}`),!U.REQUIRE_ACCESS_TOKEN)return st(r);if(e=e||U.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return r.params=r.params.filter(u=>u.indexOf("access_token")===-1),r.params.push(`access_token=${e||""}`),st(r)}},s.ResourceType=Eo,s.SegmentVector=nr,s.SourceCache=Ul,s.StencilMode=f_,s.StructArrayLayout1ui2=Ti,s.StructArrayLayout2f1f2i16=zt,s.StructArrayLayout2i4=it,s.StructArrayLayout2ui4=Er,s.StructArrayLayout3f12=Xt,s.StructArrayLayout3ui6=Ct,s.StructArrayLayout4i8=Ze,s.StructArrayLayout5f20=bn,s.Texture=yd,s.Tile=d_,s.Transitionable=N,s.Uniform1f=pf,s.Uniform1i=class extends Rs{constructor(r){super(r),this.current=0}set(r,e,i){this.fetchUniformLocation(r,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},s.Uniform2f=class extends Rs{constructor(r){super(r),this.current=[0,0]}set(r,e,i){this.fetchUniformLocation(r,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},s.Uniform3f=class extends Rs{constructor(r){super(r),this.current=[0,0,0]}set(r,e,i){this.fetchUniformLocation(r,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},s.Uniform4f=wv,s.UniformColor=bv,s.UniformMatrix2f=class extends Rs{constructor(r){super(r),this.current=Y4}set(r,e,i){if(this.fetchUniformLocation(r,e)){for(let a=0;a<4;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},s.UniformMatrix3f=class extends Rs{constructor(r){super(r),this.current=K4}set(r,e,i){if(this.fetchUniformLocation(r,e)){for(let a=0;a<9;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},s.UniformMatrix4f=class extends Rs{constructor(r){super(r),this.current=X4}set(r,e,i){if(this.fetchUniformLocation(r,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let a=1;a<16;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},s.UnwrappedTileID=Iw,s.ValidationError=vt,s.VectorTileFeature=If,s.VectorTileWorkerSource=class extends rl{constructor(r,e,i,a,u){super(),this.actor=r,this.layerIndex=e,this.availableImages=i,this.loadVectorData=u||Ob,this.loading={},this.loaded={},this.deduped=new Fb(r.scheduler),this.isSpriteLoaded=a,this.scheduler=r.scheduler}loadTile(r,e){const i=r.uid,a=r&&r.request,u=a&&a.collectResourceTiming,p=this.loading[i]=new vk(r);p.abort=this.loadVectorData(r,(g,y)=>{const w=!this.loading[i];if(delete this.loading[i],w||g||!y)return p.status="done",w||(this.loaded[i]=p),e(g);const E=y.rawData,A={};y.expires&&(A.expires=y.expires),y.cacheControl&&(A.cacheControl=y.cacheControl),p.vectorTile=y.vectorTile||new Kg(new Bf(E));const M=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(D,L)=>{if(D||!L)return e(D);const R={};if(u){const G=Hu(a);G.length>0&&(R.resourceTiming=JSON.parse(JSON.stringify(G)))}e(null,et({rawTileData:E.slice(0)},L,A,R))})};this.isSpriteLoaded?M():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(M,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):M()}),this.loaded=this.loaded||{},this.loaded[i]=p})}reloadTile(r,e){const i=this.loaded,a=r.uid,u=this;if(i&&i[a]){const p=i[a];p.showCollisionBoxes=r.showCollisionBoxes,p.enableTerrain=!!r.enableTerrain,p.projection=r.projection,p.tileTransform=Nl(r.tileID.canonical,r.projection);const g=(y,w)=>{const E=p.reloadCallback;E&&(delete p.reloadCallback,p.parse(p.vectorTile,u.layerIndex,this.availableImages,u.actor,E)),e(y,w)};p.status==="parsing"?p.reloadCallback=g:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(r,e){const i=r.uid,a=this.loading[i];a&&(a.abort&&a.abort(),delete this.loading[i]),e()}removeTile(r,e){const i=this.loaded,a=r.uid;i&&i[a]&&delete i[a],e()}},s.WritingMode=Wi,s.ZoomDependentExpression=wl,s.add=Os,s.addDynamicAttributes=qf,s.adjoint=function(r,e){var i=e[0],a=e[1],u=e[2],p=e[3],g=e[4],y=e[5],w=e[6],E=e[7],A=e[8];return r[0]=g*A-y*E,r[1]=u*E-a*A,r[2]=a*y-u*g,r[3]=y*w-p*A,r[4]=i*A-u*w,r[5]=u*p-i*y,r[6]=p*E-g*w,r[7]=a*w-i*E,r[8]=i*g-a*p,r},s.asyncAll=je,s.bezier=Ot,s.bindAll=Lr,s.boundsAttributes=vb,s.bufferConvexPolygon=function(r,e){const i=[];for(let a=0;a<r.length;a++){const u=ft(a-1,-1,r.length-1),p=ft(a+1,-1,r.length-1),g=r[a],y=r[p],w=r[u].sub(g).unit(),E=y.sub(g).unit(),A=E.angleWithSep(w.x,w.y),M=w.add(E).unit().mult(-1*e/Math.sin(A/2));i.push(g.add(M))}return i},s.cacheEntryPossiblyAdded=function(r){Ni++,Ni>Oi&&(r.getActor().send("enforceCacheSizeLimit",Es),Ni=0)},s.calculateGlobeLabelMatrix=function(r,e){const{x:i,y:a}=r.point,u=$v(i,a,r.worldSize/r._pixelsPerMercatorPixel,0,0);return Dl(u,u,Dg(as(e)))},s.calculateGlobeMatrix=function(r){const{x:e,y:i}=r.point,{lng:a,lat:u}=r._center;return $v(e,i,r.worldSize,a,u)},s.calculateGlobeMercatorMatrix=function(r){const e=r.pixelsPerMeter,i=e/Uo(1,r.center.lat),a=Oo(new Float64Array(16));return qh(a,a,[r.point.x,r.point.y,0]),Pl(a,a,[i,i,e]),Float32Array.from(a)},s.circumferenceAtLatitude=zg,s.clamp=We,s.clearTileCache=function(r){if(!ts())return;const e=C.caches.delete(Fi);r&&e.catch(r).then(()=>r())},s.clipLine=nb,s.clone=function(r){var e=new Si(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},s.clone$1=zn,s.collisionCircleLayout=y3,s.config=U,s.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},s.create=function(){var r=new Si(16);return Si!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},s.create$1=Sv,s.createExpression=ma,s.createLayout=Ae,s.createStyleLayer=function(r){return r.type==="custom"?new ck(r):new hk[r.type](r)},s.cross=Tg,s.degToRad=Ue,s.distance=function(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2])},s.div=function(r,e,i){return r[0]=e[0]/i[0],r[1]=e[1]/i[1],r[2]=e[2]/i[2],r},s.dot=ho,s.earthRadius=ed,s.ease=on,s.easeCubicInOut=kt,s.ecefToLatLng=function([r,e,i]){const a=Math.hypot(r,e,i),u=Math.atan2(r,i),p=.5*Math.PI-Math.acos(-e/a);return new Tn(Ve(u),Ve(p))},s.emitValidationErrors=af,s.endsWith=ln,s.enforceCacheSizeLimit=function(r){no(),xr&&xr.then(e=>{e.keys().then(i=>{for(let a=0;a<i.length-r;a++)e.delete(i[a])})})},s.evaluateSizeForFeature=Pf,s.evaluateSizeForZoom=Yc,s.evaluateVariableOffset=ab,s.evented=_,s.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},s.exactEquals$1=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},s.exported=So,s.exported$1=F,s.extend=et,s.extend$1=Ao,s.fillExtrusionHeightLift=Sw,s.filterObject=Yr,s.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},s.fromQuat=function(r,e){var i=e[0],a=e[1],u=e[2],p=e[3],g=i+i,y=a+a,w=u+u,E=i*g,A=a*g,M=a*y,D=u*g,L=u*y,R=u*w,G=p*g,J=p*y,oe=p*w;return r[0]=1-M-R,r[1]=A+oe,r[2]=D-J,r[3]=0,r[4]=A-oe,r[5]=1-E-R,r[6]=L+G,r[7]=0,r[8]=D+J,r[9]=L-G,r[10]=1-E-M,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},s.fromRotation=function(r,e){var i=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=i,r[2]=0,r[3]=-i,r[4]=a,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},s.fromScaling=Av,s.furthestTileCorner=function(r){const e=Math.round((r+45+360)%360/90)%4;return St[e]},s.getAABBPointSquareDist=function(r,e,i){let a=0;for(let u=0;u<2;++u){const p=i?i[u]:0;r[u]>p&&(a+=(r[u]-p)*(r[u]-p)),e[u]<p&&(a+=(p-e[u])*(p-e[u]))}return a},s.getAnchorAlignment=r_,s.getAnchorJustification=s_,s.getBounds=function(r){let e=1/0,i=1/0,a=-1/0,u=-1/0;for(const p of r)e=Math.min(e,p.x),i=Math.min(i,p.y),a=Math.max(a,p.x),u=Math.max(u,p.y);return{min:new Te(e,i),max:new Te(a,u)}},s.getColumn=kr,s.getDefaultExportFromCjs=V,s.getGridMatrix=function(r,e,i,a){const u=e.getNorth(),p=e.getSouth(),g=e.getWest(),y=e.getEast(),w=1<<r.z,E=y-g,A=u-p,M=E/Bl,D=-A/Yh[i],L=[0,M,0,D,0,0,u,g,0];if(r.z>0){const R=180/a;Cv(L,L,[R/E+1,0,0,0,R/A+1,0,-.5*R/M,.5*R/D,1])}return L[2]=w,L[5]=r.x,L[8]=r.y,L},s.getImage=ce,s.getJSON=function(r,e){return To(et(r,{type:"json"}),e)},s.getLatitudinalLod=function(r){const e=Ur-5;r=We(r,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Ue(r))),3);return Math.round(i*(Yh.length-1))},s.getMapSessionAPI=vr,s.getPerformanceMeasurement=Hu,s.getProjection=mb,s.getRTLTextPluginStatus=v,s.getReferrer=ro,s.getTilePoint=function(r,{x:e,y:i},a=0){return new Te(((e-a)*r.scale-r.x)*Dt,(i*r.scale-r.y)*Dt)},s.getTileVec3=function(r,e,i=0){return Vc(((e.x-i)*r.scale-r.x)*Dt,(e.y*r.scale-r.y)*Dt,Xv(e.z,e.y))},s.getVideo=function(r,e){const i=C.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<r.length;a++){const u=C.document.createElement("source");Ts(r[a])||(i.crossOrigin="Anonymous"),u.src=r[a],i.appendChild(u)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(r){const e=[0,0,0],i=Oo(new Float64Array(16));return Dl(i,r.pixelMatrix,r.globeMatrix),Yn(e,e,i),new Te(e[0],e[1])},s.globeDenormalizeECEF=Dg,s.globeECEFOrigin=function(r,e){const i=[0,0,0];return Yn(i,i,Qh(as(e.canonical))),Yn(i,i,r),i},s.globeMetersToEcef=gf,s.globeNormalizeECEF=Qh,s.globePixelsToTileUnits=function(r,e){return Dt/(512*Math.pow(2,r))*yf(as(e))},s.globePoleMatrixForTile=function(r,e,i){const a=Oo(new Float64Array(16)),u=(e/(1<<r)-.5)*Math.PI*2;return mf(a,i.globeMatrix,u),Float32Array.from(a)},s.globeTileBounds=as,s.globeTiltAtLngLat=Wv,s.globeToMercatorTransition=$c,s.globeUseCustomAntiAliasing=function(r,e,i){const a=$c(i.zoom),u=r.style.map._antialias,p=!!e.extStandardDerivatives,g=e.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return a===0&&!u&&!g&&p},s.identity=Oo,s.identity$1=Lv,s.invert=vg,s.isFullscreen=function(){return!!C.document.fullscreenElement||!!C.document.webkitFullscreenElement},s.isLngLatBehindGlobe=Pg,s.isMapAuthenticated=function(r){return $r.has(r)},s.isMapboxURL=Ee,s.isSafariWithAntialiasingBug=function(r){const e=r.navigator?r.navigator.userAgent:null;return!!_r(r)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Nr,s.latLngToECEF=qc,s.len=sI,s.length=$h,s.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},s.lngFromMercatorX=$i,s.loadVectorTile=Ob,s.makeRequest=To,s.mapValue=function(r,e,i,a,u){return We((r-e)/(i-e)*(u-a)+a,a,u)},s.mercatorScale=Kv,s.mercatorXfromLng=ls,s.mercatorYfromLat=cs,s.mercatorZfromAltitude=Uo,s.mul=iI,s.mul$1=oI,s.multiply=Dl,s.multiply$1=Cv,s.multiply$2=Mv,s.nextPowerOfTwo=yn,s.normalize=ti,s.normalize$1=aI,s.normalize$2=zv,s.number=rn,s.ortho=function(r,e,i,a,u,p,g){var y=1/(e-i),w=1/(a-u),E=1/(p-g);return r[0]=-2*y,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*w,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*E,r[11]=0,r[12]=(e+i)*y,r[13]=(u+a)*w,r[14]=(g+p)*E,r[15]=1,r},s.pbf=Lw,s.perspective=function(r,e,i,a,u){var p,g=1/Math.tan(e/2);return r[0]=g/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=g,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=(u+a)*(p=1/(a-u)),r[14]=2*u*a*p):(r[10]=-1,r[14]=-2*a),r},s.pick=function(r,e){const i={};for(let a=0;a<e.length;a++){const u=e[a];u in r&&(i[u]=r[u])}return i},s.plugin=S,s.pointGeometry=we,s.polesInViewport=function(r){const e=Oo(new Float64Array(16));Dl(e,r.pixelMatrix,r.globeMatrix);const i=[0,po,0],a=[0,fo,0];return Yn(i,i,e),Yn(a,a,e),[i[0]>0&&i[0]<=r.width&&i[1]>0&&i[1]<=r.height&&!Pg(r,new Tn(r.center.lat,90)),a[0]>0&&a[0]<=r.width&&a[1]>0&&a[1]<=r.height&&!Pg(r,new Tn(r.center.lat,-90))]},s.polygonContainsPoint=Fl,s.polygonIntersectsBox=rw,s.polygonIntersectsPolygon=Qv,s.polygonizeBounds=function(r,e,i=0,a=!0){const u=new Te(i,i),p=r.sub(u),g=e.add(u),y=[p,new Te(g.x,p.y),g,new Te(p.x,g.y)];return a&&y.push(p.clone()),y},s.posAttributes=Kh,s.postMapLoadEvent=Qn,s.postPerformanceEvent=hr,s.postTurnstileEvent=en,s.potpack=e_,s.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},s.radToDeg=Ve,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(r){return r({pluginStatus:d,pluginURL:o}),_.on("pluginStateChange",r),r},s.removeAuthState=function(r){$r.delete(r)},s.renderColorRamp=jg,s.resample=Yv,s.rotateX=wg,s.rotateX$1=Rv,s.rotateY=mf,s.rotateY$1=Fv,s.rotateZ=function(r,e,i){var a=Math.sin(i),u=Math.cos(i),p=e[0],g=e[1],y=e[2],w=e[3],E=e[4],A=e[5],M=e[6],D=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=p*u+E*a,r[1]=g*u+A*a,r[2]=y*u+M*a,r[3]=w*u+D*a,r[4]=E*u-p*a,r[5]=A*u-g*a,r[6]=M*u-y*a,r[7]=D*u-w*a,r},s.rotateZ$1=function(r,e,i){i*=.5;var a=e[0],u=e[1],p=e[2],g=e[3],y=Math.sin(i),w=Math.cos(i);return r[0]=a*w+u*y,r[1]=u*w-a*y,r[2]=p*w+g*y,r[3]=g*w-p*y,r},s.scale=Pl,s.scale$1=Pv,s.scale$2=qi,s.scaleAndAdd=Zh,s.set=function(r,e,i,a){return r[0]=e,r[1]=i,r[2]=a,r},s.setCacheLimits=function(r,e){Es=r,Oi=e},s.setColumn=function(r,e,i){r[4*e+0]=i[0],r[4*e+1]=i[1],r[4*e+2]=i[2],r[4*e+3]=i[3]},s.setRTLTextPlugin=function(r,e,i=!1){if(d===Nh||d===Uh||d===jh)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=So.resolveURL(r),d=Nh,xa=e,f(),i||T()},s.smoothstep=bt,s.spec=qe,s.squaredLength=function(r){var e=r[0],i=r[1],a=r[2];return e*e+i*i+a*a},s.storeAuthState=function(r,e){e?$r.add(r):$r.delete(r)},s.sub=No,s.subtract=Eg,s.symbolSize=x3,s.tileAABB=function(r,e,i,a,u,p,g,y,w){if(w.name==="globe")return dI(r,e,new Mf(i,a,u));const E=Nl({z:i,x:a,y:u},w);return new ni([(p+E.x/E.scale)*e,e*(E.y/E.scale),g],[(p+E.x2/E.scale)*e,e*(E.y2/E.scale),y])},s.tileCornersToBounds=_f,s.tileTransform=Nl,s.transformMat3=function(r,e,i){var a=e[0],u=e[1],p=e[2];return r[0]=a*i[0]+u*i[3]+p*i[6],r[1]=a*i[1]+u*i[4]+p*i[7],r[2]=a*i[2]+u*i[5]+p*i[8],r},s.transformMat4=Yn,s.transformMat4$1=zl,s.transformQuat=Dv,s.transitionTileAABBinECEF=Vv,s.translate=qh,s.transpose=function(r,e){if(r===e){var i=e[1],a=e[2],u=e[5];r[1]=e[3],r[2]=e[6],r[3]=i,r[5]=e[7],r[6]=a,r[7]=u}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r},s.triggerPluginCompletionEvent=c,s.uniqueId=nn,s.updateGlobeVertexNormal=function(r,e,i,a,u){const p=5*e+2;r.float32[p+0]=i,r.float32[p+1]=a,r.float32[p+2]=u},s.validateCustomStyleLayer=function(r){const e=[],i=r.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=r=>Ei(Cl(r)),s.validateFog=r=>Ei(rf(r)),s.validateLayer=r=>Ei(Qp(r)),s.validateLight=r=>Ei(nf(r)),s.validateSource=r=>Ei(tf(r)),s.validateStyle=sf,s.validateTerrain=r=>Ei(Bh(r)),s.values=Je,s.vectorTile=Af,s.version=k,s.warnOnce=mn,s.window=C,s.wrap=ft}),x(["./shared"],function(s){function C(de){if(typeof de=="number"||typeof de=="boolean"||typeof de=="string"||de==null)return JSON.stringify(de);if(Array.isArray(de)){let H="[";for(const ce of de)H+=`${C(ce)},`;return`${H}]`}let $="{";for(const H of Object.keys(de).sort())$+=`${H}:${C(de[H])},`;return`${$}}`}function k(de){let $="";for(const H of s.refProperties)$+=`/${C(de[H])}`;return $}class B{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,H){for(const _e of $)this._layerConfigs[_e.id]=_e,(this._layers[_e.id]=s.createStyleLayer(_e)).compileFilter(),this.keyCache[_e.id]&&delete this.keyCache[_e.id];for(const _e of H)delete this.keyCache[_e],delete this._layerConfigs[_e],delete this._layers[_e];this.familiesBySource={};const ce=function(_e,Ee){const Me={};for(let be=0;be<_e.length;be++){const Re=Ee&&Ee[_e[be].id]||k(_e[be]);Ee&&(Ee[_e[be].id]=Re);let ct=Me[Re];ct||(ct=Me[Re]=[]),ct.push(_e[be])}const ke=[];for(const be in Me)ke.push(Me[be]);return ke}(s.values(this._layerConfigs),this.keyCache);for(const _e of ce){const Ee=_e.map(dt=>this._layers[dt.id]),Me=Ee[0];if(Me.visibility==="none")continue;const ke=Me.source||"";let be=this.familiesBySource[ke];be||(be=this.familiesBySource[ke]={});const Re=Me.sourceLayer||"_geojsonTileLayer";let ct=be[Re];ct||(ct=be[Re]=[]),ct.push(Ee)}}}class U{loadTile($,H){const{uid:ce,encoding:_e,rawImageData:Ee,padding:Me,buildQuadTree:ke}=$,be=s.window.ImageBitmap&&Ee instanceof s.window.ImageBitmap?this.getImageData(Ee,Me):Ee;H(null,new s.DEMData(ce,be,_e,Me<1,ke))}getImageData($,H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);const ce=this.offscreenCanvasContext.getImageData(-H,-H,$.width+2*H,$.height+2*H);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ce}}function F(de,$){if(de.length!==0){Z(de[0],$);for(var H=1;H<de.length;H++)Z(de[H],!$)}}function Z(de,$){for(var H=0,ce=0,_e=0,Ee=de.length,Me=Ee-1;_e<Ee;Me=_e++){var ke=(de[_e][0]-de[Me][0])*(de[Me][1]+de[_e][1]),be=H+ke;ce+=Math.abs(H)>=Math.abs(ke)?H-be+ke:ke-be+H,H=be}H+ce>=0!=!!$&&de.reverse()}var q=s.getDefaultExportFromCjs(function de($,H){var ce,_e=$&&$.type;if(_e==="FeatureCollection")for(ce=0;ce<$.features.length;ce++)de($.features[ce],H);else if(_e==="GeometryCollection")for(ce=0;ce<$.geometries.length;ce++)de($.geometries[ce],H);else if(_e==="Feature")de($.geometry,H);else if(_e==="Polygon")F($.coordinates,H);else if(_e==="MultiPolygon")for(ce=0;ce<$.coordinates.length;ce++)F($.coordinates[ce],H);return $});const K=s.VectorTileFeature.prototype.toGeoJSON;var Y={exports:{}},W=s.pointGeometry,O=s.vectorTile.VectorTileFeature,V=Q;function Q(de,$){this.options=$||{},this.features=de,this.length=de.length}function ue(de,$){this.id=typeof de.id=="number"?de.id:void 0,this.type=de.type,this.rawGeometry=de.type===1?[de.geometry]:de.geometry,this.properties=de.tags,this.extent=$||4096}Q.prototype.feature=function(de){return new ue(this.features[de],this.options.extent)},ue.prototype.loadGeometry=function(){var de=this.rawGeometry;this.geometry=[];for(var $=0;$<de.length;$++){for(var H=de[$],ce=[],_e=0;_e<H.length;_e++)ce.push(new W(H[_e][0],H[_e][1]));this.geometry.push(ce)}return this.geometry},ue.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var de=this.geometry,$=1/0,H=-1/0,ce=1/0,_e=-1/0,Ee=0;Ee<de.length;Ee++)for(var Me=de[Ee],ke=0;ke<Me.length;ke++){var be=Me[ke];$=Math.min($,be.x),H=Math.max(H,be.x),ce=Math.min(ce,be.y),_e=Math.max(_e,be.y)}return[$,ce,H,_e]},ue.prototype.toGeoJSON=O.prototype.toGeoJSON;var fe=s.pbf,we=V;function Ce(de){var $=new fe;return function(H,ce){for(var _e in H.layers)ce.writeMessage(3,Te,H.layers[_e])}(de,$),$.finish()}function Te(de,$){var H;$.writeVarintField(15,de.version||1),$.writeStringField(1,de.name||""),$.writeVarintField(5,de.extent||4096);var ce={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<de.length;H++)ce.feature=de.feature(H),$.writeMessage(2,Se,ce);var _e=ce.keys;for(H=0;H<_e.length;H++)$.writeStringField(3,_e[H]);var Ee=ce.values;for(H=0;H<Ee.length;H++)$.writeMessage(4,kt,Ee[H])}function Se(de,$){var H=de.feature;H.id!==void 0&&$.writeVarintField(1,H.id),$.writeMessage(2,Ne,de),$.writeVarintField(3,H.type),$.writeMessage(4,St,H)}function Ne(de,$){var H=de.feature,ce=de.keys,_e=de.values,Ee=de.keycache,Me=de.valuecache;for(var ke in H.properties){var be=H.properties[ke],Re=Ee[ke];if(be!==null){Re===void 0&&(ce.push(ke),Ee[ke]=Re=ce.length-1),$.writeVarint(Re);var ct=typeof be;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(be=JSON.stringify(be));var dt=ct+":"+be,st=Me[dt];st===void 0&&(_e.push(be),Me[dt]=st=_e.length-1),$.writeVarint(st)}}}function Ue(de,$){return($<<3)+(7&de)}function Ve(de){return de<<1^de>>31}function St(de,$){for(var H=de.loadGeometry(),ce=de.type,_e=0,Ee=0,Me=H.length,ke=0;ke<Me;ke++){var be=H[ke],Re=1;ce===1&&(Re=be.length),$.writeVarint(Ue(1,Re));for(var ct=ce===3?be.length-1:be.length,dt=0;dt<ct;dt++){dt===1&&ce!==1&&$.writeVarint(Ue(2,ct-1));var st=be[dt].x-_e,Pt=be[dt].y-Ee;$.writeVarint(Ve(st)),$.writeVarint(Ve(Pt)),_e+=st,Ee+=Pt}ce===3&&$.writeVarint(Ue(7,1))}}function kt(de,$){var H=typeof de;H==="string"?$.writeStringField(1,de):H==="boolean"?$.writeBooleanField(7,de):H==="number"&&(de%1!=0?$.writeDoubleField(3,de):de<0?$.writeSVarintField(6,de):$.writeVarintField(5,de))}Y.exports=Ce,Y.exports.fromVectorTileJs=Ce,Y.exports.fromGeojsonVt=function(de,$){$=$||{};var H={};for(var ce in de)H[ce]=new we(de[ce].features,$),H[ce].name=ce,H[ce].version=$.version,H[ce].extent=$.extent;return Ce({layers:H})},Y.exports.GeoJSONWrapper=we;var Ot=s.getDefaultExportFromCjs(Y.exports);const on={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:de=>de},We=Math.fround||(bt=new Float32Array(1),de=>(bt[0]=+de,bt[0]));var bt;const ft=3,je=5,Je=6;class et{constructor($){this.options=Object.assign(Object.create(on),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:H,minZoom:ce,maxZoom:_e}=this.options;H&&console.time("total time");const Ee=`prepare ${$.length} points`;H&&console.time(Ee),this.points=$;const Me=[];for(let be=0;be<$.length;be++){const Re=$[be];if(!Re.geometry)continue;const[ct,dt]=Re.geometry.coordinates,st=We(Wt(ct)),Pt=We(yn(dt));Me.push(st,Pt,1/0,be,-1,1),this.options.reduce&&Me.push(0)}let ke=this.trees[_e+1]=this._createTree(Me);H&&console.timeEnd(Ee);for(let be=_e;be>=ce;be--){const Re=+Date.now();ke=this.trees[be]=this._createTree(this._cluster(ke,be)),H&&console.log("z%d: %d clusters in %dms",be,ke.numItems,+Date.now()-Re)}return H&&console.timeEnd("total time"),this}getClusters($,H){let ce=(($[0]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,$[1]));let Ee=$[2]===180?180:(($[2]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)ce=-180,Ee=180;else if(ce>Ee){const dt=this.getClusters([ce,_e,180,Me],H),st=this.getClusters([-180,_e,Ee,Me],H);return dt.concat(st)}const ke=this.trees[this._limitZoom(H)],be=ke.range(Wt(ce),yn(Me),Wt(Ee),yn(_e)),Re=ke.data,ct=[];for(const dt of be){const st=this.stride*dt;ct.push(Re[st+je]>1?tt(Re,st,this.clusterProps):this.points[Re[st+ft]])}return ct}getChildren($){const H=this._getOriginId($),ce=this._getOriginZoom($),_e="No cluster with the specified id.",Ee=this.trees[ce];if(!Ee)throw new Error(_e);const Me=Ee.data;if(H*this.stride>=Me.length)throw new Error(_e);const ke=this.options.radius/(this.options.extent*Math.pow(2,ce-1)),be=Ee.within(Me[H*this.stride],Me[H*this.stride+1],ke),Re=[];for(const ct of be){const dt=ct*this.stride;Me[dt+4]===$&&Re.push(Me[dt+je]>1?tt(Me,dt,this.clusterProps):this.points[Me[dt+ft]])}if(Re.length===0)throw new Error(_e);return Re}getLeaves($,H,ce){const _e=[];return this._appendLeaves(_e,$,H=H||10,ce=ce||0,0),_e}getTile($,H,ce){const _e=this.trees[this._limitZoom($)],Ee=Math.pow(2,$),{extent:Me,radius:ke}=this.options,be=ke/Me,Re=(ce-be)/Ee,ct=(ce+1+be)/Ee,dt={features:[]};return this._addTileFeatures(_e.range((H-be)/Ee,Re,(H+1+be)/Ee,ct),_e.data,H,ce,Ee,dt),H===0&&this._addTileFeatures(_e.range(1-be/Ee,Re,1,ct),_e.data,Ee,ce,Ee,dt),H===Ee-1&&this._addTileFeatures(_e.range(0,Re,be/Ee,ct),_e.data,-1,ce,Ee,dt),dt.features.length?dt:null}getClusterExpansionZoom($){let H=this._getOriginZoom($)-1;for(;H<=this.options.maxZoom;){const ce=this.getChildren($);if(H++,ce.length!==1)break;$=ce[0].properties.cluster_id}return H}_appendLeaves($,H,ce,_e,Ee){const Me=this.getChildren(H);for(const ke of Me){const be=ke.properties;if(be&&be.cluster?Ee+be.point_count<=_e?Ee+=be.point_count:Ee=this._appendLeaves($,be.cluster_id,ce,_e,Ee):Ee<_e?Ee++:$.push(ke),$.length===ce)break}return Ee}_createTree($){const H=new s.KDBush($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ce=0;ce<$.length;ce+=this.stride)H.add($[ce],$[ce+1]);return H.finish(),H.data=$,H}_addTileFeatures($,H,ce,_e,Ee,Me){for(const ke of $){const be=ke*this.stride,Re=H[be+je]>1;let ct,dt,st;if(Re)ct=nn(H,be,this.clusterProps),dt=H[be],st=H[be+1];else{const Nt=this.points[H[be+ft]];ct=Nt.properties;const[Zt,en]=Nt.geometry.coordinates;dt=Wt(Zt),st=yn(en)}const Pt={type:1,geometry:[[Math.round(this.options.extent*(dt*Ee-ce)),Math.round(this.options.extent*(st*Ee-_e))]],tags:ct};let Lt;Lt=Re||this.options.generateId?H[be+ft]:this.points[H[be+ft]].id,Lt!==void 0&&(Pt.id=Lt),Me.features.push(Pt)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,H){const{radius:ce,extent:_e,reduce:Ee,minPoints:Me}=this.options,ke=ce/(_e*Math.pow(2,H)),be=$.data,Re=[],ct=this.stride;for(let dt=0;dt<be.length;dt+=ct){if(be[dt+2]<=H)continue;be[dt+2]=H;const st=be[dt],Pt=be[dt+1],Lt=$.within(be[dt],be[dt+1],ke),Nt=be[dt+je];let Zt=Nt;for(const en of Lt){const Nn=en*ct;be[Nn+2]>H&&(Zt+=be[Nn+je])}if(Zt>Nt&&Zt>=Me){let en,Nn=st*Nt,Qn=Pt*Nt,Rr=-1;const hr=((dt/ct|0)<<5)+(H+1)+this.points.length;for(const io of Lt){const vr=io*ct;if(be[vr+2]<=H)continue;be[vr+2]=H;const $r=be[vr+je];Nn+=be[vr]*$r,Qn+=be[vr+1]*$r,be[vr+4]=hr,Ee&&(en||(en=this._map(be,dt,!0),Rr=this.clusterProps.length,this.clusterProps.push(en)),Ee(en,this._map(be,vr)))}be[dt+4]=hr,Re.push(Nn/Zt,Qn/Zt,1/0,hr,-1,Zt),Ee&&Re.push(Rr)}else{for(let en=0;en<ct;en++)Re.push(be[dt+en]);if(Zt>1)for(const en of Lt){const Nn=en*ct;if(!(be[Nn+2]<=H)){be[Nn+2]=H;for(let Qn=0;Qn<ct;Qn++)Re.push(be[Nn+Qn])}}}}return Re}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,H,ce){if($[H+je]>1){const Me=this.clusterProps[$[H+Je]];return ce?Object.assign({},Me):Me}const _e=this.points[$[H+ft]].properties,Ee=this.options.map(_e);return ce&&Ee===_e?Object.assign({},Ee):Ee}}function tt(de,$,H){return{type:"Feature",id:de[$+ft],properties:nn(de,$,H),geometry:{type:"Point",coordinates:[(ce=de[$],360*(ce-.5)),Ht(de[$+1])]}};var ce}function nn(de,$,H){const ce=de[$+je],_e=ce>=1e4?`${Math.round(ce/1e3)}k`:ce>=1e3?Math.round(ce/100)/10+"k":ce,Ee=de[$+Je],Me=Ee===-1?{}:Object.assign({},H[Ee]);return Object.assign(Me,{cluster:!0,cluster_id:de[$+ft],point_count:ce,point_count_abbreviated:_e})}function Wt(de){return de/360+.5}function yn(de){const $=Math.sin(de*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Ht(de){const $=(180-360*de)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Lr(de,$,H,ce){for(var _e,Ee=ce,Me=H-$>>1,ke=H-$,be=de[$],Re=de[$+1],ct=de[H],dt=de[H+1],st=$+3;st<H;st+=3){var Pt=ln(de[st],de[st+1],be,Re,ct,dt);if(Pt>Ee)_e=st,Ee=Pt;else if(Pt===Ee){var Lt=Math.abs(st-Me);Lt<ke&&(_e=st,ke=Lt)}}Ee>ce&&(_e-$>3&&Lr(de,$,_e,ce),de[_e+2]=Ee,H-_e>3&&Lr(de,_e,H,ce))}function ln(de,$,H,ce,_e,Ee){var Me=_e-H,ke=Ee-ce;if(Me!==0||ke!==0){var be=((de-H)*Me+($-ce)*ke)/(Me*Me+ke*ke);be>1?(H=_e,ce=Ee):be>0&&(H+=Me*be,ce+=ke*be)}return(Me=de-H)*Me+(ke=$-ce)*ke}function Rt(de,$,H,ce){var _e={id:de===void 0?null:de,type:$,geometry:H,tags:ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ee){var Me=Ee.geometry,ke=Ee.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")Yr(Ee,Me);else if(ke==="Polygon"||ke==="MultiLineString")for(var be=0;be<Me.length;be++)Yr(Ee,Me[be]);else if(ke==="MultiPolygon")for(be=0;be<Me.length;be++)for(var Re=0;Re<Me[be].length;Re++)Yr(Ee,Me[be][Re])}(_e),_e}function Yr(de,$){for(var H=0;H<$.length;H+=3)de.minX=Math.min(de.minX,$[H]),de.minY=Math.min(de.minY,$[H+1]),de.maxX=Math.max(de.maxX,$[H]),de.maxY=Math.max(de.maxY,$[H+1])}function zn(de,$,H,ce){if($.geometry){var _e=$.geometry.coordinates,Ee=$.geometry.type,Me=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),ke=[],be=$.id;if(H.promoteId?be=$.properties[H.promoteId]:H.generateId&&(be=ce||0),Ee==="Point")Xn(_e,ke);else if(Ee==="MultiPoint")for(var Re=0;Re<_e.length;Re++)Xn(_e[Re],ke);else if(Ee==="LineString")mn(_e,ke,Me,!1);else if(Ee==="MultiLineString"){if(H.lineMetrics){for(Re=0;Re<_e.length;Re++)mn(_e[Re],ke=[],Me,!1),de.push(Rt(be,"LineString",ke,$.properties));return}gr(_e,ke,Me,!1)}else if(Ee==="Polygon")gr(_e,ke,Me,!0);else{if(Ee!=="MultiPolygon"){if(Ee==="GeometryCollection"){for(Re=0;Re<$.geometry.geometries.length;Re++)zn(de,{id:be,geometry:$.geometry.geometries[Re],properties:$.properties},H,ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Re=0;Re<_e.length;Re++){var ct=[];gr(_e[Re],ct,Me,!0),ke.push(ct)}}de.push(Rt(be,Ee,ke,$.properties))}}function Xn(de,$){$.push(bo(de[0])),$.push(qr(de[1])),$.push(0)}function mn(de,$,H,ce){for(var _e,Ee,Me=0,ke=0;ke<de.length;ke++){var be=bo(de[ke][0]),Re=qr(de[ke][1]);$.push(be),$.push(Re),$.push(0),ke>0&&(Me+=ce?(_e*Re-be*Ee)/2:Math.sqrt(Math.pow(be-_e,2)+Math.pow(Re-Ee,2))),_e=be,Ee=Re}var ct=$.length-3;$[2]=1,Lr($,0,ct,H),$[ct+2]=1,$.size=Math.abs(Me),$.start=0,$.end=$.size}function gr(de,$,H,ce){for(var _e=0;_e<de.length;_e++){var Ee=[];mn(de[_e],Ee,H,ce),$.push(Ee)}}function bo(de){return de/360+.5}function qr(de){var $=Math.sin(de*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Ir(de,$,H,ce,_e,Ee,Me,ke){if(ce/=$,Ee>=(H/=$)&&Me<ce)return de;if(Me<H||Ee>=ce)return null;for(var be=[],Re=0;Re<de.length;Re++){var ct=de[Re],dt=ct.geometry,st=ct.type,Pt=_e===0?ct.minX:ct.minY,Lt=_e===0?ct.maxX:ct.maxY;if(Pt>=H&&Lt<ce)be.push(ct);else if(!(Lt<H||Pt>=ce)){var Nt=[];if(st==="Point"||st==="MultiPoint")Ri(dt,Nt,H,ce,_e);else if(st==="LineString")_r(dt,Nt,H,ce,_e,!1,ke.lineMetrics);else if(st==="MultiLineString")kr(dt,Nt,H,ce,_e,!1);else if(st==="Polygon")kr(dt,Nt,H,ce,_e,!0);else if(st==="MultiPolygon")for(var Zt=0;Zt<dt.length;Zt++){var en=[];kr(dt[Zt],en,H,ce,_e,!0),en.length&&Nt.push(en)}if(Nt.length){if(ke.lineMetrics&&st==="LineString"){for(Zt=0;Zt<Nt.length;Zt++)be.push(Rt(ct.id,st,Nt[Zt],ct.tags));continue}st!=="LineString"&&st!=="MultiLineString"||(Nt.length===1?(st="LineString",Nt=Nt[0]):st="MultiLineString"),st!=="Point"&&st!=="MultiPoint"||(st=Nt.length===3?"Point":"MultiPoint"),be.push(Rt(ct.id,st,Nt,ct.tags))}}}return be.length?be:null}function Ri(de,$,H,ce,_e){for(var Ee=0;Ee<de.length;Ee+=3){var Me=de[Ee+_e];Me>=H&&Me<=ce&&($.push(de[Ee]),$.push(de[Ee+1]),$.push(de[Ee+2]))}}function _r(de,$,H,ce,_e,Ee,Me){for(var ke,be,Re=yr(de),ct=_e===0?Es:Oi,dt=de.start,st=0;st<de.length-3;st+=3){var Pt=de[st],Lt=de[st+1],Nt=de[st+2],Zt=de[st+3],en=de[st+4],Nn=_e===0?Pt:Lt,Qn=_e===0?Zt:en,Rr=!1;Me&&(ke=Math.sqrt(Math.pow(Pt-Zt,2)+Math.pow(Lt-en,2))),Nn<H?Qn>H&&(be=ct(Re,Pt,Lt,Zt,en,H),Me&&(Re.start=dt+ke*be)):Nn>ce?Qn<ce&&(be=ct(Re,Pt,Lt,Zt,en,ce),Me&&(Re.start=dt+ke*be)):Fi(Re,Pt,Lt,Nt),Qn<H&&Nn>=H&&(be=ct(Re,Pt,Lt,Zt,en,H),Rr=!0),Qn>ce&&Nn<=ce&&(be=ct(Re,Pt,Lt,Zt,en,ce),Rr=!0),!Ee&&Rr&&(Me&&(Re.end=dt+ke*be),$.push(Re),Re=yr(de)),Me&&(dt+=ke)}var hr=de.length-3;Pt=de[hr],Lt=de[hr+1],Nt=de[hr+2],(Nn=_e===0?Pt:Lt)>=H&&Nn<=ce&&Fi(Re,Pt,Lt,Nt),hr=Re.length-3,Ee&&hr>=3&&(Re[hr]!==Re[0]||Re[hr+1]!==Re[1])&&Fi(Re,Re[0],Re[1],Re[2]),Re.length&&$.push(Re)}function yr(de){var $=[];return $.size=de.size,$.start=de.start,$.end=de.end,$}function kr(de,$,H,ce,_e,Ee){for(var Me=0;Me<de.length;Me++)_r(de[Me],$,H,ce,_e,Ee,!1)}function Fi(de,$,H,ce){de.push($),de.push(H),de.push(ce)}function Es(de,$,H,ce,_e,Ee){var Me=(Ee-$)/(ce-$);return de.push(Ee),de.push(H+(_e-H)*Me),de.push(1),Me}function Oi(de,$,H,ce,_e,Ee){var Me=(Ee-H)/(_e-H);return de.push($+(ce-$)*Me),de.push(Ee),de.push(1),Me}function xr(de,$){for(var H=[],ce=0;ce<de.length;ce++){var _e,Ee=de[ce],Me=Ee.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")_e=to(Ee.geometry,$);else if(Me==="MultiLineString"||Me==="Polygon"){_e=[];for(var ke=0;ke<Ee.geometry.length;ke++)_e.push(to(Ee.geometry[ke],$))}else if(Me==="MultiPolygon")for(_e=[],ke=0;ke<Ee.geometry.length;ke++){for(var be=[],Re=0;Re<Ee.geometry[ke].length;Re++)be.push(to(Ee.geometry[ke][Re],$));_e.push(be)}H.push(Rt(Ee.id,Me,_e,Ee.tags))}return H}function to(de,$){var H=[];H.size=de.size,de.start!==void 0&&(H.start=de.start,H.end=de.end);for(var ce=0;ce<de.length;ce+=3)H.push(de[ce]+$,de[ce+1],de[ce+2]);return H}function ts(de,$){if(de.transformed)return de;var H,ce,_e,Ee=1<<de.z,Me=de.x,ke=de.y;for(H=0;H<de.features.length;H++){var be=de.features[H],Re=be.geometry,ct=be.type;if(be.geometry=[],ct===1)for(ce=0;ce<Re.length;ce+=2)be.geometry.push(no(Re[ce],Re[ce+1],$,Ee,Me,ke));else for(ce=0;ce<Re.length;ce++){var dt=[];for(_e=0;_e<Re[ce].length;_e+=2)dt.push(no(Re[ce][_e],Re[ce][_e+1],$,Ee,Me,ke));be.geometry.push(dt)}}return de.transformed=!0,de}function no(de,$,H,ce,_e,Ee){return[Math.round(H*(de*ce-_e)),Math.round(H*($*ce-Ee))]}function di(de,$,H,ce,_e){for(var Ee=$===_e.maxZoom?0:_e.tolerance/((1<<$)*_e.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:ce,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<de.length;ke++){Me.numFeatures++,Ni(Me,de[ke],Ee,_e);var be=de[ke].minX,Re=de[ke].minY,ct=de[ke].maxX,dt=de[ke].maxY;be<Me.minX&&(Me.minX=be),Re<Me.minY&&(Me.minY=Re),ct>Me.maxX&&(Me.maxX=ct),dt>Me.maxY&&(Me.maxY=dt)}return Me}function Ni(de,$,H,ce){var _e=$.geometry,Ee=$.type,Me=[];if(Ee==="Point"||Ee==="MultiPoint")for(var ke=0;ke<_e.length;ke+=3)Me.push(_e[ke]),Me.push(_e[ke+1]),de.numPoints++,de.numSimplified++;else if(Ee==="LineString")Eo(Me,_e,de,H,!1,!1);else if(Ee==="MultiLineString"||Ee==="Polygon")for(ke=0;ke<_e.length;ke++)Eo(Me,_e[ke],de,H,Ee==="Polygon",ke===0);else if(Ee==="MultiPolygon")for(var be=0;be<_e.length;be++){var Re=_e[be];for(ke=0;ke<Re.length;ke++)Eo(Me,Re[ke],de,H,!0,ke===0)}if(Me.length){var ct=$.tags||null;if(Ee==="LineString"&&ce.lineMetrics){for(var dt in ct={},$.tags)ct[dt]=$.tags[dt];ct.mapbox_clip_start=_e.start/_e.size,ct.mapbox_clip_end=_e.end/_e.size}var st={geometry:Me,type:Ee==="Polygon"||Ee==="MultiPolygon"?3:Ee==="LineString"||Ee==="MultiLineString"?2:1,tags:ct};$.id!==null&&(st.id=$.id),de.features.push(st)}}function Eo(de,$,H,ce,_e,Ee){var Me=ce*ce;if(ce>0&&$.size<(_e?Me:ce))H.numPoints+=$.length/3;else{for(var ke=[],be=0;be<$.length;be+=3)(ce===0||$[be+2]>Me)&&(H.numSimplified++,ke.push($[be]),ke.push($[be+1])),H.numPoints++;_e&&function(Re,ct){for(var dt=0,st=0,Pt=Re.length,Lt=Pt-2;st<Pt;Lt=st,st+=2)dt+=(Re[st]-Re[Lt])*(Re[st+1]+Re[Lt+1]);if(dt>0===ct)for(st=0,Pt=Re.length;st<Pt/2;st+=2){var Nt=Re[st],Zt=Re[st+1];Re[st]=Re[Pt-2-st],Re[st+1]=Re[Pt-1-st],Re[Pt-2-st]=Nt,Re[Pt-1-st]=Zt}}(ke,Ee),de.push(ke)}}function Ui(de,$){var H=($=this.options=function(_e,Ee){for(var Me in Ee)_e[Me]=Ee[Me];return _e}(Object.create(this.options),$)).debug;if(H&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var ce=function(_e,Ee){var Me=[];if(_e.type==="FeatureCollection")for(var ke=0;ke<_e.features.length;ke++)zn(Me,_e.features[ke],Ee,ke);else zn(Me,_e.type==="Feature"?_e:{geometry:_e},Ee);return Me}(de,$);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ce=function(_e,Ee){var Me=Ee.buffer/Ee.extent,ke=_e,be=Ir(_e,1,-1-Me,Me,0,-1,2,Ee),Re=Ir(_e,1,1-Me,2+Me,0,-1,2,Ee);return(be||Re)&&(ke=Ir(_e,1,-Me,1+Me,0,-1,2,Ee)||[],be&&(ke=xr(be,1).concat(ke)),Re&&(ke=ke.concat(xr(Re,-1)))),ke}(ce,$),ce.length&&this.splitTile(ce,0,0,0),H&&(ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ro(de,$,H){return 32*((1<<de)*H+$)+de}function To(de,$){const H=de.tileID.canonical;if(!this._geoJSONIndex)return $(null,null);const ce=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!ce)return $(null,null);const _e=new class{constructor(Me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Me.length,this._features=Me}feature(Me){return new class{constructor(ke){this._feature=ke,this.extent=s.EXTENT,this.type=ke.type,this.properties=ke.tags,"id"in ke&&!isNaN(ke.id)&&(this.id=parseInt(ke.id,10))}loadGeometry(){if(this._feature.type===1){const ke=[];for(const be of this._feature.geometry)ke.push([new s.Point(be[0],be[1])]);return ke}{const ke=[];for(const be of this._feature.geometry){const Re=[];for(const ct of be)Re.push(new s.Point(ct[0],ct[1]));ke.push(Re)}return ke}}toGeoJSON(ke,be,Re){return K.call(this,ke,be,Re)}}(this._features[Me])}}(ce.features);let Ee=Ot(_e);Ee.byteOffset===0&&Ee.byteLength===Ee.buffer.byteLength||(Ee=new Uint8Array(Ee)),$(null,{vectorTile:_e,rawData:Ee.buffer})}Ui.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ui.prototype.splitTile=function(de,$,H,ce,_e,Ee,Me){for(var ke=[de,$,H,ce],be=this.options,Re=be.debug;ke.length;){ce=ke.pop(),H=ke.pop(),$=ke.pop(),de=ke.pop();var ct=1<<$,dt=ro($,H,ce),st=this.tiles[dt];if(!st&&(Re>1&&console.time("creation"),st=this.tiles[dt]=di(de,$,H,ce,be),this.tileCoords.push({z:$,x:H,y:ce}),Re)){Re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,H,ce,st.numFeatures,st.numPoints,st.numSimplified),console.timeEnd("creation"));var Pt="z"+$;this.stats[Pt]=(this.stats[Pt]||0)+1,this.total++}if(st.source=de,_e){if($===be.maxZoom||$===_e)continue;var Lt=1<<_e-$;if(H!==Math.floor(Ee/Lt)||ce!==Math.floor(Me/Lt))continue}else if($===be.indexMaxZoom||st.numPoints<=be.indexMaxPoints)continue;if(st.source=null,de.length!==0){Re>1&&console.time("clipping");var Nt,Zt,en,Nn,Qn,Rr,hr=.5*be.buffer/be.extent,io=.5-hr,vr=.5+hr,$r=1+hr;Nt=Zt=en=Nn=null,Qn=Ir(de,ct,H-hr,H+vr,0,st.minX,st.maxX,be),Rr=Ir(de,ct,H+io,H+$r,0,st.minX,st.maxX,be),de=null,Qn&&(Nt=Ir(Qn,ct,ce-hr,ce+vr,1,st.minY,st.maxY,be),Zt=Ir(Qn,ct,ce+io,ce+$r,1,st.minY,st.maxY,be),Qn=null),Rr&&(en=Ir(Rr,ct,ce-hr,ce+vr,1,st.minY,st.maxY,be),Nn=Ir(Rr,ct,ce+io,ce+$r,1,st.minY,st.maxY,be),Rr=null),Re>1&&console.timeEnd("clipping"),ke.push(Nt||[],$+1,2*H,2*ce),ke.push(Zt||[],$+1,2*H,2*ce+1),ke.push(en||[],$+1,2*H+1,2*ce),ke.push(Nn||[],$+1,2*H+1,2*ce+1)}}},Ui.prototype.getTile=function(de,$,H){var ce=this.options,_e=ce.extent,Ee=ce.debug;if(de<0||de>24)return null;var Me=1<<de,ke=ro(de,$=($%Me+Me)%Me,H);if(this.tiles[ke])return ts(this.tiles[ke],_e);Ee>1&&console.log("drilling down to z%d-%d-%d",de,$,H);for(var be,Re=de,ct=$,dt=H;!be&&Re>0;)Re--,ct=Math.floor(ct/2),dt=Math.floor(dt/2),be=this.tiles[ro(Re,ct,dt)];return be&&be.source?(Ee>1&&console.log("found parent tile z%d-%d-%d",Re,ct,dt),Ee>1&&console.time("drilling down"),this.splitTile(be.source,Re,ct,dt,de,$,H),Ee>1&&console.timeEnd("drilling down"),this.tiles[ke]?ts(this.tiles[ke],_e):null):null};class ns extends s.VectorTileWorkerSource{constructor($,H,ce,_e,Ee){super($,H,ce,_e,To),Ee&&(this.loadGeoJSON=Ee)}loadData($,H){const ce=$&&$.request,_e=ce&&ce.collectResourceTiming;this.loadGeoJSON($,(Ee,Me)=>{if(Ee||!Me)return H(Ee);if(typeof Me!="object")return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{q(Me,!0);try{if($.filter){const be=s.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(be.result==="error")throw new Error(be.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));Me={type:"FeatureCollection",features:Me.features.filter(ct=>be.value.evaluate({zoom:0},ct))}}this._geoJSONIndex=$.cluster?new et(function({superclusterOptions:be,clusterProperties:Re}){if(!Re||!be)return be;const ct={},dt={},st={accumulated:null,zoom:0},Pt={properties:null},Lt=Object.keys(Re);for(const Nt of Lt){const[Zt,en]=Re[Nt],Nn=s.createExpression(en),Qn=s.createExpression(typeof Zt=="string"?[Zt,["accumulated"],["get",Nt]]:Zt);ct[Nt]=Nn.value,dt[Nt]=Qn.value}return be.map=Nt=>{Pt.properties=Nt;const Zt={};for(const en of Lt)Zt[en]=ct[en].evaluate(st,Pt);return Zt},be.reduce=(Nt,Zt)=>{Pt.properties=Zt;for(const en of Lt)st.accumulated=Nt[en],Nt[en]=dt[en].evaluate(st,Pt)},be}($)).load(Me.features):function(be,Re){return new Ui(be,Re)}(Me,$.geojsonVtOptions)}catch(be){return H(be)}this.loaded={};const ke={};if(_e){const be=s.getPerformanceMeasurement(ce);be&&(ke.resourceTiming={},ke.resourceTiming[$.source]=JSON.parse(JSON.stringify(be)))}H(null,ke)}})}reloadTile($,H){const ce=this.loaded;return ce&&ce[$.uid]?super.reloadTile($,H):this.loadTile($,H)}loadGeoJSON($,H){if($.request)s.getJSON($.request,H);else{if(typeof $.data!="string")return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));try{return H(null,JSON.parse($.data))}catch{return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom($,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(ce){H(ce)}}getClusterChildren($,H){try{H(null,this._geoJSONIndex.getChildren($.clusterId))}catch(ce){H(ce)}}getClusterLeaves($,H){try{H(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(ce){H(ce)}}}class Ts{constructor($){this.self=$,this.actor=new s.Actor($,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:ns},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(H,ce)=>{if(this.workerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.workerSourceTypes[H]=ce},this.self.registerRTLTextPlugin=H=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=H.applyArabicShaping,s.plugin.processBidirectionalText=H.processBidirectionalText,s.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}}clearCaches($,H,ce){delete this.layerIndexes[$],delete this.availableImages[$],delete this.workerSources[$],delete this.demWorkerSources[$],ce()}checkIfReady($,H,ce){ce()}setReferrer($,H){this.referrer=H}spriteLoaded($,H){this.isSpriteLoaded[$]=H;for(const ce in this.workerSources[$]){const _e=this.workerSources[$][ce];for(const Ee in _e)_e[Ee]instanceof s.VectorTileWorkerSource&&(_e[Ee].isSpriteLoaded=H,_e[Ee].fire(new s.Event("isSpriteLoaded")))}}setImages($,H,ce){this.availableImages[$]=H;for(const _e in this.workerSources[$]){const Ee=this.workerSources[$][_e];for(const Me in Ee)Ee[Me].availableImages=H}ce()}enableTerrain($,H,ce){this.terrain=H,ce()}setProjection($,H){this.projections[$]=s.getProjection(H)}setLayers($,H,ce){this.getLayerIndex($).replace(H),ce()}updateLayers($,H,ce){this.getLayerIndex($).update(H.layers,H.removedIds),ce()}loadTile($,H,ce){const _e=this.enableTerrain?s.extend({enableTerrain:this.terrain},H):H;_e.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,H.type,H.source).loadTile(_e,ce)}loadDEMTile($,H,ce){const _e=this.enableTerrain?s.extend({buildQuadTree:this.terrain},H):H;this.getDEMWorkerSource($,H.source).loadTile(_e,ce)}reloadTile($,H,ce){const _e=this.enableTerrain?s.extend({enableTerrain:this.terrain},H):H;_e.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,H.type,H.source).reloadTile(_e,ce)}abortTile($,H,ce){this.getWorkerSource($,H.type,H.source).abortTile(H,ce)}removeTile($,H,ce){this.getWorkerSource($,H.type,H.source).removeTile(H,ce)}removeSource($,H,ce){if(!this.workerSources[$]||!this.workerSources[$][H.type]||!this.workerSources[$][H.type][H.source])return;const _e=this.workerSources[$][H.type][H.source];delete this.workerSources[$][H.type][H.source],_e.removeSource!==void 0?_e.removeSource(H,ce):ce()}loadWorkerSource($,H,ce){try{this.self.importScripts(H.url),ce()}catch(_e){ce(_e.toString())}}syncRTLPluginState($,H,ce){try{s.plugin.setState(H);const _e=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&_e!=null){this.self.importScripts(_e);const Ee=s.plugin.isParsed();ce(Ee?void 0:new Error(`RTL Text Plugin failed to import scripts from ${_e}`),Ee)}}catch(_e){ce(_e.toString())}}getAvailableImages($){let H=this.availableImages[$];return H||(H=[]),H}getLayerIndex($){let H=this.layerIndexes[$];return H||(H=this.layerIndexes[$]=new B),H}getWorkerSource($,H,ce){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][H]||(this.workerSources[$][H]={}),!this.workerSources[$][H][ce]){const _e={send:(Ee,Me,ke,be,Re,ct)=>{this.actor.send(Ee,Me,ke,$,Re,ct)},scheduler:this.actor.scheduler};this.workerSources[$][H][ce]=new this.workerSourceTypes[H](_e,this.getLayerIndex($),this.getAvailableImages($),this.isSpriteLoaded[$])}return this.workerSources[$][H][ce]}getDEMWorkerSource($,H){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][H]||(this.demWorkerSources[$][H]=new U),this.demWorkerSources[$][H]}enforceCacheSizeLimit($,H){s.enforceCacheSizeLimit(H)}getWorkerPerformanceMetrics($,H,ce){ce(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ts(self)),Ts}),x(["./shared"],function(s){function C(d,o){if(Array.isArray(d)){if(!Array.isArray(o)||d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(!C(d[c],o[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&o!==null){if(typeof o!="object"||Object.keys(d).length!==Object.keys(o).length)return!1;for(const c in d)if(!C(d[c],o[c]))return!1;return!0}return d===o}var k=B;function B(d){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,_,v=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(v);try{_=new Worker(T),f=!0}catch{f=!1}return _&&_.terminate(),URL.revokeObjectURL(T),f}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var f=document.createElement("canvas");f.width=f.height=1;var _=f.getContext("2d");if(!_)return!1;var v=_.getImageData(0,0,1,1);return v&&v.width===f.width}()?(U[c=o&&o.failIfMajorPerformanceCaveat]===void 0&&(U[c]=function(f){var _,v=function(T){var S=document.createElement("canvas"),I=Object.create(B.webGLContextAttributes);return I.failIfMajorPerformanceCaveat=T,S.getContext("webgl",I)||S.getContext("experimental-webgl",I)}(f);if(!v)return!1;try{_=v.createShader(v.VERTEX_SHADER)}catch{return!1}return!(!_||v.isContextLost())&&(v.shaderSource(_,"void main() {}"),v.compileShader(_),v.getShaderParameter(_,v.COMPILE_STATUS)===!0)}(c)),U[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(d)}var U={};function F(d,o,c){const f=s.window.document.createElement(d);return o!==void 0&&(f.className=o),c&&c.appendChild(f),f}function Z(d,o,c){const f=s.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const _ of Object.keys(o))f.setAttributeNS(null,_,o[_]);return c&&c.appendChild(f),f}B.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const q=s.window.document&&s.window.document.documentElement.style,K=q&&q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Y;function W(){q&&K&&(Y=q[K],q[K]="none")}function O(){q&&K&&(q[K]=Y)}function V(d){d.preventDefault(),d.stopPropagation(),s.window.removeEventListener("click",V,!0)}function Q(){s.window.addEventListener("click",V,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",V,!0)},0)}function ue(d,o){const c=d.getBoundingClientRect();return Ce(d,c,o)}function fe(d,o){const c=d.getBoundingClientRect(),f=[];for(let _=0;_<o.length;_++)f.push(Ce(d,c,o[_]));return f}function we(d){return s.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function Ce(d,o,c){const f=d.offsetWidth===o.width?1:d.offsetWidth/o.width;return new s.Point((c.clientX-o.left)*f,(c.clientY-o.top)*f)}function Te(d,o){var c=o[0],f=o[1],_=o[2],v=o[3],T=c*v-_*f;return T?(d[0]=v*(T=1/T),d[1]=-f*T,d[2]=-_*T,d[3]=c*T,d):null}function Se(d){const{userImage:o}=d;return!!(o&&o.render&&o.render())&&(d.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ne extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:c,callback:f}of this.requestors)this._notify(c,f);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,c){this._validate(o,c)&&(this.images[o]=c)}_validate(o,c){let f=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),f=!1),f}_validateStretch(o,c){if(!o)return!0;let f=0;for(const _ of o){if(_[0]<f||_[1]<_[0]||c<_[1])return!1;f=_[1]}return!0}_validateContent(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0}removeImage(o){const c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,c){let f=!0;if(!this.isLoaded())for(const _ of o)this.images[_]||(f=!1);this.isLoaded()||f?this._notify(o,c):this.requestors.push({ids:o,callback:c})}_notify(o,c){const f={};for(const _ of o){this.images[_]||this.fire(new s.Event("styleimagemissing",{id:_}));const v=this.images[_];v?f[_]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:s.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,f)}getPixelSize(){const{width:o,height:c}=this.atlasImage;return{width:o,height:c}}getPattern(o){const c=this.patterns[o],f=this.getImage(o);if(!f)return null;if(c&&c.position.version===f.version)return c.position;if(c)c.position.version=f.version;else{const _={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new s.ImagePosition(_,f);this.patterns[o]={bin:_,position:v}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const v in this.patterns)o.push(this.patterns[v].bin);const{w:c,h:f}=s.potpack(o),_=this.atlasImage;_.resize({width:c||1,height:f||1});for(const v in this.patterns){const{bin:T}=this.patterns[v],S=T.x+1,I=T.y+1,z=this.images[v].data,P=z.width,N=z.height;s.RGBAImage.copy(z,_,{x:0,y:0},{x:S,y:I},{width:P,height:N}),s.RGBAImage.copy(z,_,{x:0,y:N-1},{x:S,y:I-1},{width:P,height:1}),s.RGBAImage.copy(z,_,{x:0,y:0},{x:S,y:I+N},{width:P,height:1}),s.RGBAImage.copy(z,_,{x:P-1,y:0},{x:S-1,y:I},{width:1,height:N}),s.RGBAImage.copy(z,_,{x:0,y:0},{x:S+P,y:I},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const c of o){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const f=this.images[c];Se(f)&&this.updateImage(c,f)}}}const Ue=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(d,o){return function([c,f,_]){const v=s.degToRad(f+90),T=s.degToRad(_);return{x:c*Math.cos(v)*Math.sin(T),y:c*Math.sin(v)*Math.sin(T),z:c*Math.cos(T),azimuthal:f,polar:_}}(d.expression.evaluate(o))}interpolate(d,o,c){return{x:s.number(d.x,o.x,c),y:s.number(d.y,o.y,c),z:s.number(d.z,o.z,c),azimuthal:s.number(d.azimuthal,o.azimuthal,c),polar:s.number(d.polar,o.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class Ve extends s.Evented{constructor(o){super(),this._transitionable=new s.Transitionable(Ue),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,c={}){if(!this._validate(s.validateLight,o,c))for(const f in o){const _=o[f];s.endsWith(f,"-transition")?this._transitionable.setTransition(f.slice(0,-11),_):this._transitionable.setValue(f,_)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,f){return(!f||f.validate!==!1)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const St=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let kt=class extends s.Evented{constructor(d,o){super(),this._transitionable=new s.Transitionable(St),this.set(d),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(d){for(const o in d){const c=d[o];s.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),c):this._transitionable.setValue(o,c)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}};function Ot(d,o,c,f){const _=s.smoothstep(45,65,c),[v,T]=on(d,f),S=s.length(o);let I=1-Math.min(1,Math.exp((S-v)/(T-v)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*_*d.alpha}function on(d,o){const c=.5/Math.tan(.5*o);return[d.range[0]+c,d.range[1]+c]}const We=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class bt extends s.Evented{constructor(o,c){super(),this._transitionable=new s.Transitionable(We),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const o=this._transform,c=o.projection.name==="globe",f=s.globeToMercatorTransition(o.zoom),_=this.properties.get("range"),v=[.5,3];return{range:c?[s.number(v[0],_[0],f),s.number(v[1],_[1],f)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,c={}){if(!this._validate(s.validateFog,o,c)){for(const f of Object.keys(s.spec.fog))o&&o[f]===void 0&&(o[f]=s.spec.fog[f].default);for(const f in o){const _=o[f];s.endsWith(f,"-transition")?this._transitionable.setTransition(f.slice(0,-11),_):this._transitionable.setValue(f,_)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,o))*c.a}getOpacityAtLatLng(o,c){return this._transform.projection.supportsFog?function(f,_,v){const T=s.MercatorCoordinate.fromLngLat(_),S=v.elevation?v.elevation.getAtPointOrZero(T):0,I=[T.x,T.y,S];return s.transformMat4(I,I,v.mercatorFogMatrix),Ot(f,I,v.pitch,v._fov)}(this.state,o,c):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?on(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,f){return(!f||f.validate!==!1)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class ft{constructor(o,c){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const f=this.workerPool.acquire(this.id);for(let _=0;_<f.length;_++){const v=new ft.Actor(f[_],c,this.id);v.name=`Worker ${_}`,this.actors.push(v)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,c,f){s.asyncAll(this.actors,(_,v)=>{_.send(o,c,v)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function je(d,o,c){return o*(s.EXTENT/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}ft.Actor=s.Actor;class Je{constructor(o,c,f,_){this.screenBounds=o,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(o,c){let f,_;if(o instanceof s.Point||typeof o[0]=="number"){const v=s.Point.convert(o);f=[v],_=c.isPointAboveHorizon(v)}else{const v=s.Point.convert(o[0]),T=s.Point.convert(o[1]);f=[v,T],_=s.polygonizeBounds(v,T).every(S=>c.isPointAboveHorizon(S))}return new Je(f,c.getCameraPoint(),_,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],_=s.polygonizeBounds(c,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<f.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),s.bufferConvexPolygon(_,o)}bufferedCameraGeometryGlobe(o){const c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],_=s.polygonizeBounds(c,f,o),v=this.cameraPoint.clone();switch(3*((v.y>c.y)+(v.y>f.y))+((v.x>c.x)+(v.x>f.x))){case 0:_[0]=v,_[4]=v.clone();break;case 1:_.splice(1,0,v);break;case 2:_[1]=v;break;case 3:_.splice(4,0,v);break;case 5:_.splice(2,0,v);break;case 6:_[3]=v;break;case 7:_.splice(3,0,v);break;case 8:_[2]=v}return _}containsTile(o,c,f,_=0){const v=o.queryPadding/c._pixelsPerMercatorPixel+1,T=f?this._bufferedCameraMercator(v,c):this._bufferedScreenMercator(v,c);let S=o.tileID.wrap+(T.unwrapped?_:0);const I=T.polygon.map(ie=>s.getTilePoint(o.tileTransform,ie,S));if(!s.polygonIntersectsBox(I,0,0,s.EXTENT,s.EXTENT))return;S=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const z=this.screenGeometryMercator.polygon.map(ie=>s.getTileVec3(o.tileTransform,ie,S)),P=z.map(ie=>new s.Point(ie[0],ie[1])),N=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),X=s.getTileVec3(o.tileTransform,N,S),te=z.map(ie=>{const j=s.sub(ie,ie,X);return s.normalize(j,j),new s.Ray(X,j)}),re=je(o,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:P,tilespaceRays:te,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(ne=s.getBounds(I),ne.min.x=s.clamp(ne.min.x,0,s.EXTENT),ne.min.y=s.clamp(ne.min.y,0,s.EXTENT),ne.max.x=s.clamp(ne.max.x,0,s.EXTENT),ne.max.y=s.clamp(ne.max.y,0,s.EXTENT),ne),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:re};var ne}_bufferedScreenMercator(o,c){const f=nn(o);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),c):{polygon:this.bufferedScreenGeometry(o).map(v=>c.pointCoordinate3D(v)),unwrapped:!0},this._screenRaycastCache[f]=_,_}}_bufferedCameraMercator(o,c){const f=nn(o);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),c):{polygon:this.bufferedCameraGeometry(o).map(v=>c.pointCoordinate3D(v)),unwrapped:!0},this._cameraRaycastCache[f]=_,_}}_projectAndResample(o,c){const f=function(v,T){const S=s.multiply([],T.pixelMatrix,T.globeMatrix),I=[0,-s.GLOBE_RADIUS,0,1],z=[0,s.GLOBE_RADIUS,0,1],P=[0,0,0,1];s.transformMat4$1(I,I,S),s.transformMat4$1(z,z,S),s.transformMat4$1(P,P,S);const N=new s.Point(I[0]/I[3],I[1]/I[3]),X=new s.Point(z[0]/z[3],z[1]/z[3]),te=s.polygonContainsPoint(v,N)&&I[3]<P[3],re=s.polygonContainsPoint(v,X)&&z[3]<P[3];if(!te&&!re)return null;const ne=function(xe,Ie,Ae){for(let Be=1;Be<xe.length;Be++){const it=tt(Ie.pointCoordinate3D(xe[Be-1]).x),De=tt(Ie.pointCoordinate3D(xe[Be]).x);if(Ae<0){if(it<De)return{idx:Be,t:-it/(De-1-it)}}else if(De<it)return{idx:Be,t:(1-it)/(De+1-it)}}return null}(v,T,te?-1:1);if(!ne)return null;const{idx:ie,t:j}=ne;let ee=ie>1?et(v.slice(0,ie),T):[],ae=ie<v.length?et(v.slice(ie),T):[];ee=ee.map(xe=>new s.Point(tt(xe.x),xe.y)),ae=ae.map(xe=>new s.Point(tt(xe.x),xe.y));const le=[...ee];le.length===0&&le.push(ae[ae.length-1]);const ye=s.number(le[le.length-1].y,(ae.length===0?ee[0]:ae[0]).y,j);let ve;return ve=te?[new s.Point(0,ye),new s.Point(0,0),new s.Point(1,0),new s.Point(1,ye)]:[new s.Point(1,ye),new s.Point(1,1),new s.Point(0,1),new s.Point(0,ye)],le.push(...ve),ae.length===0?le.push(ee[0]):le.push(...ae),{polygon:le.map(xe=>new s.MercatorCoordinate(xe.x,xe.y)),unwrapped:!1}}(o,c);if(f)return f;const _=function(v,T){let S=!1,I=-1/0,z=0;for(let N=0;N<v.length-1;N++)v[N].x>I&&(I=v[N].x,z=N);for(let N=0;N<v.length-1;N++){const X=(z+N)%(v.length-1),te=v[X],re=v[X+1];Math.abs(te.x-re.x)>.5&&(te.x<re.x?(te.x+=1,X===0&&(v[v.length-1].x+=1)):(re.x+=1,X+1===v.length-1&&(v[0].x+=1)),S=!0)}const P=s.mercatorXfromLng(T.center.lng);return S&&P<Math.abs(P-1)&&v.forEach(N=>{N.x-=1}),{polygon:v,unwrapped:S}}(et(o,c).map(v=>new s.Point(tt(v.x),v.y)),c);return{polygon:_.polygon.map(v=>new s.MercatorCoordinate(v.x,v.y)),unwrapped:_.unwrapped}}}function et(d,o){return s.resample(d,c=>{const f=o.pointCoordinate3D(c);c.x=f.x,c.y=f.y},1/256)}function tt(d){return d<0?1+d%1:d%1}function nn(d){return 100*d|0}function Wt(d,o,c,f,_){const v=function(T,S){if(T)return _(T);if(S){d.url&&S.tiles&&d.tiles&&delete d.tiles;const I=s.pick(s.extend(S,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);S.vector_layers&&(I.vectorLayers=S.vector_layers,I.vectorLayerIds=I.vectorLayers.map(z=>z.id)),I.tiles=o.canonicalizeTileset(I,d.url),_(null,I)}};return d.url?s.getJSON(o.transformRequest(o.normalizeSourceURL(d.url,null,c,f),s.ResourceType.Source),v):s.exported.frame(()=>v(null,d))}class yn{constructor(o,c,f){this.bounds=s.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const c=Math.pow(2,o.z),f=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),v=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),T=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return o.x>=f&&o.x<v&&o.y>=_&&o.y<T}}class Ht{constructor(o,c,f){this.context=o;const _=o.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Lr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ln{constructor(o,c,f,_){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=o;const v=o.gl;this.buffer=v.createBuffer(),o.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,c){for(let f=0;f<this.attributes.length;f++){const _=c.attributes[this.attributes[f].name];_!==void 0&&o.enableVertexAttribArray(_)}}setVertexAttribPointers(o,c,f){for(let _=0;_<this.attributes.length;_++){const v=this.attributes[_],T=c.attributes[v.name];T!==void 0&&o.vertexAttribPointer(T,v.components,o[Lr[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Rt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Yr extends Rt{getDefault(){return s.Color.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class zn extends Rt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Xn extends Rt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class mn extends Rt{getDefault(){return[!0,!0,!0,!0]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class gr extends Rt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class bo extends Rt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class qr extends Rt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Ir extends Rt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Ri extends Rt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}}class _r extends Rt{getDefault(){return[0,1]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class yr extends Rt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}}class kr extends Rt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Fi extends Rt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}}class Es extends Rt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Oi extends Rt{getDefault(){return s.Color.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class xr extends Rt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class to extends Rt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}}class ts extends Rt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class no extends Rt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let di,Ni=class extends Rt{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}};class Eo extends Rt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ui extends Rt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ro extends Rt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class To extends Rt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ns extends Rt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Ts extends Rt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class de extends Rt{getDefault(){return null}set(o){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class $ extends Rt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class H extends Rt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ce extends Rt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class _e extends Rt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Ee extends Rt{constructor(o,c){super(o),this.context=o,this.parent=c}getDefault(){return null}}class Me extends Ee{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class ke extends Ee{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class be extends ke{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Re{constructor(o,c,f,_){this.context=o,this.width=c,this.height=f;const v=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Me(o,v),_&&(this.depthAttachment=new ke(o,v))}destroy(){const o=this.context.gl,c=this.colorAttachment.get();if(c&&o.deleteTexture(c),this.depthAttachment){const f=this.depthAttachment.get();f&&o.deleteRenderbuffer(f)}o.deleteFramebuffer(this.framebuffer)}}class ct{constructor(o,c=!1){if(this.gl=o,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const f=o;this.extVertexArrayObject={createVertexArrayOES:f.createVertexArray.bind(o),deleteVertexArrayOES:f.deleteVertexArray.bind(o),bindVertexArrayOES:f.bindVertexArray.bind(o)}}this.clearColor=new Yr(this),this.clearDepth=new zn(this),this.clearStencil=new Xn(this),this.colorMask=new mn(this),this.depthMask=new gr(this),this.stencilMask=new bo(this),this.stencilFunc=new qr(this),this.stencilOp=new Ir(this),this.stencilTest=new Ri(this),this.depthRange=new _r(this),this.depthTest=new yr(this),this.depthFunc=new kr(this),this.blend=new Fi(this),this.blendFunc=new Es(this),this.blendColor=new Oi(this),this.blendEquation=new xr(this),this.cullFace=new to(this),this.cullFaceSide=new ts(this),this.frontFace=new no(this),this.program=new Ni(this),this.activeTexture=new Eo(this),this.viewport=new Ui(this),this.bindFramebuffer=new ro(this),this.bindRenderbuffer=new To(this),this.bindTexture=new ns(this),this.bindVertexBuffer=new Ts(this),this.bindElementBuffer=new de(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $(this),this.pixelStoreUnpack=new H(this),this.pixelStoreUnpackPremultiplyAlpha=new ce(this),this.pixelStoreUnpackFlipY=new _e(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,c){return new Ht(this,o,c)}createVertexBuffer(o,c,f){return new ln(this,o,c,f)}createRenderbuffer(o,c,f){const _=this.gl,v=_.createRenderbuffer();return this.bindRenderbuffer.set(v),_.renderbufferStorage(_.RENDERBUFFER,o,c,f),this.bindRenderbuffer.set(null),v}createFramebuffer(o,c,f){return new Re(this,o,c,f)}clear({color:o,depth:c,stencil:f}){const _=this.gl;let v=0;o&&(v|=_.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(v|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(v|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),_.clear(v)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){C(o.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class dt extends s.Evented{constructor(o,c,f,_){if(super(),this.id=o,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(c,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(o){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map._worldview;this._tileJSONRequest=Wt(this._options,this.map._requestManager,c,f,(_,v)=>{this._tileJSONRequest=null,this._loaded=!0,_?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new s.ErrorEvent(_))):v&&(s.extend(this,v),v.bounds&&(this.tileBounds=new yn(v.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(v.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(_)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(o,c){const f=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(f,s.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",_,v.bind(this));else if(o.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",_,v.bind(this),void 0,!0);else{const T=s.loadVectorTile.call({deduped:this._deduped},_,(S,I)=>{S||!I?v.call(this,S):(_.data={cacheControl:I.cacheControl,expires:I.expires,rawData:I.rawData.slice(0)},o.actor&&o.actor.send("loadTile",_,v.bind(this),void 0,!0))},!0);o.request={cancel:T}}function v(T,S){return delete o.request,o.aborted?c(null):T&&T.status!==404?c(T):(S&&S.resourceTiming&&(o.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&o.setExpiryData(S),o.loadVectorData(S,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class st extends s.Evented{constructor(o,c,f,_){super(),this.id=o,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,null,null,(c,f)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):f&&(s.extend(this,f),f.bounds&&(this.tileBounds=new yn(f.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(f.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(c)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,c){const f=s.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);o.request=s.getImage(this.map._requestManager.transformRequest(_,s.ResourceType.Tile),(v,T,S,I)=>(delete o.request,o.aborted?(o.state="unloaded",c(null)):v?(o.state="errored",c(v)):T?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:S,expires:I}),o.setTexture(T,this.map.painter),o.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(o,c,f){o.setTexture(c,f)}static unloadTileData(o,c){o.texture&&c.saveTileTexture(o.texture)}abortTile(o,c){o.request&&(o.request.cancel(),delete o.request),c()}unloadTile(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Pt(d,o,c,f,_,v,T,S){const I=[d,c,_,o,f,v,1,1,1],z=[T,S,1],P=s.adjoint([],I),[N,X,te]=s.transformMat3(z,z,s.transpose(P,P));return s.multiply$1(I,[N,0,0,0,X,0,0,0,te],I)}class Lt extends s.Evented{constructor(o,c,f,_){super(),this.id=o,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c,this._dirty=!1}load(o,c){this._loaded=c||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(f,_)=>{if(this._imageRequest=null,this._loaded=!0,f)this.fire(new s.ErrorEvent(f));else if(_){const{HTMLImageElement:v}=s.window;this.image=_ instanceof v?s.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const c=o.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(f){let _=1/0,v=1/0,T=-1/0,S=-1/0;for(const N of f)_=Math.min(_,N.x),v=Math.min(v,N.y),T=Math.max(T,N.x),S=Math.max(S,N.y);const I=Math.max(T-_,S-v),z=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),P=Math.pow(2,z);return new s.CanonicalTileID(z,Math.floor((_+T)/2*P),Math.floor((v+S)/2*P))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const I in this.tiles){const z=this.tiles[I];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const c=s.tileTransform(this.tileID,this.map.transform.projection),[f,_,v,T]=this.coordinates.map(I=>{const z=c.projection.project(I[0],I[1]);return s.getTilePoint(c,z)._round()});this.perspectiveTransform=function(I,z,P,N,X,te,re,ne,ie,j){const ee=Pt(0,0,I,0,0,z,I,z),ae=Pt(P,N,X,te,re,ne,ie,j);return s.multiply$1(ae,s.adjoint(ee,ee),ae),[ae[6]/ae[8]*I/s.EXTENT,ae[7]/ae[8]*z/s.EXTENT]}(this.width,this.height,f.x,f.y,_.x,_.y,T.x,T.y,v.x,v.y);const S=this._boundsArray=new s.StructArrayLayout4i8;S.emplaceBack(f.x,f.y,0,0),S.emplaceBack(_.x,_.y,s.EXTENT,0),S.emplaceBack(T.x,T.y,0,s.EXTENT),S.emplaceBack(v.x,v.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(S,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,c=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Nt={vector:dt,raster:st,"raster-dem":class extends st{constructor(d,o,c,f){super(d,o,c,f),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(d,o){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(_,v){_&&(d.state="errored",o(_)),v&&(d.dem=v,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",o(null))}d.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),(function(_,v,T,S){if(delete d.request,d.aborted)d.state="unloaded",o(null);else if(_)d.state="errored",o(_);else if(v){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:T,expires:S});const I=s.window.ImageBitmap&&v instanceof s.window.ImageBitmap&&(di==null&&(di=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),di),z=1-(v.width-s.prevPowerOfTwo(v.width))/2;z<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const P=I?v:s.exported.getImageData(v,z),N={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:P,encoding:this.encoding,padding:z};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",N,f.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(d){const o=d.canonical,c=Math.pow(2,o.z),f=(o.x-1+c)%c,_=o.x===0?d.wrap-1:d.wrap,v=(o.x+1+c)%c,T=o.x+1===c?d.wrap+1:d.wrap,S={};return S[new s.OverscaledTileID(d.overscaledZ,_,o.z,f,o.y).key]={backfilled:!1},S[new s.OverscaledTileID(d.overscaledZ,T,o.z,v,o.y).key]={backfilled:!1},o.y>0&&(S[new s.OverscaledTileID(d.overscaledZ,_,o.z,f,o.y-1).key]={backfilled:!1},S[new s.OverscaledTileID(d.overscaledZ,d.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},S[new s.OverscaledTileID(d.overscaledZ,T,o.z,v,o.y-1).key]={backfilled:!1}),o.y+1<c&&(S[new s.OverscaledTileID(d.overscaledZ,_,o.z,f,o.y+1).key]={backfilled:!1},S[new s.OverscaledTileID(d.overscaledZ,d.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},S[new s.OverscaledTileID(d.overscaledZ,T,o.z,v,o.y+1).key]={backfilled:!1}),S}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends s.Evented{constructor(d,o,c,f){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(f),this._data=o.data,this._options=s.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const _=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*_,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*_,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*_,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},o),this}getClusterChildren(d,o){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},o),this}getClusterLeaves(d,o,c,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:o,offset:c},f),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=s.extend({},this.workerOptions),o=this._data;typeof o=="string"?(d.request=this.map._requestManager.transformRequest(s.exported.resolveURL(o),s.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(c,f)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&f&&f.resourceTiming&&f.resourceTiming[this.id]&&(_.resourceTiming=f.resourceTiming[this.id]),this.fire(new s.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,o){const c=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(c,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(f,_)=>(delete d.request,d.unloadVectorData(),d.aborted?o(null):f?o(f):(d.loadVectorData(_,this.map.painter,c==="reloadTile"),o(null))),void 0,c==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Lt{constructor(d,o,c,f){super(d,o,c,f),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const o of d.urls)this.urls.push(this.map._requestManager.transformRequest(o,s.ResourceType.Source).url);s.getVideo(this.urls,(o,c)=>{this._loaded=!0,o?this.fire(new s.ErrorEvent(o)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const o=this.video.seekable;d<o.start(0)||d>o.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,o=d.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(d,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Lt,canvas:class extends Lt{constructor(d,o,c,f){super(d,o,c,f),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(v=>typeof v!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends s.Evented{constructor(d,o,c,f){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=o,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new yn(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:o,y:c,z:f}=d.canonical;return this._implementation.hasTile({x:o,y:c,z:f})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,o){const{x:c,y:f,z:_}=d.tileID.canonical,v=new s.window.AbortController;d.request=Promise.resolve(this._implementation.loadTile({x:c,y:f,z:_},{signal:v.signal})).then((function(T){return delete d.request,d.aborted?(d.state="unloaded",o(null)):T===void 0?(d.state="errored",o(null)):T===null?(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",o(null)):function(S){return S instanceof s.window.ImageData||S instanceof s.window.HTMLCanvasElement||S instanceof s.window.ImageBitmap||S instanceof s.window.HTMLImageElement}(T)?(this.loadTileData(d,T),d.state="loaded",void o(null)):(d.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(T=>{T.code!==20&&(d.state="errored",o(T))}),d.request.cancel=()=>v.abort()}loadTileData(d,o){st.loadTileData(d,o,this._map.painter)}unloadTileData(d){st.unloadTileData(d,this._map.painter)}unloadTile(d,o){if(this.unloadTileData(d),this._implementation.unloadTile){const{x:c,y:f,z:_}=d.tileID.canonical;this._implementation.unloadTile({x:c,y:f,z:_})}o()}abortTile(d,o){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Zt=function(d,o,c,f){const _=new Nt[o.type](d,o,c,f);if(_.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${_.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],_),_};function en(d,o){const c=s.identity([]);return s.scale(c,c,[.5*d.width,.5*-d.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,d.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(c)}function Nn(d,o,c,f,_,v,T,S=!1){const I=d.tilesIn(f,T,S);I.sort(Rr);const z=[];for(const N of I)z.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(o,c,d._state,N,_,v,en(d.transform,N.tile.tileID),S)});const P=function(N){const X={},te={};for(const re of N){const ne=re.queryResults,ie=re.wrappedTileID,j=te[ie]=te[ie]||{};for(const ee in ne){const ae=ne[ee],le=j[ee]=j[ee]||{},ye=X[ee]=X[ee]||[];for(const ve of ae)le[ve.featureIndex]||(le[ve.featureIndex]=!0,ye.push(ve))}}return X}(z);for(const N in P)P[N].forEach(X=>{const te=X.feature,re=te.layer;re&&re.type!=="background"&&re.type!=="sky"&&(te.source=re.source,re["source-layer"]&&(te.sourceLayer=re["source-layer"]),te.state=te.id!==void 0?d.getFeatureState(re["source-layer"],te.id):{})});return P}function Qn(d,o){const c=d.getRenderableIds().map(v=>d.getTileByID(v)),f=[],_={};for(let v=0;v<c.length;v++){const T=c[v],S=T.tileID.canonical.key;_[S]||(_[S]=!0,T.querySourceFeatures(f,o))}return f}function Rr(d,o){const c=d.tileID,f=o.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function hr(){return xa.workerClass!=null?new xa.workerClass:new s.window.Worker(xa.workerUrl)}const io="mapboxgl_preloaded_worker_pool";class vr{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<vr.workerCount;)this.workers.push(new hr);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[io]}numActive(){return Object.keys(this.active).length}}let $r;function ta(){return $r||($r=new vr),$r}function Zm(d,o){const c={};for(const f in d)f!=="ref"&&(c[f]=d[f]);return s.refProperties.forEach(f=>{f in o&&(c[f]=o[f])}),c}function Ep(d){d=d.slice();const o=Object.create(null);for(let c=0;c<d.length;c++)o[d[c].id]=d[c];for(let c=0;c<d.length;c++)"ref"in d[c]&&(d[c]=Zm(d[c],o[d[c].ref]));return d}vr.workerCount=2;const pn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Hu(d,o,c){c.push({command:pn.addSource,args:[d,o[d]]})}function nl(d,o,c){o.push({command:pn.removeSource,args:[d]}),c[d]=!0}function Zu(d,o,c,f){nl(d,c,f),Hu(d,o,c)}function hc(d,o,c){let f;for(f in d[c])if(d[c].hasOwnProperty(f)&&f!=="data"&&!C(d[c][f],o[c][f]))return!1;for(f in o[c])if(o[c].hasOwnProperty(f)&&f!=="data"&&!C(d[c][f],o[c][f]))return!1;return!0}function oo(d,o,c,f,_,v){let T;for(T in o=o||{},d=d||{})d.hasOwnProperty(T)&&(C(d[T],o[T])||c.push({command:v,args:[f,T,o[T],_]}));for(T in o)o.hasOwnProperty(T)&&!d.hasOwnProperty(T)&&(C(d[T],o[T])||c.push({command:v,args:[f,T,o[T],_]}))}function So(d){return d.id}function Xu(d,o){return d[o.id]=o,d}class Ku{constructor(o,c){this.reset(o,c)}reset(o,c){this.points=o||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.clamp(o,0,1);let c=1,f=this._distances[c];const _=o*this.paddedLength+this.padding;for(;f<_&&c<this._distances.length;)f=this._distances[++c];const v=c-1,T=this._distances[v],S=f-T,I=S>0?(_-T)/S:0;return this.points[v].mult(1-I).add(this.points[c].mult(I))}}class Ss{constructor(o,c,f){const _=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(o/f),this.yCellCount=Math.ceil(c/f);for(let T=0;T<this.xCellCount*this.yCellCount;T++)_.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=c,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,c,f,_,v){this._forEachCell(c,f,_,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(v)}insertCircle(o,c,f,_){this._forEachCell(c-_,f-_,c+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(c),this.circles.push(f),this.circles.push(_)}_insertBoxCell(o,c,f,_,v,T){this.boxCells[v].push(T)}_insertCircleCell(o,c,f,_,v,T){this.circleCells[v].push(T)}_query(o,c,f,_,v,T){if(f<0||o>this.width||_<0||c>this.height)return!v&&[];const S=[];if(o<=0&&c<=0&&this.width<=f&&this.height<=_){if(v)return!0;for(let I=0;I<this.boxKeys.length;I++)S.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const z=this.circles[3*I],P=this.circles[3*I+1],N=this.circles[3*I+2];S.push({key:this.circleKeys[I],x1:z-N,y1:P-N,x2:z+N,y2:P+N})}return T?S.filter(T):S}return this._forEachCell(o,c,f,_,this._queryCell,S,{hitTest:v,seenUids:{box:{},circle:{}}},T),v?S.length>0:S}_queryCircle(o,c,f,_,v){const T=o-f,S=o+f,I=c-f,z=c+f;if(S<0||T>this.width||z<0||I>this.height)return!_&&[];const P=[];return this._forEachCell(T,I,S,z,this._queryCellCircle,P,{hitTest:_,circle:{x:o,y:c,radius:f},seenUids:{box:{},circle:{}}},v),_?P.length>0:P}query(o,c,f,_,v){return this._query(o,c,f,_,!1,v)}hitTest(o,c,f,_,v){return this._query(o,c,f,_,!0,v)}hitTestCircle(o,c,f,_){return this._queryCircle(o,c,f,!0,_)}_queryCell(o,c,f,_,v,T,S,I){const z=S.seenUids,P=this.boxCells[v];if(P!==null){const X=this.bboxes;for(const te of P)if(!z.box[te]){z.box[te]=!0;const re=4*te;if(o<=X[re+2]&&c<=X[re+3]&&f>=X[re+0]&&_>=X[re+1]&&(!I||I(this.boxKeys[te]))){if(S.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[te],x1:X[re],y1:X[re+1],x2:X[re+2],y2:X[re+3]})}}}const N=this.circleCells[v];if(N!==null){const X=this.circles;for(const te of N)if(!z.circle[te]){z.circle[te]=!0;const re=3*te;if(this._circleAndRectCollide(X[re],X[re+1],X[re+2],o,c,f,_)&&(!I||I(this.circleKeys[te]))){if(S.hitTest)return T.push(!0),!0;{const ne=X[re],ie=X[re+1],j=X[re+2];T.push({key:this.circleKeys[te],x1:ne-j,y1:ie-j,x2:ne+j,y2:ie+j})}}}}}_queryCellCircle(o,c,f,_,v,T,S,I){const z=S.circle,P=S.seenUids,N=this.boxCells[v];if(N!==null){const te=this.bboxes;for(const re of N)if(!P.box[re]){P.box[re]=!0;const ne=4*re;if(this._circleAndRectCollide(z.x,z.y,z.radius,te[ne+0],te[ne+1],te[ne+2],te[ne+3])&&(!I||I(this.boxKeys[re])))return T.push(!0),!0}}const X=this.circleCells[v];if(X!==null){const te=this.circles;for(const re of X)if(!P.circle[re]){P.circle[re]=!0;const ne=3*re;if(this._circlesCollide(te[ne],te[ne+1],te[ne+2],z.x,z.y,z.radius)&&(!I||I(this.circleKeys[re])))return T.push(!0),!0}}}_forEachCell(o,c,f,_,v,T,S,I){const z=this._convertToXCellCoord(o),P=this._convertToYCellCoord(c),N=this._convertToXCellCoord(f),X=this._convertToYCellCoord(_);for(let te=z;te<=N;te++)for(let re=P;re<=X;re++)if(v.call(this,o,c,f,_,this.xCellCount*re+te,T,S,I))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,c,f,_,v,T){const S=_-o,I=v-c,z=f+T;return z*z>S*S+I*I}_circleAndRectCollide(o,c,f,_,v,T,S){const I=(T-_)/2,z=Math.abs(o-(_+I));if(z>I+f)return!1;const P=(S-v)/2,N=Math.abs(c-(v+P));if(N>P+f)return!1;if(z<=I||N<=P)return!0;const X=z-I,te=N-P;return X*X+te*te<=f*f}}const Co={unknown:0,flipRequired:1,flipNotRequired:2},rl=Math.tan(85*Math.PI/180);function qe(d,o,c,f,_,v,T){const S=s.create();if(c)if(v.name==="globe"){const I=s.calculateGlobeLabelMatrix(_,o);s.multiply(S,S,I)}else{const I=Te([],T);S[0]=I[0],S[1]=I[1],S[4]=I[2],S[5]=I[3],f||s.rotateZ(S,S,_.angle)}else s.multiply(S,_.labelPlaneMatrix,d);return S}function Ao(d,o,c,f,_,v,T){const S=qe(d,o,c,f,_,v,T);return v.name==="globe"&&c||(S[2]=S[6]=S[10]=S[14]=0),S}function er(d,o,c,f,_,v,T){if(c){if(v.name==="globe"){const S=qe(d,o,c,f,_,v,T);return s.invert(S,S),s.multiply(S,d,S),S}{const S=s.clone(d),I=s.identity([]);return I[0]=T[0],I[1]=T[1],I[4]=T[2],I[5]=T[3],s.multiply(S,S,I),f||s.rotateZ(S,S,-_.angle),S}}return _.glCoordMatrix}function wr(d,o,c,f){const _=[d,o,c,1];c?s.transformMat4$1(_,_,f):Yt(_,_,f);const v=_[3];return _[0]/=v,_[1]/=v,_[2]/=v,_}function Tp(d,o){return Math.min(.5+d/o*.5,1.5)}function so(d,o){const c=d[0]/d[3],f=d[1]/d[3];return c>=-o[0]&&c<=o[0]&&f>=-o[1]&&f<=o[1]}function Yu(d,o,c,f,_,v,T,S,I,z){const P=c.transform,N=f?d.textSizeData:d.iconSizeData,X=s.evaluateSizeForZoom(N,c.transform.zoom),te=P.projection.name==="globe",re=[256/c.width*2+1,256/c.height*2+1],ne=f?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;ne.clear();let ie=null;te&&(ie=f?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const j=d.lineVertexArray,ee=f?d.text.placedSymbolArray:d.icon.placedSymbolArray,ae=c.transform.width/c.transform.height;let le,ye=!1;for(let ve=0;ve<ee.length;ve++){const xe=ee.get(ve),{numGlyphs:Ie,writingMode:Ae}=xe;if(Ae!==s.WritingMode.vertical||ye||le===s.WritingMode.horizontal||(ye=!0),le=Ae,(xe.hidden||Ae===s.WritingMode.vertical)&&!ye){ji(Ie,ne);continue}ye=!1;const Be=new s.Point(xe.tileAnchorX,xe.tileAnchorY);let{x:it,y:De,z:Ze}=P.projection.projectTilePoint(Be.x,Be.y,z.canonical);if(I){const[Ft,Et,zt]=I(Be);it+=Ft,De+=Et,Ze+=zt}const Fe=[it,De,Ze,1];if(s.transformMat4$1(Fe,Fe,o),!so(Fe,re)){ji(Ie,ne);continue}const rt=Tp(c.transform.cameraToCenterDistance,Fe[3]),ze=s.evaluateSizeForFeature(N,X,xe),He=T?ze/rt:ze*rt,at=wr(it,De,Ze,_);if(at[3]<=0){ji(Ie,ne);continue}let Qe={};const lt=T?null:I,At=yt(xe,He,!1,S,o,_,v,d.glyphOffsetArray,j,ne,ie,at,Be,Qe,ae,lt,P.projection,z,T);ye=At.useVertical,lt&&At.needsFlipping&&(Qe={}),(At.notEnoughRoom||ye||At.needsFlipping&&yt(xe,He,!0,S,o,_,v,d.glyphOffsetArray,j,ne,ie,at,Be,Qe,ae,lt,P.projection,z,T).notEnoughRoom)&&ji(Ie,ne)}f?(d.text.dynamicLayoutVertexBuffer.updateData(ne),ie&&d.text.globeExtVertexBuffer.updateData(ie)):(d.icon.dynamicLayoutVertexBuffer.updateData(ne),ie&&d.icon.globeExtVertexBuffer.updateData(ie))}function Sp(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne){const{lineStartIndex:ie,glyphStartIndex:j,segment:ee}=S,ae=j+S.numGlyphs,le=ie+S.lineLength,ye=o.getoffsetX(j),ve=o.getoffsetX(ae-1),xe=pi(d*ye,c,f,_,v,T,ee,ie,le,I,z,P,N,X,!0,te,re,ne);if(!xe)return null;const Ie=pi(d*ve,c,f,_,v,T,ee,ie,le,I,z,P,N,X,!0,te,re,ne);return Ie?{first:xe,last:Ie}:null}function na(d,o,c,f){return d===s.WritingMode.horizontal&&Math.abs(f)>Math.abs(c)?{useVertical:!0}:d===s.WritingMode.vertical?f>0?{needsFlipping:!0}:null:o!==Co.unknown&&function(_,v){return _===0||Math.abs(v/_)>rl}(c,f)?o===Co.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function yt(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne,ie,j,ee){const ae=o/24,le=d.lineOffsetX*ae,ye=d.lineOffsetY*ae,{lineStartIndex:ve,glyphStartIndex:xe,numGlyphs:Ie,segment:Ae,writingMode:Be,flipState:it}=d,De=ve+d.lineLength,Ze=Fe=>{if(P){const[at,Qe,lt]=Fe.up,At=z.length;s.updateGlobeVertexNormal(P,At+0,at,Qe,lt),s.updateGlobeVertexNormal(P,At+1,at,Qe,lt),s.updateGlobeVertexNormal(P,At+2,at,Qe,lt),s.updateGlobeVertexNormal(P,At+3,at,Qe,lt)}const[rt,ze,He]=Fe.point;s.addDynamicAttributes(z,rt,ze,He,Fe.angle)};if(Ie>1){const Fe=Sp(ae,S,le,ye,c,N,X,d,I,v,te,ne,!1,ie,j,ee);if(!Fe)return{notEnoughRoom:!0};if(f&&!c){let[rt,ze,He]=Fe.first.point,[at,Qe,lt]=Fe.last.point;[rt,ze]=wr(rt,ze,He,T),[at,Qe]=wr(at,Qe,lt,T);const At=na(Be,it,(at-rt)*re,Qe-ze);if(d.flipState=At&&At.needsFlipping?Co.flipRequired:Co.flipNotRequired,At)return At}Ze(Fe.first);for(let rt=xe+1;rt<xe+Ie-1;rt++){const ze=pi(ae*S.getoffsetX(rt),le,ye,c,N,X,Ae,ve,De,I,v,te,ne,!1,!1,ie,j,ee);if(!ze)return z.length-=4*(rt-xe),{notEnoughRoom:!0};Ze(ze)}Ze(Fe.last)}else{if(f&&!c){const rt=wr(X.x,X.y,0,_),ze=ve+Ae+1,He=new s.Point(I.getx(ze),I.gety(ze)),at=wr(He.x,He.y,0,_),Qe=at[3]>0?at:Kt(X,He,rt,1,_,void 0,ie,j.canonical),lt=na(Be,it,(Qe[0]-rt[0])*re,Qe[1]-rt[1]);if(d.flipState=lt&&lt.needsFlipping?Co.flipRequired:Co.flipNotRequired,lt)return lt}const Fe=pi(ae*S.getoffsetX(xe),le,ye,c,N,X,Ae,ve,De,I,v,te,ne,!1,!1,ie,j,ee);if(!Fe)return{notEnoughRoom:!0};Ze(Fe)}return{}}function Qt(d,o,c,f,_){const{x:v,y:T,z:S}=f.projectTilePoint(d.x,d.y,o);if(!_)return wr(v,T,S,c);const[I,z,P]=_(d);return wr(v+I,T+z,S+P,c)}function Kt(d,o,c,f,_,v,T,S){const I=Qt(d.sub(o)._unit()._add(d),S,_,T,v);return s.sub(I,c,I),s.normalize(I,I),s.scaleAndAdd(I,c,I,f)}function pi(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne,ie,j){const ee=f?d-o:d+o;let ae=ee>0?1:-1,le=0;f&&(ae*=-1,le=Math.PI),ae<0&&(le+=Math.PI);let ye=S+T+(ae>0?0:1)|0,ve=_,xe=_,Ie=0,Ae=0;const Be=Math.abs(ee),it=[],De=[];let Ze=v,Fe=Ze;const rt=()=>Kt(Fe,Ze,xe,Be-Ie+1,P,X,ne,ie.canonical);for(;Ie+Ae<=Be;){if(ye+=ae,ye<S||ye>=I)return null;if(xe=ve,Fe=Ze,it.push(xe),te&&De.push(Fe),Ze=new s.Point(z.getx(ye),z.gety(ye)),ve=N[ye],!ve){const zt=Qt(Ze,ie.canonical,P,ne,X);ve=zt[3]>0?N[ye]=zt:rt()}Ie+=Ae,Ae=s.distance(xe,ve)}re&&X&&(N[ye]&&(ve=rt(),Ae=s.distance(xe,ve)),N[ye]=ve);const ze=(Be-Ie)/Ae,He=Ze.sub(Fe)._mult(ze)._add(Fe),at=s.sub([],ve,xe),Qe=s.scaleAndAdd([],xe,at,ze);let lt=[0,0,1],At=at[0],Ft=at[1];if(j&&(lt=ne.upVector(ie.canonical,He.x,He.y),lt[0]!==0||lt[1]!==0||lt[2]!==1)){const zt=[lt[2],0,-lt[0]],Jt=s.cross([],lt,zt);s.normalize(zt,zt),s.normalize(Jt,Jt),At=s.dot(at,zt),Ft=s.dot(at,Jt)}if(c){const zt=s.cross([],lt,at);s.normalize(zt,zt),s.scaleAndAdd(Qe,Qe,zt,c*ae)}const Et=le+Math.atan2(Ft,At);return it.push(Qe),te&&De.push(He),{point:Qe,angle:Et,path:it,tilePath:De,up:lt}}function ji(d,o){const c=o.length,f=c+4*d;o.resize(f),o.float32.fill(-1/0,4*c,4*f)}function Yt(d,o,c){const f=o[0],_=o[1];return d[0]=c[0]*f+c[4]*_+c[12],d[1]=c[1]*f+c[5]*_+c[13],d[3]=c[3]*f+c[7]*_+c[15],d}const fi=100;class il{constructor(o,c,f=new Ss(o.width+200,o.height+200,25),_=new Ss(o.width+200,o.height+200,25)){this.transform=o,this.grid=f,this.ignoredGrid=_,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+fi,this.screenBottomBoundary=o.height+fi,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=c}placeCollisionBox(o,c,f,_,v,T,S,I){let z=f.projectedAnchorX,P=f.projectedAnchorY,N=f.projectedAnchorZ;const X=f.elevation,te=f.tileID,re=o.getProjection();if(X&&te){const[ve,xe,Ie]=re.upVector(te.canonical,f.tileAnchorX,f.tileAnchorY),Ae=re.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=ve*X*Ae,P+=xe*X*Ae,N+=Ie*X*Ae}const ne=this.projectAndGetPerspectiveRatio(S,z,P,N,f.tileID,re.name==="globe"||!!X||this.transform.pitch>0,re),ie=T*ne.perspectiveRatio,j=(f.x1*c+_.x-f.padding)*ie+ne.point.x,ee=(f.y1*c+_.y-f.padding)*ie+ne.point.y,ae=(f.x2*c+_.x+f.padding)*ie+ne.point.x,le=(f.y2*c+_.y+f.padding)*ie+ne.point.y,ye=ne.perspectiveRatio<=.55||ne.occluded;return!this.isInsideGrid(j,ee,ae,le)||!v&&this.grid.hitTest(j,ee,ae,le,I)||ye?{box:[],offscreen:!1,occluded:ne.occluded}:{box:[j,ee,ae,le],offscreen:this.isOffscreen(j,ee,ae,le),occluded:!1}}placeCollisionCircles(o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne){const ie=[],j=this.transform.elevation,ee=o.getProjection(),ae=j?j.getAtTileOffsetFunc(ne,this.transform.center.lat,this.transform.worldSize,ee):null,le=new s.Point(f.tileAnchorX,f.tileAnchorY);let{x:ye,y:ve,z:xe}=ee.projectTilePoint(le.x,le.y,ne.canonical);if(ae){const[He,at,Qe]=ae(le);ye+=He,ve+=at,xe+=Qe}const Ie=ee.name==="globe",Ae=this.projectAndGetPerspectiveRatio(S,ye,ve,xe,ne,Ie||!!j||this.transform.pitch>0,ee),{perspectiveRatio:Be}=Ae,it=(N?T/Be:T*Be)/s.ONE_EM,De=wr(ye,ve,xe,I),Ze=Ae.signedDistanceFromCamera>0?Sp(it,v,f.lineOffsetX*it,f.lineOffsetY*it,!1,De,le,f,_,I,{},j&&!N?ae:null,N&&!!j,ee,ne,N):null;let Fe=!1,rt=!1,ze=!0;if(Ze&&!Ae.occluded){const He=.5*te*Be+re,at=new s.Point(-100,-100),Qe=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),lt=new Ku,{first:At,last:Ft}=Ze,Et=At.path.length;let zt=[];for(let Ct=Et-1;Ct>=1;Ct--)zt.push(At.path[Ct]);for(let Ct=1;Ct<Ft.path.length;Ct++)zt.push(Ft.path[Ct]);const Jt=2.5*He;z&&(zt=zt.map(([Ct,gn,vn],wn)=>(ae&&!Ie&&(vn=ae(wn<Et-1?At.tilePath[Et-1-wn]:Ft.tilePath[wn-Et+2])[2]),wr(Ct,gn,vn,z))),zt.some(Ct=>Ct[3]<=0)&&(zt=[]));let Xt=[];if(zt.length>0){let Ct=1/0,gn=-1/0,vn=1/0,wn=-1/0;for(const bn of zt)Ct=Math.min(Ct,bn[0]),vn=Math.min(vn,bn[1]),gn=Math.max(gn,bn[0]),wn=Math.max(wn,bn[1]);gn>=at.x&&Ct<=Qe.x&&wn>=at.y&&vn<=Qe.y&&(Xt=[zt.map(bn=>new s.Point(bn[0],bn[1]))],(Ct<at.x||gn>Qe.x||vn<at.y||wn>Qe.y)&&(Xt=s.clipLine(Xt,at.x,at.y,Qe.x,Qe.y)))}for(const Ct of Xt){lt.reset(Ct,.25*He);let gn=0;gn=lt.length<=.5*He?1:Math.ceil(lt.paddedLength/Jt)+1;for(let vn=0;vn<gn;vn++){const wn=vn/Math.max(gn-1,1),bn=lt.lerp(wn),Or=bn.x+fi,Er=bn.y+fi;ie.push(Or,Er,He,0);const Ti=Or-He,uo=Er-He,Fn=Or+He,En=Er+He;if(ze=ze&&this.isOffscreen(Ti,uo,Fn,En),rt=rt||this.isInsideGrid(Ti,uo,Fn,En),!c&&this.grid.hitTestCircle(Or,Er,He,X)&&(Fe=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Fe,occluded:!1}}}}return{circles:!P&&Fe||!rt?[]:ie,offscreen:ze,collisionDetected:Fe,occluded:Ae.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let f=1/0,_=1/0,v=-1/0,T=-1/0;for(const P of o){const N=new s.Point(P.x+fi,P.y+fi);f=Math.min(f,N.x),_=Math.min(_,N.y),v=Math.max(v,N.x),T=Math.max(T,N.y),c.push(N)}const S=this.grid.query(f,_,v,T).concat(this.ignoredGrid.query(f,_,v,T)),I={},z={};for(const P of S){const N=P.key;if(I[N.bucketInstanceId]===void 0&&(I[N.bucketInstanceId]={}),I[N.bucketInstanceId][N.featureIndex])continue;const X=[new s.Point(P.x1,P.y1),new s.Point(P.x2,P.y1),new s.Point(P.x2,P.y2),new s.Point(P.x1,P.y2)];s.polygonIntersectsPolygon(c,X)&&(I[N.bucketInstanceId][N.featureIndex]=!0,z[N.bucketInstanceId]===void 0&&(z[N.bucketInstanceId]=[]),z[N.bucketInstanceId].push(N.featureIndex))}return z}insertCollisionBox(o,c,f,_,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:v},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,c,f,_,v){const T=c?this.ignoredGrid:this.grid,S={bucketInstanceId:f,featureIndex:_,collisionGroupID:v};for(let I=0;I<o.length;I+=4)T.insertCircle(S,o[I],o[I+1],o[I+2])}projectAndGetPerspectiveRatio(o,c,f,_,v,T,S){const I=[c,f,_,1];let z=!1;_||this.transform.pitch>0?(s.transformMat4$1(I,I,o),this.fogState&&v&&S.name!=="globe"&&(z=function(X,te,re,ne,ie,j){const ee=j.calculateFogTileMatrix(ie),ae=[te,re,ne];return s.transformMat4(ae,ae,ee),Ot(X,ae,j.pitch,j._fov)}(this.fogState,c,f,_,v.toUnwrapped(),this.transform)>.9)):Yt(I,I,o);const P=I[3];return{point:new s.Point((I[0]/P+1)/2*this.transform.width+fi,(-I[1]/P+1)/2*this.transform.height+fi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(S)/P*.5,1.5),signedDistanceFromCamera:P,occluded:T&&I[2]>P||z}}isOffscreen(o,c,f,_){return f<fi||o>=this.screenRightBoundary||_<fi||c>this.screenBottomBoundary}isInsideGrid(o,c,f,_){return f>=0&&o<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const o=s.identity([]);return s.translate(o,o,[-100,-100,0]),o}}function Cs(d,o,c){const f=o.createTileMatrix(d,d.worldSize,c.toUnwrapped());return s.multiply(new Float32Array(16),d.projMatrix,f)}function vi(d,o,c){if(o.projection.name===c.projection.name)return d.projMatrix;const f=c.clone();return f.setProjection(o.projection),Cs(f,o.getProjection(),d)}function Rn(d,o,c){return o.name===c.projection.name?d.projMatrix:Cs(c,o,d)}class Cp{constructor(o,c,f,_){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?c:-c))):_&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Io{constructor(o,c,f,_,v,T=!1){this.text=new Cp(o?o.text:null,c,f,v),this.icon=new Cp(o?o.icon:null,c,_,v),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ol{constructor(o,c,f,_=!1){this.text=o,this.icon=c,this.skipFade=f,this.clipped=_}}class sl{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Ju{constructor(o,c,f,_,v){this.bucketInstanceId=o,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=v}}class Ap{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const c=++this.maxGroupID;this.collisionGroups[o]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[o]}}function al(d,o,c,f,_){const{horizontalAlign:v,verticalAlign:T}=s.getAnchorAlignment(d),S=-(v-.5)*o,I=-(T-.5)*c,z=s.evaluateVariableOffset(d,f);return new s.Point(S+z[0]*_,I+z[1]*_)}function ll(d,o,c,f,_){const v=new s.Point(d,o);return c&&v._rotate(f?_:-_),v}class dc{constructor(o,c,f,_,v){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new il(this.transform,v),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ap(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,c,f,_){const v=f.getBucket(c),T=f.latestFeatureIndex;if(!v||!T||c.id!==v.layerIds[0])return;const S=v.layers[0].layout,I=f.collisionBoxArray,z=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),P=f.tileSize/s.EXTENT,N=f.tileID.toUnwrapped();this.transform.setProjection(v.projection);const X=(te=f.tileID,re=v.getProjection(),ne=this.transform,re.name===this.projection?ne.calculateProjMatrix(te.toUnwrapped()):Cs(ne,re,te));var te,re,ne;const ie=S.get("text-pitch-alignment")==="map",j=S.get("text-rotation-alignment")==="map";c.compileFilter();const ee=c.dynamicFilter(),ae=c.dynamicFilterNeedsFeature(),le=this.transform.calculatePixelsToTileUnitsMatrix(f),ye=Ao(X,f.tileID.canonical,ie,j,this.transform,v.getProjection(),le);let ve=null;if(ie){const Ae=er(X,f.tileID.canonical,ie,j,this.transform,v.getProjection(),le);ve=s.multiply([],this.transform.labelPlaneMatrix,Ae)}let xe=null;ee&&f.latestFeatureIndex&&(xe={unwrappedTileID:N,dynamicFilter:ee,dynamicFilterNeedsFeature:ae,featureIndex:f.latestFeatureIndex}),this.retainedQueryData[v.bucketInstanceId]=new Ju(v.bucketInstanceId,T,v.sourceLayerIndex,v.index,f.tileID);const Ie={bucket:v,layout:S,posMatrix:X,textLabelPlaneMatrix:ye,labelToScreenMatrix:ve,clippingData:xe,scale:z,textPixelRatio:P,holdingForFade:f.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(v.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(_)for(const Ae of v.sortKeyRanges){const{sortKey:Be,symbolInstanceStart:it,symbolInstanceEnd:De}=Ae;o.push({sortKey:Be,symbolInstanceStart:it,symbolInstanceEnd:De,parameters:Ie})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Ie})}attemptAnchorPlacement(o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne,ie,j,ee){const{textOffset0:ae,textOffset1:le,crossTileID:ye}=X,ve=[ae,le],xe=al(o,f,_,ve,v),Ie=this.collisionIndex.placeCollisionBox(re,v,c,ll(xe.x,xe.y,T,S,this.transform.angle),N,I,z,P.predicate);if(ie){const Ae=re.getSymbolInstanceIconSize(ee,this.transform.zoom,X.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(re,Ae,ie,ll(xe.x,xe.y,T,S,this.transform.angle),N,I,z,P.predicate).box.length===0)return}if(Ie.box.length>0){let Ae;return this.prevPlacement&&this.prevPlacement.variableOffsets[ye]&&this.prevPlacement.placements[ye]&&this.prevPlacement.placements[ye].text&&(Ae=this.prevPlacement.variableOffsets[ye].anchor),this.variableOffsets[ye]={textOffset:ve,width:f,height:_,anchor:o,textScale:v,prevAnchor:Ae},this.markUsedJustification(re,o,X,ne),re.allowVerticalPlacement&&(this.markUsedOrientation(re,ne,X),this.placedOrientations[ye]=ne),{shift:xe,placedGlyphBoxes:Ie}}}placeLayerBucketPart(o,c,f,_){const{bucket:v,layout:T,posMatrix:S,textLabelPlaneMatrix:I,labelToScreenMatrix:z,clippingData:P,textPixelRatio:N,holdingForFade:X,collisionBoxArray:te,partiallyEvaluatedTextSize:re,partiallyEvaluatedIconSize:ne,collisionGroup:ie}=o.parameters,j=T.get("text-optional"),ee=T.get("icon-optional"),ae=T.get("text-allow-overlap"),le=T.get("icon-allow-overlap"),ye=T.get("text-rotation-alignment")==="map",ve=T.get("text-pitch-alignment")==="map",xe=T.get("icon-text-fit")!=="none",Ie=T.get("symbol-z-order")==="viewport-y";this.transform.setProjection(v.projection);let Ae=ae&&(le||!v.hasIconData()||ee),Be=le&&(ae||!v.hasTextData()||j);!v.collisionArrays&&te&&v.deserializeCollisionBoxes(te),f&&_&&v.updateCollisionDebugBuffers(this.transform.zoom,te);const it=(De,Ze,Fe)=>{const{crossTileID:rt,numVerticalGlyphVertices:ze}=De;if(P){const Fn={zoom:this.transform.zoom,pitch:this.transform.pitch};let En=null;if(P.dynamicFilterNeedsFeature){const cn=this.retainedQueryData[v.bucketInstanceId];En=P.featureIndex.loadFeature({featureIndex:De.featureIndex,bucketIndex:cn.bucketIndex,sourceLayerIndex:cn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,P.dynamicFilter)(Fn,En,this.retainedQueryData[v.bucketInstanceId].tileID.canonical,new s.Point(De.tileAnchorX,De.tileAnchorY),this.transform.calculateDistanceTileData(P.unwrappedTileID)))return this.placements[rt]=new ol(!1,!1,!1,!0),void c.add(rt)}if(c.has(rt))return;if(X)return void(this.placements[rt]=new ol(!1,!1,!1));let He=!1,at=!1,Qe=!0,lt=!1,At=!1,Ft=null,Et={box:null,offscreen:null,occluded:null},zt={box:null,offscreen:null,occluded:null},Jt=null,Xt=null,Ct=null,gn=0,vn=0,wn=0;Fe.textFeatureIndex?gn=Fe.textFeatureIndex:De.useRuntimeCollisionCircles&&(gn=De.featureIndex),Fe.verticalTextFeatureIndex&&(vn=Fe.verticalTextFeatureIndex);const bn=Fn=>{Fn.tileID=this.retainedQueryData[v.bucketInstanceId].tileID;const En=this.transform.elevation;(En||Fn.elevation)&&(Fn.elevation=En?En.getAtTileOffset(Fn.tileID,Fn.tileAnchorX,Fn.tileAnchorY):0)},Or=Fe.textBox;if(Or){bn(Or);const Fn=cn=>{let tr=s.WritingMode.horizontal;if(v.allowVerticalPlacement&&!cn&&this.prevPlacement){const Wr=this.prevPlacement.placedOrientations[rt];Wr&&(this.placedOrientations[rt]=Wr,tr=Wr,this.markUsedOrientation(v,tr,De))}return tr},En=(cn,tr)=>{if(v.allowVerticalPlacement&&ze>0&&Fe.verticalTextBox){for(const Wr of v.writingModes)if(Wr===s.WritingMode.vertical?(Et=tr(),zt=Et):Et=cn(),Et&&Et.box&&Et.box.length)break}else Et=cn()};if(T.get("text-variable-anchor")){let cn=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[rt]){const Bn=this.prevPlacement.variableOffsets[rt];cn.indexOf(Bn.anchor)>0&&(cn=cn.filter(ei=>ei!==Bn.anchor),cn.unshift(Bn.anchor))}const tr=(Bn,ei,Nc)=>{const Bs=v.getSymbolInstanceTextSize(re,De,this.transform.zoom,Ze),Il=(Bn.x2-Bn.x1)*Bs+2*Bn.padding,Lo=(Bn.y2-Bn.y1)*Bs+2*Bn.padding,os=xe&&!le?ei:null;os&&bn(os);let Ls={box:[],offscreen:!1,occluded:!1};const Uc=ae?2*cn.length:cn.length;for(let kl=0;kl<Uc;++kl){const Vh=this.attemptAnchorPlacement(cn[kl%cn.length],Bn,Il,Lo,Bs,ye,ve,N,S,ie,kl>=cn.length,De,Ze,v,Nc,os,re,ne);if(Vh&&(Ls=Vh.placedGlyphBoxes,Ls&&Ls.box&&Ls.box.length)){He=!0,Ft=Vh.shift;break}}return Ls};En(()=>tr(Or,Fe.iconBox,s.WritingMode.horizontal),()=>{const Bn=Fe.verticalTextBox;return Bn&&bn(Bn),v.allowVerticalPlacement&&!(Et&&Et.box&&Et.box.length)&&ze>0&&Bn?tr(Bn,Fe.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Et&&(He=Et.box,Qe=Et.offscreen,lt=Et.occluded);const Wr=Fn(!(!Et||!Et.box));if(!He&&this.prevPlacement){const Bn=this.prevPlacement.variableOffsets[rt];Bn&&(this.variableOffsets[rt]=Bn,this.markUsedJustification(v,Bn.anchor,De,Wr))}}else{const cn=(tr,Wr)=>{const Bn=v.getSymbolInstanceTextSize(re,De,this.transform.zoom,Ze),ei=this.collisionIndex.placeCollisionBox(v,Bn,tr,new s.Point(0,0),ae,N,S,ie.predicate);return ei&&ei.box&&ei.box.length&&(this.markUsedOrientation(v,Wr,De),this.placedOrientations[rt]=Wr),ei};En(()=>cn(Or,s.WritingMode.horizontal),()=>{const tr=Fe.verticalTextBox;return v.allowVerticalPlacement&&ze>0&&tr?(bn(tr),cn(tr,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Fn(!!(Et&&Et.box&&Et.box.length))}}if(Jt=Et,He=Jt&&Jt.box&&Jt.box.length>0,Qe=Jt&&Jt.offscreen,lt=Jt&&Jt.occluded,De.useRuntimeCollisionCircles){const Fn=v.text.placedSymbolArray.get(De.centerJustifiedTextSymbolIndex>=0?De.centerJustifiedTextSymbolIndex:De.verticalPlacedTextSymbolIndex),En=s.evaluateSizeForFeature(v.textSizeData,re,Fn),cn=T.get("text-padding");Xt=this.collisionIndex.placeCollisionCircles(v,ae,Fn,v.lineVertexArray,v.glyphOffsetArray,En,S,I,z,f,ve,ie.predicate,De.collisionCircleDiameter*En/s.ONE_EM,cn,this.retainedQueryData[v.bucketInstanceId].tileID),He=ae||Xt.circles.length>0&&!Xt.collisionDetected,Qe=Qe&&Xt.offscreen,lt=Xt.occluded}if(Fe.iconFeatureIndex&&(wn=Fe.iconFeatureIndex),Fe.iconBox){const Fn=En=>{bn(En);const cn=xe&&Ft?ll(Ft.x,Ft.y,ye,ve,this.transform.angle):new s.Point(0,0),tr=v.getSymbolInstanceIconSize(ne,this.transform.zoom,De.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(v,tr,En,cn,le,N,S,ie.predicate)};zt&&zt.box&&zt.box.length&&Fe.verticalIconBox?(Ct=Fn(Fe.verticalIconBox),at=Ct.box.length>0):(Ct=Fn(Fe.iconBox),at=Ct.box.length>0),Qe=Qe&&Ct.offscreen,At=Ct.occluded}const Er=j||De.numHorizontalGlyphVertices===0&&ze===0,Ti=ee||De.numIconVertices===0;if(Er||Ti?Ti?Er||(at=at&&He):He=at&&He:at=He=at&&He,He&&Jt&&Jt.box&&this.collisionIndex.insertCollisionBox(Jt.box,T.get("text-ignore-placement"),v.bucketInstanceId,zt&&zt.box&&vn?vn:gn,ie.ID),at&&Ct&&this.collisionIndex.insertCollisionBox(Ct.box,T.get("icon-ignore-placement"),v.bucketInstanceId,wn,ie.ID),Xt&&(He&&this.collisionIndex.insertCollisionCircles(Xt.circles,T.get("text-ignore-placement"),v.bucketInstanceId,gn,ie.ID),f)){const Fn=v.bucketInstanceId;let En=this.collisionCircleArrays[Fn];En===void 0&&(En=this.collisionCircleArrays[Fn]=new sl);for(let cn=0;cn<Xt.circles.length;cn+=4)En.circles.push(Xt.circles[cn+0]),En.circles.push(Xt.circles[cn+1]),En.circles.push(Xt.circles[cn+2]),En.circles.push(Xt.collisionDetected?1:0)}const uo=v.projection.name!=="globe";Ae=Ae&&(uo||!lt),Be=Be&&(uo||!At),this.placements[rt]=new ol(He||Ae,at||Be,Qe||v.justReloaded),c.add(rt)};if(Ie){const De=v.getSortedSymbolIndexes(this.transform.angle);for(let Ze=De.length-1;Ze>=0;--Ze){const Fe=De[Ze];it(v.symbolInstances.get(Fe),Fe,v.collisionArrays[Fe])}}else for(let De=o.symbolInstanceStart;De<o.symbolInstanceEnd;De++)it(v.symbolInstances.get(De),De,v.collisionArrays[De]);if(f&&v.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[v.bucketInstanceId];s.invert(De.invProjMatrix,S),De.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(o,c,f,_){const{leftJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:T,rightJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:I,crossTileID:z}=f,P=s.getAnchorJustification(c),N=_===s.WritingMode.vertical?I:P==="left"?v:P==="center"?T:P==="right"?S:-1;v>=0&&(o.text.placedSymbolArray.get(v).crossTileID=N>=0&&v!==N?0:z),T>=0&&(o.text.placedSymbolArray.get(T).crossTileID=N>=0&&T!==N?0:z),S>=0&&(o.text.placedSymbolArray.get(S).crossTileID=N>=0&&S!==N?0:z),I>=0&&(o.text.placedSymbolArray.get(I).crossTileID=N>=0&&I!==N?0:z)}markUsedOrientation(o,c,f){const _=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,v=c===s.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:z}=f,P=o.text.placedSymbolArray;T>=0&&(P.get(T).placedOrientation=_),S>=0&&(P.get(S).placedOrientation=_),I>=0&&(P.get(I).placedOrientation=_),z>=0&&(P.get(z).placedOrientation=v)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(o):1,v=c?c.opacities:{},T=c?c.variableOffsets:{},S=c?c.placedOrientations:{};for(const I in this.placements){const z=this.placements[I],P=v[I];P?(this.opacities[I]=new Io(P,_,z.text,z.icon,null,z.clipped),f=f||z.text!==P.text.placed||z.icon!==P.icon.placed):(this.opacities[I]=new Io(null,_,z.text,z.icon,z.skipFade,z.clipped),f=f||z.text||z.icon)}for(const I in v){const z=v[I];if(!this.opacities[I]){const P=new Io(z,_,!1,!1);P.isHidden()||(this.opacities[I]=P,f=f||z.text.placed||z.icon.placed)}}for(const I in T)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=T[I]);for(const I in S)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=S[I]);f?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:o)}updateLayerOpacities(o,c){const f=new Set;for(const _ of c){const v=_.getBucket(o);v&&_.latestFeatureIndex&&o.id===v.layerIds[0]&&this.updateBucketOpacities(v,f,_.collisionBoxArray)}}updateBucketOpacities(o,c,f){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const _=o.layers[0].layout,v=!!o.layers[0].dynamicFilter(),T=new Io(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),I=_.get("icon-allow-overlap"),z=_.get("text-variable-anchor"),P=_.get("text-rotation-alignment")==="map",N=_.get("text-pitch-alignment")==="map",X=_.get("icon-text-fit")!=="none",te=new Io(null,0,S&&(I||!o.hasIconData()||_.get("icon-optional")),I&&(S||!o.hasTextData()||_.get("text-optional")),!0);!o.collisionArrays&&f&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(f);const re=(ie,j,ee)=>{for(let ae=0;ae<j/4;ae++)ie.opacityVertexArray.emplaceBack(ee)};let ne=0;for(let ie=0;ie<o.symbolInstances.length;ie++){const j=o.symbolInstances.get(ie),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:ae,crossTileID:le,numIconVertices:ye}=j,ve=c.has(le);let xe=this.opacities[le];ve?xe=T:xe||(xe=te,this.opacities[le]=xe),c.add(le);const Ie=ee>0||ae>0,Ae=ye>0,Be=this.placedOrientations[le],it=Be===s.WritingMode.vertical,De=Be===s.WritingMode.horizontal||Be===s.WritingMode.horizontalOnly;if(!Ie&&!Ae||xe.isHidden()||ne++,Ie){const Ze=cl(xe.text);re(o.text,ee,it?$n:Ze),re(o.text,ae,De?$n:Ze);const Fe=xe.text.isHidden(),{leftJustifiedTextSymbolIndex:rt,centerJustifiedTextSymbolIndex:ze,rightJustifiedTextSymbolIndex:He,verticalPlacedTextSymbolIndex:at}=j,Qe=o.text.placedSymbolArray,lt=Fe||it?1:0;rt>=0&&(Qe.get(rt).hidden=lt),ze>=0&&(Qe.get(ze).hidden=lt),He>=0&&(Qe.get(He).hidden=lt),at>=0&&(Qe.get(at).hidden=Fe||De?1:0);const At=this.variableOffsets[le];At&&this.markUsedJustification(o,At.anchor,j,Be);const Ft=this.placedOrientations[le];Ft&&(this.markUsedJustification(o,"left",j,Ft),this.markUsedOrientation(o,Ft,j))}if(Ae){const Ze=cl(xe.icon),{placedIconSymbolIndex:Fe,verticalPlacedIconSymbolIndex:rt}=j,ze=o.icon.placedSymbolArray,He=xe.icon.isHidden()?1:0;Fe>=0&&(re(o.icon,ye,it?$n:Ze),ze.get(Fe).hidden=He),rt>=0&&(re(o.icon,j.numVerticalIconVertices,De?$n:Ze),ze.get(rt).hidden=He)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Ze=o.collisionArrays[ie];if(Ze){let Fe=new s.Point(0,0),rt=!0;if(Ze.textBox||Ze.verticalTextBox){if(z){const He=this.variableOffsets[le];He?(Fe=al(He.anchor,He.width,He.height,He.textOffset,He.textScale),P&&Fe._rotate(N?this.transform.angle:-this.transform.angle)):rt=!1}v&&(rt=!xe.clipped),Ze.textBox&&ra(o.textCollisionBox.collisionVertexArray,xe.text.placed,!rt||it,Fe.x,Fe.y),Ze.verticalTextBox&&ra(o.textCollisionBox.collisionVertexArray,xe.text.placed,!rt||De,Fe.x,Fe.y)}const ze=rt&&!!(!De&&Ze.verticalIconBox);Ze.iconBox&&ra(o.iconCollisionBox.collisionVertexArray,xe.icon.placed,ze,X?Fe.x:0,X?Fe.y:0),Ze.verticalIconBox&&ra(o.iconCollisionBox.collisionVertexArray,xe.icon.placed,!ze,X?Fe.x:0,X?Fe.y:0)}}}if(o.fullyClipped=ne===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const ie=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ie.invProjMatrix,o.placementViewportMatrix=ie.viewportMatrix,o.collisionCircleArray=ie.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,c){const f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>o}setStale(){this.stale=!0}}function ra(d,o,c,f,_){d.emplaceBack(o?1:0,c?1:0,f||0,_||0),d.emplaceBack(o?1:0,c?1:0,f||0,_||0),d.emplaceBack(o?1:0,c?1:0,f||0,_||0),d.emplaceBack(o?1:0,c?1:0,f||0,_||0)}const Jr=Math.pow(2,25),Kn=Math.pow(2,24),Qu=Math.pow(2,17),eh=Math.pow(2,16),Qr=Math.pow(2,9),wi=Math.pow(2,8),Ip=Math.pow(2,1);function cl(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const o=d.placed?1:0,c=Math.floor(127*d.opacity);return c*Jr+o*Kn+c*Qu+o*eh+c*Qr+o*wi+c*Ip+o}const $n=0;class ul{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,c,f,_,v){const T=this._bucketParts;for(;this._currentTileIndex<o.length;)if(c.getBucketParts(T,_,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((S,I)=>S.sortKey-I.sortKey));this._currentPartIndex<T.length;){const S=T[this._currentPartIndex];if(c.placeLayerBucketPart(S,this._seenCrossTileIDs,f,S.symbolInstanceStart===0),this._currentPartIndex++,v())return!0}return!1}}class th{constructor(o,c,f,_,v,T,S,I){this.placement=new dc(o,v,T,S,I),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(o,c,f){const _=s.exported.now(),v=()=>{const T=s.exported.now()-_;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=c[o[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=S)&&(!T.maxzoom||T.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new ul(T)),this._inProgressLayer.continuePlacement(f[T.source],this.placement,this._showCollisionBoxes,T,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const As=512/s.EXTENT/2;class Mr{constructor(o,c,f){this.tileID=o,this.bucketInstanceId=f,this.index=new s.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=o.canonical.x*s.EXTENT,v=o.canonical.y*s.EXTENT;for(let T=0;T<c.length;T++){const{key:S,crossTileID:I,tileAnchorX:z,tileAnchorY:P}=c.get(T),N=Math.floor((_+z)*As),X=Math.floor((v+P)*As);this.index.add(N,X),this.keys.push(S),this.crossTileIDs.push(I)}this.index.finish()}findMatches(o,c,f){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),v=As/Math.pow(2,c.canonical.z-this.tileID.canonical.z),T=c.canonical.x*s.EXTENT,S=c.canonical.y*s.EXTENT;for(let I=0;I<o.length;I++){const z=o.get(I);if(z.crossTileID)continue;const{key:P,tileAnchorX:N,tileAnchorY:X}=z,te=Math.floor((T+N)*v),re=Math.floor((S+X)*v),ne=this.index.range(te-_,re-_,te+_,re+_);for(const ie of ne){const j=this.crossTileIDs[ie];if(this.keys[ie]===P&&!f.has(j)){f.add(j),z.crossTileID=j;break}}}}}class nh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const c=Math.round((o-this.lng)/360);if(c!==0)for(const f in this.indexes){const _=this.indexes[f],v={};for(const T in _){const S=_[T];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),v[S.tileID.key]=S}this.indexes[f]=v}this.lng=o}addBucket(o,c,f){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let v=0;v<c.symbolInstances.length;v++)c.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const _=this.usedCrossTileIDs[o.overscaledZ];for(const v in this.indexes){const T=this.indexes[v];if(Number(v)>o.overscaledZ)for(const S in T){const I=T[S];I.tileID.isChildOf(o)&&I.findMatches(c.symbolInstances,o,_)}else{const S=T[o.scaledTo(Number(v)).key];S&&S.findMatches(c.symbolInstances,o,_)}}for(let v=0;v<c.symbolInstances.length;v++){const T=c.symbolInstances.get(v);T.crossTileID||(T.crossTileID=f.generate(),_.add(T.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Mr(o,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(o,c){for(const f of c.crossTileIDs)this.usedCrossTileIDs[o].delete(f)}removeStaleBuckets(o){let c=!1;for(const f in this.indexes){const _=this.indexes[f];for(const v in _)o[_[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[v]),delete _[v],c=!0)}return c}}class ko{constructor(){this.layerIndexes={},this.crossTileIDs=new nh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,c,f,_){let v=this.layerIndexes[o.id];v===void 0&&(v=this.layerIndexes[o.id]=new rh);let T=!1;const S={};_.name!=="globe"&&v.handleWrapJump(f);for(const I of c){const z=I.getBucket(o);z&&o.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(I.tileID,z,this.crossTileIDs)&&(T=!0),S[z.bucketInstanceId]=!0)}return v.removeStaleBuckets(S)&&(T=!0),T}pruneUnusedLayers(o){const c={};o.forEach(f=>{c[f]=!0});for(const f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}const rs=(d,o)=>s.emitValidationErrors(d,o&&o.filter(c=>c.identifier!=="source.canvas")),pc=s.pick(pn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Xm=s.pick(pn,["setCenter","setZoom","setBearing","setPitch"]),ih={version:8,layers:[],sources:{}},ia={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ao extends s.Evented{constructor(o,c={}){super(),this.map=o,this.dispatcher=new ft(ta(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(o._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new ko,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const f=this;this._rtlTextPluginCallback=ao.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(v,T)=>{if(s.triggerPluginCompletionEvent(v),T&&T.every(S=>S))for(const S in f._sourceCaches){const I=f._sourceCaches[S],z=I.getSource().type;z!=="vector"&&z!=="geojson"||I.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const v=this.getSource(_.sourceId);if(v&&v.vectorLayerIds)for(const T in this._layers){const S=this._layers[T];S.source===v.id&&this._validateLayer(S)}})}loadURL(o,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const f=typeof c.validate=="boolean"?c.validate:!s.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);const _=this.map._requestManager.transformRequest(o,s.ResourceType.Style);this._request=s.getJSON(_,(v,T)=>{this._request=null,v?this.fire(new s.ErrorEvent(v)):T&&this._load(T,f)})}loadJSON(o,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(o,c.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(ih,!1)}_updateLayerCount(o,c){const f=c?1:-1;o.is3D()&&(this._num3DLayers+=f),o.type==="circle"&&(this._numCircleLayers+=f),o.type==="symbol"&&(this._numSymbolLayers+=f)}_load(o,c){if(c&&rs(this,s.validateStyle(o)))return;this._loaded=!0,this.stylesheet=s.clone$1(o),this._updateMapProjection();for(const _ in o.sources)this.addSource(_,o.sources[_],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const f=Ep(this.stylesheet.layers);this._order=f.map(_=>_.id),this._layers={},this._serializedLayers={};for(const _ of f){const v=s.createStyleLayer(_);v.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=v,this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ve(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=function(c,f,_){let v,T,S;const I=s.exported.devicePixelRatio>1?"@2x":"";let z=s.getJSON(f.transformRequest(f.normalizeSpriteURL(c,I,".json"),s.ResourceType.SpriteJSON),(X,te)=>{z=null,S||(S=X,v=te,N())}),P=s.getImage(f.transformRequest(f.normalizeSpriteURL(c,I,".png"),s.ResourceType.SpriteImage),(X,te)=>{P=null,S||(S=X,T=te,N())});function N(){if(S)_(S);else if(v&&T){const X=s.exported.getImageData(T),te={};for(const re in v){const{width:ne,height:ie,x:j,y:ee,sdf:ae,pixelRatio:le,stretchX:ye,stretchY:ve,content:xe}=v[re],Ie=new s.RGBAImage({width:ne,height:ie});s.RGBAImage.copy(X,Ie,{x:j,y:ee},{x:0,y:0},{width:ne,height:ie}),te[re]={data:Ie,pixelRatio:le,sdf:ae,stretchX:ye,stretchY:ve,content:xe}}_(null,te)}}return{cancel(){z&&(z.cancel(),z=null),P&&(P.cancel(),P=null)}}}(o,this.map._requestManager,(c,f)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(f)for(const _ in f)this.imageManager.addImage(_,f[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(o){const c=this.getSource(o.source);if(!c)return;const f=o.sourceLayer;f&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(f)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${c.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const c=[];for(const f of o){const _=this._layers[f];_.type!=="custom"&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped():ia[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(_.length||v.length)&&this._updateWorkerLayers(_,v);for(const T in this._updatedSources){const S=this._updatedSources[T];S==="reload"?this._reloadSource(T):S==="clear"&&this._clearSource(T)}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const f={};for(const _ in this._sourceCaches){const v=this._sourceCaches[_];f[_]=v.used,v.used=!1}for(const _ of this._order){const v=this._layers[_];if(v.recalculate(o,this._availableImages),!v.isHidden(o.zoom)){const S=this._getLayerSourceCache(v);S&&(S.used=!0)}const T=this.map.painter;if(T){const S=v.getProgramIds();if(!S)continue;const I=v.getProgramConfiguration(o.zoom);for(const z of S)T.useProgram(z,I)}}for(const _ in f){const v=this._sourceCaches[_];f[_]!==v.used&&v.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),rs(this,s.validateStyle(o)))return!1;(o=s.clone$1(o)).layers=Ep(o.layers);const c=function(_,v){if(!_)return[{command:pn.setStyle,args:[v]}];let T=[];try{if(!C(_.version,v.version))return[{command:pn.setStyle,args:[v]}];C(_.center,v.center)||T.push({command:pn.setCenter,args:[v.center]}),C(_.zoom,v.zoom)||T.push({command:pn.setZoom,args:[v.zoom]}),C(_.bearing,v.bearing)||T.push({command:pn.setBearing,args:[v.bearing]}),C(_.pitch,v.pitch)||T.push({command:pn.setPitch,args:[v.pitch]}),C(_.sprite,v.sprite)||T.push({command:pn.setSprite,args:[v.sprite]}),C(_.glyphs,v.glyphs)||T.push({command:pn.setGlyphs,args:[v.glyphs]}),C(_.transition,v.transition)||T.push({command:pn.setTransition,args:[v.transition]}),C(_.light,v.light)||T.push({command:pn.setLight,args:[v.light]}),C(_.fog,v.fog)||T.push({command:pn.setFog,args:[v.fog]}),C(_.projection,v.projection)||T.push({command:pn.setProjection,args:[v.projection]});const S={},I=[];(function(N,X,te,re){let ne;for(ne in X=X||{},N=N||{})N.hasOwnProperty(ne)&&(X.hasOwnProperty(ne)||nl(ne,te,re));for(ne in X){if(!X.hasOwnProperty(ne))continue;const ie=X[ne];N.hasOwnProperty(ne)?C(N[ne],ie)||(N[ne].type==="geojson"&&ie.type==="geojson"&&hc(N,X,ne)?te.push({command:pn.setGeoJSONSourceData,args:[ne,ie.data]}):Zu(ne,X,te,re)):Hu(ne,X,te)}})(_.sources,v.sources,I,S);const z=[];_.layers&&_.layers.forEach(N=>{N.source&&S[N.source]?T.push({command:pn.removeLayer,args:[N.id]}):z.push(N)});let P=_.terrain;P&&S[P.source]&&(T.push({command:pn.setTerrain,args:[void 0]}),P=void 0),T=T.concat(I),C(P,v.terrain)||T.push({command:pn.setTerrain,args:[v.terrain]}),function(N,X,te){X=X||[];const re=(N=N||[]).map(So),ne=X.map(So),ie=N.reduce(Xu,{}),j=X.reduce(Xu,{}),ee=re.slice(),ae=Object.create(null);let le,ye,ve,xe,Ie,Ae,Be;for(le=0,ye=0;le<re.length;le++)ve=re[le],j.hasOwnProperty(ve)?ye++:(te.push({command:pn.removeLayer,args:[ve]}),ee.splice(ee.indexOf(ve,ye),1));for(le=0,ye=0;le<ne.length;le++)ve=ne[ne.length-1-le],ee[ee.length-1-le]!==ve&&(ie.hasOwnProperty(ve)?(te.push({command:pn.removeLayer,args:[ve]}),ee.splice(ee.lastIndexOf(ve,ee.length-ye),1)):ye++,Ae=ee[ee.length-le],te.push({command:pn.addLayer,args:[j[ve],Ae]}),ee.splice(ee.length-le,0,ve),ae[ve]=!0);for(le=0;le<ne.length;le++)if(ve=ne[le],xe=ie[ve],Ie=j[ve],!ae[ve]&&!C(xe,Ie))if(C(xe.source,Ie.source)&&C(xe["source-layer"],Ie["source-layer"])&&C(xe.type,Ie.type)){for(Be in oo(xe.layout,Ie.layout,te,ve,null,pn.setLayoutProperty),oo(xe.paint,Ie.paint,te,ve,null,pn.setPaintProperty),C(xe.filter,Ie.filter)||te.push({command:pn.setFilter,args:[ve,Ie.filter]}),C(xe.minzoom,Ie.minzoom)&&C(xe.maxzoom,Ie.maxzoom)||te.push({command:pn.setLayerZoomRange,args:[ve,Ie.minzoom,Ie.maxzoom]}),xe)xe.hasOwnProperty(Be)&&Be!=="layout"&&Be!=="paint"&&Be!=="filter"&&Be!=="metadata"&&Be!=="minzoom"&&Be!=="maxzoom"&&(Be.indexOf("paint.")===0?oo(xe[Be],Ie[Be],te,ve,Be.slice(6),pn.setPaintProperty):C(xe[Be],Ie[Be])||te.push({command:pn.setLayerProperty,args:[ve,Be,Ie[Be]]}));for(Be in Ie)Ie.hasOwnProperty(Be)&&!xe.hasOwnProperty(Be)&&Be!=="layout"&&Be!=="paint"&&Be!=="filter"&&Be!=="metadata"&&Be!=="minzoom"&&Be!=="maxzoom"&&(Be.indexOf("paint.")===0?oo(xe[Be],Ie[Be],te,ve,Be.slice(6),pn.setPaintProperty):C(xe[Be],Ie[Be])||te.push({command:pn.setLayerProperty,args:[ve,Be,Ie[Be]]}))}else te.push({command:pn.removeLayer,args:[ve]}),Ae=ee[ee.lastIndexOf(ve)+1],te.push({command:pn.addLayer,args:[Ie,Ae]})}(z,v.layers,T)}catch(S){console.warn("Unable to compute style diff:",S),T=[{command:pn.setStyle,args:[v]}]}return T}(this.serialize(),o).filter(_=>!(_.command in Xm));if(c.length===0)return!1;const f=c.filter(_=>!(_.command in pc));if(f.length>0)throw new Error(`Unimplemented: ${f.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{_.command!=="setTransition"&&_.command!=="setProjection"&&this[_.command].apply(this,_.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,c){return this.getImage(o)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,c),this._afterImageUpdated(o),this)}updateImage(o,c){this.imageManager.updateImage(o,c)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,c,f={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateSource,`sources.${o}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=Zt(o,c,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:_.serialize(),sourceId:o}));const v=T=>{const S=(T?"symbol:":"other:")+o,I=this._sourceCaches[S]=new s.SourceCache(S,_,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[o]=I,I.style=this,I.onAdd(this.map)};v(!1),c.type!=="vector"&&c.type!=="geojson"||v(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const c=this.getSource(o);if(!c)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const f=this._getSourceCaches(o);for(const _ of f)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,c){this._checkLoaded(),this.getSource(o).setData(c),this._changed=!0}getSource(o){const c=this._getSourceCache(o);return c&&c.getSource()}_getSources(){const o=[];for(const c in this._otherSourceCaches){const f=this._getSourceCache(c);f&&o.push(f.getSource())}return o}addLayer(o,c,f={}){this._checkLoaded();const _=o.id;if(this.getLayer(_))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let v;if(o.type==="custom"){if(rs(this,s.validateCustomStyleLayer(o)))return;v=s.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(_,o.source),o=s.clone$1(o),o=s.extend(o,{source:_})),this._validate(s.validateLayer,`layers.${_}`,o,{arrayIndex:-1},f))return;v=s.createStyleLayer(o),this._validateLayer(v),v.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0)}const T=c?this._order.indexOf(c):this._order.length;if(c&&T===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(T,0,_),this._layerOrderChanged=!0,this._layers[_]=v;const S=this._getLayerSourceCache(v);if(this._removedLayers[_]&&v.source&&S&&v.type!=="custom"){const I=this._removedLayers[_];delete this._removedLayers[_],I.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",S.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,c){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===c)return;const f=this._order.indexOf(o);this._order.splice(f,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(_,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const c=this._layers[o];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const f=this._order.indexOf(o);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const c in this._layers)if(this._layers[c].type===o)return!0;return!1}setLayerZoomRange(o,c,f){this._checkLoaded();const _=this.getLayer(o);_?_.minzoom===c&&_.maxzoom===f||(c!=null&&(_.minzoom=c),f!=null&&(_.maxzoom=f),this._updateLayer(_)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,c,f={}){this._checkLoaded();const _=this.getLayer(o);if(_){if(!C(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(s.validateFilter,`layers.${_.id}.filter`,c,{layerType:_.type},f)||(_.filter=s.clone$1(c),this._updateLayer(_)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const c=this.getLayer(o);return c&&s.clone$1(c.filter)}setLayoutProperty(o,c,f,_={}){this._checkLoaded();const v=this.getLayer(o);v?C(v.getLayoutProperty(c),f)||(v.setLayoutProperty(c,f,_),this._updateLayer(v)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,c){const f=this.getLayer(o);if(f)return f.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,c,f,_={}){this._checkLoaded();const v=this.getLayer(o);v?C(v.getPaintProperty(c),f)||(v.setPaintProperty(c,f,_)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,c){const f=this.getLayer(o);return f&&f.getPaintProperty(c)}setFeatureState(o,c){this._checkLoaded();const f=o.source,_=o.sourceLayer,v=this.getSource(f);if(!v)return void this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const T=v.type;if(T==="geojson"&&_)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(T==="vector"&&!_)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const S=this._getSourceCaches(f);for(const I of S)I.setFeatureState(_,o.id,c)}removeFeatureState(o,c){this._checkLoaded();const f=o.source,_=this.getSource(f);if(!_)return void this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const v=_.type,T=v==="vector"?o.sourceLayer:void 0;if(v==="vector"&&!T)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const S=this._getSourceCaches(f);for(const I of S)I.removeFeatureState(T,o.id,c)}getFeatureState(o){this._checkLoaded();const c=o.source,f=o.sourceLayer,_=this.getSource(c);if(_){if(_.type!=="vector"||f)return o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(f,o.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const c in this._sourceCaches){const f=this._sourceCaches[c].getSource();o[f.id]||(o[f.id]=f.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0;const c=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",c.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const c=T=>this._layers[T].type==="fill-extrusion",f={},_=[];for(let T=this._order.length-1;T>=0;T--){const S=this._order[T];if(c(S)){f[S]=T;for(const I of o){const z=I[S];if(z)for(const P of z)_.push(P)}}}_.sort((T,S)=>S.intersectionZ-T.intersectionZ);const v=[];for(let T=this._order.length-1;T>=0;T--){const S=this._order[T];if(c(S))for(let I=_.length-1;I>=0;I--){const z=_[I].feature;if(f[z.layer.id]<T)break;v.push(z),_.pop()}else for(const I of o){const z=I[S];if(z)for(const P of z)v.push(P.feature)}}return v}queryRenderedFeatures(o,c,f){c&&c.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const I of c.layers){const z=this._layers[I];if(!z)return this.fire(new s.ErrorEvent(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];_[z.source]=!0}}const v=[];c.availableImages=this._availableImages;const T=c&&c.layers?c.layers.some(I=>{const z=this.getLayer(I);return z&&z.is3D()}):this.has3DLayers(),S=Je.createFromScreenPoints(o,f);for(const I in this._sourceCaches){const z=this._sourceCaches[I].getSource().id;c.layers&&!_[z]||v.push(Nn(this._sourceCaches[I],this._layers,this._serializedLayers,S,c,f,T,!!this.map._showQueryGeometry))}return this.placement&&v.push(function(I,z,P,N,X,te,re){const ne={},ie=te.queryRenderedSymbols(N),j=[];for(const ee of Object.keys(ie).map(Number))j.push(re[ee]);j.sort(Rr);for(const ee of j){const ae=ee.featureIndex.lookupSymbolFeatures(ie[ee.bucketInstanceId],z,ee.bucketIndex,ee.sourceLayerIndex,X.filter,X.layers,X.availableImages,I);for(const le in ae){const ye=ne[le]=ne[le]||[],ve=ae[le];ve.sort((xe,Ie)=>{const Ae=ee.featureSortOrder;if(Ae){const Be=Ae.indexOf(xe.featureIndex);return Ae.indexOf(Ie.featureIndex)-Be}return Ie.featureIndex-xe.featureIndex});for(const xe of ve)ye.push(xe)}}for(const ee in ne)ne[ee].forEach(ae=>{const le=ae.feature,ye=P(I[ee]);if(!ye)return;const ve=ye.getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=ve});return ne}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),S.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(o,c){c&&c.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const f=this._getSourceCaches(o);let _=[];for(const v of f)_=_.concat(Qn(v,c));return _}addSourceType(o,c,f){return ao.getSourceType(o)?f(new Error(`A source type called "${o}" already exists.`)):(ao.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(o,c={}){this._checkLoaded();const f=this.light.getLight();let _=!1;for(const T in o)if(!C(o[T],f[T])){_=!0;break}if(!_)return;const v=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,c),this.light.updateTransitions(v)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,c=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let f=o;if(c===1){if(typeof f.source=="object"){const _="terrain-dem-src";this.addSource(_,f.source),f=s.clone$1(f),f=s.extend(f,{source:_})}if(this._validate(s.validateTerrain,"terrain",f))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!f)return;this._createTerrain(f,c)}else{const _=this.terrain,v=_.get();for(const T of Object.keys(s.spec.terrain))!f.hasOwnProperty(T)&&s.spec.terrain[T].default&&(f[T]=s.spec.terrain[T].default);for(const T in f)if(!C(f[T],v[T])){_.set(f),this.stylesheet.terrain=f;const S=this._setTransitionParameters({duration:0});_.updateTransitions(S);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const c=this.fog=new bt(o,this.map.transform);this.stylesheet.fog=o;const f=this._setTransitionParameters({duration:0});c.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,f=c.get();Object.keys(o).length===0&&c.set(o);for(const _ in o)if(!C(o[_],f[_])){c.set(o),this.stylesheet.fog=o;const v=this._setTransitionParameters({duration:0});c.updateTransitions(v);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:s.exported.now(),transition:s.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(f=>this.isLayerDraped(this._layers[f])),c=this._order.filter(f=>!this.isLayerDraped(this._layers[f]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...c)}_createTerrain(o,c){const f=this.terrain=new kt(o,c);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});f.updateTransitions(_)}_force3DLayerUpdate(){for(const o in this._layers){const c=this._layers[o];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const c=this._layers[o];c.type==="symbol"&&this._updateLayer(c)}}_validate(o,c,f,_,v={}){return(!v||v.validate!==!1)&&rs(this,o.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:f,styleSpec:s.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const c=this._getSourceCaches(o);for(const f of c)f.clearTiles()}_reloadSource(o){const c=this._getSourceCaches(o);for(const f of c)f.resume(),f.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const c in this._sourceCaches)this._sourceCaches[c].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const c=this._sourceCaches[o];c.resume(),c.reload()}}_updatePlacement(o,c,f,_,v=!1){let T=!1,S=!1;const I={};for(const z of this._order){const P=this._layers[z];if(P.type!=="symbol")continue;if(!I[P.source]){const X=this._getLayerSourceCache(P);if(!X)continue;I[P.source]=X.getRenderableIds(!0).map(te=>X.getTileByID(te)).sort((te,re)=>re.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(re.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(P,I[P.source],o.center.lng,o.projection);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),v=v||this._layerOrderChanged||f===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(v||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),o.zoom))&&(this.pauseablePlacement=new th(o,this._order,v,c,f,_,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),S=!0),T&&this.pauseablePlacement.placement.setStale()),S||T)for(const z of this._order){const P=this._layers[z];P.type==="symbol"&&this.placement.updateLayerOpacities(P,I[P.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,c,f){this.imageManager.getImages(c.icons,f),this._updateTilesForChangedImages();const _=v=>{v&&v.setDependencies(c.tileID.key,c.type,c.icons)};_(this._otherSourceCaches[c.source]),_(this._symbolSourceCaches[c.source])}getGlyphs(o,c,f){this.glyphManager.getGlyphs(c.stacks,f)}getResource(o,c,f){return s.makeRequest(c,f)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const c=[];return this._otherSourceCaches[o]&&c.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&c.push(this._symbolSourceCaches[o]),c}_isSourceCacheLoaded(o){const c=this._getSourceCaches(o);return c.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):c.every(f=>f.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ao.getSourceType=function(d){return Nt[d]},ao.setSourceType=function(d,o){Nt[d]=o},ao.registerForPluginStateChange=s.registerForPluginStateChange;var oh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Is="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Mo=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,hl=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Do=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let fc={},oa={};const dl=[];sa(oh,dl),sa(Mo,dl),sa(hl,dl),sa(Do,dl),fc=fn("",Mo),oa=fn(Do,hl);const kp=fn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),mc=oh,sh=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var ah={background:fn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:fn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:fn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:fn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:fn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:fn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:fn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:fn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:fn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:fn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:fn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:fn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:fn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:fn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:fn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:fn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:fn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:fn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:fn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:fn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:fn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:fn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:fn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:fn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Is),skyboxGradient:fn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Is),skyboxCapture:fn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:fn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:fn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function sa(d,o){const c=d.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let f of c)if(f=f.trim(),f[0]==="#"&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=f.split(" ");for(const v of _)o.includes(v)||o.push(v)}}function fn(d,o){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},v=[...dl];return sa(d,v),sa(o,v),{fragmentSource:d=d.replace(c,(T,S,I,z,P)=>(_[P]=!0,S==="define"?`
#ifndef HAS_UNIFORM_u_${P}
varying ${I} ${z} ${P};
#else
uniform ${I} ${z} u_${P};
#endif
`:`
#ifdef HAS_UNIFORM_u_${P}
    ${I} ${z} ${P} = u_${P};
#endif
`)),vertexSource:o=o.replace(c,(T,S,I,z,P)=>{const N=z==="float"?"vec2":"vec4",X=P.match(/color/)?"color":N;return _[P]?S==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${I} ${N} a_${P};
varying ${I} ${z} ${P};
#else
uniform ${I} ${z} u_${P};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = a_${P};
#else
    ${I} ${z} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = unpack_mix_${X}(a_${P}, u_${P}_t);
#else
    ${I} ${z} ${P} = u_${P};
#endif
`:S==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${I} ${N} a_${P};
#else
uniform ${I} ${z} u_${P};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${I} ${z} ${P} = a_${P};
#else
    ${I} ${z} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${I} ${z} ${P} = unpack_mix_${X}(a_${P}, u_${P}_t);
#else
    ${I} ${z} ${P} = u_${P};
#endif
`}),staticAttributes:f,usedDefines:v}}class Km{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,c,f,_,v,T,S){this.context=o;let I=this.boundPaintVertexBuffers.length!==_.length;for(let P=0;!I&&P<_.length;P++)this.boundPaintVertexBuffers[P]!==_[P]&&(I=!0);let z=this.boundDynamicVertexBuffers.length!==S.length;for(let P=0;!z&&P<S.length;P++)this.boundDynamicVertexBuffers[P]!==S[P]&&(z=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==f||I||z||this.boundIndexBuffer!==v||this.boundVertexOffset!==T)this.freshBind(c,f,_,v,T,S);else{o.bindVertexArrayOES.set(this.vao);for(const P of S)P&&P.bind();v&&v.dynamicDraw&&v.bind()}}freshBind(o,c,f,_,v,T){let S;const I=o.numAttributes,z=this.context,P=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),S=0,this.boundProgram=o,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=v,this.boundDynamicVertexBuffers=T;else{S=z.currentNumAttributes||0;for(let N=I;N<S;N++)P.disableVertexAttribArray(N)}c.enableAttributes(P,o),c.bind(),c.setVertexAttribPointers(P,o,v);for(const N of f)N.enableAttributes(P,o),N.bind(),N.setVertexAttribPointers(P,o,v);for(const N of T)N&&(N.enableAttributes(P,o),N.bind(),N.setVertexAttribPointers(P,o,v));_&&_.bind(),z.currentNumAttributes=I}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function lh(d,o){const c=Math.pow(2,o.canonical.z),f=o.canonical.y;return[new s.MercatorCoordinate(0,f/c).toLngLat().lat,new s.MercatorCoordinate(0,(f+1)/c).toLngLat().lat]}function Mp(d,o,c,f,_,v,T){const S=d.context,I=S.gl,z=c.fbo;if(!z)return;d.prepareDrawTile();const P=d.useProgram("hillshade");S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,z.colorAttachment.get());const N=((ne,ie,j,ee)=>{const ae=j.paint.get("hillshade-shadow-color"),le=j.paint.get("hillshade-highlight-color"),ye=j.paint.get("hillshade-accent-color");let ve=j.paint.get("hillshade-illumination-direction")*(Math.PI/180);j.paint.get("hillshade-illumination-anchor")==="viewport"&&(ve-=ne.transform.angle);const xe=!ne.options.moving;return{u_matrix:ee||ne.transform.calculateProjMatrix(ie.tileID.toUnwrapped(),xe),u_image:0,u_latrange:lh(0,ie.tileID),u_light:[j.paint.get("hillshade-exaggeration"),ve],u_shadow:ae,u_highlight:le,u_accent:ye}})(d,c,f,d.terrain?o.projMatrix:null);d.prepareDrawProgram(S,P,o.toUnwrapped());const{tileBoundsBuffer:X,tileBoundsIndexBuffer:te,tileBoundsSegments:re}=d.getTileBoundsBuffers(c);P.draw(S,I.TRIANGLES,_,v,T,s.CullFaceMode.disabled,N,f.id,X,te,re)}function ch(d,o,c){if(!o.needsDEMTextureUpload)return;const f=d.context,_=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||d.getTileTexture(c.stride);const v=c.getPixels();o.demTexture?o.demTexture.update(v,{premultiply:!1}):o.demTexture=new s.Texture(f,v,_.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Dp(d,o,c,f,_,v){const T=d.context,S=T.gl;if(!o.dem)return;const I=o.dem;if(T.activeTexture.set(S.TEXTURE1),ch(d,o,I),!o.demTexture)return;o.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const z=I.dim;T.activeTexture.set(S.TEXTURE0);let P=o.fbo;if(!P){const re=new s.Texture(T,{width:z,height:z,data:null},S.RGBA);re.bind(S.LINEAR,S.CLAMP_TO_EDGE),P=o.fbo=T.createFramebuffer(z,z,!0),P.colorAttachment.set(re.texture)}T.bindFramebuffer.set(P.framebuffer),T.viewport.set([0,0,z,z]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:X,tileBoundsSegments:te}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(T,S.TRIANGLES,f,_,v,s.CullFaceMode.disabled,((re,ne)=>{const ie=ne.stride,j=s.create();return s.ortho(j,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(j,j,[0,-s.EXTENT,0]),{u_matrix:j,u_image:1,u_dimension:[ie,ie],u_zoom:re.overscaledZ,u_unpack:ne.unpackVector}})(o.tileID,I),c.id,N,X,te),o.needsHillshadePrepare=!1}const uh=d=>({u_matrix:new s.UniformMatrix4f(d),u_image0:new s.Uniform1i(d),u_skirt_height:new s.Uniform1f(d)}),aa=(d,o)=>({u_matrix:d,u_image0:0,u_skirt_height:o}),gc=(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:c,u_zoom_transition:_,u_merc_center:v,u_image0:0,u_frustum_tl:T,u_frustum_tr:S,u_frustum_br:I,u_frustum_bl:z,u_globe_pos:P,u_globe_radius:N,u_viewport:X,u_grid_matrix:re?Float32Array.from(re):new Float32Array(9),u_skirt_height:te});function la(d,o){return d!=null&&o!=null&&!(!d.hasData()||!o.hasData())&&d.demTexture!=null&&o.demTexture!=null&&d.tileID.key!==o.tileID.key}const Po=new class{constructor(){this.operations={}}newMorphing(d,o,c,f,_){if(d in this.operations){const v=this.operations[d];v.to.tileID.key!==c.tileID.key&&(v.queued=c)}else this.operations[d]={startTime:f,phase:0,duration:_,from:o,to:c,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const o=this.operations[d];return{from:o.from,to:o.to,phase:o.phase}}update(d){for(const o in this.operations){const c=this.operations[o];for(c.phase=(d-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,d)){delete this.operations[o];break}}}_nextOp(d,o){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=o,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},ks={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function _c(d){return 6*Math.pow(1.5,22-d)}function Pp(d,o){const c=1<<d.z;return!o&&(d.x===0||d.x===c-1)||d.y===0||d.y===c-1}const pl=d=>({u_matrix:d});function hh(d,o,c,f,_){if(_>0){const v=s.exported.now(),T=(v-d.timeAdded)/_,S=o?(v-o.timeAdded)/_:-1,I=c.getSource(),z=f.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),P=!o||Math.abs(o.tileID.overscaledZ-z)>Math.abs(d.tileID.overscaledZ-z),N=P&&d.refreshedUponExpiration?1:s.clamp(P?T:1-S,0,1);return d.refreshedUponExpiration&&T>=1&&(d.refreshedUponExpiration=!1),o?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class dh extends s.SourceCache{constructor(o){const c={type:"raster-dem",maxzoom:o.transform.maxZoom},f=new ft(ta(),null),_=Zt("mock-dem",c,f,o.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,c){o.state="loaded",c(null)}}class yc extends s.SourceCache{constructor(o){const c=Zt("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new ft(ta(),null),o.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,c,f){if(o.freezeTileCoverage)return;this.transform=o;const _=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,T)=>{if(v[T.key]="",!this._tiles[T.key]){const S=new s.Tile(T,this._source.tileSize*T.overscaleFactor(),o.tileZoom);S.state="loaded",this._tiles[T.key]=S}return v},{});for(const v in this._tiles)v in _||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(o){const c=this.proxyCachedFBO[o];if(c!==void 0){const f=Object.values(c);this.renderCachePool.push(...f),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class xc extends s.OverscaledTileID{constructor(o,c,f){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=c,this.projMatrix=f}}class ph extends s.Elevation{constructor(o,c){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,_,v]=function(I){const z=new s.StructArrayLayout2i4,P=new s.StructArrayLayout3ui6,N=131;z.reserve(17161),P.reserve(33800);const X=s.EXTENT/128,te=s.EXTENT+X/2,re=te+X;for(let ie=-X;ie<re;ie+=X)for(let j=-X;j<re;j+=X){const ee=j<0||j>te||ie<0||ie>te?24575:0,ae=s.clamp(Math.round(j),0,s.EXTENT),le=s.clamp(Math.round(ie),0,s.EXTENT);z.emplaceBack(ae+ee,le)}const ne=(ie,j)=>{const ee=j*N+ie;P.emplaceBack(ee+1,ee,ee+N),P.emplaceBack(ee+N,ee+N+1,ee+1)};for(let ie=1;ie<129;ie++)for(let j=1;j<129;j++)ne(j,ie);return[0,129].forEach(ie=>{for(let j=0;j<130;j++)ne(j,ie),ne(ie,j)}),[z,P,32768]}(),T=o.context;this.gridBuffer=T.createVertexBuffer(f,s.posAttributes.members),this.gridIndexBuffer=T.createIndexBuffer(_),this.gridSegments=s.SegmentVector.simpleSegment(0,0,f.length,_.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,f.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new yc(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const S=T.gl;this._overlapStencilMode=new s.StencilMode({func:S.GEQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new dh(c.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,c,f){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const _=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const v=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const T=this.getScaledDemTileSize();this.sourceCache.update(c,T,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,v(),this._initializing=!0),v(),c.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=c.getIds().map(I=>{const z=c.getTileByID(I).tileID;return z.projMatrix=f.calculateProjMatrix(z.toUnwrapped()),z});(function(I,z){const P=z.transform.pointCoordinate(z.transform.getCameraPoint()),N=new s.Point(P.x,P.y);I.sort((X,te)=>{if(te.overscaledZ-X.overscaledZ)return te.overscaledZ-X.overscaledZ;const re=new s.Point(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ne=new s.Point(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),ie=N.mult(1<<X.canonical.z);return ie.x-=.5,ie.y-=.5,ie.distSqr(re)-ie.distSqr(ne)})})(_,this.painter),this._previousZoom=f.zoom;const v=this.proxyToSource||{};this.proxyToSource={},_.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const T=this._style._sourceCaches;for(const I in T){const z=T[I];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,o[I],v),z.usedForTerrain))continue;const P=o[I];z.getSource().reparseOverscaled&&this._assignTerrainTiles(P)}this.proxiedCoords[c.id]=_.map(I=>new xc(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const S={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const z=this.terrainTileForTile[I.key];if(!z)continue;const P=z.tileID.key;P in S||(this._visibleDemTiles.push(z),S[P]=P)}}_assignTerrainTiles(o){this._initializing||o.forEach(c=>{if(this.terrainTileForTile[c.key])return;const f=this._findTileCoveringTileID(c,this.sourceCache);f&&(this.terrainTileForTile[c.key]=f)})}_prepareDEMTextures(){const o=this.painter.context,c=o.gl;for(const f in this.terrainTileForTile){const _=this.terrainTileForTile[f],v=_.dem;!v||_.demTexture&&!_.needsDEMTextureUpload||(o.activeTexture.set(c.TEXTURE1),ch(this.painter,_,v))}}_prepareDemTileUniforms(o,c,f,_){if(!c||c.demTexture==null)return!1;const v=o.tileID.canonical,T=Math.pow(2,c.tileID.canonical.z-v.z),S=_||"";return f[`u_dem_tl${S}`]=[v.x*T%1,v.y*T%1],f[`u_dem_scale${S}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,c=o.gl;if(!this._emptyDepthBufferTexture){const f=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(o,f,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const c=this._visibleDemTiles.reduce((f,_)=>{if(!_.dem)return f;const v=_.dem.tree.minimums[0];return v>0&&o++,f+v},0);return o?c/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,c=o.gl;o.activeTexture.set(c.TEXTURE2);const f=this._getLoadedAreaMinimum(),_=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(f,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(_,{premultiply:!1}):v=this._emptyDEMTexture=new s.Texture(o,_,c.RGBA,{premultiply:!1}),v}setupElevationDraw(o,c,f){const _=this.painter.context,v=_.gl,T=(S=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(S),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var S;T.u_dem_size=this.sourceCache.getSource().tileSize,T.u_exaggeration=this.exaggeration();let I=null,z=null,P=1;if(f&&f.morphing&&this._useVertexMorphing){const N=f.morphing.srcDemTile,X=f.morphing.dstDemTile;P=f.morphing.phase,N&&X&&(this._prepareDemTileUniforms(o,N,T,"_prev")&&(z=N),this._prepareDemTileUniforms(o,X,T)&&(I=X))}if(z&&I?(_.activeTexture.set(v.TEXTURE2),I.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),_.activeTexture.set(v.TEXTURE4),z.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),T.u_dem_lerp=P):(I=this.terrainTileForTile[o.tileID.key],_.activeTexture.set(v.TEXTURE2),(this._prepareDemTileUniforms(o,I,T)?I.demTexture:this.emptyDEMTexture).bind(v.NEAREST,v.CLAMP_TO_EDGE)),_.activeTexture.set(v.TEXTURE3),f&&f.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),f&&f.useMeterToDem&&I){const N=(1<<I.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=N}if(f&&f.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),c.setTerrainUniformValues(_,T),this.painter.transform.projection.name==="globe"){const N=this.globeUniformValues(this.painter.transform,o.tileID.canonical,f&&f.useDenormalizedUpVectorScale);c.setGlobeUniformValues(_,N)}}globeUniformValues(o,c,f){const _=o.projection;return{u_tile_tl_up:_.upVector(c,0,0),u_tile_tr_up:_.upVector(c,s.EXTENT,0),u_tile_br_up:_.upVector(c,s.EXTENT,s.EXTENT),u_tile_bl_up:_.upVector(c,0,s.EXTENT),u_tile_up_scale:f?s.globeMetersToEcef(1):_.upVectorScale(c,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const c=this.painter,f=this.painter.context;o.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,v,T,S,I){if(_.transform.projection.name==="globe")(function(z,P,N,X,te){const re=z.context,ne=re.gl;let ie,j;const ee=z.options.showTerrainWireframe?2:0,ae=z.transform,le=s.globeUseCustomAntiAliasing(z,re,ae),ye=(rt,ze)=>{if(j===rt)return;const He=[ks[rt],"PROJECTION_GLOBE_VIEW"];le&&He.push("CUSTOM_ANTIALIASING"),ze&&He.push(ks[ee]),ie=z.useProgram("globeRaster",null,He),j=rt},ve=z.colorModeForRenderPass(),xe=new s.DepthMode(ne.LEQUAL,s.DepthMode.ReadWrite,z.depthRangeFor3D);Po.update(te);const Ie=s.calculateGlobeMercatorMatrix(ae),Ae=[s.mercatorXfromLng(ae.center.lng),s.mercatorYfromLat(ae.center.lat)],Be=ee?[!1,!0]:[!1],it=z.globeSharedBuffers,De=[ae.width*s.exported.devicePixelRatio,ae.height*s.exported.devicePixelRatio],Ze=Float32Array.from(ae.globeMatrix),Fe={useDenormalizedUpVectorScale:!0};if(Be.forEach(rt=>{const ze=z.transform,He=_c(ze.zoom)*P.exaggeration();j=-1;const at=rt?ne.LINES:ne.TRIANGLES;for(const Qe of X){const lt=N.getTile(Qe),At=s.StencilMode.disabled,Ft=P.prevTerrainTileForTile[Qe.key],Et=P.terrainTileForTile[Qe.key];la(Ft,Et)&&Po.newMorphing(Qe.key,Ft,Et,te,250),re.activeTexture.set(ne.TEXTURE0),lt.texture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);const zt=Po.getMorphValuesForProxy(Qe.key),Jt=zt?1:0;zt&&s.extend$1(Fe,{morphing:{srcDemTile:zt.from,dstDemTile:zt.to,phase:s.easeCubicInOut(zt.phase)}});const Xt=s.tileCornersToBounds(Qe.canonical),Ct=s.getLatitudinalLod(Xt.getCenter().lat),gn=s.getGridMatrix(Qe.canonical,Xt,Ct,ze.worldSize/ze._pixelsPerMercatorPixel),vn=s.globeNormalizeECEF(s.globeTileBounds(Qe.canonical)),wn=gc(ze.projMatrix,Ze,Ie,vn,s.globeToMercatorTransition(ze.zoom),Ae,ze.frustumCorners.TL,ze.frustumCorners.TR,ze.frustumCorners.BR,ze.frustumCorners.BL,ze.globeCenterInViewSpace,ze.globeRadius,De,He,gn);if(ye(Jt,rt),P.setupElevationDraw(lt,ie,Fe),z.prepareDrawProgram(re,ie,Qe.toUnwrapped()),it){const[bn,Or,Er]=rt?it.getWirefameBuffers(z.context,Ct):it.getGridBuffers(Ct,He!==0);ie.draw(re,at,xe,At,ve,s.CullFaceMode.backCCW,wn,"globe_raster",bn,Or,Er)}}}),it){const rt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];le&&rt.push("CUSTOM_ANTIALIASING"),ie=z.useProgram("globeRaster",null,rt);for(const ze of X){const{x:He,y:at,z:Qe}=ze.canonical,lt=at===0,At=at===(1<<Qe)-1,[Ft,Et,zt,Jt]=it.getPoleBuffers(Qe);if(Jt&&(lt||At)){const Xt=N.getTile(ze);re.activeTexture.set(ne.TEXTURE0),Xt.texture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);let Ct=s.globePoleMatrixForTile(Qe,He,ae);const gn=s.globeNormalizeECEF(s.globeTileBounds(ze.canonical)),vn=(wn,bn)=>wn.draw(re,ne.TRIANGLES,xe,s.StencilMode.disabled,ve,s.CullFaceMode.disabled,gc(ae.projMatrix,Ct,Ct,gn,0,Ae,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,De,0),"globe_pole_raster",bn,zt,Jt);P.setupElevationDraw(Xt,ie,Fe),z.prepareDrawProgram(re,ie,ze.toUnwrapped()),lt&&vn(ie,Ft),At&&(Ct=s.scale(s.create(),Ct,[1,-1,1]),vn(ie,Et))}}}})(_,v,T,S,I);else{const z=_.context,P=z.gl;let N,X;const te=_.options.showTerrainWireframe?2:0,re=(ae,le)=>{if(X===ae)return;const ye=[ks[ae]];le&&ye.push(ks[te]),N=_.useProgram("terrainRaster",null,ye),X=ae},ne=_.colorModeForRenderPass(),ie=new s.DepthMode(P.LEQUAL,s.DepthMode.ReadWrite,_.depthRangeFor3D);Po.update(I);const j=_.transform,ee=_c(j.zoom)*v.exaggeration();(te?[!1,!0]:[!1]).forEach(ae=>{X=-1;const le=ae?P.LINES:P.TRIANGLES,[ye,ve]=ae?v.getWirefameBuffer():[v.gridIndexBuffer,v.gridSegments];for(const xe of S){const Ie=T.getTile(xe),Ae=s.StencilMode.disabled,Be=v.prevTerrainTileForTile[xe.key],it=v.terrainTileForTile[xe.key];la(Be,it)&&Po.newMorphing(xe.key,Be,it,I,250),z.activeTexture.set(P.TEXTURE0),Ie.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST);const De=Po.getMorphValuesForProxy(xe.key),Ze=De?1:0;let Fe;De&&(Fe={morphing:{srcDemTile:De.from,dstDemTile:De.to,phase:s.easeCubicInOut(De.phase)}});const rt=aa(xe.projMatrix,Pp(xe.canonical,j.renderWorldCopies)?ee/10:ee);re(Ze,ae),v.setupElevationDraw(Ie,N,Fe),_.prepareDrawProgram(z,N,xe.toUnwrapped()),N.draw(z,le,ie,Ae,ne,s.CullFaceMode.backCCW,rt,"terrain_raster",v.gridBuffer,ye,ve)}})}}(c,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const c=this.painter,f=this.painter.context,_=this.proxySourceCache,v=this.proxiedCoords[_.id],T=this._drapedRenderBatches.shift(),S=[],I=c.style.order;let z=0;for(const P of v){const N=_.getTileByID(P.proxyTileKey),X=_.proxyCachedFBO[P.key]?_.proxyCachedFBO[P.key][o]:void 0,te=X!==void 0?_.renderCache[X]:this.pool[z++],re=X!==void 0;if(N.texture=te.tex,re&&!te.dirty){S.push(N.tileID);continue}let ne;f.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(f.clear({color:s.Color.transparent,stencil:0}),te.dirty=!1);for(let ie=T.start;ie<=T.end;++ie){const j=c.style._layers[I[ie]];if(j.isHidden(c.transform.zoom))continue;const ee=c.style._getLayerSourceCache(j),ae=ee?this.proxyToSource[P.key][ee.id]:[P];if(!ae)continue;const le=ae;f.viewport.set([0,0,te.fb.width,te.fb.height]),ne!==(ee?ee.id:null)&&(this._setupStencil(te,ae,j,ee),ne=ee?ee.id:null),c.renderLayer(c,ee,j,le)}this.renderedToTile?(te.dirty=!0,S.push(N.tileID)):re||--z,z===5&&(z=0,this.renderToBackBuffer(S))}return this.renderToBackBuffer(S),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),T.end+1}postRender(){}renderCacheEfficiency(o){const c=o.order.length;if(c===0)return{efficiency:100};let f,_=0,v=0,T=!1;for(let S=0;S<c;++S){const I=o._layers[o.order[S]];this._style.isLayerDraped(I)?(T&&++_,++v):T||(T=!0,f=I.id)}return v===0?{efficiency:100}:{efficiency:100*(1-_/v),firstUndrapedLayer:f}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{o=Math.min(o,c.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,c,f){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const T=v.tileID,S=1<<T.overscaledZ,{x:I,y:z}=T.canonical,P=I/S,N=(I+1)/S,X=z/S,te=(z+1)/S;return{minx:P,miny:X,maxx:N,maxy:te,t:v.dem.tree.raycastRoot(P,X,N,te,o,c,f),tile:v}});_.sort((v,T)=>(v.t!==null?v.t:Number.MAX_VALUE)-(T.t!==null?T.t:Number.MAX_VALUE));for(const v of _){if(v.t==null)return null;const T=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,o,c,f);if(T!=null)return T}return null}_createFBO(){const o=this.painter.context,c=o.gl,f=this.drapeBufferSize;o.activeTexture.set(c.TEXTURE0);const _=new s.Texture(o,{width:f[0],height:f[1],data:null},c.RGBA);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);const v=o.createFramebuffer(f[0],f[1],!1);return v.colorAttachment.set(_.texture),v.depthAttachment=new be(o,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:v,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const c=this._style._layers[o],f=c.isHidden(this.painter.transform.zoom);return c.type==="custom"?!f&&c.shouldRedrape():!f&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const f of this._style._getSources())if(f instanceof dt){o=!0;break}if(!o)return;const c={};for(let f=0;f<this._style.order.length;++f){const _=this._style._layers[this._style.order[f]],v=this._style._getLayerSourceCache(_);if(v&&!c[v.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof s.ZoomDependentExpression){c[v.id]=!0;for(const T of this.proxyCoords){const S=this.proxyToSource[T.key][v.id];if(S)for(const I of S)this._clearRenderCacheForTile(v.id,I)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f]._source instanceof st){o=!0;break}if(!o)return;const c={};for(let f=0;f<this._style.order.length;++f){const _=this._style._layers[this._style.order[f]],v=this._style._getLayerSourceCache(_);if(!v||c[v.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const T=_.paint.get("raster-fade-duration");for(const S of this.proxyCoords){const I=this.proxyToSource[S.key][v.id];if(I)for(const z of I){const P=hh(v.getTile(z),v.findLoadedParent(z,0),v,this.painter.transform,T);(P.opacity!==1||P.mix!==0)&&this._clearRenderCacheForTile(v.id,z)}}}}_setupDrapedRenderBatches(){const o=this._style.order,c=o.length;if(c===0)return;const f=[];let _,v=0,T=this._style._layers[o[v]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++v<c;)T=this._style._layers[o[v]];for(;v<c;++v){const S=this._style._layers[o[v]];S.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(S)?_===void 0&&(_=v):_!==void 0&&(f.push({start:_,end:v-1}),_=void 0))}_!==void 0&&f.push({start:_,end:v-1}),this._drapedRenderBatches=f}_setupRenderCache(o){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const T=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let S=0;S<T.length;++S){const I=Object.values(T[S]);c.renderCachePool.push(...I)}}return}this._clearRasterLayersFromRenderCache();const f=this.proxyCoords,_=this._tilesDirty;for(let T=f.length-1;T>=0;T--){const S=f[T];if(c.getTileByID(S.key),c.proxyCachedFBO[S.key]!==void 0){const I=o[S.key],z=this.proxyToSource[S.key];let P=0;for(const N in z){const X=z[N],te=I[N];if(!te||te.length!==X.length||X.some((re,ne)=>re!==te[ne]||_[N]&&_[N].hasOwnProperty(re.key))){P=-1;break}++P}for(const N in c.proxyCachedFBO[S.key])c.renderCache[c.proxyCachedFBO[S.key][N]].dirty=P<0||P!==Object.values(I).length}}const v=[...this._drapedRenderBatches];v.sort((T,S)=>S.end-S.start-(T.end-T.start));for(const T of v)for(const S of f){if(c.proxyCachedFBO[S.key])continue;let I=c.renderCachePool.pop();I===void 0&&c.renderCache.length<50&&(I=c.renderCache.length,c.renderCache.push(this._createFBO())),I!==void 0&&(c.proxyCachedFBO[S.key]={},c.proxyCachedFBO[S.key][T.start]=I,c.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(o,c,f,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,T=v.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let S;if(f.isTileClipped())S=c.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);S=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+S>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=S,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(o,c){const f=this.painter,_=this.painter.context,v=_.gl;f._tileClippingMaskIDs={},_.setColorMode(s.ColorMode.disabled),_.setDepthMode(s.DepthMode.disabled);const T=f.useProgram("clippingMask");for(const S of o){const I=f._tileClippingMaskIDs[S.key]=--c;T.draw(_,v.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:v.ALWAYS,mask:0},I,255,v.KEEP,v.KEEP,v.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,pl(S.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(o){const c=this.painter.transform;if(o.x<0||o.x>c.width||o.y<0||o.y>c.height)return null;const f=[o.x,o.y,1,1];s.transformMat4$1(f,f,c.pixelMatrixInverse),s.scale$1(f,f,1/f[3]),f[0]/=c.worldSize,f[1]/=c.worldSize;const _=c._camera.position,v=s.mercatorZfromAltitude(1,c.center.lat),T=[_[0],_[1],_[2]/v,0],S=s.subtract([],f.slice(0,3),T);s.normalize(S,S);const I=this.raycast(T,S,this._exaggeration);return I!==null&&I?(s.scaleAndAdd(T,T,S,I),T[3]=T[2],T[2]*=v,T):null}drawDepth(){const o=this.painter,c=o.context,f=this.proxySourceCache,_=Math.ceil(o.width),v=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===v||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=c.gl,S=c.createFramebuffer(_,v,!0);c.activeTexture.set(T.TEXTURE0);const I=new s.Texture(c,{width:_,height:v,data:null},T.RGBA);I.bind(T.NEAREST,T.CLAMP_TO_EDGE),S.colorAttachment.set(I.texture);const z=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,_,v);S.depthAttachment.set(z),this._depthFBO=S,this._depthTexture=I}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,_,v]),function(T,S,I,z){if(T.transform.projection.name==="globe")return;const P=T.context,N=P.gl;P.clear({depth:1});const X=T.useProgram("terrainDepth"),te=new s.DepthMode(N.LESS,s.DepthMode.ReadWrite,T.depthRangeFor3D);for(const re of z){const ne=I.getTile(re),ie=aa(re.projMatrix,0);S.setupElevationDraw(ne,X),X.draw(P,N.TRIANGLES,te,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,ie,"terrain_depth",S.gridBuffer,S.gridIndexBuffer,S.gridNoSkirtSegments)}}(o,this,f,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,c,f){if(o.getSource()instanceof Lt)return this._setupProxiedCoordsForImageSource(o,c,f);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const _=this.proxiedCoords[o.id]=[],v=this.proxyCoords;for(let S=0;S<v.length;S++){const I=v[S],z=this._findTileCoveringTileID(I,o);if(z){const P=this._createProxiedId(I,z,f[I.key]&&f[I.key][o.id]);_.push(P),this.proxyToSource[I.key][o.id]=[P]}}let T=!1;for(let S=0;S<c.length;S++){const I=o.getTile(c[S]);if(!I||!I.hasData())continue;const z=this._findTileCoveringTileID(I.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==I.tileID.canonical.z){const P=this.proxyToSource[z.tileID.key][o.id],N=this._createProxiedId(z.tileID,I,f[z.tileID.key]&&f[z.tileID.key][o.id]);P?P.splice(P.length-1,0,N):this.proxyToSource[z.tileID.key][o.id]=[N],_.push(N),T=!0}}this._sourceTilesOverlap[o.id]=T}_setupProxiedCoordsForImageSource(o,c,f){if(!o.getSource().loaded())return;const _=this.proxiedCoords[o.id]=[],v=this.proxyCoords,T=o.getSource(),S=new s.Point(T.tileID.x,T.tileID.y)._div(1<<T.tileID.z),I=T.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((P,N)=>(P.min.x=Math.min(P.min.x,N.x-S.x),P.min.y=Math.min(P.min.y,N.y-S.y),P.max.x=Math.max(P.max.x,N.x-S.x),P.max.y=Math.max(P.max.y,N.y-S.y),P),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(P,N)=>{const X=P.wrap+P.canonical.x/(1<<P.canonical.z),te=P.canonical.y/(1<<P.canonical.z),re=s.EXTENT/(1<<P.canonical.z),ne=N.wrap+N.canonical.x/(1<<N.canonical.z),ie=N.canonical.y/(1<<N.canonical.z);return X+re<ne+I.min.x||X>ne+I.max.x||te+re<ie+I.min.y||te>ie+I.max.y};for(let P=0;P<v.length;P++){const N=v[P];for(let X=0;X<c.length;X++){const te=o.getTile(c[X]);if(!te||!te.hasData()||z(N,te.tileID))continue;const re=this._createProxiedId(N,te,f[N.key]&&f[N.key][o.id]),ne=this.proxyToSource[N.key][o.id];ne?ne.push(re):this.proxyToSource[N.key][o.id]=[re],_.push(re)}}}_createProxiedId(o,c,f){let _=this.orthoMatrix;if(f){const v=f.find(T=>T.key===c.tileID.key);if(v)return v}if(c.tileID.key!==o.key){const v=o.canonical.z-c.tileID.canonical.z;let T,S,I;_=s.create();const z=c.tileID.wrap-o.wrap<<o.overscaledZ;v>0?(T=s.EXTENT>>v,S=T*((c.tileID.canonical.x<<v)-o.canonical.x+z),I=T*((c.tileID.canonical.y<<v)-o.canonical.y)):(T=s.EXTENT<<-v,S=s.EXTENT*(c.tileID.canonical.x-(o.canonical.x+z<<-v)),I=s.EXTENT*(c.tileID.canonical.y-(o.canonical.y<<-v))),s.ortho(_,0,T,0,T,0,1),s.translate(_,_,[S,I,0])}return new xc(c.tileID,o.key,_)}_findTileCoveringTileID(o,c){let f=c.getTile(o);if(f&&f.hasData())return f;const _=this._findCoveringTileCache[c.id],v=_[o.key];if(f=v?c.getTileByID(v):null,f&&f.hasData()||v===null)return f;let T=f?f.tileID:o,S=T.overscaledZ;const I=c.getSource().minzoom,z=[];if(!v){const N=c.getSource().maxzoom;if(o.canonical.z>=N){const X=o.canonical.z-N;c.getSource().reparseOverscaled?(S=Math.max(o.canonical.z+2,c.transform.tileZoom),T=new s.OverscaledTileID(S,o.wrap,N,o.canonical.x>>X,o.canonical.y>>X)):X!==0&&(S=N,T=new s.OverscaledTileID(S,o.wrap,N,o.canonical.x>>X,o.canonical.y>>X))}T.key!==o.key&&(z.push(T.key),f=c.getTile(T))}const P=N=>{z.forEach(X=>{_[X]=N}),z.length=0};for(S-=1;S>=I&&(!f||!f.hasData());S--){f&&P(f.tileID.key);const N=T.calculateScaledKey(S);if(f=c.getTileByID(N),f&&f.hasData())break;const X=_[N];if(X===null)break;X===void 0?z.push(N):f=c.getTileByID(X)}return P(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,c){let f=this._tilesDirty[o];f||(f=this._tilesDirty[o]={}),f[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(c){let f=0;const _=new s.StructArrayLayout2ui4,v=131;for(let T=1;T<129;T++){for(let S=1;S<129;S++)f=T*v+S,_.emplaceBack(f,f+1),_.emplaceBack(f,f+v),_.emplaceBack(f+1,f+v),T===128&&_.emplaceBack(f+v,f+v+1);_.emplaceBack(f+1,f+1+v)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class rn{static cacheKey(o,c,f,_){let v=`${c}${_?_.cacheKey:""}`;for(const T of f)o.usedDefines.includes(T)&&(v+=`/${T}`);return v}constructor(o,c,f,_,v,T){const S=o.gl;this.program=S.createProgram();const I=function(j){const ee=[];for(let ae=0;ae<j.length;ae++){if(j[ae]===null)continue;const le=j[ae].split(" ");ee.push(le.pop())}return ee}(f.staticAttributes),z=_?_.getBinderAttributes():[],P=I.concat(z);let N=_?_.defines():[];N=N.concat(T.map(j=>`#define ${j}`));const X=o.isWebGL2?`#version 300 es
`:"",te=X+N.concat(o.extStandardDerivatives&&X.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(sh):sh,sh,mc,kp.fragmentSource,oa.fragmentSource,f.fragmentSource).join(`
`),re=X+N.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,mc,kp.vertexSource,oa.vertexSource,fc.vertexSource,f.vertexSource).join(`
`),ne=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(ne,te),S.compileShader(ne),S.attachShader(this.program,ne);const ie=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(ie,re),S.compileShader(ie),S.attachShader(this.program,ie),this.attributes={},this.numAttributes=P.length;for(let j=0;j<this.numAttributes;j++)P[j]&&(S.bindAttribLocation(this.program,j,P[j]),this.attributes[P[j]]=j);S.linkProgram(this.program),S.deleteShader(ie),S.deleteShader(ne),this.fixedUniforms=v(o),this.binderUniforms=_?_.getUniforms(o):[],T.includes("TERRAIN")&&(this.terrainUniforms=(j=>({u_dem:new s.Uniform1i(j),u_dem_prev:new s.Uniform1i(j),u_dem_unpack:new s.Uniform4f(j),u_dem_tl:new s.Uniform2f(j),u_dem_scale:new s.Uniform1f(j),u_dem_tl_prev:new s.Uniform2f(j),u_dem_scale_prev:new s.Uniform1f(j),u_dem_size:new s.Uniform1f(j),u_dem_lerp:new s.Uniform1f(j),u_exaggeration:new s.Uniform1f(j),u_depth:new s.Uniform1i(j),u_depth_size_inv:new s.Uniform2f(j),u_meter_to_dem:new s.Uniform1f(j),u_label_plane_matrix_inv:new s.UniformMatrix4f(j)}))(o)),T.includes("GLOBE")&&(this.globeUniforms=(j=>({u_tile_tl_up:new s.Uniform3f(j),u_tile_tr_up:new s.Uniform3f(j),u_tile_br_up:new s.Uniform3f(j),u_tile_bl_up:new s.Uniform3f(j),u_tile_up_scale:new s.Uniform1f(j)}))(o)),T.includes("FOG")&&(this.fogUniforms=(j=>({u_fog_matrix:new s.UniformMatrix4f(j),u_fog_range:new s.Uniform2f(j),u_fog_color:new s.Uniform4f(j),u_fog_horizon_blend:new s.Uniform1f(j),u_fog_temporal_offset:new s.Uniform1f(j),u_frustum_tl:new s.Uniform3f(j),u_frustum_tr:new s.Uniform3f(j),u_frustum_br:new s.Uniform3f(j),u_frustum_bl:new s.Uniform3f(j),u_globe_pos:new s.Uniform3f(j),u_globe_radius:new s.Uniform1f(j),u_globe_transition:new s.Uniform1f(j),u_is_globe:new s.Uniform1i(j),u_viewport:new s.Uniform2f(j)}))(o))}}setTerrainUniformValues(o,c){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const _ in c)f[_]&&f[_].set(this.program,_,c[_])}}setGlobeUniformValues(o,c){if(!this.globeUniforms)return;const f=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const _ in c)f[_]&&f[_].set(this.program,_,c[_])}}setFogUniformValues(o,c){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const _ in c)f[_].set(this.program,_,c[_])}}draw(o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne){const ie=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(f),o.setStencilMode(_),o.setColorMode(v),o.setCullFace(T);for(const ee of Object.keys(this.fixedUniforms))this.fixedUniforms[ee].set(this.program,ee,S[ee]);re&&re.setUniforms(this.program,o,this.binderUniforms,X,{zoom:te});const j={[ie.LINES]:2,[ie.TRIANGLES]:3,[ie.LINE_STRIP]:1}[c];for(const ee of N.get()){const ae=ee.vaos||(ee.vaos={});(ae[I]||(ae[I]=new Km)).bind(o,this,z,re?re.getPaintVertexBuffers():[],P,ee.vertexOffset,ne||[]),ie.drawElements(c,ee.primitiveLength*j,ie.UNSIGNED_SHORT,ee.primitiveOffset*j*2)}}}function fl(d,o){const c=Math.pow(2,o.tileID.overscaledZ),f=o.tileSize*Math.pow(2,d.transform.tileZoom)/c,_=f*(o.tileID.canonical.x+o.tileID.wrap*c),v=f*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/je(o,1,d.transform.tileZoom),u_pixel_coord_upper:[_>>16,v>>16],u_pixel_coord_lower:[65535&_,65535&v]}}const zp=s.create(),fh=(d,o,c,f,_,v,T,S,I,z,P)=>{const N=o.style.light,X=N.properties.get("position"),te=[X.x,X.y,X.z],re=s.create$1();N.properties.get("anchor")==="viewport"&&(s.fromRotation(re,-o.transform.angle),s.transformMat3(te,te,re));const ne=N.properties.get("color"),ie=o.transform,j={u_matrix:d,u_lightpos:te,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[ne.r,ne.g,ne.b],u_vertical_gradient:+c,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:zp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:v};return ie.projection.name==="globe"&&(j.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],j.u_zoom_transition=I,j.u_inv_rot_matrix=P,j.u_merc_center=z,j.u_up_dir=ie.projection.upVector(new s.CanonicalTileID(0,0,0),z[0]*s.EXTENT,z[1]*s.EXTENT),j.u_height_lift=S),j},Bp=(d,o,c,f,_,v,T,S,I,z,P,N)=>{const X=fh(d,o,c,f,_,v,T,I,z,P,N),te={u_height_factor:-Math.pow(2,T.overscaledZ)/S.tileSize/8};return s.extend(X,fl(o,S),te)},Ms=d=>({u_matrix:d}),mh=(d,o,c)=>s.extend(Ms(d),fl(o,c)),Ym=(d,o)=>({u_matrix:d,u_world:o}),Jm=(d,o,c,f)=>s.extend(mh(d,o,c),{u_world:f}),Qm=s.create(),gh=(d,o,c,f,_,v)=>{const T=d.transform,S=T.projection.name==="globe";let I;if(v.paint.get("circle-pitch-alignment")==="map")if(S){const P=s.globePixelsToTileUnits(T.zoom,o.canonical)*T._pixelsPerMercatorPixel;I=Float32Array.from([P,0,0,P])}else I=T.calculatePixelsToTileUnitsMatrix(c);else I=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:T.cameraToCenterDistance,u_matrix:d.translatePosMatrix(o.projMatrix,c,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:I,u_inv_rot_matrix:Qm,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(S){z.u_inv_rot_matrix=f,z.u_merc_center=_,z.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],z.u_zoom_transition=s.globeToMercatorTransition(T.zoom);const P=_[0]*s.EXTENT,N=_[1]*s.EXTENT;z.u_up_dir=T.projection.upVector(new s.CanonicalTileID(0,0,0),P,N)}return z},_h=d=>{const o=[];return d.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},yh=(d,o,c,f)=>{const _=s.EXTENT/c.tileSize;return{u_matrix:d,u_camera_to_center_distance:o.getCameraToCenterDistance(f),u_extrude_scale:[o.pixelsToGLUnits[0]/_,o.pixelsToGLUnits[1]/_]}},vc=(d,o,c=1)=>({u_matrix:d,u_color:o,u_overlay:0,u_overlay_scale:c}),Lp=s.create(),Rp=(d,o,c,f,_,v,T)=>{const S=d.transform,I=S.projection.name==="globe",z=I?s.globePixelsToTileUnits(S.zoom,o.canonical)*S._pixelsPerMercatorPixel:je(c,1,v),P={u_matrix:o.projMatrix,u_extrude_scale:z,u_intensity:T,u_inv_rot_matrix:Lp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){P.u_inv_rot_matrix=f,P.u_merc_center=_,P.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],P.u_zoom_transition=s.globeToMercatorTransition(S.zoom);const N=_[0]*s.EXTENT,X=_[1]*s.EXTENT;P.u_up_dir=S.projection.upVector(new s.CanonicalTileID(0,0,0),N,X)}return P},eg=(d,o,c,f,_,v,T)=>{const S=d.transform,I=S.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:xh(d,o,c,f),u_pixels_to_tile_units:I,u_device_pixel_ratio:v,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:gl(c)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ca(o,d.transform),u_alpha_discard_threshold:0,u_trim_offset:T}},ml=(d,o,c,f,_)=>{const v=d.transform;return{u_matrix:xh(d,o,c,f),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:ca(o,v),u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ca(d,o){return 1/je(d,1,o.tileZoom)}function xh(d,o,c,f){return d.translatePosMatrix(f||o.tileID.projMatrix,o,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function gl(d){const o=d.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const vh=(d,o,c,f,_,v)=>{return{u_matrix:d,u_tl_parent:o,u_scale_parent:c,u_fade_t:f.mix,u_opacity:f.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(T=_.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:lo(_.paint.get("raster-hue-rotate")),u_perspective_transform:v};var T,S};function lo(d){d*=Math.PI/180;const o=Math.sin(d),c=Math.cos(d);return[(2*c+1)/3,(-Math.sqrt(3)*o-c+1)/3,(Math.sqrt(3)*o-c+1)/3]}const wc=s.create(),wh=(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne)=>{const ie=_.transform,j={u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ie.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:ie.width/ie.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:T,u_coord_matrix:S,u_is_text:+I,u_pitch_with_map:+f,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:wc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:wc,u_up_vector:[0,-1,0]};return ne.name==="globe"&&(j.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],j.u_zoom_transition=N,j.u_inv_rot_matrix=te,j.u_merc_center=X,j.u_camera_forward=ie._camera.forward(),j.u_ecef_origin=s.globeECEFOrigin(ie.globeMatrix,P.toUnwrapped()),j.u_tile_matrix=Float32Array.from(ie.globeMatrix),j.u_up_vector=re),j},bc=(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne,ie)=>s.extend(wh(d,o,c,f,_,v,T,S,I,z,N,X,te,re,ne,ie),{u_gamma_scale:f?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+P}),Fp=(d,o,c,f,_,v,T,S,I,z,P,N,X,te,re,ne)=>s.extend(bc(d,o,c,f,_,v,T,S,!0,I,!0,P,N,X,te,re,ne),{u_texsize_icon:z,u_texture_icon:1}),bh=(d,o,c)=>({u_matrix:d,u_opacity:o,u_color:c}),tg=(d,o,c,f,_)=>s.extend(function(v,T,S){const I=T.imageManager.getPattern(v.toString()),{width:z,height:P}=T.imageManager.getPixelSize(),N=Math.pow(2,S.tileID.overscaledZ),X=S.tileSize*Math.pow(2,T.transform.tileZoom)/N,te=X*(S.tileID.canonical.x+S.tileID.wrap*N),re=X*S.tileID.canonical.y;return{u_image:0,u_pattern_tl:I.tl,u_pattern_br:I.br,u_texsize:[z,P],u_pattern_size:I.displaySize,u_tile_units_to_pixels:1/je(S,1,T.transform.tileZoom),u_pixel_coord_upper:[te>>16,re>>16],u_pixel_coord_lower:[65535&te,65535&re]}}(f,c,_),{u_matrix:d,u_opacity:o}),Eh={fillExtrusion:d=>({u_matrix:new s.UniformMatrix4f(d),u_lightpos:new s.Uniform3f(d),u_lightintensity:new s.Uniform1f(d),u_lightcolor:new s.Uniform3f(d),u_vertical_gradient:new s.Uniform1f(d),u_opacity:new s.Uniform1f(d),u_edge_radius:new s.Uniform1f(d),u_ao:new s.Uniform2f(d),u_tile_id:new s.Uniform3f(d),u_zoom_transition:new s.Uniform1f(d),u_inv_rot_matrix:new s.UniformMatrix4f(d),u_merc_center:new s.Uniform2f(d),u_up_dir:new s.Uniform3f(d),u_height_lift:new s.Uniform1f(d)}),fillExtrusionPattern:d=>({u_matrix:new s.UniformMatrix4f(d),u_lightpos:new s.Uniform3f(d),u_lightintensity:new s.Uniform1f(d),u_lightcolor:new s.Uniform3f(d),u_vertical_gradient:new s.Uniform1f(d),u_height_factor:new s.Uniform1f(d),u_edge_radius:new s.Uniform1f(d),u_ao:new s.Uniform2f(d),u_tile_id:new s.Uniform3f(d),u_zoom_transition:new s.Uniform1f(d),u_inv_rot_matrix:new s.UniformMatrix4f(d),u_merc_center:new s.Uniform2f(d),u_up_dir:new s.Uniform3f(d),u_height_lift:new s.Uniform1f(d),u_image:new s.Uniform1i(d),u_texsize:new s.Uniform2f(d),u_pixel_coord_upper:new s.Uniform2f(d),u_pixel_coord_lower:new s.Uniform2f(d),u_tile_units_to_pixels:new s.Uniform1f(d),u_opacity:new s.Uniform1f(d)}),fill:d=>({u_matrix:new s.UniformMatrix4f(d)}),fillPattern:d=>({u_matrix:new s.UniformMatrix4f(d),u_image:new s.Uniform1i(d),u_texsize:new s.Uniform2f(d),u_pixel_coord_upper:new s.Uniform2f(d),u_pixel_coord_lower:new s.Uniform2f(d),u_tile_units_to_pixels:new s.Uniform1f(d)}),fillOutline:d=>({u_matrix:new s.UniformMatrix4f(d),u_world:new s.Uniform2f(d)}),fillOutlinePattern:d=>({u_matrix:new s.UniformMatrix4f(d),u_world:new s.Uniform2f(d),u_image:new s.Uniform1i(d),u_texsize:new s.Uniform2f(d),u_pixel_coord_upper:new s.Uniform2f(d),u_pixel_coord_lower:new s.Uniform2f(d),u_tile_units_to_pixels:new s.Uniform1f(d)}),circle:d=>({u_camera_to_center_distance:new s.Uniform1f(d),u_extrude_scale:new s.UniformMatrix2f(d),u_device_pixel_ratio:new s.Uniform1f(d),u_matrix:new s.UniformMatrix4f(d),u_inv_rot_matrix:new s.UniformMatrix4f(d),u_merc_center:new s.Uniform2f(d),u_tile_id:new s.Uniform3f(d),u_zoom_transition:new s.Uniform1f(d),u_up_dir:new s.Uniform3f(d)}),collisionBox:d=>({u_matrix:new s.UniformMatrix4f(d),u_camera_to_center_distance:new s.Uniform1f(d),u_extrude_scale:new s.Uniform2f(d)}),collisionCircle:d=>({u_matrix:new s.UniformMatrix4f(d),u_inv_matrix:new s.UniformMatrix4f(d),u_camera_to_center_distance:new s.Uniform1f(d),u_viewport_size:new s.Uniform2f(d)}),debug:d=>({u_color:new s.UniformColor(d),u_matrix:new s.UniformMatrix4f(d),u_overlay:new s.Uniform1i(d),u_overlay_scale:new s.Uniform1f(d)}),clippingMask:d=>({u_matrix:new s.UniformMatrix4f(d)}),heatmap:d=>({u_extrude_scale:new s.Uniform1f(d),u_intensity:new s.Uniform1f(d),u_matrix:new s.UniformMatrix4f(d),u_inv_rot_matrix:new s.UniformMatrix4f(d),u_merc_center:new s.Uniform2f(d),u_tile_id:new s.Uniform3f(d),u_zoom_transition:new s.Uniform1f(d),u_up_dir:new s.Uniform3f(d)}),heatmapTexture:d=>({u_image:new s.Uniform1i(d),u_color_ramp:new s.Uniform1i(d),u_opacity:new s.Uniform1f(d)}),hillshade:d=>({u_matrix:new s.UniformMatrix4f(d),u_image:new s.Uniform1i(d),u_latrange:new s.Uniform2f(d),u_light:new s.Uniform2f(d),u_shadow:new s.UniformColor(d),u_highlight:new s.UniformColor(d),u_accent:new s.UniformColor(d)}),hillshadePrepare:d=>({u_matrix:new s.UniformMatrix4f(d),u_image:new s.Uniform1i(d),u_dimension:new s.Uniform2f(d),u_zoom:new s.Uniform1f(d),u_unpack:new s.Uniform4f(d)}),line:d=>({u_matrix:new s.UniformMatrix4f(d),u_pixels_to_tile_units:new s.UniformMatrix2f(d),u_device_pixel_ratio:new s.Uniform1f(d),u_units_to_pixels:new s.Uniform2f(d),u_dash_image:new s.Uniform1i(d),u_gradient_image:new s.Uniform1i(d),u_image_height:new s.Uniform1f(d),u_texsize:new s.Uniform2f(d),u_tile_units_to_pixels:new s.Uniform1f(d),u_alpha_discard_threshold:new s.Uniform1f(d),u_trim_offset:new s.Uniform2f(d)}),linePattern:d=>({u_matrix:new s.UniformMatrix4f(d),u_texsize:new s.Uniform2f(d),u_pixels_to_tile_units:new s.UniformMatrix2f(d),u_device_pixel_ratio:new s.Uniform1f(d),u_image:new s.Uniform1i(d),u_units_to_pixels:new s.Uniform2f(d),u_tile_units_to_pixels:new s.Uniform1f(d),u_alpha_discard_threshold:new s.Uniform1f(d)}),raster:d=>({u_matrix:new s.UniformMatrix4f(d),u_tl_parent:new s.Uniform2f(d),u_scale_parent:new s.Uniform1f(d),u_fade_t:new s.Uniform1f(d),u_opacity:new s.Uniform1f(d),u_image0:new s.Uniform1i(d),u_image1:new s.Uniform1i(d),u_brightness_low:new s.Uniform1f(d),u_brightness_high:new s.Uniform1f(d),u_saturation_factor:new s.Uniform1f(d),u_contrast_factor:new s.Uniform1f(d),u_spin_weights:new s.Uniform3f(d),u_perspective_transform:new s.Uniform2f(d)}),symbolIcon:d=>({u_is_size_zoom_constant:new s.Uniform1i(d),u_is_size_feature_constant:new s.Uniform1i(d),u_size_t:new s.Uniform1f(d),u_size:new s.Uniform1f(d),u_camera_to_center_distance:new s.Uniform1f(d),u_rotate_symbol:new s.Uniform1i(d),u_aspect_ratio:new s.Uniform1f(d),u_fade_change:new s.Uniform1f(d),u_matrix:new s.UniformMatrix4f(d),u_label_plane_matrix:new s.UniformMatrix4f(d),u_coord_matrix:new s.UniformMatrix4f(d),u_is_text:new s.Uniform1i(d),u_pitch_with_map:new s.Uniform1i(d),u_texsize:new s.Uniform2f(d),u_tile_id:new s.Uniform3f(d),u_zoom_transition:new s.Uniform1f(d),u_inv_rot_matrix:new s.UniformMatrix4f(d),u_merc_center:new s.Uniform2f(d),u_camera_forward:new s.Uniform3f(d),u_tile_matrix:new s.UniformMatrix4f(d),u_up_vector:new s.Uniform3f(d),u_ecef_origin:new s.Uniform3f(d),u_texture:new s.Uniform1i(d)}),symbolSDF:d=>({u_is_size_zoom_constant:new s.Uniform1i(d),u_is_size_feature_constant:new s.Uniform1i(d),u_size_t:new s.Uniform1f(d),u_size:new s.Uniform1f(d),u_camera_to_center_distance:new s.Uniform1f(d),u_rotate_symbol:new s.Uniform1i(d),u_aspect_ratio:new s.Uniform1f(d),u_fade_change:new s.Uniform1f(d),u_matrix:new s.UniformMatrix4f(d),u_label_plane_matrix:new s.UniformMatrix4f(d),u_coord_matrix:new s.UniformMatrix4f(d),u_is_text:new s.Uniform1i(d),u_pitch_with_map:new s.Uniform1i(d),u_texsize:new s.Uniform2f(d),u_texture:new s.Uniform1i(d),u_gamma_scale:new s.Uniform1f(d),u_device_pixel_ratio:new s.Uniform1f(d),u_tile_id:new s.Uniform3f(d),u_zoom_transition:new s.Uniform1f(d),u_inv_rot_matrix:new s.UniformMatrix4f(d),u_merc_center:new s.Uniform2f(d),u_camera_forward:new s.Uniform3f(d),u_tile_matrix:new s.UniformMatrix4f(d),u_up_vector:new s.Uniform3f(d),u_ecef_origin:new s.Uniform3f(d),u_is_halo:new s.Uniform1i(d)}),symbolTextAndIcon:d=>({u_is_size_zoom_constant:new s.Uniform1i(d),u_is_size_feature_constant:new s.Uniform1i(d),u_size_t:new s.Uniform1f(d),u_size:new s.Uniform1f(d),u_camera_to_center_distance:new s.Uniform1f(d),u_rotate_symbol:new s.Uniform1i(d),u_aspect_ratio:new s.Uniform1f(d),u_fade_change:new s.Uniform1f(d),u_matrix:new s.UniformMatrix4f(d),u_label_plane_matrix:new s.UniformMatrix4f(d),u_coord_matrix:new s.UniformMatrix4f(d),u_is_text:new s.Uniform1i(d),u_pitch_with_map:new s.Uniform1i(d),u_texsize:new s.Uniform2f(d),u_texsize_icon:new s.Uniform2f(d),u_texture:new s.Uniform1i(d),u_texture_icon:new s.Uniform1i(d),u_gamma_scale:new s.Uniform1f(d),u_device_pixel_ratio:new s.Uniform1f(d),u_is_halo:new s.Uniform1i(d)}),background:d=>({u_matrix:new s.UniformMatrix4f(d),u_opacity:new s.Uniform1f(d),u_color:new s.UniformColor(d)}),backgroundPattern:d=>({u_matrix:new s.UniformMatrix4f(d),u_opacity:new s.Uniform1f(d),u_image:new s.Uniform1i(d),u_pattern_tl:new s.Uniform2f(d),u_pattern_br:new s.Uniform2f(d),u_texsize:new s.Uniform2f(d),u_pattern_size:new s.Uniform2f(d),u_pixel_coord_upper:new s.Uniform2f(d),u_pixel_coord_lower:new s.Uniform2f(d),u_tile_units_to_pixels:new s.Uniform1f(d)}),terrainRaster:uh,terrainDepth:uh,skybox:d=>({u_matrix:new s.UniformMatrix4f(d),u_sun_direction:new s.Uniform3f(d),u_cubemap:new s.Uniform1i(d),u_opacity:new s.Uniform1f(d),u_temporal_offset:new s.Uniform1f(d)}),skyboxGradient:d=>({u_matrix:new s.UniformMatrix4f(d),u_color_ramp:new s.Uniform1i(d),u_center_direction:new s.Uniform3f(d),u_radius:new s.Uniform1f(d),u_opacity:new s.Uniform1f(d),u_temporal_offset:new s.Uniform1f(d)}),skyboxCapture:d=>({u_matrix_3f:new s.UniformMatrix3f(d),u_sun_direction:new s.Uniform3f(d),u_sun_intensity:new s.Uniform1f(d),u_color_tint_r:new s.Uniform4f(d),u_color_tint_m:new s.Uniform4f(d),u_luminance:new s.Uniform1f(d)}),globeRaster:d=>({u_proj_matrix:new s.UniformMatrix4f(d),u_globe_matrix:new s.UniformMatrix4f(d),u_normalize_matrix:new s.UniformMatrix4f(d),u_merc_matrix:new s.UniformMatrix4f(d),u_zoom_transition:new s.Uniform1f(d),u_merc_center:new s.Uniform2f(d),u_image0:new s.Uniform1i(d),u_grid_matrix:new s.UniformMatrix3f(d),u_skirt_height:new s.Uniform1f(d),u_frustum_tl:new s.Uniform3f(d),u_frustum_tr:new s.Uniform3f(d),u_frustum_br:new s.Uniform3f(d),u_frustum_bl:new s.Uniform3f(d),u_globe_pos:new s.Uniform3f(d),u_globe_radius:new s.Uniform1f(d),u_viewport:new s.Uniform2f(d)}),globeAtmosphere:d=>({u_frustum_tl:new s.Uniform3f(d),u_frustum_tr:new s.Uniform3f(d),u_frustum_br:new s.Uniform3f(d),u_frustum_bl:new s.Uniform3f(d),u_horizon:new s.Uniform1f(d),u_transition:new s.Uniform1f(d),u_fadeout_range:new s.Uniform1f(d),u_color:new s.Uniform4f(d),u_high_color:new s.Uniform4f(d),u_space_color:new s.Uniform4f(d),u_star_intensity:new s.Uniform1f(d),u_star_density:new s.Uniform1f(d),u_star_size:new s.Uniform1f(d),u_temporal_offset:new s.Uniform1f(d),u_horizon_angle:new s.Uniform1f(d),u_rotation_matrix:new s.UniformMatrix4f(d)})};let Ec;function _l(d,o,c,f,_,v,T){const S=d.context,I=S.gl,z=d.transform,P=d.useProgram("collisionBox"),N=[];let X=0,te=0;for(let le=0;le<f.length;le++){const ye=f[le],ve=o.getTile(ye),xe=ve.getBucket(c);if(!xe)continue;const Ie=vi(ye,xe,z);let Ae=Ie;_[0]===0&&_[1]===0||(Ae=d.translatePosMatrix(Ie,ve,_,v));const Be=T?xe.textCollisionBox:xe.iconCollisionBox,it=xe.collisionCircleArray;if(it.length>0){const De=s.create(),Ze=Ae;s.mul(De,xe.placementInvProjMatrix,z.glCoordMatrix),s.mul(De,De,xe.placementViewportMatrix),N.push({circleArray:it,circleOffset:te,transform:Ze,invTransform:De,projection:xe.getProjection()}),X+=it.length/4,te=X}Be&&(d.terrain&&d.terrain.setupElevationDraw(ve,P),P.draw(S,I.LINES,s.DepthMode.disabled,s.StencilMode.disabled,d.colorModeForRenderPass(),s.CullFaceMode.disabled,yh(Ae,z,ve,xe.getProjection()),c.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,null,z.zoom,null,[Be.collisionVertexBuffer,Be.collisionVertexBufferExt]))}if(!T||!N.length)return;const re=d.useProgram("collisionCircle"),ne=new s.StructArrayLayout2f1f2i16;ne.resize(4*X),ne._trim();let ie=0;for(const le of N)for(let ye=0;ye<le.circleArray.length/4;ye++){const ve=4*ye,xe=le.circleArray[ve+0],Ie=le.circleArray[ve+1],Ae=le.circleArray[ve+2],Be=le.circleArray[ve+3];ne.emplace(ie++,xe,Ie,Ae,Be,0),ne.emplace(ie++,xe,Ie,Ae,Be,1),ne.emplace(ie++,xe,Ie,Ae,Be,2),ne.emplace(ie++,xe,Ie,Ae,Be,3)}(!Ec||Ec.length<2*X)&&(Ec=function(le){const ye=2*le,ve=new s.StructArrayLayout3ui6;ve.resize(ye),ve._trim();for(let xe=0;xe<ye;xe++){const Ie=6*xe;ve.uint16[Ie+0]=4*xe+0,ve.uint16[Ie+1]=4*xe+1,ve.uint16[Ie+2]=4*xe+2,ve.uint16[Ie+3]=4*xe+2,ve.uint16[Ie+4]=4*xe+3,ve.uint16[Ie+5]=4*xe+0}return ve}(X));const j=S.createIndexBuffer(Ec,!0),ee=S.createVertexBuffer(ne,s.collisionCircleLayout.members,!0);for(const le of N){const ye={u_matrix:le.transform,u_inv_matrix:le.invTransform,u_camera_to_center_distance:(ae=z).getCameraToCenterDistance(le.projection),u_viewport_size:[ae.width,ae.height]};re.draw(S,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,d.colorModeForRenderPass(),s.CullFaceMode.disabled,ye,c.id,ee,j,s.SegmentVector.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,z.zoom)}var ae;ee.destroy(),j.destroy()}const Op=s.create();function Th({width:d,height:o,anchor:c,textOffset:f,textScale:_},v){const{horizontalAlign:T,verticalAlign:S}=s.getAnchorAlignment(c),I=-(T-.5)*d,z=-(S-.5)*o,P=s.evaluateVariableOffset(c,f);return new s.Point((I/_+P[0])*v,(z/_+P[1])*v)}function ng(d,o,c,f,_,v,T,S,I,z,P){const N=d.text.placedSymbolArray,X=d.text.dynamicLayoutVertexArray,te=d.icon.dynamicLayoutVertexArray,re={},ne=d.getProjection(),ie=Rn(S,ne,v),j=v.elevation,ee=ne.upVectorScale(S.canonical,v.center.lat,v.worldSize).metersToTile;X.clear();for(let ae=0;ae<N.length;ae++){const le=N.get(ae),{tileAnchorX:ye,tileAnchorY:ve,numGlyphs:xe}=le,Ie=le.hidden||!le.crossTileID||d.allowVerticalPlacement&&!le.placedOrientation?null:f[le.crossTileID];if(Ie){let Ae=0,Be=0,it=0;if(j){const lt=j?j.getAtTileOffset(S,ye,ve):0,[At,Ft,Et]=ne.upVector(S.canonical,ye,ve);Ae=lt*At*ee,Be=lt*Ft*ee,it=lt*Et*ee}let[De,Ze,Fe,rt]=wr(le.projectedAnchorX+Ae,le.projectedAnchorY+Be,le.projectedAnchorZ+it,c?ie:T);const ze=Tp(v.getCameraToCenterDistance(ne),rt);let He=_.evaluateSizeForFeature(d.textSizeData,z,le)*ze/s.ONE_EM;c&&(He*=d.tilePixelRatio/I);const at=Th(Ie,He);c?({x:De,y:Ze,z:Fe}=ne.projectTilePoint(ye+at.x,ve+at.y,S.canonical),[De,Ze,Fe]=wr(De+Ae,Ze+Be,Fe+it,T)):(o&&at._rotate(-v.angle),De+=at.x,Ze+=at.y,Fe=0);const Qe=d.allowVerticalPlacement&&le.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let lt=0;lt<xe;lt++)s.addDynamicAttributes(X,De,Ze,Fe,Qe);P&&le.associatedIconIndex>=0&&(re[le.associatedIconIndex]={x:De,y:Ze,z:Fe,angle:Qe})}else ji(xe,X)}if(P){te.clear();const ae=d.icon.placedSymbolArray;for(let le=0;le<ae.length;le++){const ye=ae.get(le),{numGlyphs:ve}=ye,xe=re[le];if(ye.hidden||!xe)ji(ve,te);else{const{x:Ie,y:Ae,z:Be,angle:it}=xe;for(let De=0;De<ve;De++)s.addDynamicAttributes(te,Ie,Ae,Be,it)}}d.icon.dynamicLayoutVertexBuffer.updateData(te)}d.text.dynamicLayoutVertexBuffer.updateData(X)}function Sh(d,o,c){return c.iconsInText&&o?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function Np(d,o,c,f,_,v,T,S,I,z,P,N){const X=d.context,te=X.gl,re=d.transform,ne=S==="map",ie=I==="map",j=ne&&c.layout.get("symbol-placement")!=="point",ee=ne&&!ie&&!j,ae=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let le=!1;const ye=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),ve=[s.mercatorXfromLng(re.center.lng),s.mercatorYfromLat(re.center.lat)],xe=c.layout.get("text-variable-anchor"),Ie=re.projection.name==="globe",Ae=[],Be=[0,-1,0];let it=Be;!Ie&&!re.mercatorFromTransition||ne||(it=function(De){const Ze=De._camera.getWorldToCamera(De.worldSize,1),Fe=s.multiply([],Ze,De.globeMatrix);s.invert(Fe,Fe);const rt=[0,0,0],ze=[0,1,0,0];return s.transformMat4$1(ze,ze,Fe),rt[0]=ze[0],rt[1]=ze[1],rt[2]=ze[2],s.normalize(rt,rt),rt}(re));for(const De of f){const Ze=o.getTile(De),Fe=Ze.getBucket(c);if(!Fe||Fe.projection.name==="mercator"&&Ie)continue;const rt=_?Fe.text:Fe.icon;if(!rt||Fe.fullyClipped||!rt.segments.get().length)continue;const ze=rt.programConfigurations.get(c.id),He=_||Fe.sdfIcons,at=_?Fe.textSizeData:Fe.iconSizeData,Qe=ie||re.pitch!==0,lt=s.evaluateSizeForZoom(at,re.zoom);let At,Ft,Et,zt,Jt=[0,0],Xt=null;if(_)Ft=Ze.glyphAtlasTexture,Et=te.LINEAR,At=Ze.glyphAtlasTexture.size,Fe.iconsInText&&(Jt=Ze.imageAtlasTexture.size,Xt=Ze.imageAtlasTexture,zt=Qe||d.options.rotating||d.options.zooming||at.kind==="composite"||at.kind==="camera"?te.LINEAR:te.NEAREST);else{const Lo=c.layout.get("icon-size").constantOr(0)!==1||Fe.iconsNeedLinear;Ft=Ze.imageAtlasTexture,Et=He||d.options.rotating||d.options.zooming||Lo||Qe?te.LINEAR:te.NEAREST,At=Ze.imageAtlasTexture.size}const Ct=Fe.projection.name==="globe",gn=Ct?it:Be,vn=Ct?s.globeToMercatorTransition(re.zoom):0,wn=Rn(De,Fe.getProjection(),re),bn=re.calculatePixelsToTileUnitsMatrix(Ze),Or=qe(wn,Ze.tileID.canonical,ie,ne,re,Fe.getProjection(),bn),Er=d.terrain&&ie&&j?s.invert(s.create(),Or):Op,Ti=er(wn,Ze.tileID.canonical,ie,ne,re,Fe.getProjection(),bn),uo=xe&&Fe.hasTextData(),Fn=c.layout.get("icon-text-fit")!=="none"&&uo&&Fe.hasIconData();if(j){const Lo=re.elevation,os=Lo?Lo.getAtTileOffsetFunc(De,re.center.lat,re.worldSize,Fe.getProjection()):null,Ls=Ao(wn,Ze.tileID.canonical,ie,ne,re,Fe.getProjection(),bn);Yu(Fe,wn,d,_,Ls,Ti,ie,z,os,De)}const En=j||_&&xe||Fn,cn=d.translatePosMatrix(wn,Ze,v,T),tr=En?Op:Or,Wr=d.translatePosMatrix(Ti,Ze,v,T,!0),Bn=Fe.getProjection().createInversionMatrix(re,De.canonical),ei=[];d.terrainRenderModeElevated()&&ie&&ei.push("PITCH_WITH_MAP_TERRAIN"),Ct&&ei.push("PROJECTION_GLOBE_VIEW"),En&&ei.push("PROJECTED_POS_ON_VIEWPORT");const Nc=He&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Bs;Bs=He?Fe.iconsInText?Fp(at.kind,lt,ee,ie,d,cn,tr,Wr,At,Jt,De,vn,ve,Bn,gn,Fe.getProjection()):bc(at.kind,lt,ee,ie,d,cn,tr,Wr,_,At,!0,De,vn,ve,Bn,gn,Fe.getProjection()):wh(at.kind,lt,ee,ie,d,cn,tr,Wr,_,At,De,vn,ve,Bn,gn,Fe.getProjection());const Il={program:d.useProgram(Sh(He,_,Fe),ze,ei),buffers:rt,uniformValues:Bs,atlasTexture:Ft,atlasTextureIcon:Xt,atlasInterpolation:Et,atlasInterpolationIcon:zt,isSDF:He,hasHalo:Nc,tile:Ze,labelPlaneMatrixInv:Er};if(ae&&Fe.canOverlap){le=!0;const Lo=rt.segments.get();for(const os of Lo)Ae.push({segments:new s.SegmentVector([os]),sortKey:os.sortKey,state:Il})}else Ae.push({segments:rt.segments,sortKey:0,state:Il})}le&&Ae.sort((De,Ze)=>De.sortKey-Ze.sortKey);for(const De of Ae){const Ze=De.state;if(d.terrain&&d.terrain.setupElevationDraw(Ze.tile,Ze.program,{useDepthForOcclusion:!Ie,labelPlaneMatrixInv:Ze.labelPlaneMatrixInv}),X.activeTexture.set(te.TEXTURE0),Ze.atlasTexture.bind(Ze.atlasInterpolation,te.CLAMP_TO_EDGE),Ze.atlasTextureIcon&&(X.activeTexture.set(te.TEXTURE1),Ze.atlasTextureIcon&&Ze.atlasTextureIcon.bind(Ze.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Ze.isSDF){const Fe=Ze.uniformValues;Ze.hasHalo&&(Fe.u_is_halo=1,yl(Ze.buffers,De.segments,c,d,Ze.program,ye,P,N,Fe)),Fe.u_is_halo=0}yl(Ze.buffers,De.segments,c,d,Ze.program,ye,P,N,Ze.uniformValues)}}function yl(d,o,c,f,_,v,T,S,I){const z=f.context,P=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.globeExtVertexBuffer];_.draw(z,z.gl.TRIANGLES,v,T,S,s.CullFaceMode.disabled,I,c.id,d.layoutVertexBuffer,d.indexBuffer,o,c.paint,f.transform.zoom,d.programConfigurations.get(c.id),P)}function Up(d,o,c,f,_,v,T){const S=d.context.gl,I=c.paint.get("fill-pattern"),z=I&&I.constantOr(1);let P,N,X,te,re;T?(N=z&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=S.LINES):(N=z?"fillPattern":"fill",P=S.TRIANGLES);for(const ne of f){const ie=o.getTile(ne);if(z&&!ie.patternsLoaded())continue;const j=ie.getBucket(c);if(!j)continue;d.prepareDrawTile();const ee=j.programConfigurations.get(c.id),ae=d.useProgram(N,ee);z&&(d.context.activeTexture.set(S.TEXTURE0),ie.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),ee.updatePaintBuffers());const le=I.constantOr(null);if(le&&ie.imageAtlas){const ve=ie.imageAtlas.patternPositions[le.toString()];ve&&ee.setConstantPatternPositions(ve)}const ye=d.translatePosMatrix(ne.projMatrix,ie,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(T){te=j.indexBuffer2,re=j.segments2;const ve=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[S.drawingBufferWidth,S.drawingBufferHeight];X=N==="fillOutlinePattern"&&z?Jm(ye,d,ie,ve):Ym(ye,ve)}else te=j.indexBuffer,re=j.segments,X=z?mh(ye,d,ie):Ms(ye);d.prepareDrawProgram(d.context,ae,ne.toUnwrapped()),ae.draw(d.context,P,_,d.stencilModeForClipping(ne),v,s.CullFaceMode.disabled,X,c.id,j.layoutVertexBuffer,te,re,c.paint,d.transform.zoom,ee)}}function Tc(d,o,c,f,_,v,T){const S=d.context,I=S.gl,z=d.transform,P=c.paint.get("fill-extrusion-pattern"),N=P.constantOr(1),X=c.paint.get("fill-extrusion-opacity"),te=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],re=c.layout.get("fill-extrusion-edge-radius"),ne=re>0&&!c.paint.get("fill-extrusion-rounded-roof"),ie=ne?0:re,j=z.projection.name==="globe"?s.fillExtrusionHeightLift():0,ee=z.projection.name==="globe",ae=ee?s.globeToMercatorTransition(z.zoom):0,le=[s.mercatorXfromLng(z.center.lng),s.mercatorYfromLat(z.center.lat)],ye=[];ee&&ye.push("PROJECTION_GLOBE_VIEW"),te[0]>0&&ye.push("FAUX_AO"),ne&&ye.push("ZERO_ROOF_RADIUS");for(const ve of f){const xe=o.getTile(ve),Ie=xe.getBucket(c);if(!Ie||Ie.projection.name!==z.projection.name)continue;const Ae=Ie.programConfigurations.get(c.id),Be=d.useProgram(N?"fillExtrusionPattern":"fillExtrusion",Ae,ye);if(d.terrain){const He=d.terrain;if(d.style.terrainSetForDrapingOnly())He.setupElevationDraw(xe,Be,{useMeterToDem:!0});else{if(!Ie.enableTerrain)continue;if(He.setupElevationDraw(xe,Be,{useMeterToDem:!0}),jp(S,o,ve,Ie,c,He),!Ie.centroidVertexBuffer){const at=Be.attributes.a_centroid_pos;at!==void 0&&I.vertexAttrib2f(at,0,0)}}}N&&(d.context.activeTexture.set(I.TEXTURE0),xe.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const it=P.constantOr(null);if(it&&xe.imageAtlas){const He=xe.imageAtlas.patternPositions[it.toString()];He&&Ae.setConstantPatternPositions(He)}const De=d.translatePosMatrix(ve.projMatrix,xe,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ze=z.projection.createInversionMatrix(z,ve.canonical),Fe=c.paint.get("fill-extrusion-vertical-gradient"),rt=N?Bp(De,d,Fe,X,te,ie,ve,xe,j,ae,le,Ze):fh(De,d,Fe,X,te,ie,ve,j,ae,le,Ze);d.prepareDrawProgram(S,Be,ve.toUnwrapped());const ze=[];d.terrain&&ze.push(Ie.centroidVertexBuffer),ee&&ze.push(Ie.layoutVertexExtBuffer),Be.draw(S,S.gl.TRIANGLES,_,v,T,s.CullFaceMode.backCCW,rt,c.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,c.paint,d.transform.zoom,Ae,ze)}}function jp(d,o,c,f,_,v){const T=[j=>{let ee=j.canonical.x-1,ae=j.wrap;return ee<0&&(ee=(1<<j.canonical.z)-1,ae--),new s.OverscaledTileID(j.overscaledZ,ae,j.canonical.z,ee,j.canonical.y)},j=>{let ee=j.canonical.x+1,ae=j.wrap;return ee===1<<j.canonical.z&&(ee=0,ae++),new s.OverscaledTileID(j.overscaledZ,ae,j.canonical.z,ee,j.canonical.y)},j=>new s.OverscaledTileID(j.overscaledZ,j.wrap,j.canonical.z,j.canonical.x,(j.canonical.y===0?1<<j.canonical.z:j.canonical.y)-1),j=>new s.OverscaledTileID(j.overscaledZ,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y===(1<<j.canonical.z)-1?0:j.canonical.y+1)],S=j=>{const ee=o.getSource().minzoom,ae=ye=>{const ve=o.getTileByID(ye);if(ve&&ve.hasData())return ve.getBucket(_)},le=[0,-1,1];for(const ye of le){if(j.overscaledZ+ye<ee)continue;const ve=ae(j.calculateScaledKey(j.overscaledZ+ye));if(ve)return ve}},I=[0,0,0],z=(j,ee)=>(I[0]=Math.min(j.min.y,ee.min.y),I[1]=Math.max(j.max.y,ee.max.y),I[2]=s.EXTENT-ee.min.x>j.max.x?ee.min.x-s.EXTENT:j.max.x,I),P=(j,ee)=>(I[0]=Math.min(j.min.x,ee.min.x),I[1]=Math.max(j.max.x,ee.max.x),I[2]=s.EXTENT-ee.min.y>j.max.y?ee.min.y-s.EXTENT:j.max.y,I),N=[(j,ee)=>z(j,ee),(j,ee)=>z(ee,j),(j,ee)=>P(j,ee),(j,ee)=>P(ee,j)],X=new s.Point(0,0);let te,re,ne;const ie=(j,ee,ae,le,ye)=>{const ve=[[le?ae:j,le?j:ae,0],[le?ae:ee,le?ee:ae,0]],xe=ye<0?s.EXTENT+ye:ye,Ie=[le?xe:(j+ee)/2,le?(j+ee)/2:xe,0];return ae===0&&ye<0||ae!==0&&ye>0?v.getForTilePoints(ne,[Ie],!0,re):ve.push(Ie),v.getForTilePoints(c,ve,!0,te),Math.max(ve[0][2],ve[1][2],Ie[2])/v.exaggeration()};for(let j=0;j<4;j++){const ee=(j<2?1:5)-j,ae=f.borders[j];if(ae.length===0)continue;const le=ne=T[j](c),ye=S(le);if(!(ye&&ye instanceof s.FillExtrusionBucket&&ye.enableTerrain)||f.borderDoneWithNeighborZ[j]===ye.canonical.z&&ye.borderDoneWithNeighborZ[ee]===f.canonical.z||(re=v.findDEMTileFor(le),!re||!re.dem))continue;if(!te){const Ae=v.findDEMTileFor(c);if(!Ae||!Ae.dem)return;te=Ae}const ve=ye.borders[ee];let xe=0;const Ie=ye.borderDoneWithNeighborZ[ee]!==f.canonical.z;if(f.canonical.z===ye.canonical.z){for(let Ae=0;Ae<ae.length;Ae++){const Be=f.featuresOnBorder[ae[Ae]],it=Be.borders[j];let De;for(;xe<ve.length&&(De=ye.featuresOnBorder[ve[xe]],!(De.borders[ee][1]>it[0]+3));)Ie&&ye.encodeCentroid(void 0,De,!1),xe++;if(De&&xe<ve.length){const Ze=xe;let Fe=0;for(;!(De.borders[ee][0]>it[1]-3)&&(Fe++,++xe!==ve.length);)De=ye.featuresOnBorder[ve[xe]];if(De=ye.featuresOnBorder[ve[Ze]],Be.intersectsCount()>1||De.intersectsCount()>1||Fe!==1){Fe!==1&&(xe=Ze),f.encodeCentroid(void 0,Be,!1),Ie&&ye.encodeCentroid(void 0,De,!1);continue}const rt=N[j](Be,De),ze=j%2?s.EXTENT-1:0;X.x=ie(rt[0],Math.min(s.EXTENT-1,rt[1]),ze,j<2,rt[2]),X.y=0,f.encodeCentroid(X,Be,!1),Ie&&ye.encodeCentroid(X,De,!1)}else f.encodeCentroid(void 0,Be,!1)}f.borderDoneWithNeighborZ[j]=ye.canonical.z,f.needsCentroidUpdate=!0,Ie&&(ye.borderDoneWithNeighborZ[ee]=f.canonical.z,ye.needsCentroidUpdate=!0)}else{for(const Ae of ae)f.encodeCentroid(void 0,f.featuresOnBorder[Ae],!1);if(Ie){for(const Ae of ve)ye.encodeCentroid(void 0,ye.featuresOnBorder[Ae],!1);ye.borderDoneWithNeighborZ[ee]=f.canonical.z,ye.needsCentroidUpdate=!0}f.borderDoneWithNeighborZ[j]=ye.canonical.z,f.needsCentroidUpdate=!0}}(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(d)}const ua=new s.Color(1,0,0,1),rg=new s.Color(0,1,0,1),ig=new s.Color(0,0,1,1),og=new s.Color(1,0,1,1),sg=new s.Color(0,1,1,1);function ag(d,o,c){const f=d.context,_=d.transform,v=f.gl,T=_.projection.name==="globe",S=T?["PROJECTION_GLOBE_VIEW"]:null;let I=c.projMatrix;if(T&&s.globeToMercatorTransition(_.zoom)>0){const Be=s.transitionTileAABBinECEF(c.canonical,_),it=s.globeDenormalizeECEF(Be);I=s.multiply(new Float32Array(16),_.globeMatrix,it),s.multiply(I,_.projMatrix,I)}const z=d.useProgram("debug",null,S),P=o.getTileByID(c.key);d.terrain&&d.terrain.setupElevationDraw(P,z);const N=s.DepthMode.disabled,X=s.StencilMode.disabled,te=d.colorModeForRenderPass(),re="$debug";f.activeTexture.set(v.TEXTURE0),d.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),T?P._makeGlobeTileDebugBuffers(d.context,_):P._makeDebugTileBoundsBuffers(d.context,_.projection);const ne=P._tileDebugBuffer||d.debugBuffer,ie=P._tileDebugIndexBuffer||d.debugIndexBuffer,j=P._tileDebugSegments||d.debugSegments;z.draw(f,v.LINE_STRIP,N,X,te,s.CullFaceMode.disabled,vc(I,s.Color.red),re,ne,ie,j,null,null,null,[P._globeTileDebugBorderBuffer]);const ee=P.latestRawTileData,ae=Math.floor((ee&&ee.byteLength||0)/1024),le=o.getTile(c).tileSize,ye=512/Math.min(le,512)*(c.overscaledZ/_.zoom)*.5;let ve=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(ve+=` => ${c.overscaledZ}`),ve+=` ${ae}kb`,function(Be,it){Be.initDebugOverlayCanvas();const De=Be.debugOverlayCanvas,Ze=Be.context.gl,Fe=Be.debugOverlayCanvas.getContext("2d");Fe.clearRect(0,0,De.width,De.height),Fe.shadowColor="white",Fe.shadowBlur=2,Fe.lineWidth=1.5,Fe.strokeStyle="white",Fe.textBaseline="top",Fe.font="bold 36px Open Sans, sans-serif",Fe.fillText(it,5,5),Fe.strokeText(it,5,5),Be.debugOverlayTexture.update(De),Be.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(d,ve);const xe=P._tileDebugTextBuffer||d.debugBuffer,Ie=P._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,Ae=P._tileDebugTextSegments||d.debugSegments;z.draw(f,v.TRIANGLES,N,X,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,vc(I,s.Color.transparent,ye),re,xe,Ie,Ae,null,null,null,[P._globeTileDebugTextBuffer])}function Vp(d,o,c,f){ha(d,0,o+c/2,d.transform.width,c,f)}function Sc(d,o,c,f){ha(d,o-c/2,0,c,d.transform.height,f)}function ha(d,o,c,f,_,v){const T=d.context,S=T.gl;S.enable(S.SCISSOR_TEST),S.scissor(o*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,f*s.exported.devicePixelRatio,_*s.exported.devicePixelRatio),T.clear({color:v}),S.disable(S.SCISSOR_TEST)}const Gp=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qp}=Gp;function zo(d,o,c,f){d.emplaceBack(o,c,f)}class Cc{constructor(o){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,zo(this.vertexArray,-1,-1,1),zo(this.vertexArray,1,-1,1),zo(this.vertexArray,-1,1,1),zo(this.vertexArray,1,1,1),zo(this.vertexArray,-1,-1,-1),zo(this.vertexArray,1,-1,-1),zo(this.vertexArray,-1,1,-1),zo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,qp),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function bi(d,o,c,f,_,v){const T=d.gl,S=o.paint.get("sky-atmosphere-color"),I=o.paint.get("sky-atmosphere-halo-color"),z=o.paint.get("sky-atmosphere-sun-intensity"),P=((N,X,te,re,ne)=>({u_matrix_3f:N,u_sun_direction:X,u_sun_intensity:te,u_color_tint_r:[re.r,re.g,re.b,re.a],u_color_tint_m:[ne.r,ne.g,ne.b,ne.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),f),_,z,S,I);T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+v,o.skyboxTexture,0),c.draw(d,T.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,P,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const xl=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class $p{constructor(o){const c=new s.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const f=new s.StructArrayLayout3ui6;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(c,xl.members),this.indexBuffer=o.createIndexBuffer(f),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ds={symbol:function(d,o,c,f,_){if(d.renderPass!=="translucent")return;const v=s.StencilMode.disabled,T=d.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(S,I,z,P,N,X,te){const re=I.transform,ne=N==="map",ie=X==="map";for(const j of S){const ee=P.getTile(j),ae=ee.getBucket(z);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const le=s.evaluateSizeForZoom(ae.textSizeData,re.zoom),ye=Rn(j,ae.getProjection(),re),ve=re.calculatePixelsToTileUnitsMatrix(ee),xe=qe(ye,ee.tileID.canonical,ie,ne,re,ae.getProjection(),ve),Ie=z.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(le){const Ae=Math.pow(2,re.zoom-ee.tileID.overscaledZ);ng(ae,ne,ie,te,s.symbolSize,re,xe,j,Ae,le,Ie)}}}(f,d,c,o,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&Np(d,o,c,f,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),v,T),c.paint.get("text-opacity").constantOr(1)!==0&&Np(d,o,c,f,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),v,T),o.map.showCollisionBoxes&&(_l(d,o,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),_l(d,o,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(d,o,c,f){if(d.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),v=c.paint.get("circle-stroke-width"),T=c.paint.get("circle-stroke-opacity"),S=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(v.constantOr(1)===0||T.constantOr(1)===0))return;const I=d.context,z=I.gl,P=d.transform,N=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),X=s.StencilMode.disabled,te=d.colorModeForRenderPass(),re=P.projection.name==="globe",ne=[s.mercatorXfromLng(P.center.lng),s.mercatorYfromLat(P.center.lat)],ie=[];for(let ee=0;ee<f.length;ee++){const ae=f[ee],le=o.getTile(ae),ye=le.getBucket(c);if(!ye||ye.projection.name!==P.projection.name)continue;const ve=ye.programConfigurations.get(c.id),xe=_h(c);re&&xe.push("PROJECTION_GLOBE_VIEW");const Ie=d.useProgram("circle",ve,xe),Ae=ye.layoutVertexBuffer,Be=ye.globeExtVertexBuffer,it=ye.indexBuffer,De=P.projection.createInversionMatrix(P,ae.canonical),Ze={programConfiguration:ve,program:Ie,layoutVertexBuffer:Ae,globeExtVertexBuffer:Be,indexBuffer:it,uniformValues:gh(d,ae,le,De,ne,c),tile:le};if(S){const Fe=ye.segments.get();for(const rt of Fe)ie.push({segments:new s.SegmentVector([rt]),sortKey:rt.sortKey,state:Ze})}else ie.push({segments:ye.segments,sortKey:0,state:Ze})}S&&ie.sort((ee,ae)=>ee.sortKey-ae.sortKey);const j={useDepthForOcclusion:!re};for(const ee of ie){const{programConfiguration:ae,program:le,layoutVertexBuffer:ye,globeExtVertexBuffer:ve,indexBuffer:xe,uniformValues:Ie,tile:Ae}=ee.state,Be=ee.segments;d.terrain&&d.terrain.setupElevationDraw(Ae,le,j),d.prepareDrawProgram(I,le,Ae.tileID.toUnwrapped()),le.draw(I,z.TRIANGLES,N,X,te,s.CullFaceMode.disabled,Ie,c.id,ye,xe,Be,c.paint,P.zoom,ae,[ve])}},heatmap:function(d,o,c,f){if(c.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const _=d.context,v=_.gl,T=s.StencilMode.disabled,S=new s.ColorMode([v.ONE,v.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(te,re,ne,ie){const j=te.gl,ee=re.width*ie,ae=re.height*ie;te.activeTexture.set(j.TEXTURE1),te.viewport.set([0,0,ee,ae]);let le=ne.heatmapFbo;if(!le||le&&(le.width!==ee||le.height!==ae)){le&&le.destroy();const ye=j.createTexture();j.bindTexture(j.TEXTURE_2D,ye),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.LINEAR),le=ne.heatmapFbo=te.createFramebuffer(ee,ae,!1),function(ve,xe,Ie,Ae,Be,it){const De=ve.gl;De.texImage2D(De.TEXTURE_2D,0,ve.isWebGL2&&ve.extRenderToTextureHalfFloat?De.RGBA16F:De.RGBA,Be,it,0,De.RGBA,ve.extRenderToTextureHalfFloat?ve.isWebGL2?De.HALF_FLOAT:ve.extTextureHalfFloat.HALF_FLOAT_OES:De.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Ie)}(te,0,ye,le,ee,ae)}else j.bindTexture(j.TEXTURE_2D,le.colorAttachment.get()),te.bindFramebuffer.set(le.framebuffer)})(_,d,c,d.transform.projection.name==="globe"?.5:.25),_.clear({color:s.Color.transparent});const I=d.transform,z=I.projection.name==="globe",P=z?["PROJECTION_GLOBE_VIEW"]:null,N=z?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,X=[s.mercatorXfromLng(I.center.lng),s.mercatorYfromLat(I.center.lat)];for(let te=0;te<f.length;te++){const re=f[te];if(o.hasRenderableParent(re))continue;const ne=o.getTile(re),ie=ne.getBucket(c);if(!ie||ie.projection.name!==I.projection.name)continue;const j=ie.programConfigurations.get(c.id),ee=d.useProgram("heatmap",j,P),{zoom:ae}=d.transform;d.terrain&&d.terrain.setupElevationDraw(ne,ee),d.prepareDrawProgram(_,ee,re.toUnwrapped());const le=I.projection.createInversionMatrix(I,re.canonical);ee.draw(_,v.TRIANGLES,s.DepthMode.disabled,T,S,N,Rp(d,re,ne,le,X,ae,c.paint.get("heatmap-intensity")),c.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,c.paint,d.transform.zoom,j,z?[ie.globeExtVertexBuffer]:null)}_.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(_,v){const T=_.context,S=T.gl,I=v.heatmapFbo;if(!I)return;T.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,I.colorAttachment.get()),T.activeTexture.set(S.TEXTURE1);let z=v.colorRampTexture;z||(z=v.colorRampTexture=new s.Texture(T,v.colorRamp,S.RGBA)),z.bind(S.LINEAR,S.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(T,S.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,_.colorModeForRenderPass(),s.CullFaceMode.disabled,((P,N,X,te)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,v),v.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,v.paint,_.transform.zoom)}(d,c))},line:function(d,o,c,f){if(d.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),v=c.paint.get("line-width");if(_.constantOr(1)===0||v.constantOr(1)===0)return;const T=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),S=d.colorModeForRenderPass(),I=d.terrain&&d.terrain.renderingToTexture?1:s.exported.devicePixelRatio,z=c.paint.get("line-dasharray"),P=z.constantOr(1),N=c.layout.get("line-cap"),X=c.paint.get("line-pattern"),te=X.constantOr(1),re=c.paint.get("line-gradient"),ne=te?"linePattern":"line",ie=d.context,j=ie.gl,ee=(le=>{const ye=[];gl(le)&&ye.push("RENDER_LINE_DASH"),le.paint.get("line-gradient")&&ye.push("RENDER_LINE_GRADIENT");const ve=le.paint.get("line-trim-offset");ve[0]===0&&ve[1]===0||ye.push("RENDER_LINE_TRIM_OFFSET");const xe=le.paint.get("line-pattern").constantOr(1),Ie=le.paint.get("line-opacity").constantOr(1)!==1;return!xe&&Ie&&ye.push("RENDER_LINE_ALPHA_DISCARD"),ye})(c);let ae=ee.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(ae=!1);for(const le of f){const ye=o.getTile(le);if(te&&!ye.patternsLoaded())continue;const ve=ye.getBucket(c);if(!ve)continue;d.prepareDrawTile();const xe=ve.programConfigurations.get(c.id),Ie=d.useProgram(ne,xe,ee),Ae=X.constantOr(null);if(Ae&&ye.imageAtlas){const He=ye.imageAtlas.patternPositions[Ae.toString()];He&&xe.setConstantPatternPositions(He)}const Be=z.constantOr(null),it=N.constantOr(null);if(!te&&Be&&it&&ye.lineAtlas){const He=ye.lineAtlas.getDash(Be,it);He&&xe.setConstantPatternPositions(He)}let[De,Ze]=c.paint.get("line-trim-offset");(it==="round"||it==="square")&&De!==Ze&&(De===0&&(De-=1),Ze===1&&(Ze+=1));const Fe=d.terrain?le.projMatrix:null,rt=te?ml(d,ye,c,Fe,I):eg(d,ye,c,Fe,ve.lineClipsArray.length,I,[De,Ze]);if(re){const He=ve.gradients[c.id];let at=He.texture;if(c.gradientVersion!==He.version){let Qe=256;if(c.stepInterpolant){const lt=o.getSource().maxzoom,At=le.canonical.z===lt?Math.ceil(1<<d.transform.maxZoom-le.canonical.z):1;Qe=s.clamp(s.nextPowerOfTwo(ve.maxLineLength/s.EXTENT*1024*At),256,ie.maxTextureSize)}He.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Qe,image:He.gradient||void 0,clips:ve.lineClipsArray}),He.texture?He.texture.update(He.gradient):He.texture=new s.Texture(ie,He.gradient,j.RGBA),He.version=c.gradientVersion,at=He.texture}ie.activeTexture.set(j.TEXTURE1),at.bind(c.stepInterpolant?j.NEAREST:j.LINEAR,j.CLAMP_TO_EDGE)}P&&(ie.activeTexture.set(j.TEXTURE0),ye.lineAtlasTexture.bind(j.LINEAR,j.REPEAT),xe.updatePaintBuffers()),te&&(ie.activeTexture.set(j.TEXTURE0),ye.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),xe.updatePaintBuffers()),d.prepareDrawProgram(ie,Ie,le.toUnwrapped());const ze=He=>{Ie.draw(ie,j.TRIANGLES,T,He,S,s.CullFaceMode.disabled,rt,c.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,c.paint,d.transform.zoom,xe,[ve.layoutVertexBuffer2])};if(ae){const He=d.stencilModeForClipping(le).ref;He===0&&d.terrain&&ie.clear({stencil:0});const at={func:j.EQUAL,mask:255};rt.u_alpha_discard_threshold=.8,ze(new s.StencilMode(at,He,255,j.KEEP,j.KEEP,j.INVERT)),rt.u_alpha_discard_threshold=0,ze(new s.StencilMode(at,He,255,j.KEEP,j.KEEP,j.KEEP))}else ze(d.stencilModeForClipping(le))}ae&&(d.resetStencilClippingMasks(),d.terrain&&ie.clear({stencil:0}))},fill:function(d,o,c,f){const _=c.paint.get("fill-color"),v=c.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const T=d.colorModeForRenderPass(),S=c.paint.get("fill-pattern"),I=d.opaquePassEnabledForLayer()&&!S.constantOr(1)&&_.constantOr(s.Color.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===I){const z=d.depthModeForSublayer(1,d.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Up(d,o,c,f,z,T,!1)}if(d.renderPass==="translucent"&&c.paint.get("fill-antialias")){const z=d.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Up(d,o,c,f,z,T,!0)}},"fill-extrusion":function(d,o,c,f){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&d.renderPass==="translucent"){const v=new s.DepthMode(d.context.gl.LEQUAL,s.DepthMode.ReadWrite,d.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))Tc(d,o,c,f,v,s.StencilMode.disabled,s.ColorMode.disabled),Tc(d,o,c,f,v,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const T=d.colorModeForRenderPass();Tc(d,o,c,f,v,s.StencilMode.disabled,T)}}},hillshade:function(d,o,c,f){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const _=d.context,v=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),T=d.colorModeForRenderPass(),S=d.terrain&&d.terrain.renderingToTexture,[I,z]=d.renderPass!=="translucent"||S?[{},f]:d.stencilConfigForOverlap(f);for(const P of z){const N=o.getTile(P);if(N.needsHillshadePrepare&&d.renderPass==="offscreen")Dp(d,N,c,v,s.StencilMode.disabled,T);else if(d.renderPass==="translucent"){const X=S&&d.terrain?d.terrain.stencilModeForRTTOverlap(P):I[P.overscaledZ];Mp(d,P,N,c,v,X,T)}}_.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,o,c,f,_,v){if(d.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!f.length)return;const T=d.context,S=T.gl,I=o.getSource(),z=d.useProgram("raster"),P=d.colorModeForRenderPass(),N=d.terrain&&d.terrain.renderingToTexture,[X,te]=I instanceof Lt||N?[{},f]:d.stencilConfigForOverlap(f),re=te[te.length-1].overscaledZ,ne=!d.options.moving;for(const ie of te){const j=N?s.DepthMode.disabled:d.depthModeForSublayer(ie.overscaledZ-re,c.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,S.LESS),ee=ie.toUnwrapped(),ae=o.getTile(ie);if(N&&(!ae||!ae.hasData()))continue;const le=N?ie.projMatrix:d.transform.calculateProjMatrix(ee,ne),ye=d.terrain&&N?d.terrain.stencilModeForRTTOverlap(ie):X[ie.overscaledZ],ve=v?0:c.paint.get("raster-fade-duration");ae.registerFadeDuration(ve);const xe=o.findLoadedParent(ie,0),Ie=hh(ae,xe,o,d.transform,ve);let Ae,Be;d.terrain&&d.terrain.prepareDrawTile();const it=c.paint.get("raster-resampling")==="nearest"?S.NEAREST:S.LINEAR;T.activeTexture.set(S.TEXTURE0),ae.texture.bind(it,S.CLAMP_TO_EDGE),T.activeTexture.set(S.TEXTURE1),xe?(xe.texture.bind(it,S.CLAMP_TO_EDGE),Ae=Math.pow(2,xe.tileID.overscaledZ-ae.tileID.overscaledZ),Be=[ae.tileID.canonical.x*Ae%1,ae.tileID.canonical.y*Ae%1]):ae.texture.bind(it,S.CLAMP_TO_EDGE),ae.texture.useMipmap&&T.extTextureFilterAnisotropic&&d.transform.pitch>20&&S.texParameterf(S.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax);const De=vh(le,Be||[0,0],Ae||1,Ie,c,I instanceof Lt?I.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(T,z,ee),I instanceof Lt)I.boundsBuffer&&I.boundsSegments&&z.draw(T,S.TRIANGLES,j,s.StencilMode.disabled,P,s.CullFaceMode.disabled,De,c.id,I.boundsBuffer,d.quadTriangleIndexBuffer,I.boundsSegments);else{const{tileBoundsBuffer:Ze,tileBoundsIndexBuffer:Fe,tileBoundsSegments:rt}=d.getTileBoundsBuffers(ae);z.draw(T,S.TRIANGLES,j,ye,P,s.CullFaceMode.disabled,De,c.id,Ze,Fe,rt)}}d.resetStencilClippingMasks()},background:function(d,o,c,f){const _=c.paint.get("background-color"),v=c.paint.get("background-opacity");if(v===0)return;const T=d.context,S=T.gl,I=d.transform,z=I.tileSize,P=c.paint.get("background-pattern");if(d.isPatternMissing(P))return;const N=!P&&_.a===1&&v===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==N)return;const X=s.StencilMode.disabled,te=d.depthModeForSublayer(0,N==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),re=d.colorModeForRenderPass(),ne=d.useProgram(P?"backgroundPattern":"background");let ie,j=f;j||(ie=d.getBackgroundTiles(),j=Object.values(ie).map(ee=>ee.tileID)),P&&(T.activeTexture.set(S.TEXTURE0),d.imageManager.bind(d.context));for(const ee of j){const ae=ee.toUnwrapped(),le=f?ee.projMatrix:d.transform.calculateProjMatrix(ae);d.prepareDrawTile();const ye=o?o.getTile(ee):ie?ie[ee.key]:new s.Tile(ee,z,I.zoom,d),ve=P?tg(le,v,d,P,{tileID:ee,tileSize:z}):bh(le,v,_);d.prepareDrawProgram(T,ne,ae);const{tileBoundsBuffer:xe,tileBoundsIndexBuffer:Ie,tileBoundsSegments:Ae}=d.getTileBoundsBuffers(ye);ne.draw(T,S.TRIANGLES,te,X,re,s.CullFaceMode.disabled,ve,c.id,xe,Ie,Ae)}},sky:function(d,o,c){const f=d.transform,_=f.projection.name==="mercator"||f.projection.name==="globe"?1:s.smoothstep(7,8,f.zoom),v=c.paint.get("sky-opacity")*_;if(v===0)return;const T=d.context,S=c.paint.get("sky-type"),I=new s.DepthMode(T.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),z=d.frameCounter/1e3%1;S==="atmosphere"?d.renderPass==="offscreen"?c.needsSkyboxCapture(d)&&(function(P,N,X,te){const re=P.context,ne=re.gl;let ie=N.skyboxFbo;if(!ie){ie=N.skyboxFbo=re.createFramebuffer(32,32,!1),N.skyboxGeometry=new Cc(re),N.skyboxTexture=re.gl.createTexture(),ne.bindTexture(ne.TEXTURE_CUBE_MAP,N.skyboxTexture),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_MAG_FILTER,ne.LINEAR);for(let le=0;le<6;++le)ne.texImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,ne.RGBA,32,32,0,ne.RGBA,ne.UNSIGNED_BYTE,null)}re.bindFramebuffer.set(ie.framebuffer),re.viewport.set([0,0,32,32]);const j=N.getCenter(P,!0),ee=P.useProgram("skyboxCapture"),ae=new Float64Array(16);s.identity(ae),s.rotateY(ae,ae,.5*-Math.PI),bi(re,N,ee,ae,j,0),s.identity(ae),s.rotateY(ae,ae,.5*Math.PI),bi(re,N,ee,ae,j,1),s.identity(ae),s.rotateX(ae,ae,.5*-Math.PI),bi(re,N,ee,ae,j,2),s.identity(ae),s.rotateX(ae,ae,.5*Math.PI),bi(re,N,ee,ae,j,3),s.identity(ae),bi(re,N,ee,ae,j,4),s.identity(ae),s.rotateY(ae,ae,Math.PI),bi(re,N,ee,ae,j,5),re.viewport.set([0,0,P.width,P.height])}(d,c),c.markSkyboxValid(d)):d.renderPass==="sky"&&function(P,N,X,te,re){const ne=P.context,ie=ne.gl,j=P.transform,ee=P.useProgram("skybox");ne.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_CUBE_MAP,N.skyboxTexture);const ae=((le,ye,ve,xe,Ie)=>({u_matrix:le,u_sun_direction:ye,u_cubemap:0,u_opacity:xe,u_temporal_offset:Ie}))(j.skyboxMatrix,N.getCenter(P,!1),0,te,re);P.prepareDrawProgram(ne,ee),ee.draw(ne,ie.TRIANGLES,X,s.StencilMode.disabled,P.colorModeForRenderPass(),s.CullFaceMode.backCW,ae,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(d,c,I,v,z):S==="gradient"&&d.renderPass==="sky"&&function(P,N,X,te,re){const ne=P.context,ie=ne.gl,j=P.transform,ee=P.useProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new Cc(ne)),ne.activeTexture.set(ie.TEXTURE0);let ae=N.colorRampTexture;ae||(ae=N.colorRampTexture=new s.Texture(ne,N.colorRamp,ie.RGBA)),ae.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const le=((ye,ve,xe,Ie,Ae)=>({u_matrix:ye,u_color_ramp:0,u_center_direction:ve,u_radius:s.degToRad(xe),u_opacity:Ie,u_temporal_offset:Ae}))(j.skyboxMatrix,N.getCenter(P,!1),N.paint.get("sky-gradient-radius"),te,re);P.prepareDrawProgram(ne,ee),ee.draw(ne,ie.TRIANGLES,X,s.StencilMode.disabled,P.colorModeForRenderPass(),s.CullFaceMode.backCW,le,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(d,c,I,v,z)},debug:function(d,o,c){for(let f=0;f<c.length;f++)ag(d,o,c[f])},custom:function(d,o,c,f){const _=d.context,v=c.implementation;if(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes("custom")||d.terrain&&(d.terrain.renderingToTexture||d.renderPass==="offscreen")&&c.isLayerDraped()){if(d.renderPass==="offscreen"){const T=v.prerender;if(T){if(d.setCustomLayerDefaults(),_.setColorMode(d.colorModeForRenderPass()),d.transform.projection.name==="globe"){const S=d.transform.pointMerc;T.call(v,_.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(d.transform.zoom),[S.x,S.y],d.transform.pixelsPerMeterRatio)}else T.call(v,_.gl,d.transform.customLayerMatrix());_.setDirty(),d.setBaseState()}}else if(d.renderPass==="translucent"){if(d.terrain&&d.terrain.renderingToTexture){const S=v.renderToTile;if(S){const I=f[0].canonical,z=new s.MercatorCoordinate(I.x+f[0].wrap*(1<<I.z),I.y,I.z);_.setDepthMode(s.DepthMode.disabled),_.setStencilMode(s.StencilMode.disabled),_.setColorMode(d.colorModeForRenderPass()),d.setCustomLayerDefaults(),S.call(v,_.gl,z),_.setDirty(),d.setBaseState()}return}d.setCustomLayerDefaults(),_.setColorMode(d.colorModeForRenderPass()),_.setStencilMode(s.StencilMode.disabled);const T=v.renderingMode==="3d"?new s.DepthMode(d.context.gl.LEQUAL,s.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(_.setDepthMode(T),d.transform.projection.name==="globe"){const S=d.transform.pointMerc;v.render(_.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(d.transform.zoom),[S.x,S.y],d.transform.pixelsPerMeterRatio)}else v.render(_.gl,d.transform.customLayerMatrix());_.setDirty(),d.setBaseState(),_.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class da{constructor(o,c,f=!1){this.context=new ct(o,f),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,c){const f=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ph(this,o));const _=this._terrain;this.transform.elevation=f?_:null,_.update(o,this.transform,c)}_updateFog(o){const c=o.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,_]=c.getFovAdjustedRange(this.transform._fov);if(f>_)return void(this.transform.fogCullDistSq=null);const v=f+.78*(_-f);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,c){if(this.width=o*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._layers[f].resize()}setup(){const o=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const f=new s.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=o.createVertexBuffer(f,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const _=new s.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(_,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const v=new s.StructArrayLayout4i8;v.emplaceBack(0,0,0,0),v.emplaceBack(s.EXTENT,0,s.EXTENT,0),v.emplaceBack(0,s.EXTENT,0,s.EXTENT),v.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(v,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const T=new s.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(T);const S=new s.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])S.emplaceBack(z);this.debugIndexBuffer=o.createIndexBuffer(S),this.emptyTexture=new s.Texture(o,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=s.create();const I=this.context.gl;this.stencilClearMode=new s.StencilMode({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new $p(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,c=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,pl(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,c,f){if(!c||this.currentStencilSource===c.id||!o.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let S=!1;for(const I of f)if(this._tileClippingMaskIDs[I.key]===void 0){S=!0;break}if(!S)return}this.currentStencilSource=c.id;const _=this.context,v=_.gl;this.nextStencilID+f.length>256&&this.clearStencil(),_.setColorMode(s.ColorMode.disabled),_.setDepthMode(s.DepthMode.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of f){const I=c.getTile(S),z=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,{tileBoundsBuffer:P,tileBoundsIndexBuffer:N,tileBoundsSegments:X}=this.getTileBoundsBuffers(I);T.draw(_,v.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:v.ALWAYS,mask:0},z,255,v.KEEP,v.KEEP,v.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,pl(S.projMatrix),"$clipping",P,N,X)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},o,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(o){const c=this.context.gl,f=o.sort((T,S)=>S.overscaledZ-T.overscaledZ),_=f[f.length-1].overscaledZ,v=f[0].overscaledZ-_+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const T={};for(let S=0;S<v;S++)T[S+_]=new s.StencilMode({func:c.GEQUAL,mask:255},S+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=v,[T,f]}return[{[_]:s.StencilMode.disabled},f]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([o.CONSTANT_COLOR,o.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(o,c,f){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new s.DepthMode(f||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,c){this.style=o,this.options=c,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const f=this.style.order,_=this.style._sourceCaches;for(const z in _){const P=_[z];P.used&&P.prepare(this.context)}const v={},T={},S={};for(const z in _){const P=_[z];v[z]=P.getVisibleCoordinates(),T[z]=v[z].slice().reverse(),S[z]=P.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<f.length;z++)if(this.style._layers[f[z]].is3D()){this.opaquePassCutoff=z;break}if(this.terrain&&(this.terrain.updateTileBinding(S),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const z of f){const P=this.style._layers[z],N=o._getLayerSourceCache(P);if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const X=N?T[N.id]:void 0;(P.type==="custom"||P.isSky()||X&&X.length)&&this.renderLayer(this,N,P,X)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const I=this.terrain;if(I&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&I.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[f[this.currentLayer]],P=o._getLayerSourceCache(z);if(z.isSky())continue;const N=P?T[P.id]:void 0;this._renderTileClippingMasks(z,P,N),this.renderLayer(this,P,z,N)}if(this.style.fog&&this.transform.projection.supportsFog&&function(z,P){const N=z.context,X=N.gl,te=z.transform,re=new s.DepthMode(X.LEQUAL,s.DepthMode.ReadOnly,[0,1]),ne=z.useProgram("globeAtmosphere",null,te.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ie=s.globeToMercatorTransition(te.zoom),j=P.properties.get("color").toArray01(),ee=P.properties.get("high-color").toArray01(),ae=P.properties.get("space-color").toArray01PremultipliedAlpha(),le=s.identity$1([]);s.rotateY$1(le,le,-s.degToRad(te._center.lng)),s.rotateX$1(le,le,s.degToRad(te._center.lat)),s.rotateZ$1(le,le,te.angle),s.rotateX$1(le,le,-te._pitch);const ye=s.fromQuat(new Float32Array(16),le),ve=s.mapValue(P.properties.get("star-intensity"),0,1,0,.25),xe=5e-4,Ie=s.mapValue(P.properties.get("horizon-blend"),0,1,xe,.25),Ae=s.globeUseCustomAntiAliasing(z,N,te)&&Ie===xe?te.worldSize/(2*Math.PI*1.025)-1:te.globeRadius,Be=z.frameCounter/1e3%1,it=s.length(te.globeCenterInViewSpace),De=Math.sqrt(Math.pow(it,2)-Math.pow(Ae,2)),Ze=Math.acos(De/it),Fe=((ze,He,at,Qe,lt,At,Ft,Et,zt,Jt,Xt,Ct,gn,vn)=>({u_frustum_tl:ze,u_frustum_tr:He,u_frustum_br:at,u_frustum_bl:Qe,u_horizon:lt,u_transition:At,u_fadeout_range:Ft,u_color:Et,u_high_color:zt,u_space_color:Jt,u_star_intensity:Xt,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ct,u_horizon_angle:gn,u_rotation_matrix:vn}))(te.frustumCorners.TL,te.frustumCorners.TR,te.frustumCorners.BR,te.frustumCorners.BL,te.frustumCorners.horizon,ie,Ie,j,ee,ae,ve,Be,Ze,ye);z.prepareDrawProgram(N,ne);const rt=z.atmosphereBuffer;rt&&ne.draw(N,X.TRIANGLES,re,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,Fe,"skybox",rt.vertexBuffer,rt.indexBuffer,rt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const z=this.style._layers[f[this.currentLayer]],P=o._getLayerSourceCache(z);z.isSky()&&this.renderLayer(this,P,z,P?T[P.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;){const z=this.style._layers[f[this.currentLayer]],P=o._getLayerSourceCache(z);if(z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(z)){if(z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const N=P?(z.type==="symbol"?S:T)[P.id]:void 0;this._renderTileClippingMasks(z,P,P?v[P.id]:void 0),this.renderLayer(this,P,z,N),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let z=null;s.values(this.style._layers).forEach(P=>{const N=o._getLayerSourceCache(P);N&&!P.isHidden(this.transform.zoom)&&(!z||z.getSource().maxzoom<N.getSource().maxzoom)&&(z=N)}),z&&this.options.showTileBoundaries&&Ds.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const P=z.transform.padding;Vp(z,z.transform.height-(P.top||0),3,ua),Vp(z,P.bottom||0,3,rg),Sc(z,P.left||0,3,ig),Sc(z,z.transform.width-(P.right||0),3,og);const N=z.transform.centerPoint;(function(X,te,re,ne){ha(X,te-1,re-10,2,20,ne),ha(X,te-10,re-1,20,2,ne)})(z,N.x,z.transform.height-N.y,sg)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,c,f,_){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||_&&_.length)&&(this.id=f.id,this.gpuTimingStart(f),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(f.type)||o.terrain&&f.type==="custom")&&Ds[f.type](o,c,f,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let f=this.gpuTimers[o.id];f||(f=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),f.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,f.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,c=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),o.beginQueryEXT(o.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const c={};for(const f in o){const _=o[f],v=this.context.extTimerQuery,T=v.getQueryObjectEXT(_.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(_.query),c[f]=T}return c}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let f=0;for(const _ of o)f+=c.getQueryObjectEXT(_,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(_);return f}translatePosMatrix(o,c,f,_,v){if(!f[0]&&!f[1])return o;const T=v?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(T){const z=Math.sin(T),P=Math.cos(T);f=[f[0]*P-f[1]*z,f[0]*z+f[1]*P]}const S=[v?f[0]:je(c,f[0],this.transform.zoom),v?f[1]:je(c,f[1],this.transform.zoom),0],I=new Float32Array(16);return s.translate(I,o,S),I}saveTileTexture(o){const c=this._tileTextures[o.size[0]];c?c.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const c=this._tileTextures[o];return c&&c.length>0?c.pop():null}isPatternMissing(o){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&this.terrain.exaggeration()===0,f=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),this.transform.projection.name==="globe"&&_.push("GLOBE"),c&&_.push("ZERO_EXAGGERATION"),f&&!o&&f.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),o&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(o,c,f){this.cache=this.cache||{};const _=f||[],v=this.currentGlobalDefines().concat(_),T=rn.cacheKey(ah[o],o,v,c);return this.cache[T]||(this.cache[T]=new rn(this.context,o,ah[o],c,Eh[o],v)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,c,f){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const v=_.getOpacity(this.transform.pitch),T=((S,I,z,P,N,X,te,re,ne,ie,j)=>{const ee=S.transform,ae=I.properties.get("color").toArray01();ae[3]=P;const le=S.frameCounter/1e3%1;return{u_fog_matrix:z?ee.calculateFogTileMatrix(z):S.identityMat,u_fog_range:I.getFovAdjustedRange(ee._fov),u_fog_color:ae,u_fog_horizon_blend:I.properties.get("horizon-blend"),u_fog_temporal_offset:le,u_frustum_tl:N,u_frustum_tr:X,u_frustum_br:te,u_frustum_bl:re,u_globe_pos:ne,u_globe_radius:ie,u_viewport:j,u_globe_transition:s.globeToMercatorTransition(ee.zoom),u_is_globe:+(ee.projection.name==="globe")}})(this,_,f,v,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);c.setFogUniformValues(o,T)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,c=o.createTexture();return o.bindTexture(o.TEXTURE_2D,c),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,c=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const _ of f)c[_.key]=o[_.key]||new s.Tile(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Ac{constructor(o=0,c=0,f=0,_=0){if(isNaN(o)||o<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=c,this.left=f,this.right=_}interpolate(o,c,f){return c.top!=null&&o.top!=null&&(this.top=s.number(o.top,c.top,f)),c.bottom!=null&&o.bottom!=null&&(this.bottom=s.number(o.bottom,c.bottom,f)),c.left!=null&&o.left!=null&&(this.left=s.number(o.left,c.left,f)),c.right!=null&&o.right!=null&&(this.right=s.number(o.right,c.right,f)),this}getCenter(o,c){const f=s.clamp((this.left+o-this.right)/2,0,o),_=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.Point(f,_)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Ac(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ic(d,o){const c=s.getColumn(d,3);s.fromQuat(d,o),s.setColumn(d,3,c)}function sn(d,o){const c=s.identity$1([]);return s.rotateZ$1(c,c,-o),s.rotateX$1(c,c,-d),c}function vl(d,o){const c=[d[0],d[1],0],f=[o[0],o[1],0];if(s.length(c)>=1e-15){const T=s.normalize([],c);s.scale$2(f,T,s.dot(f,T)),o[0]=f[0],o[1]=f[1]}const _=s.cross([],o,d);if(s.len(_)<1e-15)return null;const v=Math.atan2(-_[1],_[0]);return sn(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),v)}class Wp{constructor(o,c){this.position=o,this.orientation=c}get position(){return this._position}set position(o){if(o){const c=o instanceof s.MercatorCoordinate?o:new s.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(c.x=s.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(o,c){if(this.orientation=null,!this.position)return;const f=this.position,_=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(o)):0,v=s.MercatorCoordinate.fromLngLat(o,_),T=[v.x-f.x,v.y-f.y,v.z-f.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=vl(T,c)}setPitchBearing(o,c){this.orientation=sn(s.degToRad(o),s.degToRad(-c))}}class kc{constructor(o,c){this._transform=s.identity([]),this.orientation=c,this.position=o}get mercatorPosition(){const o=this.position;return new s.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=s.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var c;o&&s.setColumn(this._transform,3,[(c=o)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||s.identity$1([]),o&&Ic(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,c){this._orientation=sn(o,c),Ic(this._transform,this._orientation)}forward(){const o=s.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=s.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=s.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,c){const f=new Float64Array(16);return s.invert(f,this.getWorldToCamera(o,c)),f}getWorldToCameraPosition(o,c,f){const _=this.position;s.scale$2(_,_,-o);const v=new Float64Array(16);return s.fromScaling(v,[f,f,f]),s.translate(v,v,_),v[10]*=c,v}getWorldToCamera(o,c){const f=new Float64Array(16),_=new Float64Array(4),v=this.position;return s.conjugate(_,this._orientation),s.scale$2(v,v,-o),s.fromQuat(f,_),s.translate(f,f,v),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=c,f[9]*=c,f[10]*=c,f[11]*=c,f}getCameraToClipPerspective(o,c,f,_){const v=new Float64Array(16);return s.perspective(v,o,c,f,_),v}getDistanceToElevation(o,c=!1){const f=o===0?0:s.mercatorZfromAltitude(o,c?s.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(f-this.position[2])/_[2]}clone(){return new kc([...this.position],[...this.orientation])}}function pa(d,o){const c=Mc(d.projection,d.zoom,d.width,d.height),f=function(v,T,S,I,z){const P=new s.LngLat(S.lng-180*Bo,S.lat),N=new s.LngLat(S.lng+180*Bo,S.lat),X=v.project(P.lng,P.lat),te=v.project(N.lng,N.lat),re=-Math.atan2(te.y-X.y,te.x-X.x),ne=s.MercatorCoordinate.fromLngLat(S);ne.y=s.clamp(ne.y,-1+Bo,1-Bo);const ie=ne.toLngLat(),j=v.project(ie.lng,ie.lat),ee=s.MercatorCoordinate.fromLngLat(ie);ee.x+=Bo;const ae=ee.toLngLat(),le=v.project(ae.lng,ae.lat),ye=Dc(le.x-j.x,le.y-j.y,re),ve=s.MercatorCoordinate.fromLngLat(ie);ve.y+=Bo;const xe=ve.toLngLat(),Ie=v.project(xe.lng,xe.lat),Ae=Dc(Ie.x-j.x,Ie.y-j.y,re),Be=Math.abs(ye.x)/Math.abs(Ae.y),it=s.identity([]);s.rotateZ(it,it,-re*(1-(z?0:I)));const De=s.identity([]);return s.scale(De,De,[1,1-(1-Be)*I,1]),De[4]=-Ae.x/Ae.y*I,s.rotateZ(De,De,re),s.multiply(De,it,De),De}(d.projection,0,d.center,c,o),_=Hp(d);return s.scale(f,f,[_,_,1]),f}function Hp(d){const o=d.projection,c=Mc(d.projection,d.zoom,d.width,d.height),f=Zp(o,d.center),_=Zp(o,s.LngLat.convert(o.center));return Math.pow(2,f*c+(1-c)*_)}function Mc(d,o,c,f,_=1/0){const v=d.range;if(!v)return 0;const T=Math.min(_,Math.max(c,f)),S=Math.log(T/1024)/Math.LN2;return s.smoothstep(v[0]+S,v[1]+S,o)}const Bo=1/4e4;function Zp(d,o){const c=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),f=new s.LngLat(o.lng-180*Bo,c),_=new s.LngLat(o.lng+180*Bo,c),v=d.project(f.lng,c),T=d.project(_.lng,c),S=s.MercatorCoordinate.fromLngLat(f),I=s.MercatorCoordinate.fromLngLat(_),z=T.x-v.x,P=T.y-v.y,N=I.x-S.x,X=I.y-S.y,te=Math.sqrt((N*N+X*X)/(z*z+P*P));return Math.log(te)/Math.LN2}function Dc(d,o,c){const f=Math.cos(c),_=Math.sin(c);return{x:d*f-o*_,y:d*_+o*f}}class fa{constructor(o,c,f,_,v,T,S){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=o||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=_??60,this.setProjection(T),this.setMaxBounds(S),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ac,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new kc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new fa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,c=!1){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(o||f)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const f=!C(c,this.getProjection());return f&&this._calcMatrices(),this.mercatorFromTransition=!1,f}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const c=o!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const c=-o*Math.PI/180;var f;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(f=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(_,v,T){var S=v[0],I=v[1],z=v[2],P=v[3],N=Math.sin(T),X=Math.cos(T);_[0]=S*X+z*N,_[1]=I*X+P*N,_[2]=S*-N+z*X,_[3]=I*-N+P*X}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const c=s.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=s.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const c=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let _=0,v=0;for(let T=0;T<c.length;T++){const S=new s.Point(c[T][0]*this.width,f+c[T][1]*(this.height-f)),I=o.pointCoordinate(S);if(!I)continue;const z=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);_+=I[3]*z,v+=z}return v===0?NaN:_/v}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*c,_=this._mercatorZfromZoom(o),v=this._mercatorZfromZoom(this._maxZoom),T=Math.max(_-f,v);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let f;f=o.z<this._camera.position[2]?[c.x,c.y,c.z]:[o.x,o.y,o.z];const _=s.length(s.sub([],this._camera.position,f));return s.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let c=!1;if(o.orientation&&!s.exactEquals(o.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(o.orientation)),o.position){const f=[o.position.x,o.position.y,o.position.z];s.exactEquals$1(f,this._camera.position)||(this._setCameraPosition(f),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,c=new Wp;return c.position=new s.MercatorCoordinate(o[0],o[1],o[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(o){if(!s.length$1(o))return!1;s.normalize$1(o,o);const c=s.transformQuat([],[0,0,-1],o),f=s.transformQuat([],[0,-1,0],o);if(f[2]<0)return!1;const _=vl(c,f);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(o){const c=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;o[2]=s.clamp(o[2],_/f,_/c),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,c,f){this._unmodified=!1,this._edgeInsets.interpolate(o,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const c=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(o){const c=[new s.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const f=this.pointCoordinate(new s.Point(0,0)),_=this.pointCoordinate(new s.Point(this.width,0)),v=this.pointCoordinate(new s.Point(this.width,this.height)),T=this.pointCoordinate(new s.Point(0,this.height)),S=Math.floor(Math.min(f.x,_.x,v.x,T.x)),I=Math.floor(Math.max(f.x,_.x,v.x,T.x)),z=1;for(let P=S-z;P<=I+z;P++)P!==0&&c.push(new s.UnwrappedTileID(P,o))}return c}coveringTiles(o){let c=this.coveringZoomLevel(o);const f=c,_=this.elevation&&!o.isTerrainDEM,v=this.projection.name==="mercator";if(o.minzoom!==void 0&&c<o.minzoom)return[];o.maxzoom!==void 0&&c>o.maxzoom&&(c=o.maxzoom);const T=this.locationCoordinate(this.center),S=this.center.lat,I=1<<c,z=[I*T.x,I*T.y,0],P=this.projection.name==="globe",N=!P,X=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,N),te=P?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),re=I*s.mercatorZfromAltitude(1,this.center.lat),ne=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),ie=[I*te.x,I*te.y,ne*(N?1:re)],j=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),ee=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,ae=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,le=o.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,ye=this.projection.isReprojectedInTileSpace?Hp(this):1,ve=ze=>{const at=new s.MercatorCoordinate(ze.x+25e-6,ze.y,ze.z),Qe=new s.MercatorCoordinate(ze.x,ze.y+25e-6,ze.z),lt=ze.toLngLat(),At=at.toLngLat(),Ft=Qe.toLngLat(),Et=this.locationCoordinate(lt),zt=this.locationCoordinate(At),Jt=this.locationCoordinate(Ft),Xt=Math.hypot(zt.x-Et.x,zt.y-Et.y),Ct=Math.hypot(Jt.x-Et.x,Jt.y-Et.y);return Math.sqrt(Xt*Ct)*ye/25e-6},xe=ze=>{const He=ae,at=le;return{aabb:s.tileAABB(this,I,0,0,0,ze,at,He,this.projection),zoom:0,x:0,y:0,minZ:at,maxZ:He,wrap:ze,fullyVisible:!1}},Ie=[];let Ae=[];const Be=c,it=o.reparseOverscaled?f:c,De=ze=>ze*ze,Ze=De((ne-this._centerAltitude)*re),Fe=ze=>{if(!this._elevation||!ze.tileID||!v)return;const He=this._elevation.getMinMaxForTile(ze.tileID),at=ze.aabb;He?(at.min[2]=He.min,at.max[2]=He.max,at.center[2]=(at.min[2]+at.max[2])/2):(ze.shouldSplit=rt(ze),ze.shouldSplit||(at.min[2]=at.max[2]=at.center[2]=this._centerAltitude))},rt=ze=>{if(ze.zoom<ee)return!0;if(ze.zoom===Be)return!1;if(ze.shouldSplit!=null)return ze.shouldSplit;const He=ze.aabb.distanceX(ie),at=ze.aabb.distanceY(ie);let Qe=Ze,lt=1;if(P){Qe=De(ze.aabb.distanceZ(ie));const Et=Math.pow(2,ze.zoom),zt=s.latFromMercatorY((ze.y+1)/Et),Jt=s.latFromMercatorY(ze.y/Et),Xt=Math.min(Math.max(S,zt),Jt),Ct=s.circumferenceAtLatitude(Xt)/s.circumferenceAtLatitude(S);if(lt=Xt===S?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ct/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&ze.zoom===Be-1&&Ct>=.9)return!0}else if(_&&(Qe=De(ze.aabb.distanceZ(ie)*re)),this.projection.isReprojectedInTileSpace&&f<=5){const Et=Math.pow(2,ze.zoom),zt=ve(new s.MercatorCoordinate((ze.x+.5)/Et,(ze.y+.5)/Et));lt=zt>.85?1:zt}const At=He*He+at*at+Qe,Ft=De((1<<Be-ze.zoom)*j*lt*((Et,zt)=>{if(zt*De(.707)<Et)return 1;const Jt=Math.sqrt(zt/Et);return Jt/(1.4144271570014144+(Math.pow(1.1,Jt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Qe,Ze),At));return At<Ft};if(this.renderWorldCopies)for(let ze=1;ze<=3;ze++)Ie.push(xe(-ze)),Ie.push(xe(ze));for(Ie.push(xe(0));Ie.length>0;){const ze=Ie.pop(),He=ze.x,at=ze.y;let Qe=ze.fullyVisible;if(!Qe){const lt=ze.aabb.intersects(X);if(lt===0)continue;Qe=lt===2}if(ze.zoom!==Be&&rt(ze))for(let lt=0;lt<4;lt++){const At=(He<<1)+lt%2,Ft=(at<<1)+(lt>>1),Et={aabb:v?ze.aabb.quadrant(lt):s.tileAABB(this,I,ze.zoom+1,At,Ft,ze.wrap,ze.minZ,ze.maxZ,this.projection),zoom:ze.zoom+1,x:At,y:Ft,wrap:ze.wrap,fullyVisible:Qe,tileID:void 0,shouldSplit:void 0,minZ:ze.minZ,maxZ:ze.maxZ};_&&!P&&(Et.tileID=new s.OverscaledTileID(ze.zoom+1===Be?it:ze.zoom+1,ze.wrap,ze.zoom+1,At,Ft),Fe(Et)),Ie.push(Et)}else{const lt=ze.zoom===Be?it:ze.zoom;if(o.minzoom&&o.minzoom>lt)continue;const At=z[0]-(.5+He+(ze.wrap<<ze.zoom))*(1<<c-ze.zoom),Ft=z[1]-.5-at,Et=ze.tileID?ze.tileID:new s.OverscaledTileID(lt,ze.wrap,ze.zoom,He,at);Ae.push({tileID:Et,distanceSq:At*At+Ft*Ft})}}if(this.fogCullDistSq){const ze=this.fogCullDistSq,He=this.horizonLineFromTop();Ae=Ae.filter(at=>{const Qe=[0,0,0,1],lt=[s.EXTENT,s.EXTENT,0,1],At=this.calculateFogTileMatrix(at.tileID.toUnwrapped());s.transformMat4$1(Qe,Qe,At),s.transformMat4$1(lt,lt,At);const Ft=s.getAABBPointSquareDist(Qe,lt);if(Ft===0)return!0;let Et=!1;const zt=this._elevation;if(zt&&Ft>ze&&He!==0){const Jt=this.calculateProjMatrix(at.tileID.toUnwrapped());let Xt;o.isTerrainDEM||(Xt=zt.getMinMaxForTile(at.tileID)),Xt||(Xt={min:le,max:ae});const Ct=s.furthestTileCorner(this.rotation),gn=[Ct[0]*s.EXTENT,Ct[1]*s.EXTENT,Xt.max];s.transformMat4(gn,gn,Jt),Et=(1-gn[1])*this.height*.5<He}return Ft<ze||Et})}return Ae.sort((ze,He)=>ze.distanceSq-He.distanceSq).map(ze=>ze.tileID)}resize(o,c){this.width=o,this.height=c,this.pixelsToGLUnits=[2/o,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const c=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),f=this.projection.project(o.lng,c);return new s.Point(f.x*this.worldSize,f.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,c){let f,_;const v=this.centerPoint;if(this.projection.name==="globe"){const S=this.worldSize;f=(c.x-v.x)/S,_=(c.y-v.y)/S}else{const S=this.pointCoordinate(c),I=this.pointCoordinate(v);f=S.x-I.x,_=S.y-I.y}const T=this.locationCoordinate(o);this.setLocation(new s.MercatorCoordinate(T.x-f,T.y-_))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,c){const f=c?s.mercatorZfromAltitude(c,o.lat):void 0,_=this.projection.project(o.lng,o.lat);return new s.MercatorCoordinate(_.x,_.y,f)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,c){const f=c??this._centerAltitude,_=[o.x,o.y,0,1],v=[o.x,o.y,1,1];s.transformMat4$1(_,_,this.pixelMatrixInverse),s.transformMat4$1(v,v,this.pixelMatrixInverse);const T=v[3];s.scale$1(_,_,1/_[3]),s.scale$1(v,v,1/T);const S=_[2],I=v[2];return{p0:_,p1:v,t:S===I?0:(f-S)/(I-S)}}screenPointToMercatorRay(o){const c=[o.x,o.y,0,1],f=[o.x,o.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(f,f,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(f,f,1/f[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,f[2]=s.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(f,f,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],f,c)))}rayIntersectionCoordinate(o){const{p0:c,p1:f,t:_}=o,v=s.mercatorZfromAltitude(c[2],this._center.lat),T=s.mercatorZfromAltitude(f[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],f[0],_)/this.worldSize,s.number(c[1],f[1],_)/this.worldSize,s.number(v,T,_))}pointCoordinate(o,c=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,c)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let c=this.projection.pointCoordinate3D(this,o.x,o.y);if(c)return new s.MercatorCoordinate(c[0],c[1],c[2]);let f=0,_=this.horizonLineFromTop();if(o.y>_)return this.pointCoordinate(o);const v=.02*_,T=o.clone();for(let S=0;S<10&&_-f>v;S++){T.y=s.number(f,_,.66);const I=this.projection.pointCoordinate3D(this,T.x,T.y);I?(_=T.y,c=I):f=T.y}return c?new s.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const c=this.pointCoordinate(o);return c.y>=0&&c.y<=1}_coordinatePoint(o,c){const f=c&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,_=[o.x*this.worldSize,o.y*this.worldSize,f+o.toAltitude(),1];return s.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new s.Point(_[0]/_[3],_[1]/_[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:c}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,v=this.pointLocation3D(new s.Point(c,o)),T=this.pointLocation3D(new s.Point(_,o)),S=this.pointLocation3D(new s.Point(_,f)),I=this.pointLocation3D(new s.Point(c,f));let z=Math.min(v.lng,T.lng,S.lng,I.lng),P=Math.max(v.lng,T.lng,S.lng,I.lng),N=Math.min(v.lat,T.lat,S.lat,I.lat),X=Math.max(v.lat,T.lat,S.lat,I.lat);const te=Math.pow(2,-this.zoom)/16*270,re=this.projection.name==="globe"?1:4,ne=(ie,j,ee,ae,le)=>{const ye=(ie+ee)/2,ve=(j+ae)/2,xe=new s.Point(ye,ve),{lng:Ie,lat:Ae}=this.pointLocation3D(xe),Be=Math.max(0,z-Ie,N-Ae,Ie-P,Ae-X);z=Math.min(z,Ie),P=Math.max(P,Ie),N=Math.min(N,Ae),X=Math.max(X,Ae),(le<re||Be>te)&&(ne(ie,j,ye,ve,le+1),ne(ye,ve,ee,ae,le+1))};if(ne(c,o,_,o,1),ne(_,o,_,f,1),ne(_,f,c,f,1),ne(c,f,c,o,1),this.projection.name==="globe"){const[ie,j]=s.polesInViewport(this);ie?(X=90,P=180,z=-180):j&&(N=-90,P=180,z=-180)}return new s.LngLatBounds(new s.LngLat(z,N),new s.LngLat(P,X))}_getBoundsRectangular(o,c){const{top:f,left:_}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,S=new s.Point(_,f),I=new s.Point(T,f),z=new s.Point(T,v),P=new s.Point(_,v);let N=this.pointCoordinate(S,o),X=this.pointCoordinate(I,o);const te=this.pointCoordinate(z,c),re=this.pointCoordinate(P,c),ne=(ie,j)=>(j.y-ie.y)/(j.x-ie.x);return N.y>1&&X.y>=0?N=new s.MercatorCoordinate((1-re.y)/ne(re,N)+re.x,1):N.y<0&&X.y<=1&&(N=new s.MercatorCoordinate(-re.y/ne(re,N)+re.x,0)),X.y>1&&N.y>=0?X=new s.MercatorCoordinate((1-te.y)/ne(te,X)+te.x,1):X.y<0&&N.y<=1&&(X=new s.MercatorCoordinate(-te.y/ne(te,X)+te.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(N)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=o.visibleDemTiles.reduce((f,_)=>{if(_.dem){const v=_.dem.tree;f.min=Math.min(f.min,v.minimums[0]),f.max=Math.max(f.max,v.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*o.exaggeration(),c.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,f=this.height/2-c*(1-this._horizonShift);return o?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,c){return this.projection.createTileMatrix(this,c,o)}calculateDistanceTileData(o){const c=o.key,f=this._distanceTileDataCache;if(f[c])return f[c];const _=o.canonical,v=1/this.height,T=this.cameraWorldSize,S=T/this.zoomScale(_.z),I=(_.x+Math.pow(2,_.z)*o.wrap)*S,z=_.y*S,P=this.point;P.x*=T/this.worldSize,P.y*=T/this.worldSize;const N=this.angle,X=Math.sin(-N),te=-Math.cos(-N);return f[c]={bearing:[X,te],center:[(P.x-I)*v,(P.y-z)*v],scale:S/s.EXTENT*v},f[c]}calculateFogTileMatrix(o){const c=o.key,f=this._fogTileMatrixCache;if(f[c])return f[c];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return s.multiply(_,this.worldToFogMatrix,_),f[c]=new Float32Array(_),f[c]}calculateProjMatrix(o,c=!1){const f=o.key,_=c?this._alignedProjMatrixCache:this._projMatrixCache;if(_[f])return _[f];const v=this.calculatePosMatrix(o,this.worldSize);return s.multiply(v,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,v),_[f]=new Float32Array(v),_[f]}calculatePixelsToTileUnitsMatrix(o){const c=o.tileID.key,f=this._pixelsToTileUnitsCache;if(f[c])return f[c];const _=function(v,T){const{scale:S}=v.tileTransform,I=S*s.EXTENT/(v.tileSize*Math.pow(2,T.zoom-v.tileID.overscaledZ+v.tileID.canonical.z));return z=new Float32Array(4),X=(P=T.inverseAdjustmentMatrix)[1],te=P[2],re=P[3],ie=(N=[I,I])[1],z[0]=P[0]*(ne=N[0]),z[1]=X*ne,z[2]=te*ie,z[3]=re*ie,z;var z,P,N,X,te,re,ne,ie}(o,this);return f[c]=_,f[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,c=s.fromScaling([],[o,o,o]);return s.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(c),_=this._camera.forward(),v=s.mercatorZfromAltitude(1,this._center.lat);f[2]/=v,_[2]/=v,s.normalize(_,_);const T=o.raycast(f,_,o.exaggeration());if(T){const S=s.scaleAndAdd([],f,_,T),I=new s.MercatorCoordinate(S[0],S[1],s.mercatorZfromAltitude(S[2],s.latFromMercatorY(S[1]))),z=(I.z+s.length([I.x-f[0],I.y-f[1],I.z-f[2]*v]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const c=this._elevation,f=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(f),v=c.getAtPointOrZero(new s.MercatorCoordinate(..._)),T=this.pixelsPerMeter/this.worldSize*v,S=this._minimumHeightOverTerrain(),I=_[2]-T;if(I<=S)if(I<0||o){const z=this.locationCoordinate(this._center,this._centerAltitude),P=[_[0],_[1],z.z-_[2]],N=s.length(P);P[2]-=(S-I)/this._pixelsPerMercatorPixel;const X=s.length(P);if(X===0)return;s.scale$2(P,P,N/X*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],z.z*this._pixelsPerMercatorPixel-P[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const X=this.center;return X.lat=s.clamp(X.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(X.lng=s.clamp(X.lng,this.minLng,this.maxLng)),this.center=X,void(this._constraining=!1)}const c=this._unmodified,{x:f,y:_}=this.point;let v=0,T=f,S=_;const I=this.width/2,z=this.height/2,P=this.worldMinY*this.scale,N=this.worldMaxY*this.scale;if(_-z<P&&(S=P+z),_+z>N&&(S=N-z),N-P<this.height&&(v=Math.max(v,this.height/(N-P)),S=(N+P)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const X=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,re=this.worldSize/2-(X+te)/2;T=(f+re+this.worldSize)%this.worldSize-re,T-I<X&&(T=X+I),T+I>te&&(T=te-I),te-X<this.width&&(v=Math.max(v,this.width/(te-X)),T=(te+X)/2)}T===f&&S===_||(this.center=this.unproject(new s.Point(T,S))),v&&(this.zoom+=this.scaleZoom(v)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const f=Mc(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,f),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this.projection.zAxisUnit==="meters"?c:1,v=this._camera.getWorldToCamera(this.worldSize,_),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-o.x/this.width,T[9]=2*o.y/this.height;let S=s.mul([],T,v);if(this.projection.isReprojectedInTileSpace){const ve=this.locationCoordinate(this.center),xe=s.identity([]);s.translate(xe,xe,[ve.x*this.worldSize,ve.y*this.worldSize,0]),s.multiply(xe,xe,pa(this)),s.translate(xe,xe,[-ve.x*this.worldSize,-ve.y*this.worldSize,0]),s.multiply(S,S,xe),this.inverseAdjustmentMatrix=function(Ie){const Ae=pa(Ie,!0);return Te([],[Ae[0],Ae[1],Ae[4],Ae[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],S,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=S,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const I=s.invert([],T);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(I,this.horizonLineFromTop(),this.height);const z=new Float32Array(16);s.identity(z),s.scale(z,z,[1,-1,1]),s.rotateX(z,z,this._pitch),s.rotateZ(z,z,this.angle);const P=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),N=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;P[8]=2*-o.x/this.width,P[9]=2*(o.y+N)/this.height,this.skyboxMatrix=s.multiply(z,P,z);const X=this.point,te=X.x,re=X.y,ne=this.width%2/2,ie=this.height%2/2,j=Math.cos(this.angle),ee=Math.sin(this.angle),ae=te-Math.round(te)+j*ne+ee*ie,le=re-Math.round(re)+j*ie+ee*ne,ye=new Float64Array(S);if(s.translate(ye,ye,[ae>.5?ae-1:ae,le>.5?le-1:le,0]),this.alignedProjMatrix=ye,S=s.create(),s.scale(S,S,[this.width/2,-this.height/2,1]),s.translate(S,S,[1,-1,0]),this.labelPlaneMatrix=S,S=s.create(),s.scale(S,S,[1,-1,1]),s.translate(S,S,[-1,-1,0]),s.scale(S,S,[2/this.width,2/this.height,1]),this.glCoordMatrix=S,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},S=s.invert(new Float64Array(16),this.pixelMatrix),!S)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=S,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(ve,ve,v),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=S;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,f=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,v=[o,o,c];s.scale$2(v,v,_),s.scale$2(f,f,-1),s.multiply$2(f,f,v);const T=s.create();s.translate(T,T,f),s.scale(T,T,v),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,c,_)}_computeCameraPosition(o){const c=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),_=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-o/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-f[0]*v,_.y/this.worldSize-f[1]*v,o/this.worldSize*this._centerAltitude-f[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],_=o[2];let v=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(v=Math.min((c-f)/_,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,o,v),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,c=this._camera.forward(),{pitch:f,bearing:_}=this._camera.getPitchBearing(),v=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),S=Math.max((o[2]-v)/Math.cos(f),T),I=this._zoomFromMercatorZ(S);s.scaleAndAdd(o,o,c,S),this._pitch=s.clamp(f,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(_,-Math.PI,Math.PI),this._setZoom(s.clamp(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let c=0,f=s.GLOBE_ZOOM_THRESHOLD_MAX,_=0,v=1/0;for(;f-c>1e-6&&f>c;){const T=c+.5*(f-c),S=this.tileSize*Math.pow(2,T),I=this.getCameraToCenterDistance(this.projection,T,S),z=this.scaleZoom(I/(o*this.tileSize)),P=Math.abs(T-z);P<v&&(v=P,_=T),T<z?c=T:f=T}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,c){const f=Math.min(o.x,c.x),_=Math.max(o.x,c.x),v=Math.min(o.y,c.y),T=Math.max(o.y,c.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const S=[new s.Point(f,v),new s.Point(_,T),new s.Point(f,T),new s.Point(_,v)],I=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const P of S){const N=this.pointRayIntersection(P);if(N.t<0)return!0;const X=this.rayIntersectionCoordinate(N);if(X.x<I||X.y<0||X.x>z||X.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(o,c){const f=s.length(s.sub([],this._camera.position,o)),_=this._zoomFromMercatorZ(f)+c;return f-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([c,f,_],v){const T=[c,f,_,1];s.transformMat4$1(T,T,v);const S=T[3]=Math.max(T[3],1e-6);return T[0]/=S,T[1]/=S,T[2]/=S,T}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,o))}}getCameraToCenterDistance(o,c=this.zoom,f=this.worldSize){const _=Mc(o,c,this.width,this.height,1024),v=o.pixelSpaceConversion(this.center.lat,f,_);return .5/Math.tan(.5*this._fov)*this.height*v}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(o,o,this.globeMatrix),o}}function ma(d,o){let c=!1,f=null;const _=()=>{f=null,c&&(d(),f=setTimeout(_,o),c=!1)};return()=>(c=!0,f||_(),f)}class Ch{constructor(o){this._hashName=o&&encodeURIComponent(o),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ma(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,s.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const c=wl(o);if(this._hashName){const f=this._hashName;let _=!1;const v=s.window.location.hash.slice(1).split("&").map(T=>{const S=T.split("=")[0];return S===f?(_=!0,`${S}=${c}`):T}).filter(T=>T);return _||v.push(`${f}=${c}`),`#${v.join("&")}`}return`#${c}`}_getCurrentHash(){const o=s.window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(f=>isNaN(f))){const f=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(c[3]||0):o.getBearing();return o.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,o)}}function wl(d,o){const c=d.getCenter(),f=Math.round(100*d.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,_),T=Math.round(c.lng*v)/v,S=Math.round(c.lat*v)/v,I=d.getBearing(),z=d.getPitch();let P=o?`/${T}/${S}/${f}`:`${f}/${S}/${T}`;return(I||z)&&(P+="/"+Math.round(10*I)/10),z&&(P+=`/${Math.round(z)}`),P}const bl={linearity:.3,easing:s.bezier(0,0,.3,1)},Pc=s.extend({deceleration:2500,maxSpeed:1400},bl),zc=s.extend({deceleration:20,maxSpeed:1400},bl),vt=s.extend({deceleration:1e3,maxSpeed:360},bl),Vi=s.extend({deceleration:1e3,maxSpeed:90},bl);class Xp{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,c=s.exported.now();for(;o.length>0&&c-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)c.zoom+=v.zoomDelta||0,c.bearing+=v.bearingDelta||0,c.pitch+=v.pitchDelta||0,v.panDelta&&c.pan._add(v.panDelta),v.around&&(c.around=v.around),v.pinchAround&&(c.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const v=Tl(c.pan.mag(),f,s.extend({},Pc,o||{}));_.offset=c.pan.mult(v.amount/c.pan.mag()),_.center=this._map.transform.center,El(_,v)}if(c.zoom){const v=Tl(c.zoom,f,zc);_.zoom=this._map.transform.zoom+v.amount,El(_,v)}if(c.bearing){const v=Tl(c.bearing,f,vt);_.bearing=this._map.transform.bearing+s.clamp(v.amount,-179,179),El(_,v)}if(c.pitch){const v=Tl(c.pitch,f,Vi);_.pitch=this._map.transform.pitch+v.amount,El(_,v)}if(_.zoom||_.bearing){const v=c.pinchAround===void 0?c.around:c.pinchAround;_.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function El(d,o){(!d.duration||d.duration<o.duration)&&(d.duration=o.duration,d.easing=o.easing)}function Tl(d,o,c){const{maxSpeed:f,linearity:_,deceleration:v}=c,T=s.clamp(d*_/(o/1e3),-f,f),S=Math.abs(T)/(v*_);return{easing:c.easing,duration:1e3*S,amount:T*(S/2)}}class br extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,f,_={}){const v=ue(c.getCanvasContainer(),f),T=c.unproject(v);super(o,s.extend({point:v,lngLat:T,originalEvent:f},_)),this._defaultPrevented=!1,this.target=c}}class Sl extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,f){const _=o==="touchend"?f.changedTouches:f.touches,v=fe(c.getCanvasContainer(),_),T=v.map(I=>c.unproject(I)),S=v.reduce((I,z,P,N)=>I.add(z.div(N.length)),new s.Point(0,0));super(o,{points:v,point:S,lngLats:T,lngLat:c.unproject(S),originalEvent:f}),this._defaultPrevented=!1}}class Bc extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,f){super(o,{originalEvent:f}),this._defaultPrevented=!1}}class Ah{constructor(o,c){this._map=o,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Bc(o.type,this._map,o))}mousedown(o,c){return this._mousedownPos=c,this._firePreventable(new br(o.type,this._map,o))}mouseup(o){this._map.fire(new br(o.type,this._map,o))}preclick(o){const c=s.extend({},o);c.type="preclick",this._map.fire(new br(c.type,this._map,c))}click(o,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(o),this._map.fire(new br(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new br(o.type,this._map,o))}mouseover(o){this._map.fire(new br(o.type,this._map,o))}mouseout(o){this._map.fire(new br(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Sl(o.type,this._map,o))}touchmove(o){this._map.fire(new Sl(o.type,this._map,o))}touchend(o){this._map.fire(new Sl(o.type,this._map,o))}touchcancel(o){this._map.fire(new Sl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Lc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new br(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new br("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new br(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kp{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,c){this.isEnabled()&&o.shiftKey&&o.button===0&&(W(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(o,c){if(!this._active)return;const f=c,_=this._startPos,v=this._lastPos;if(!_||!v||v.equals(f)||!this._box&&f.dist(_)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=F("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const T=Math.min(_.x,f.x),S=Math.max(_.x,f.x),I=Math.min(_.y,f.y),z=Math.max(_.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${I}px)`,this._box.style.width=S-T+"px",this._box.style.height=z-I+"px")})}mouseupWindow(o,c){if(!this._active)return;const f=this._startPos,_=c;if(f&&o.button===0){if(this.reset(),Q(),f.x!==_.x||f.y!==_.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:v=>v.fitScreenCoordinates(f,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),O(),delete this._startPos,delete this._lastPos}_fireEvent(o,c){return this._map.fire(new s.Event(o,{originalEvent:c}))}}function Rc(d,o){const c={};for(let f=0;f<d.length;f++)c[d[f].identifier]=o[f];return c}class ga{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const v=new s.Point(0,0);for(const T of _)v._add(T);return v.div(_.length)}(c),this.touches=Rc(f,c)))}touchmove(o,c,f){if(this.aborted||!this.centroid)return;const _=Rc(f,c);for(const v in this.touches){const T=_[v];(!T||T.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(o,c,f){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Ih{constructor(o){this.singleTap=new ga(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,c,f){this.singleTap.touchstart(o,c,f)}touchmove(o,c,f){this.singleTap.touchmove(o,c,f)}touchend(o,c,f){const _=this.singleTap.touchend(o,c,f);if(_){const v=o.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(_)<30;if(v&&T||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class lg{constructor(){this._zoomIn=new Ih({numTouches:1,numTaps:2}),this._zoomOut=new Ih({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,c,f){this._zoomIn.touchstart(o,c,f),this._zoomOut.touchstart(o,c,f)}touchmove(o,c,f){this._zoomIn.touchmove(o,c,f),this._zoomOut.touchmove(o,c,f)}touchend(o,c,f){const _=this._zoomIn.touchend(o,c,f),v=this._zoomOut.touchend(o,c,f);return _?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(_)},{originalEvent:o})}):v?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(v)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Yp={0:1,2:2};class _a{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,c){return!1}_move(o,c){return{}}mousedown(o,c){if(this._lastPoint)return;const f=we(o);this._correctButton(o,f)&&(this._lastPoint=c,this._eventButton=f)}mousemoveWindow(o,c){const f=this._lastPoint;if(f){if(o.preventDefault(),this._eventButton!=null&&function(_,v){const T=Yp[v];return _.buttons===void 0||(_.buttons&T)!==T}(o,this._eventButton))this.reset();else if(this._moved||!(c.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(f,c)}}mouseupWindow(o){this._lastPoint&&we(o)===this._eventButton&&(this._moved&&Q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kh extends _a{mousedown(o,c){super.mousedown(o,c),this._lastPoint&&(this._active=!0)}_correctButton(o,c){return c===0&&!o.ctrlKey}_move(o,c){return{around:c,panDelta:c.sub(o)}}}class Mh extends _a{_correctButton(o,c){return c===0&&o.ctrlKey||c===2}_move(o,c){const f=.8*(c.x-o.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(o){o.preventDefault()}}class Dh extends _a{_correctButton(o,c){return c===0&&o.ctrlKey||c===2}_move(o,c){const f=-.5*(c.y-o.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(o){o.preventDefault()}}class Fc{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(o,c,f){return this._calculateTransform(o,c,f)}touchmove(o,c,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,c,f)}}touchend(o,c,f){this._calculateTransform(o,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,c,f){f.length>0&&(this._active=!0);const _=Rc(f,c),v=new s.Point(0,0),T=new s.Point(0,0);let S=0;for(const z in _){const P=_[z],N=this._touches[z];N&&(v._add(P),T._add(P.sub(N)),S++,_[z]=P)}if(this._touches=_,S<this._minTouches||!T.mag())return;const I=T.div(S);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(S),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Cl{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,c,f){return{}}touchstart(o,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(o,c,f){const _=this._firstTwoTouches;if(!_)return;o.preventDefault();const[v,T]=_,S=Al(f,c,v),I=Al(f,c,T);if(!S||!I)return;const z=this._aroundCenter?null:S.add(I).div(2);return this._move([S,I],z,o)}touchend(o,c,f){if(!this._firstTwoTouches)return;const[_,v]=this._firstTwoTouches,T=Al(f,c,_),S=Al(f,c,v);T&&S||(this._active&&Q(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Al(d,o,c){for(let f=0;f<d.length;f++)if(d[f].identifier===c)return o[f]}function Ph(d,o){return Math.log(d/o)/Math.LN2}class Jp extends Cl{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,c){const f=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ph(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ph(this._distance,f),pinchAround:c}}}function zh(d,o){return 180*d.angleWith(o)/Math.PI}class Qp extends Cl{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,c){const f=this._vector;if(this._vector=o[0].sub(o[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:zh(this._vector,f),pinchAround:c}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const c=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;const _=zh(o,f);return Math.abs(_)<c}}function is(d){return Math.abs(d.y)>Math.abs(d.x)}class ef extends Cl{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,is(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,c,f){const _=this._lastPoints;if(!_)return;const v=o[0].sub(_[0]),T=o[1].sub(_[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(v,T,f.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5})}gestureBeginsVertically(o,c,f){if(this._valid!==void 0)return this._valid;const _=o.mag()>=2,v=c.mag()>=2;if(!_&&!v)return;if(!_||!v)return this._firstMove==null&&(this._firstMove=f),f-this._firstMove<100&&void 0;const T=o.y>0==c.y>0;return is(o)&&is(c)&&T}}const tf={panStep:100,bearingStep:15,pitchStep:10};class cg{constructor(){const o=tf;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let c=0,f=0,_=0,v=0,T=0;switch(o.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:o.shiftKey?f=-1:(o.preventDefault(),v=-1);break;case 39:o.shiftKey?f=1:(o.preventDefault(),v=1);break;case 38:o.shiftKey?_=1:(o.preventDefault(),T=-1);break;case 40:o.shiftKey?_=-1:(o.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:S=>{const I=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:nf,zoom:c?Math.round(I)+c*(o.shiftKey?2:1):I,bearing:S.getBearing()+f*this._bearingStep,pitch:S.getPitch()+_*this._pitchStep,offset:[-v*this._panStep,-T*this._panStep],center:S.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function nf(d){return d*(2-d)}const Bh=4.000244140625;class rf{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=o.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const f=s.exported.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%Bh==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),o.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=o,this._delta-=c,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=ue(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>Bh?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&z!==0&&(z=1/z);const P=c(),N=Math.pow(2,P),X=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):N;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(X*z))),this._type==="wheel"&&(this._startZoom=P,this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:c(),_=this._startZoom,v=this._easing;let T,S=!1;if(this._type==="wheel"&&_&&v){const I=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),z=v(I);T=s.number(_,f,z),I<1?this._frameId||(this._frameId=!0):S=!0}else T=f,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:T-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let c=s.ease;if(this._prevEase){const f=this._prevEase,_=(s.exported.now()-f.start)/f.duration,v=f.easing(_+.01)-f.easing(_),T=.27/Math.sqrt(v*v+1e-4)*.01,S=Math.sqrt(.0729-T*T);c=s.bezier(T,S,.25,1)}return this._prevEase={start:s.exported.now(),duration:o,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class of{constructor(o,c){this._clickZoom=o,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,c){return o.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(o.shiftKey?-1:1),around:f.unproject(c)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ug{constructor(){this._tap=new Ih({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,c,f){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(o,c,f))}touchmove(o,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=c[0],v=_.y-this._swipePoint.y;return this._swipePoint=_,o.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(o,c,f)}touchend(o,c,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(o,c,f)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sf{constructor(o,c,f){this._el=o,this._mousePan=c,this._touchPan=f}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class hg{constructor(o,c,f){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class dg{constructor(o,c,f,_){this._el=o,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ei=d=>d.zoom||d.drag||d.pitch||d.rotate;class af extends s.Event{}class pg{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,c){const f=s.sub([],c,o);this.radius=s.length(f[2]<0?s.div([],f,this.constants):[f[0],f[1],0])}projectRay(o){s.div(o,o,this.constants),s.normalize(o,o),s.mul$1(o,o,this.constants);const c=s.scale$2([],o,this.radius);if(c[2]>0){const f=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),_=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),v=s.add([],c,s.scale$2([],s.sub([],s.add([],_,f),c),2));c[0]=v[0],c[1]=v[1]}return c}}function Gi(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class co{constructor(o,c){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xp(o),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new pg,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[_,v,T]of this._listeners)_.addEventListener(v,_===s.window.document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[o,c,f]of this._listeners)o.removeEventListener(c,o===s.window.document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(o){const c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new Ah(c,o));const _=c.boxZoom=new Kp(c,o);this._add("boxZoom",_);const v=new lg,T=new Fr;c.doubleClickZoom=new of(T,v),this._add("tapZoom",v),this._add("clickZoom",T);const S=new ug;this._add("tapDragZoom",S);const I=c.touchPitch=new ef(c);this._add("touchPitch",I);const z=new Mh(o),P=new Dh(o);c.dragRotate=new hg(o,z,P),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",P,["mouseRotate"]);const N=new kh(o),X=new Fc(c,o);c.dragPan=new sf(f,N,X),this._add("mousePan",N),this._add("touchPan",X,["touchZoom","touchRotate"]);const te=new Qp,re=new Jp;c.touchZoomRotate=new dg(f,re,te,S),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Lc(c));const ne=c.scrollZoom=new rf(c,this);this._add("scrollZoom",ne,["mousePan"]);const ie=c.keyboard=new cg;this._add("keyboard",ie);for(const j of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[j]&&c[j].enable(o[j])}_add(o,c,f){this._handlers.push({handlerName:o,handler:c,allowed:f}),this._handlersById[o]=c}stop(o){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ei(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,c,f){for(const _ in o)if(_!==f&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const c=[];for(const f of o)this._el.contains(f.target)&&c.push(f);return c}handleEvent(o,c){this._updatingCamera=!0;const f=o.type==="renderFrame",_=f?void 0:o,v={needsRenderFrame:!1},T={},S={},I=o.touches?this._getMapTouches(o.touches):void 0,z=I?fe(this._el,I):f?void 0:ue(this._el,o);for(const{handlerName:X,handler:te,allowed:re}of this._handlers){if(!te.isEnabled())continue;let ne;this._blockedByActive(S,re,X)?te.reset():te[c||o.type]&&(ne=te[c||o.type](o,z,I),this.mergeHandlerResult(v,T,ne,X,_),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||te.isActive())&&(S[X]=te)}const P={};for(const X in this._previousActiveHandlers)S[X]||(P[X]=_);this._previousActiveHandlers=S,(Object.keys(P).length||Gi(v))&&(this._changes.push([v,T,P]),this._triggerRenderFrame()),(Object.keys(S).length||Gi(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=v;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(o,c,f,_,v){if(!f)return;s.extend(o,f);const T={handlerName:_,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(c.zoom=T),f.panDelta!==void 0&&(c.drag=T),f.pitchDelta!==void 0&&(c.pitch=T),f.bearingDelta!==void 0&&(c.rotate=T)}_applyChanges(){const o={},c={},f={};for(const[_,v,T]of this._changes)_.panDelta&&(o.panDelta=(o.panDelta||new s.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(o.around=_.around),_.aroundCoord!==void 0&&(o.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(o.pinchAround=_.pinchAround),_.noInertia&&(o.noInertia=_.noInertia),s.extend(c,v),s.extend(f,T);this._updateMapTransform(o,c,f),this._changes=[]}_updateMapTransform(o,c,f){const _=this._map,v=_.transform,T=ee=>[ee.x,ee.y,ee.z];if((ee=>{const ae=this._eventsInProgress.drag;return ae&&!this._handlersById[ae.handlerName].isActive()})()&&!Gi(o)){const ee=v.zoom;v.cameraElevationReference="sea",v.recenterOnTerrain(),v.cameraElevationReference="ground",ee!==v.zoom&&this._map._update(!0)}if(v._isCameraConstrained&&_._stop(!0),!Gi(o))return void this._fireEvents(c,f,!0);let{panDelta:S,zoomDelta:I,bearingDelta:z,pitchDelta:P,around:N,aroundCoord:X,pinchAround:te}=o;v._isCameraConstrained&&(I>0&&(I=0),v._isCameraConstrained=!1),te!==void 0&&(N=te),(I||(ee=>c[ee]&&!this._eventsInProgress[ee])("drag"))&&N&&(this._dragOrigin=T(v.pointCoordinate3D(N)),this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",_._stop(!0),N=N||_.transform.centerPoint,z&&(v.bearing+=z),P&&(v.pitch+=P),v._updateCameraState();const re=[0,0,0];if(S)if(v.projection.name==="mercator"){const ee=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N).dir),ae=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N.sub(S)).dir);re[0]=ae[0]-ee[0],re[1]=ae[1]-ee[1]}else{const ee=v.pointCoordinate(N);if(v.projection.name==="globe"){S=S.rotate(-v.angle);const ae=v._pixelsPerMercatorPixel/v.worldSize;re[0]=-S.x*s.mercatorScale(s.latFromMercatorY(ee.y))*ae,re[1]=-S.y*s.mercatorScale(v.center.lat)*ae}else{const ae=v.pointCoordinate(N.sub(S));ee&&ae&&(re[0]=ae.x-ee.x,re[1]=ae.y-ee.y)}}const ne=v.zoom,ie=[0,0,0];if(I){const ee=T(X||v.pointCoordinate3D(N)),ae={dir:s.normalize([],s.sub([],ee,v._camera.position))};if(ae.dir[2]<0){const le=v.zoomDeltaToMovement(ee,I);s.scale$2(ie,ae.dir,le)}}const j=s.add(re,re,ie);v._translateCameraConstrained(j),I&&Math.abs(v.zoom-ne)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(c,f,!0)}_fireEvents(o,c,f){const _=Ei(this._eventsInProgress),v=Ei(o),T={};for(const P in o){const{originalEvent:N}=o[P];this._eventsInProgress[P]||(T[`${P}start`]=N),this._eventsInProgress[P]=o[P]}!_&&v&&this._fireEvent("movestart",v.originalEvent);for(const P in T)this._fireEvent(P,T[P]);v&&this._fireEvent("move",v.originalEvent);for(const P in o){const{originalEvent:N}=o[P];this._fireEvent(P,N)}const S={};let I;for(const P in this._eventsInProgress){const{handlerName:N,originalEvent:X}=this._eventsInProgress[P];this._handlersById[N].isActive()||(delete this._eventsInProgress[P],I=c[N]||X,S[`${P}end`]=I)}for(const P in S)this._fireEvent(P,S[P]);const z=Ei(this._eventsInProgress);if(f&&(_||v)&&!z){this._updatingCamera=!0;const P=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;P?(N(P.bearing||this._map.getBearing())&&(P.bearing=0),this._map.easeTo(P,{originalEvent:I})):(this._map.fire(new s.Event("moveend",{originalEvent:I})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,c){this._map.fire(new s.Event(o,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new af("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ps="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Oc extends s.Evented{constructor(o,c){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,c){return this.jumpTo({center:o},c)}panBy(o,c,f){return o=s.Point.convert(o).mult(-1),this.panTo(this.transform.center,s.extend({offset:o},c),f)}panTo(o,c,f){return this.easeTo(s.extend({center:o},c),f)}getZoom(){return this.transform.zoom}setZoom(o,c){return this.jumpTo({zoom:o},c),this}zoomTo(o,c,f){return this.easeTo(s.extend({zoom:o},c),f)}zoomIn(o,c){return this.zoomTo(this.getZoom()+1,o,c),this}zoomOut(o,c){return this.zoomTo(this.getZoom()-1,o,c),this}getBearing(){return this.transform.bearing}setBearing(o,c){return this.jumpTo({bearing:o},c),this}getPadding(){return this.transform.padding}setPadding(o,c){return this.jumpTo({padding:o},c),this}rotateTo(o,c,f){return this.easeTo(s.extend({bearing:o},c),f)}resetNorth(o,c){return this.rotateTo(0,s.extend({duration:1e3},o),c),this}resetNorthPitch(o,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},o),c),this}snapToNorth(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this}getPitch(){return this.transform.pitch}setPitch(o,c){return this.jumpTo({pitch:o},c),this}cameraForBounds(o,c){o=s.LngLatBounds.convert(o);const f=c&&c.bearing||0,_=c&&c.pitch||0,v=o.getNorthWest(),T=o.getSouthEast();return this._cameraForBounds(this.transform,v,T,f,_,c)}_extendCameraOptions(o){const c={top:0,bottom:0,right:0,left:0};if(typeof(o=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const f=o.padding;o.padding={top:f,bottom:f,right:f,left:f}}return o.padding=s.extend(c,o.padding),o}_minimumAABBFrustumDistance(o,c){const f=c.max[0]-c.min[0],_=c.max[1]-c.min[1];return f/_>o.aspect?f/(2*Math.tan(.5*o.fovX)*o.aspect):_/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,c,f,_,v,T){const S=o.clone(),I=this._extendCameraOptions(T);S.bearing=_,S.pitch=v;const z=s.LngLat.convert(c),P=s.LngLat.convert(f),N=.5*(z.lat+P.lat),X=.5*(z.lng+P.lng),te=s.latLngToECEF(N,X),re=s.normalize([],te),ne=s.normalize([],s.cross([],re,[0,1,0])),ie=s.cross([],ne,re),j=[ne[0],ne[1],ne[2],0,ie[0],ie[1],ie[2],0,re[0],re[1],re[2],0,0,0,0,1],ee=[te,s.latLngToECEF(z.lat,z.lng),s.latLngToECEF(P.lat,z.lng),s.latLngToECEF(P.lat,P.lng),s.latLngToECEF(z.lat,P.lng),s.latLngToECEF(N,z.lng),s.latLngToECEF(N,P.lng),s.latLngToECEF(z.lat,X),s.latLngToECEF(P.lat,X)];let ae=s.Aabb.fromPoints(ee.map(Qe=>[s.dot(ne,Qe),s.dot(ie,Qe),s.dot(re,Qe)]));const le=s.transformMat4([],ae.center,j);s.squaredLength(le)===0&&s.set(le,0,0,1),s.normalize(le,le),s.scale$2(le,le,s.GLOBE_RADIUS),S.center=s.ecefToLatLng(le);const ye=S.getWorldToCameraMatrix(),ve=s.invert(new Float64Array(16),ye);ae=s.Aabb.applyTransform(ae,s.multiply([],ye,j)),s.transformMat4(le,le,ye);const xe=.5*(ae.max[2]-ae.min[2]),Ie=this._minimumAABBFrustumDistance(S,ae),Ae=s.scale$2([],[0,0,1],xe),Be=s.add(Ae,le,Ae),it=Ie+(S.pitch===0?0:s.distance(le,Be)),De=S.globeCenterInViewSpace,Ze=s.sub([],le,[De[0],De[1],De[2]]);s.normalize(Ze,Ze),s.scale$2(Ze,Ze,it);const Fe=s.add([],le,Ze);s.transformMat4(Fe,Fe,ve);const rt=s.earthRadius/s.GLOBE_RADIUS,ze=s.length(Fe),He=s.mercatorZfromAltitude(Math.max(ze*rt-s.earthRadius,Number.EPSILON),0),at=Math.min(S.zoomFromMercatorZAdjusted(He),I.maxZoom);return at>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(S.setProjection({name:"mercator"}),S.zoom=at,this._cameraForBounds(S,c,f,_,v,T)):{center:S.center,zoom:at,bearing:_,pitch:v}}queryTerrainElevation(o,c){const f=this.transform.elevation;return f?(c=s.extend({},{exaggerated:!0},c),f.getAtPoint(s.MercatorCoordinate.fromLngLat(o),null,c.exaggerated)):null}_cameraForBounds(o,c,f,_,v,T){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,c,f,_,v,T);const S=o.clone(),I=this._extendCameraOptions(T),z=S.padding;S.bearing=_,S.pitch=v;const P=s.LngLat.convert(c),N=s.LngLat.convert(f),X=new s.LngLat(P.lng,N.lat),te=new s.LngLat(N.lng,P.lat),re=S.project(P),ne=S.project(N),ie=this.queryTerrainElevation(P),j=this.queryTerrainElevation(N),ee=this.queryTerrainElevation(X),ae=this.queryTerrainElevation(te),le=[[re.x,re.y,Math.min(ie||0,j||0,ee||0,ae||0)],[ne.x,ne.y,Math.max(ie||0,j||0,ee||0,ae||0)]];let ye=s.Aabb.fromPoints(le);const ve=S.getWorldToCameraMatrix(),xe=s.invert(new Float64Array(16),ve);ye=s.Aabb.applyTransform(ye,ve);const Ie=s.sub([],ye.max,ye.min),Ae=z.left||0,Be=z.right||0,it=z.bottom||0,De=z.top||0,{left:Ze,right:Fe,top:rt,bottom:ze}=I.padding,He=.5*(Ae+Be),at=.5*(De+it),Qe=Math.min(S.scaleZoom(S.scale*Math.min((S.width-(Ae+Be+Ze+Fe))/Ie[0],(S.height-(it+De+ze+rt))/Ie[1])),I.maxZoom),lt=S.scale/S.zoomScale(Qe);ye=new s.Aabb([ye.min[0]-(Ze+He)*lt,ye.min[1]-(ze+at)*lt,ye.min[2]],[ye.max[0]+(Fe+He)*lt,ye.max[1]+(rt+at)*lt,ye.max[2]]);const At=.5*Ie[2],Ft=this._minimumAABBFrustumDistance(S,ye),Et=[0,0,1,0];s.transformMat4$1(Et,Et,ve),s.normalize$2(Et,Et);const zt=s.scale$2([],Et,Ft+At),Jt=s.add([],ye.center,zt),Xt=(typeof I.offset.x=="number"&&typeof I.offset.y=="number"?new s.Point(I.offset.x,I.offset.y):s.Point.convert(I.offset)).rotate(-s.degToRad(_));ye.center[0]-=Xt.x*lt,ye.center[1]+=Xt.y*lt,s.transformMat4(ye.center,ye.center,xe),s.transformMat4(Jt,Jt,xe);const Ct=[ye.center[0],ye.center[1],Jt[2]*S.pixelsPerMeter];s.scale$2(Ct,Ct,1/S.worldSize);const gn=s.lngFromMercatorX(Ct[0]),vn=s.latFromMercatorY(Ct[1]),wn=Math.min(S._zoomFromMercatorZ(Ct[2]),I.maxZoom),bn=new s.LngLat(gn,vn);return S.mercatorFromTransition&&wn<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(S.setProjection({name:"globe"}),S.zoom=wn,this._cameraForBounds(S,c,f,_,v,T)):{center:bn,zoom:wn,bearing:_,pitch:v}}fitBounds(o,c,f){const _=this.cameraForBounds(o,c);return this._fitInternal(_,c,f)}fitScreenCoordinates(o,c,f,_,v){const T=s.Point.convert(o),S=s.Point.convert(c),I=new s.Point(Math.min(T.x,S.x),Math.min(T.y,S.y)),z=new s.Point(Math.max(T.x,S.x),Math.max(T.y,S.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(T,S))return this;const P=this.transform.pointLocation3D(I),N=this.transform.pointLocation3D(z),X=this.transform.pointLocation3D(new s.Point(I.x,z.y)),te=this.transform.pointLocation3D(new s.Point(z.x,I.y)),re=[Math.min(P.lng,N.lng,X.lng,te.lng),Math.min(P.lat,N.lat,X.lat,te.lat)],ne=[Math.max(P.lng,N.lng,X.lng,te.lng),Math.max(P.lat,N.lat,X.lat,te.lat)],ie=_&&_.pitch?_.pitch:this.getPitch(),j=this._cameraForBounds(this.transform,re,ne,f,ie,_);return this._fitInternal(j,_,v)}_fitInternal(o,c,f){return o?(delete(c=s.extend(o,c)).padding,c.linear?this.easeTo(c,f):this.flyTo(c,f)):this}jumpTo(o,c){this.stop();const f=o.preloadOnly?this.transform.clone():this.transform;let _=!1,v=!1,T=!1;return"zoom"in o&&f.zoom!==+o.zoom&&(_=!0,f.zoom=+o.zoom),o.center!==void 0&&(f.center=s.LngLat.convert(o.center)),"bearing"in o&&f.bearing!==+o.bearing&&(v=!0,f.bearing=+o.bearing),"pitch"in o&&f.pitch!==+o.pitch&&(T=!0,f.pitch=+o.pitch),o.padding==null||f.isPaddingEqual(o.padding)||(f.padding=o.padding),o.preloadOnly?(this._preloadTiles(f),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),_&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),v&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),T&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(Ps),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,c){const f=this.transform;if(!f.projection.supportsFreeCamera)return s.warnOnce(Ps),this;this.stop();const _=f.zoom,v=f.pitch,T=f.bearing;f.setFreeCameraOptions(o);const S=_!==f.zoom,I=v!==f.pitch,z=T!==f.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),S&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),z&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),I&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(o,c){this._stop(!1,o.easeId),((o=s.extend({offset:[0,0],duration:500,easing:s.ease},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const f=this.transform,_=this.getZoom(),v=this.getBearing(),T=this.getPitch(),S=this.getPadding(),I="zoom"in o?+o.zoom:_,z="bearing"in o?this._normalizeBearing(o.bearing,v):v,P="pitch"in o?+o.pitch:T,N="padding"in o?o.padding:f.padding,X=s.Point.convert(o.offset);let te,re,ne;if(f.projection.name==="globe"){const Ae=s.MercatorCoordinate.fromLngLat(f.center),Be=X.rotate(-f.angle);Ae.x+=Be.x/f.worldSize,Ae.y+=Be.y/f.worldSize;const it=Ae.toLngLat(),De=s.LngLat.convert(o.center||it);this._normalizeCenter(De),te=f.centerPoint.add(Be),re=new s.Point(Ae.x,Ae.y).mult(f.worldSize),ne=new s.Point(s.mercatorXfromLng(De.lng),s.mercatorYfromLat(De.lat)).mult(f.worldSize).sub(re)}else{te=f.centerPoint.add(X);const Ae=f.pointLocation(te),Be=s.LngLat.convert(o.center||Ae);this._normalizeCenter(Be),re=f.project(Ae),ne=f.project(Be).sub(re)}const ie=f.zoomScale(I-_);let j,ee;o.around&&(j=s.LngLat.convert(o.around),ee=f.locationPoint(j));const ae=this._zooming||I!==_,le=this._rotating||v!==z,ye=this._pitching||P!==T,ve=!f.isPaddingEqual(N),xe=Ae=>Be=>{if(ae&&(Ae.zoom=s.number(_,I,Be)),le&&(Ae.bearing=s.number(v,z,Be)),ye&&(Ae.pitch=s.number(T,P,Be)),ve&&(Ae.interpolatePadding(S,N,Be),te=Ae.centerPoint.add(X)),j)Ae.setLocationAtPoint(j,ee);else{const it=Ae.zoomScale(Ae.zoom-_),De=I>_?Math.min(2,ie):Math.max(.5,ie),Ze=Math.pow(De,1-Be),Fe=Ae.unproject(re.add(ne.mult(Be*Ze)).mult(it));Ae.setLocationAtPoint(Ae.renderWorldCopies?Fe.wrap():Fe,te)}return o.preloadOnly||this._fireMoveEvents(c),Ae};if(o.preloadOnly){const Ae=this._emulate(xe,o.duration,f);return this._preloadTiles(Ae),this}const Ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ae,this._rotating=le,this._pitching=ye,this._padding=ve,this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Ie),this._ease(xe(f),Ae=>{f.recenterOnTerrain(),this._afterEase(c,Ae)},o),this}_prepareEase(o,c,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||f.moving||this.fire(new s.Event("movestart",o)),this._zooming&&!f.zooming&&this.fire(new s.Event("zoomstart",o)),this._rotating&&!f.rotating&&this.fire(new s.Event("rotatestart",o)),this._pitching&&!f.pitching&&this.fire(new s.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new s.Event("move",o)),this._zooming&&this.fire(new s.Event("zoom",o)),this._rotating&&this.fire(new s.Event("rotate",o)),this._pitching&&this.fire(new s.Event("pitch",o))}_afterEase(o,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const f=this._zooming,_=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new s.Event("zoomend",o)),_&&this.fire(new s.Event("rotateend",o)),v&&this.fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o))}flyTo(o,c){if(this._prefersReducedMotion(o)){const Qe=s.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qe,c)}this.stop(),o=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},o);const f=this.transform,_=this.getZoom(),v=this.getBearing(),T=this.getPitch(),S=this.getPadding(),I="zoom"in o?s.clamp(+o.zoom,f.minZoom,f.maxZoom):_,z="bearing"in o?this._normalizeBearing(o.bearing,v):v,P="pitch"in o?+o.pitch:T,N="padding"in o?o.padding:f.padding,X=f.zoomScale(I-_),te=s.Point.convert(o.offset);let re=f.centerPoint.add(te);const ne=f.pointLocation(re),ie=s.LngLat.convert(o.center||ne);this._normalizeCenter(ie);const j=f.project(ne),ee=f.project(ie).sub(j);let ae=o.curve;const le=Math.max(f.width,f.height),ye=le/X,ve=ee.mag();if("minZoom"in o){const Qe=s.clamp(Math.min(o.minZoom,_,I),f.minZoom,f.maxZoom),lt=le/f.zoomScale(Qe-_);ae=Math.sqrt(lt/ve*2)}const xe=ae*ae;function Ie(Qe){const lt=(ye*ye-le*le+(Qe?-1:1)*xe*xe*ve*ve)/(2*(Qe?ye:le)*xe*ve);return Math.log(Math.sqrt(lt*lt+1)-lt)}function Ae(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function Be(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const it=Ie(0);let De=function(Qe){return Be(it)/Be(it+ae*Qe)},Ze=function(Qe){return le*((Be(it)*(Ae(lt=it+ae*Qe)/Be(lt))-Ae(it))/xe)/ve;var lt},Fe=(Ie(1)-it)/ae;if(Math.abs(ve)<1e-6||!isFinite(Fe)){if(Math.abs(le-ye)<1e-6)return this.easeTo(o,c);const Qe=ye<le?-1:1;Fe=Math.abs(Math.log(ye/le))/ae,Ze=function(){return 0},De=function(lt){return Math.exp(Qe*ae*lt)}}o.duration="duration"in o?+o.duration:1e3*Fe/("screenSpeed"in o?+o.screenSpeed/ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const rt=v!==z,ze=P!==T,He=!f.isPaddingEqual(N),at=Qe=>lt=>{const At=lt*Fe,Ft=1/De(At);Qe.zoom=lt===1?I:_+Qe.scaleZoom(Ft),rt&&(Qe.bearing=s.number(v,z,lt)),ze&&(Qe.pitch=s.number(T,P,lt)),He&&(Qe.interpolatePadding(S,N,lt),re=Qe.centerPoint.add(te));const Et=lt===1?ie:Qe.unproject(j.add(ee.mult(Ze(At))).mult(Ft));return Qe.setLocationAtPoint(Qe.renderWorldCopies?Et.wrap():Et,re),Qe._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(c),Qe};if(o.preloadOnly){const Qe=this._emulate(at,o.duration,f);return this._preloadTiles(Qe),this}return this._zooming=!0,this._rotating=rt,this._pitching=ze,this._padding=He,this._prepareEase(c,!1),this._ease(at(f),()=>this._afterEase(c),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,c)}if(!o){const f=this.handlers;f&&f.stop(!1)}return this}_ease(o,c,f){f.animate===!1||f.duration===0?(o(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=f,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,c){o=s.wrap(o,-180,180);const f=Math.abs(o-c);return Math.abs(o-360-c)<f&&(o-=360),Math.abs(o+360-c)<f&&(o+=360),o}_normalizeCenter(o){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const f=o.lng-c.center.lng;o.lng+=f>180?-360:f<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,c,f){const _=Math.ceil(15*c/1e3),v=[],T=o(f.clone());for(let S=0;S<=_;S++){const I=T(S/_);v.push(I.clone())}return v}}class wt{constructor(o={}){this.options=o,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const c=this.options&&this.options.compact;return this._map=o,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F("button","mapboxgl-ctrl-attrib-button",this._container),F("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,c){const f=this._map._getUIString(`AttributionControl.${c}`);o.setAttribute("aria-label",f),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",f)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(o){const f=c.reduce((_,v,T)=>(v.value&&(_+=`${v.key}=${v.value}${T<c.length-1?"&":""}`),_),"?");o.href=`${s.config.FEEDBACK_URL}/${f}#${wl(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style._sourceCaches;for(const _ in c){const v=c[_];if(v.used){const T=v.getSource();T.attribution&&o.indexOf(T.attribution)<0&&o.push(T.attribution)}}o.sort((_,v)=>_.length-v.length),o=o.filter((_,v)=>{for(let T=v+1;T<o.length;T++)if(o[T].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const f=o.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,o.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Lh{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=F("div","mapboxgl-ctrl");const c=F("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const c in o){const f=o[c].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Rh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const c=++this._id;return this._queue.push({callback:o,id:c,cancelled:!1}),c}remove(o){const c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(const _ of f)if(_.id===o)return void(_.cancelled=!0)}run(o=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const f of c)if(!f.cancelled&&(f.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ya(d,o,c){if(d=new s.LngLat(d.lng,d.lat),o){const f=new s.LngLat(d.lng-360,d.lat),_=new s.LngLat(d.lng+360,d.lat),v=360*Math.ceil(Math.abs(d.lng-c.center.lng)/360),T=c.locationPoint(d).distSqr(o),S=o.x<0||o.y<0||o.x>c.width||o.y>c.height;c.locationPoint(f).distSqr(o)<T&&(S||Math.abs(f.lng-c.center.lng)<v)?d=f:c.locationPoint(_).distSqr(o)<T&&(S||Math.abs(_.lng-c.center.lng)<v)&&(d=_)}for(;Math.abs(d.lng-c.center.lng)>180;){const f=c.locationPoint(d);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;d.lng>c.center.lng?d.lng-=360:d.lng+=360}return d}const zs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class _t extends s.Evented{constructor(o,c){if(super(),(o instanceof s.window.HTMLElement||c)&&(o=s.extend({element:o},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=s.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=F("div");const _=41,v=27,T=Z("svg",{display:"block",height:_*this._scale+"px",width:v*this._scale+"px",viewBox:`0 0 ${v} ${_}`},this._element),S=Z("radialGradient",{id:"shadowGradient"},Z("defs",{},T));Z("stop",{offset:"10%","stop-opacity":.4},S),Z("stop",{offset:"100%","stop-opacity":.05},S),Z("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},T),Z("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},T),Z("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},T),Z("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},T),this._offset=s.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const f=this._element.classList;for(const _ in zs)f.remove(`mapboxgl-marker-anchor-${_}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const c=o.code,f=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(o){const c=o.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,c=this._pos;if(!o||!c)return!1;const f=o.unproject(c),_=o.getFreeCameraOptions();if(!_.position)return!1;const v=_.position.toLngLat();return v.distanceTo(f)<.9*v.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const c=this._pos;if(!c||c.x<0||c.x>o.transform.width||c.y<0||c.y>o.transform.height)return void this._clearFadeTimer();const f=o.unproject(c);let _;o._showingGlobe()&&s.isLngLatBehindGlobe(o.transform,this._lngLat)?_=0:(_=1-o._queryFogOpacity(f),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${zs[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const o=this._pos,c=this._map,f=this.getPitchAlignment();if(!c||!o||f!=="map")return"";if(!c._showingGlobe()){const I=c.getPitch();return I?`rotateX(${I}deg)`:""}const _=s.radToDeg(s.globeTiltAtLngLat(c.transform,this._lngLat)),v=o.sub(s.globeCenterToScreenPoint(c.transform)),T=Math.abs(v.x)+Math.abs(v.y);if(T===0)return"";const S=_/T;return`rotateX(${-v.y*S}deg) rotateY(${v.x*S}deg)`}_calculateZTransform(){const o=this._pos,c=this._map;if(!c||!o)return"";let f=0;const _=this.getRotationAlignment();if(_==="map")if(c._showingGlobe()){const v=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),T=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(v);f=s.radToDeg(Math.atan2(T.y,T.x))-90}else f=-c.getBearing();else if(_==="horizon"){const v=s.smoothstep(4,6,c.getZoom()),T=s.globeCenterToScreenPoint(c.transform);T.y+=v*c.transform.height;const S=o.sub(T),I=s.radToDeg(Math.atan2(S.y,S.x));f=(I>90?I-270:I+90)*(1-v)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(o){s.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=ya(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),o===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=s.Point.convert(o),this._update(),this}_onMove(o){const c=this._map;if(!c)return;const f=this._pointerdownPos,_=this._positionDelta;if(f&&_){if(!this._isDragging){const v=this._clickTolerance||c._clickTolerance;if(o.point.dist(f)<v)return;this._isDragging=!0}this._pos=o.point.sub(_),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(o){const c=this._map,f=this._pos;c&&f&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(f),this._pointerdownPos=o.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const c=this._map;return c&&(o?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Fh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},fg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lf(d=new s.Point(0,0),o="bottom"){if(typeof d=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(o){case"top":return new s.Point(0,d);case"top-left":return new s.Point(c,c);case"top-right":return new s.Point(-c,c);case"bottom":return new s.Point(0,-d);case"bottom-left":return new s.Point(c,-c);case"bottom-right":return new s.Point(-c,-c);case"left":return new s.Point(d,0);case"right":return new s.Point(-d,0)}return new s.Point(0,0)}return d instanceof s.Point||Array.isArray(d)?s.Point.convert(d):s.Point.convert(d[o]||[0,0])}class Oh{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const c=s.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,c,f){this._start=this.getValue(c),this._end=o,this._startTime=c,this._endTime=c+f}}const cf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},uf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},mg={showCompass:!0,showZoom:!0,visualizePitch:!1};class gg{constructor(o,c,f=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Mh({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,f&&(this.mousePitch=new Dh({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(o,c){this.mouseRotate.mousedown(o,c),this.mousePitch&&this.mousePitch.mousedown(o,c),W()}move(o,c){const f=this.map,_=this.mouseRotate.mousemoveWindow(o,c),v=_&&_.bearingDelta;if(v&&f.setBearing(f.getBearing()+v),this.mousePitch){const T=this.mousePitch.mousemoveWindow(o,c),S=T&&T.pitchDelta;S&&f.setPitch(f.getPitch()+S)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){O(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(s.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),ue(this.element,o)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,ue(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=fe(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=fe(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Nh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Uh={maxWidth:100,unit:"metric"},jh={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},xa={version:s.version,supported:k,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Oc{constructor(d){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(d=s.extend({},uf,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(d.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new fa(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._useWebGL2=d.useWebGL2,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._language=this._parseLanguage(d.language),this._worldview=d.worldview,this._renderTaskQueue=new Rh,this._domRenderTaskQueue=new Rh,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},cf,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._performanceMetricsCollection=d.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Oh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,typeof d.container=="string"){if(this._container=s.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new co(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new Ch(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,s.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new wt({customAttribution:d.customAttribution})),this._logoControl=new Lh,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new s.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new s.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(d,o){if(o===void 0&&(o=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=d.onAdd(this);this._controls.push(d);const f=this._controlPositions[o];return o.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(d);return o>-1&&this._controls.splice(o,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),this.fire(new s.Event("resize",d)),o&&this.fire(new s.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(s.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(d){return d==="auto"?s.window.navigator.language:Array.isArray(d)?d.length===0?void 0:d.map(o=>o==="auto"?s.window.navigator.language:o):d}setLanguage(d){const o=this._parseLanguage(d);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){return this.style&&d!==this._worldview?(this._worldview=d,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(d){return this._lazyInitEmptyStyle(),d?typeof d=="string"&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const d=this.transform,o=d.projection.name;let c;o==="globe"&&d.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(d.setMercatorFromTransition(),c=!0):o==="mercator"&&d.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(d.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,o){return this._updateProjection(d||o||{name:"mercator"})}_updateProjection(d){let o;if(o=d.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(d){return this.transform.locationPoint3D(s.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(s.Point.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(d,o,c){if(d==="mouseenter"||d==="mouseover"){let f=!1;const _=T=>{const S=o.filter(z=>this.getLayer(z)),I=S.length?this.queryRenderedFeatures(T.point,{layers:S}):[];I.length?f||(f=!0,c.call(this,new br(d,this,T.originalEvent,{features:I}))):f=!1},v=()=>{f=!1};return{layers:new Set(o),listener:c,delegates:{mousemove:_,mouseout:v}}}if(d==="mouseleave"||d==="mouseout"){let f=!1;const _=T=>{const S=o.filter(I=>this.getLayer(I));(S.length?this.queryRenderedFeatures(T.point,{layers:S}):[]).length?f=!0:f&&(f=!1,c.call(this,new br(d,this,T.originalEvent)))},v=T=>{f&&(f=!1,c.call(this,new br(d,this,T.originalEvent)))};return{layers:new Set(o),listener:c,delegates:{mousemove:_,mouseout:v}}}{const f=_=>{const v=o.filter(S=>this.getLayer(S)),T=v.length?this.queryRenderedFeatures(_.point,{layers:v}):[];T.length&&(_.features=T,c.call(this,_),delete _.features)};return{layers:new Set(o),listener:c,delegates:{[d]:f}}}}on(d,o,c){if(c===void 0)return super.on(d,o);Array.isArray(o)||(o=[o]);const f=this._createDelegatedListener(d,o,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return this}once(d,o,c){if(c===void 0)return super.once(d,o);Array.isArray(o)||(o=[o]);const f=this._createDelegatedListener(d,o,c);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(d,o,c){if(c===void 0)return super.off(d,o);o=new Set(Array.isArray(o)?o:[o]);const f=(v,T)=>{if(v.size!==T.size)return!1;for(const S of v)if(!T.has(S))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[d]:void 0;return _&&(v=>{for(let T=0;T<v.length;T++){const S=v[T];if(S.listener===c&&f(S.layers,o)){for(const I in S.delegates)this.off(I,S.delegates[I]);return v.splice(T,1),this}}})(_),this}queryRenderedFeatures(d,o){return this.style?(o!==void 0||d===void 0||d instanceof s.Point||Array.isArray(d)||(o=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(d,o){return this.style.querySourceFeatures(d,o)}isPointOnSurface(d){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&s.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(d))}setStyle(d,o){return(o=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(d,o))}_getUIString(d){const o=this._locale[d];if(o==null)throw new Error(`Missing UI string '${d}'`);return o}_updateStyle(d,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new ao(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,o){if(typeof d=="string"){const c=this._requestManager.normalizeStyleURL(d),f=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(f,(_,v)=>{_?this.fire(new s.ErrorEvent(_)):v&&this._updateDiff(v,o)})}else typeof d=="object"&&this._updateDiff(d,o)}_updateDiff(d,o){try{this.style.setState(d)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(d,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(d,o){return this._lazyInitEmptyStyle(),this.style.addSource(d,o),this._update(!0)}isSourceLoaded(d){return!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const o in d){const c=d[o]._tiles;for(const f in c){const _=c[f];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(d,o,c){this._lazyInitEmptyStyle(),this.style.addSourceType(d,o,c)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,o,{pixelRatio:c=1,sdf:f=!1,stretchX:_,stretchY:v,content:T}={}){if(this._lazyInitEmptyStyle(),o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap){const{width:S,height:I,data:z}=s.exported.getImageData(o);this.style.addImage(d,{data:new s.RGBAImage({width:S,height:I},z),pixelRatio:c,stretchX:_,stretchY:v,content:T,sdf:f,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:S,height:I}=o,z=o;this.style.addImage(d,{data:new s.RGBAImage({width:S,height:I},new Uint8Array(z.data)),pixelRatio:c,stretchX:_,stretchY:v,content:T,sdf:f,version:0,userImage:z}),z.onAdd&&z.onAdd(this,d)}}updateImage(d,o){const c=this.style.getImage(d);if(!c)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap?s.exported.getImageData(o):o,{width:_,height:v}=f;_!==void 0&&v!==void 0?_===c.data.width&&v===c.data.height?(c.data.replace(f.data,!(o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap)),this.style.updateImage(d,c)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${v})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,o){s.getImage(this._requestManager.transformRequest(d,s.ResourceType.Image),(c,f)=>{o(c,f instanceof s.window.HTMLImageElement?s.exported.getImageData(f):f)})}listImages(){return this.style.listImages()}addLayer(d,o){return this._lazyInitEmptyStyle(),this.style.addLayer(d,o),this._update(!0)}moveLayer(d,o){return this.style.moveLayer(d,o),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,o,c){return this.style.setLayerZoomRange(d,o,c),this._update(!0)}setFilter(d,o,c={}){return this.style.setFilter(d,o,c),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,o,c,f={}){return this.style.setPaintProperty(d,o,c,f),this._update(!0)}getPaintProperty(d,o){return this.style.getPaintProperty(d,o)}setLayoutProperty(d,o,c,f={}){return this.style.setLayoutProperty(d,o,c,f),this._update(!0)}getLayoutProperty(d,o){return this.style.getLayoutProperty(d,o)}setLight(d,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(d),this.transform):0}setFeatureState(d,o){return this.style.setFeatureState(d,o),this._update()}removeFeatureState(d,o){return this.style.removeFeatureState(d,o),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let c,f,_,v=this._container;for(;v&&(!f||!_);){const T=s.window.getComputedStyle(v).transform;T&&T!=="none"&&(c=T.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(f=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(_=c[3])),v=v.parentElement}this._containerWidth=f?Math.abs(d/f):d,this._containerHeight=_?Math.abs(o/_):o}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=F("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=F("div","mapboxgl-canvas-container",d);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=F("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=F("div","mapboxgl-control-container",d),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{f[_]=F("div",`mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,o){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(d),this._canvas.height=c*Math.ceil(o),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${o}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const o=this._markers.indexOf(d);o!==-1&&this._markers.splice(o,1)}_addPopup(d){this._popups.push(d)}_removePopup(d){const o=this._popups.indexOf(d);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const d=s.extend({},k.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",d),c=o||this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);c?(this._useWebGL2&&!o&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(c,!0),this.painter=new da(c,this.transform,!!o),this.on("data",f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(c)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let o;const c=this.painter.context.extTimerQuery,f=s.exported.now();if(this.listens("gpu-timing-frame")&&(o=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const S=this.transform.zoom,I=this.transform.pitch,z=s.exported.now(),P=new s.EvaluationParameters(S,{now:z,fadeDuration:_,pitch:I,transition:this.style.getTransition()});this.style.update(P)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let v=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),v=this._updateAverageElevation(f),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):v=this._updateAverageElevation(f),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const S=s.exported.now()-f;c.endQueryEXT(c.TIME_ELAPSED_EXT,o),setTimeout(()=>{const I=c.getQueryObjectEXT(o,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(o),this.fire(new s.Event("gpu-timing-frame",{cpuTime:S,gpuTime:I})),s.window.performance.mark("frame-gpu",{startTime:f,detail:{gpuTime:I}})},50)}if(this.listens("gpu-timing-layer")){const S=this.painter.collectGpuTimers();setTimeout(()=>{const I=this.painter.queryGpuTimers(S);this.fire(new s.Event("gpu-timing-layer",{layerTimes:I}))},50)}if(this.listens("gpu-timing-deferred-render")){const S=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const I=this.painter.queryGpuTimeDeferredRender(S);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:I}))},50)}const T=this._sourcesDirty||this._styleDirty||this._placementDirty||v;if(T||this._repaint)this.triggerRepaint();else{const S=!this.isMoving()&&this.loaded();if(S&&(v=this._updateAverageElevation(f,!0)),v)this.triggerRepaint();else if(this._triggerFrame(!1),S&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const I=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:I})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||T||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(d){for(const o of this._markers)d&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!d||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(d,o=!1){const c=f=>(this.transform.averageElevation=f,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((o||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const f=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),v=!1;this.transform.elevation&&(v=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=d;const T=Math.abs(f-_);if(T>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(_),c(_);this._averageElevation.easeTo(_,d,300)}else if(T>1e-4)return this._averageElevation.jumpTo(_),c(_)}return!!this._averageElevation.isEasing(d)&&c(this._averageElevation.getValue(d))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===s.AUTH_ERR_MSG||d.status===401)){const o=this.painter.context.gl;s.storeAuthState(o,!1),this._logoControl instanceof Lh&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const d=this._isDragging();this.painter.updateTerrain(this.style,d)}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const c=this.painter.context.gl,f=c.createFramebuffer();function _(v){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,v,0);const T=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,T),T}return c.bindFramebuffer(c.FRAMEBUFFER,f),this._canvasPixelComparison(_(d),o.canvasCopies.map(_),o.timeStamps)}_canvasPixelComparison(d,o,c){let f=c[1]-c[0];const _=d.length/4;for(let v=0;v<o.length;v++){const T=o[v];let S=0;for(let I=0;I<T.length;I+=4)T[I]===d[I]&&T[I+1]===d[I+1]&&T[I+2]===d[I+2]&&T[I+3]===d[I+3]&&(S+=1);f+=(c[v+2]-c[v+1])*(1-S/_)}return f}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=s.exported.frame(o=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(o)}))}_preloadTiles(d){const o=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(o,(c,f)=>c._preloadTiles(d,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(d){this._showTileAABBs!==d&&(this._showTileAABBs=d,d&&this._update())}_setCacheLimits(d,o){s.setCacheLimits(d,o)}get version(){return s.version}},NavigationControl:class{constructor(d){this.options=s.extend({},mg,d),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),F("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),F("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:o}):c.resetNorth({},{originalEvent:o}))}),this._compassIcon=F("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const o=d.getZoom(),c=o===d.getMaxZoom(),f=o===d.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gg(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,o){const c=F("button",d,this._container);return c.type="button",c.addEventListener("click",o),c}_setButtonTitle(d,o){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${o}`);d.setAttribute("aria-label",c),d.firstElementChild&&d.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(d){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Nh,d),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ma(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){const o=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,d(c)};this._supportsGeolocation!==void 0?d(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>o(c.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(d){const o=this._map.getMaxBounds(),c=d.coords;return!!o&&(c.longitude<o.getWest()||c.longitude>o.getEast()||c.latitude<o.getSouth()||c.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",d)),this._finish()}}_updateCamera(d){const o=new s.LngLat(d.coords.longitude,d.coords.latitude),c=d.coords.accuracy,f=this._map.getBearing(),_=s.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(c),_,{geolocateSource:!0})}_updateMarker(d){if(d){const o=new s.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,o=s.mercatorZfromAltitude(1,d._center.lat)*d.worldSize,c=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=F("button","mapboxgl-ctrl-geolocate",this._container),F("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F("div","mapboxgl-user-location"),this._dotElement.appendChild(F("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(F("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new _t({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=F("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _t({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:wt,ScaleControl:class{constructor(d){this.options=s.extend({},Uh,d),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,o=this._map,c=o._containerHeight/2,f=o._containerWidth/2-d/2,_=o.unproject([f,c]),v=o.unproject([f+d,c]),T=_.distanceTo(v);if(this.options.unit==="imperial"){const S=3.2808*T;S>5280?this._setScale(d,S/5280,"mile"):this._setScale(d,S,"foot")}else this.options.unit==="nautical"?this._setScale(d,T/1852,"nautical-mile"):T>=1e3?this._setScale(d,T/1e3,"kilometer"):this._setScale(d,T,"meter")}_setScale(d,o,c){this._map._requestDomTask(()=>{const f=function(v){const T=Math.pow(10,`${Math.floor(v)}`.length-1);let S=v/T;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(I){const z=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*z)/z}(S),T*S}(o),_=f/o;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(f):`${f}&nbsp;${jh[c]}`,this._container.style.width=d*_+"px"})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof s.window.HTMLElement?this._container=d.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=F("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(d){super(),this.options=s.extend(Object.create(Fh),d),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),d._addPopup(this),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),d._canvasContainer&&d._canvasContainer.classList.remove("mapboxgl-track-pointer"),d._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=s.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(s.window.document.createTextNode(d))}setHTML(d){const o=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let f;for(c.innerHTML=d;f=c.firstChild,f;)o.appendChild(f);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=F("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(d),this.options.closeButton){const c=this._closeButton=F("button","mapboxgl-popup-close-button",o);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let o;return this._classList.delete(d)?o=!1:(this._classList.add(d),o=!0),this._updateClassList(),o}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const o=this._map,c=this._container,f=this._pos;if(!o||!c||!f)return"bottom";const _=c.offsetWidth,v=c.offsetHeight,T=f.x<_/2,S=f.x>o.transform.width-_/2;if(f.y+d<v)return T?"top-left":S?"top-right":"top";if(f.y>o.transform.height-v){if(T)return"bottom-left";if(S)return"bottom-right"}return T?"left":S?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),d.className=o.join(" ")}_update(d){const o=this._map,c=this._content;if(!o||!this._lngLat&&!this._trackPointer||!c)return;let f=this._container;if(f||(f=this._container=F("div","mapboxgl-popup",o.getContainer()),this._tip=F("div","mapboxgl-popup-tip",f),f.appendChild(c)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ya(this._lngLat,this._pos,o.transform)),!this._trackPointer||d){const _=this._pos=this._trackPointer&&d?d:o.project(this._lngLat),v=lf(this.options.offset),T=this._anchor=this._getAnchor(v.y),S=lf(this.options.offset,T),I=_.add(S).round();o._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${zs[T]} translate(${I.x}px,${I.y}px)`)})}if(!this._marker&&o._showingGlobe()){const _=s.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(fg);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:_t,Style:ao,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Wp,Evented:s.Evented,config:s.config,prewarm:function(){ta().acquire(io)},clearPrewarmedResources:function(){const d=$r;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(io),$r=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(d){s.config.ACCESS_TOKEN=d},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(d){s.config.API_URL=d},get workerCount(){return vr.workerCount},set workerCount(d){vr.workerCount=d},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){s.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){s.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return xa});var b=m;return b})})(G4);var mv=G4.exports;const P6=e1(mv),z6=bk({__proto__:null,default:P6},[mv]);var $4={exports:{}};function B6(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var py={exports:{}};const L6={},R6=Object.freeze(Object.defineProperty({__proto__:null,default:L6},Symbol.toStringTag,{value:"Module"})),F6=KT(R6);var uT;function _n(){return uT||(uT=1,function(t,n){(function(l,h){t.exports=h()})($t,function(){var l=l||function(h,m){var x;if(typeof window<"u"&&window.crypto&&(x=window.crypto),typeof self<"u"&&self.crypto&&(x=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(x=globalThis.crypto),!x&&typeof window<"u"&&window.msCrypto&&(x=window.msCrypto),!x&&typeof $t<"u"&&$t.crypto&&(x=$t.crypto),!x&&typeof B6=="function")try{x=F6}catch{}var b=function(){if(x){if(typeof x.getRandomValues=="function")try{return x.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof x.randomBytes=="function")try{return x.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function O(){}return function(V){var Q;return O.prototype=V,Q=new O,O.prototype=null,Q}}(),C={},k=C.lib={},B=k.Base=function(){return{extend:function(O){var V=s(this);return O&&V.mixIn(O),(!V.hasOwnProperty("init")||this.init===V.init)&&(V.init=function(){V.$super.init.apply(this,arguments)}),V.init.prototype=V,V.$super=this,V},create:function(){var O=this.extend();return O.init.apply(O,arguments),O},init:function(){},mixIn:function(O){for(var V in O)O.hasOwnProperty(V)&&(this[V]=O[V]);O.hasOwnProperty("toString")&&(this.toString=O.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),U=k.WordArray=B.extend({init:function(O,V){O=this.words=O||[],V!=m?this.sigBytes=V:this.sigBytes=O.length*4},toString:function(O){return(O||Z).stringify(this)},concat:function(O){var V=this.words,Q=O.words,ue=this.sigBytes,fe=O.sigBytes;if(this.clamp(),ue%4)for(var we=0;we<fe;we++){var Ce=Q[we>>>2]>>>24-we%4*8&255;V[ue+we>>>2]|=Ce<<24-(ue+we)%4*8}else for(var Te=0;Te<fe;Te+=4)V[ue+Te>>>2]=Q[Te>>>2];return this.sigBytes+=fe,this},clamp:function(){var O=this.words,V=this.sigBytes;O[V>>>2]&=4294967295<<32-V%4*8,O.length=h.ceil(V/4)},clone:function(){var O=B.clone.call(this);return O.words=this.words.slice(0),O},random:function(O){for(var V=[],Q=0;Q<O;Q+=4)V.push(b());return new U.init(V,O)}}),F=C.enc={},Z=F.Hex={stringify:function(O){for(var V=O.words,Q=O.sigBytes,ue=[],fe=0;fe<Q;fe++){var we=V[fe>>>2]>>>24-fe%4*8&255;ue.push((we>>>4).toString(16)),ue.push((we&15).toString(16))}return ue.join("")},parse:function(O){for(var V=O.length,Q=[],ue=0;ue<V;ue+=2)Q[ue>>>3]|=parseInt(O.substr(ue,2),16)<<24-ue%8*4;return new U.init(Q,V/2)}},q=F.Latin1={stringify:function(O){for(var V=O.words,Q=O.sigBytes,ue=[],fe=0;fe<Q;fe++){var we=V[fe>>>2]>>>24-fe%4*8&255;ue.push(String.fromCharCode(we))}return ue.join("")},parse:function(O){for(var V=O.length,Q=[],ue=0;ue<V;ue++)Q[ue>>>2]|=(O.charCodeAt(ue)&255)<<24-ue%4*8;return new U.init(Q,V)}},K=F.Utf8={stringify:function(O){try{return decodeURIComponent(escape(q.stringify(O)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(O){return q.parse(unescape(encodeURIComponent(O)))}},Y=k.BufferedBlockAlgorithm=B.extend({reset:function(){this._data=new U.init,this._nDataBytes=0},_append:function(O){typeof O=="string"&&(O=K.parse(O)),this._data.concat(O),this._nDataBytes+=O.sigBytes},_process:function(O){var V,Q=this._data,ue=Q.words,fe=Q.sigBytes,we=this.blockSize,Ce=we*4,Te=fe/Ce;O?Te=h.ceil(Te):Te=h.max((Te|0)-this._minBufferSize,0);var Se=Te*we,Ne=h.min(Se*4,fe);if(Se){for(var Ue=0;Ue<Se;Ue+=we)this._doProcessBlock(ue,Ue);V=ue.splice(0,Se),Q.sigBytes-=Ne}return new U.init(V,Ne)},clone:function(){var O=B.clone.call(this);return O._data=this._data.clone(),O},_minBufferSize:0});k.Hasher=Y.extend({cfg:B.extend(),init:function(O){this.cfg=this.cfg.extend(O),this.reset()},reset:function(){Y.reset.call(this),this._doReset()},update:function(O){return this._append(O),this._process(),this},finalize:function(O){O&&this._append(O);var V=this._doFinalize();return V},blockSize:16,_createHelper:function(O){return function(V,Q){return new O.init(Q).finalize(V)}},_createHmacHelper:function(O){return function(V,Q){return new W.HMAC.init(O,Q).finalize(V)}}});var W=C.algo={};return C}(Math);return l})}(py)),py.exports}var fy={exports:{}},hT;function Hm(){return hT||(hT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(h){var m=l,x=m.lib,b=x.Base,s=x.WordArray,C=m.x64={};C.Word=b.extend({init:function(k,B){this.high=k,this.low=B}}),C.WordArray=b.extend({init:function(k,B){k=this.words=k||[],B!=h?this.sigBytes=B:this.sigBytes=k.length*8},toX32:function(){for(var k=this.words,B=k.length,U=[],F=0;F<B;F++){var Z=k[F];U.push(Z.high),U.push(Z.low)}return s.create(U,this.sigBytes)},clone:function(){for(var k=b.clone.call(this),B=k.words=this.words.slice(0),U=B.length,F=0;F<U;F++)B[F]=B[F].clone();return k}})}(),l})}(fy)),fy.exports}var my={exports:{}},dT;function O6(){return dT||(dT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(){if(typeof ArrayBuffer=="function"){var h=l,m=h.lib,x=m.WordArray,b=x.init,s=x.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var k=C.byteLength,B=[],U=0;U<k;U++)B[U>>>2]|=C[U]<<24-U%4*8;b.call(this,B,k)}else b.apply(this,arguments)};s.prototype=x}}(),l.lib.WordArray})}(my)),my.exports}var gy={exports:{}},pT;function N6(){return pT||(pT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(){var h=l,m=h.lib,x=m.WordArray,b=h.enc;b.Utf16=b.Utf16BE={stringify:function(C){for(var k=C.words,B=C.sigBytes,U=[],F=0;F<B;F+=2){var Z=k[F>>>2]>>>16-F%4*8&65535;U.push(String.fromCharCode(Z))}return U.join("")},parse:function(C){for(var k=C.length,B=[],U=0;U<k;U++)B[U>>>1]|=C.charCodeAt(U)<<16-U%2*16;return x.create(B,k*2)}},b.Utf16LE={stringify:function(C){for(var k=C.words,B=C.sigBytes,U=[],F=0;F<B;F+=2){var Z=s(k[F>>>2]>>>16-F%4*8&65535);U.push(String.fromCharCode(Z))}return U.join("")},parse:function(C){for(var k=C.length,B=[],U=0;U<k;U++)B[U>>>1]|=s(C.charCodeAt(U)<<16-U%2*16);return x.create(B,k*2)}};function s(C){return C<<8&4278255360|C>>>8&16711935}}(),l.enc.Utf16})}(gy)),gy.exports}var _y={exports:{}},fT;function cc(){return fT||(fT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(){var h=l,m=h.lib,x=m.WordArray,b=h.enc;b.Base64={stringify:function(C){var k=C.words,B=C.sigBytes,U=this._map;C.clamp();for(var F=[],Z=0;Z<B;Z+=3)for(var q=k[Z>>>2]>>>24-Z%4*8&255,K=k[Z+1>>>2]>>>24-(Z+1)%4*8&255,Y=k[Z+2>>>2]>>>24-(Z+2)%4*8&255,W=q<<16|K<<8|Y,O=0;O<4&&Z+O*.75<B;O++)F.push(U.charAt(W>>>6*(3-O)&63));var V=U.charAt(64);if(V)for(;F.length%4;)F.push(V);return F.join("")},parse:function(C){var k=C.length,B=this._map,U=this._reverseMap;if(!U){U=this._reverseMap=[];for(var F=0;F<B.length;F++)U[B.charCodeAt(F)]=F}var Z=B.charAt(64);if(Z){var q=C.indexOf(Z);q!==-1&&(k=q)}return s(C,k,U)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(C,k,B){for(var U=[],F=0,Z=0;Z<k;Z++)if(Z%4){var q=B[C.charCodeAt(Z-1)]<<Z%4*2,K=B[C.charCodeAt(Z)]>>>6-Z%4*2,Y=q|K;U[F>>>2]|=Y<<24-F%4*8,F++}return x.create(U,F)}}(),l.enc.Base64})}(_y)),_y.exports}var yy={exports:{}},mT;function U6(){return mT||(mT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(){var h=l,m=h.lib,x=m.WordArray,b=h.enc;b.Base64url={stringify:function(C,k){k===void 0&&(k=!0);var B=C.words,U=C.sigBytes,F=k?this._safe_map:this._map;C.clamp();for(var Z=[],q=0;q<U;q+=3)for(var K=B[q>>>2]>>>24-q%4*8&255,Y=B[q+1>>>2]>>>24-(q+1)%4*8&255,W=B[q+2>>>2]>>>24-(q+2)%4*8&255,O=K<<16|Y<<8|W,V=0;V<4&&q+V*.75<U;V++)Z.push(F.charAt(O>>>6*(3-V)&63));var Q=F.charAt(64);if(Q)for(;Z.length%4;)Z.push(Q);return Z.join("")},parse:function(C,k){k===void 0&&(k=!0);var B=C.length,U=k?this._safe_map:this._map,F=this._reverseMap;if(!F){F=this._reverseMap=[];for(var Z=0;Z<U.length;Z++)F[U.charCodeAt(Z)]=Z}var q=U.charAt(64);if(q){var K=C.indexOf(q);K!==-1&&(B=K)}return s(C,B,F)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function s(C,k,B){for(var U=[],F=0,Z=0;Z<k;Z++)if(Z%4){var q=B[C.charCodeAt(Z-1)]<<Z%4*2,K=B[C.charCodeAt(Z)]>>>6-Z%4*2,Y=q|K;U[F>>>2]|=Y<<24-F%4*8,F++}return x.create(U,F)}}(),l.enc.Base64url})}(yy)),yy.exports}var xy={exports:{}},gT;function uc(){return gT||(gT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(h){var m=l,x=m.lib,b=x.WordArray,s=x.Hasher,C=m.algo,k=[];(function(){for(var K=0;K<64;K++)k[K]=h.abs(h.sin(K+1))*4294967296|0})();var B=C.MD5=s.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(K,Y){for(var W=0;W<16;W++){var O=Y+W,V=K[O];K[O]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}var Q=this._hash.words,ue=K[Y+0],fe=K[Y+1],we=K[Y+2],Ce=K[Y+3],Te=K[Y+4],Se=K[Y+5],Ne=K[Y+6],Ue=K[Y+7],Ve=K[Y+8],St=K[Y+9],kt=K[Y+10],Ot=K[Y+11],on=K[Y+12],We=K[Y+13],bt=K[Y+14],ft=K[Y+15],je=Q[0],Je=Q[1],et=Q[2],tt=Q[3];je=U(je,Je,et,tt,ue,7,k[0]),tt=U(tt,je,Je,et,fe,12,k[1]),et=U(et,tt,je,Je,we,17,k[2]),Je=U(Je,et,tt,je,Ce,22,k[3]),je=U(je,Je,et,tt,Te,7,k[4]),tt=U(tt,je,Je,et,Se,12,k[5]),et=U(et,tt,je,Je,Ne,17,k[6]),Je=U(Je,et,tt,je,Ue,22,k[7]),je=U(je,Je,et,tt,Ve,7,k[8]),tt=U(tt,je,Je,et,St,12,k[9]),et=U(et,tt,je,Je,kt,17,k[10]),Je=U(Je,et,tt,je,Ot,22,k[11]),je=U(je,Je,et,tt,on,7,k[12]),tt=U(tt,je,Je,et,We,12,k[13]),et=U(et,tt,je,Je,bt,17,k[14]),Je=U(Je,et,tt,je,ft,22,k[15]),je=F(je,Je,et,tt,fe,5,k[16]),tt=F(tt,je,Je,et,Ne,9,k[17]),et=F(et,tt,je,Je,Ot,14,k[18]),Je=F(Je,et,tt,je,ue,20,k[19]),je=F(je,Je,et,tt,Se,5,k[20]),tt=F(tt,je,Je,et,kt,9,k[21]),et=F(et,tt,je,Je,ft,14,k[22]),Je=F(Je,et,tt,je,Te,20,k[23]),je=F(je,Je,et,tt,St,5,k[24]),tt=F(tt,je,Je,et,bt,9,k[25]),et=F(et,tt,je,Je,Ce,14,k[26]),Je=F(Je,et,tt,je,Ve,20,k[27]),je=F(je,Je,et,tt,We,5,k[28]),tt=F(tt,je,Je,et,we,9,k[29]),et=F(et,tt,je,Je,Ue,14,k[30]),Je=F(Je,et,tt,je,on,20,k[31]),je=Z(je,Je,et,tt,Se,4,k[32]),tt=Z(tt,je,Je,et,Ve,11,k[33]),et=Z(et,tt,je,Je,Ot,16,k[34]),Je=Z(Je,et,tt,je,bt,23,k[35]),je=Z(je,Je,et,tt,fe,4,k[36]),tt=Z(tt,je,Je,et,Te,11,k[37]),et=Z(et,tt,je,Je,Ue,16,k[38]),Je=Z(Je,et,tt,je,kt,23,k[39]),je=Z(je,Je,et,tt,We,4,k[40]),tt=Z(tt,je,Je,et,ue,11,k[41]),et=Z(et,tt,je,Je,Ce,16,k[42]),Je=Z(Je,et,tt,je,Ne,23,k[43]),je=Z(je,Je,et,tt,St,4,k[44]),tt=Z(tt,je,Je,et,on,11,k[45]),et=Z(et,tt,je,Je,ft,16,k[46]),Je=Z(Je,et,tt,je,we,23,k[47]),je=q(je,Je,et,tt,ue,6,k[48]),tt=q(tt,je,Je,et,Ue,10,k[49]),et=q(et,tt,je,Je,bt,15,k[50]),Je=q(Je,et,tt,je,Se,21,k[51]),je=q(je,Je,et,tt,on,6,k[52]),tt=q(tt,je,Je,et,Ce,10,k[53]),et=q(et,tt,je,Je,kt,15,k[54]),Je=q(Je,et,tt,je,fe,21,k[55]),je=q(je,Je,et,tt,Ve,6,k[56]),tt=q(tt,je,Je,et,ft,10,k[57]),et=q(et,tt,je,Je,Ne,15,k[58]),Je=q(Je,et,tt,je,We,21,k[59]),je=q(je,Je,et,tt,Te,6,k[60]),tt=q(tt,je,Je,et,Ot,10,k[61]),et=q(et,tt,je,Je,we,15,k[62]),Je=q(Je,et,tt,je,St,21,k[63]),Q[0]=Q[0]+je|0,Q[1]=Q[1]+Je|0,Q[2]=Q[2]+et|0,Q[3]=Q[3]+tt|0},_doFinalize:function(){var K=this._data,Y=K.words,W=this._nDataBytes*8,O=K.sigBytes*8;Y[O>>>5]|=128<<24-O%32;var V=h.floor(W/4294967296),Q=W;Y[(O+64>>>9<<4)+15]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,Y[(O+64>>>9<<4)+14]=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360,K.sigBytes=(Y.length+1)*4,this._process();for(var ue=this._hash,fe=ue.words,we=0;we<4;we++){var Ce=fe[we];fe[we]=(Ce<<8|Ce>>>24)&16711935|(Ce<<24|Ce>>>8)&4278255360}return ue},clone:function(){var K=s.clone.call(this);return K._hash=this._hash.clone(),K}});function U(K,Y,W,O,V,Q,ue){var fe=K+(Y&W|~Y&O)+V+ue;return(fe<<Q|fe>>>32-Q)+Y}function F(K,Y,W,O,V,Q,ue){var fe=K+(Y&O|W&~O)+V+ue;return(fe<<Q|fe>>>32-Q)+Y}function Z(K,Y,W,O,V,Q,ue){var fe=K+(Y^W^O)+V+ue;return(fe<<Q|fe>>>32-Q)+Y}function q(K,Y,W,O,V,Q,ue){var fe=K+(W^(Y|~O))+V+ue;return(fe<<Q|fe>>>32-Q)+Y}m.MD5=s._createHelper(B),m.HmacMD5=s._createHmacHelper(B)}(Math),l.MD5})}(xy)),xy.exports}var vy={exports:{}},_T;function W4(){return _T||(_T=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(){var h=l,m=h.lib,x=m.WordArray,b=m.Hasher,s=h.algo,C=[],k=s.SHA1=b.extend({_doReset:function(){this._hash=new x.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(B,U){for(var F=this._hash.words,Z=F[0],q=F[1],K=F[2],Y=F[3],W=F[4],O=0;O<80;O++){if(O<16)C[O]=B[U+O]|0;else{var V=C[O-3]^C[O-8]^C[O-14]^C[O-16];C[O]=V<<1|V>>>31}var Q=(Z<<5|Z>>>27)+W+C[O];O<20?Q+=(q&K|~q&Y)+1518500249:O<40?Q+=(q^K^Y)+1859775393:O<60?Q+=(q&K|q&Y|K&Y)-1894007588:Q+=(q^K^Y)-899497514,W=Y,Y=K,K=q<<30|q>>>2,q=Z,Z=Q}F[0]=F[0]+Z|0,F[1]=F[1]+q|0,F[2]=F[2]+K|0,F[3]=F[3]+Y|0,F[4]=F[4]+W|0},_doFinalize:function(){var B=this._data,U=B.words,F=this._nDataBytes*8,Z=B.sigBytes*8;return U[Z>>>5]|=128<<24-Z%32,U[(Z+64>>>9<<4)+14]=Math.floor(F/4294967296),U[(Z+64>>>9<<4)+15]=F,B.sigBytes=U.length*4,this._process(),this._hash},clone:function(){var B=b.clone.call(this);return B._hash=this._hash.clone(),B}});h.SHA1=b._createHelper(k),h.HmacSHA1=b._createHmacHelper(k)}(),l.SHA1})}(vy)),vy.exports}var wy={exports:{}},yT;function gv(){return yT||(yT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){return function(h){var m=l,x=m.lib,b=x.WordArray,s=x.Hasher,C=m.algo,k=[],B=[];(function(){function Z(W){for(var O=h.sqrt(W),V=2;V<=O;V++)if(!(W%V))return!1;return!0}function q(W){return(W-(W|0))*4294967296|0}for(var K=2,Y=0;Y<64;)Z(K)&&(Y<8&&(k[Y]=q(h.pow(K,1/2))),B[Y]=q(h.pow(K,1/3)),Y++),K++})();var U=[],F=C.SHA256=s.extend({_doReset:function(){this._hash=new b.init(k.slice(0))},_doProcessBlock:function(Z,q){for(var K=this._hash.words,Y=K[0],W=K[1],O=K[2],V=K[3],Q=K[4],ue=K[5],fe=K[6],we=K[7],Ce=0;Ce<64;Ce++){if(Ce<16)U[Ce]=Z[q+Ce]|0;else{var Te=U[Ce-15],Se=(Te<<25|Te>>>7)^(Te<<14|Te>>>18)^Te>>>3,Ne=U[Ce-2],Ue=(Ne<<15|Ne>>>17)^(Ne<<13|Ne>>>19)^Ne>>>10;U[Ce]=Se+U[Ce-7]+Ue+U[Ce-16]}var Ve=Q&ue^~Q&fe,St=Y&W^Y&O^W&O,kt=(Y<<30|Y>>>2)^(Y<<19|Y>>>13)^(Y<<10|Y>>>22),Ot=(Q<<26|Q>>>6)^(Q<<21|Q>>>11)^(Q<<7|Q>>>25),on=we+Ot+Ve+B[Ce]+U[Ce],We=kt+St;we=fe,fe=ue,ue=Q,Q=V+on|0,V=O,O=W,W=Y,Y=on+We|0}K[0]=K[0]+Y|0,K[1]=K[1]+W|0,K[2]=K[2]+O|0,K[3]=K[3]+V|0,K[4]=K[4]+Q|0,K[5]=K[5]+ue|0,K[6]=K[6]+fe|0,K[7]=K[7]+we|0},_doFinalize:function(){var Z=this._data,q=Z.words,K=this._nDataBytes*8,Y=Z.sigBytes*8;return q[Y>>>5]|=128<<24-Y%32,q[(Y+64>>>9<<4)+14]=h.floor(K/4294967296),q[(Y+64>>>9<<4)+15]=K,Z.sigBytes=q.length*4,this._process(),this._hash},clone:function(){var Z=s.clone.call(this);return Z._hash=this._hash.clone(),Z}});m.SHA256=s._createHelper(F),m.HmacSHA256=s._createHmacHelper(F)}(Math),l.SHA256})}(wy)),wy.exports}var by={exports:{}},xT;function j6(){return xT||(xT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),gv())})($t,function(l){return function(){var h=l,m=h.lib,x=m.WordArray,b=h.algo,s=b.SHA256,C=b.SHA224=s.extend({_doReset:function(){this._hash=new x.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var k=s._doFinalize.call(this);return k.sigBytes-=4,k}});h.SHA224=s._createHelper(C),h.HmacSHA224=s._createHmacHelper(C)}(),l.SHA224})}(by)),by.exports}var Ey={exports:{}},vT;function H4(){return vT||(vT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Hm())})($t,function(l){return function(){var h=l,m=h.lib,x=m.Hasher,b=h.x64,s=b.Word,C=b.WordArray,k=h.algo;function B(){return s.create.apply(s,arguments)}var U=[B(1116352408,3609767458),B(1899447441,602891725),B(3049323471,3964484399),B(3921009573,2173295548),B(961987163,4081628472),B(1508970993,3053834265),B(2453635748,2937671579),B(2870763221,3664609560),B(3624381080,2734883394),B(310598401,1164996542),B(607225278,1323610764),B(1426881987,3590304994),B(1925078388,4068182383),B(2162078206,991336113),B(2614888103,633803317),B(3248222580,3479774868),B(3835390401,2666613458),B(4022224774,944711139),B(264347078,2341262773),B(604807628,2007800933),B(770255983,1495990901),B(1249150122,1856431235),B(1555081692,3175218132),B(1996064986,2198950837),B(2554220882,3999719339),B(2821834349,766784016),B(2952996808,2566594879),B(3210313671,3203337956),B(3336571891,1034457026),B(3584528711,2466948901),B(113926993,3758326383),B(338241895,168717936),B(666307205,1188179964),B(773529912,1546045734),B(1294757372,1522805485),B(1396182291,2643833823),B(1695183700,2343527390),B(1986661051,1014477480),B(2177026350,1206759142),B(2456956037,344077627),B(2730485921,1290863460),B(2820302411,3158454273),B(3259730800,3505952657),B(3345764771,106217008),B(3516065817,3606008344),B(3600352804,1432725776),B(4094571909,1467031594),B(275423344,851169720),B(430227734,3100823752),B(506948616,1363258195),B(659060556,3750685593),B(883997877,3785050280),B(958139571,3318307427),B(1322822218,3812723403),B(1537002063,2003034995),B(1747873779,3602036899),B(1955562222,1575990012),B(2024104815,1125592928),B(2227730452,2716904306),B(2361852424,442776044),B(2428436474,593698344),B(2756734187,3733110249),B(3204031479,2999351573),B(3329325298,3815920427),B(3391569614,3928383900),B(3515267271,566280711),B(3940187606,3454069534),B(4118630271,4000239992),B(116418474,1914138554),B(174292421,2731055270),B(289380356,3203993006),B(460393269,320620315),B(685471733,587496836),B(852142971,1086792851),B(1017036298,365543100),B(1126000580,2618297676),B(1288033470,3409855158),B(1501505948,4234509866),B(1607167915,987167468),B(1816402316,1246189591)],F=[];(function(){for(var q=0;q<80;q++)F[q]=B()})();var Z=k.SHA512=x.extend({_doReset:function(){this._hash=new C.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(q,K){for(var Y=this._hash.words,W=Y[0],O=Y[1],V=Y[2],Q=Y[3],ue=Y[4],fe=Y[5],we=Y[6],Ce=Y[7],Te=W.high,Se=W.low,Ne=O.high,Ue=O.low,Ve=V.high,St=V.low,kt=Q.high,Ot=Q.low,on=ue.high,We=ue.low,bt=fe.high,ft=fe.low,je=we.high,Je=we.low,et=Ce.high,tt=Ce.low,nn=Te,Wt=Se,yn=Ne,Ht=Ue,Lr=Ve,ln=St,Rt=kt,Yr=Ot,zn=on,Xn=We,mn=bt,gr=ft,bo=je,qr=Je,Ir=et,Ri=tt,_r=0;_r<80;_r++){var yr,kr,Fi=F[_r];if(_r<16)kr=Fi.high=q[K+_r*2]|0,yr=Fi.low=q[K+_r*2+1]|0;else{var Es=F[_r-15],Oi=Es.high,xr=Es.low,to=(Oi>>>1|xr<<31)^(Oi>>>8|xr<<24)^Oi>>>7,ts=(xr>>>1|Oi<<31)^(xr>>>8|Oi<<24)^(xr>>>7|Oi<<25),no=F[_r-2],di=no.high,Ni=no.low,Eo=(di>>>19|Ni<<13)^(di<<3|Ni>>>29)^di>>>6,Ui=(Ni>>>19|di<<13)^(Ni<<3|di>>>29)^(Ni>>>6|di<<26),ro=F[_r-7],To=ro.high,ns=ro.low,Ts=F[_r-16],de=Ts.high,$=Ts.low;yr=ts+ns,kr=to+To+(yr>>>0<ts>>>0?1:0),yr=yr+Ui,kr=kr+Eo+(yr>>>0<Ui>>>0?1:0),yr=yr+$,kr=kr+de+(yr>>>0<$>>>0?1:0),Fi.high=kr,Fi.low=yr}var H=zn&mn^~zn&bo,ce=Xn&gr^~Xn&qr,_e=nn&yn^nn&Lr^yn&Lr,Ee=Wt&Ht^Wt&ln^Ht&ln,Me=(nn>>>28|Wt<<4)^(nn<<30|Wt>>>2)^(nn<<25|Wt>>>7),ke=(Wt>>>28|nn<<4)^(Wt<<30|nn>>>2)^(Wt<<25|nn>>>7),be=(zn>>>14|Xn<<18)^(zn>>>18|Xn<<14)^(zn<<23|Xn>>>9),Re=(Xn>>>14|zn<<18)^(Xn>>>18|zn<<14)^(Xn<<23|zn>>>9),ct=U[_r],dt=ct.high,st=ct.low,Pt=Ri+Re,Lt=Ir+be+(Pt>>>0<Ri>>>0?1:0),Pt=Pt+ce,Lt=Lt+H+(Pt>>>0<ce>>>0?1:0),Pt=Pt+st,Lt=Lt+dt+(Pt>>>0<st>>>0?1:0),Pt=Pt+yr,Lt=Lt+kr+(Pt>>>0<yr>>>0?1:0),Nt=ke+Ee,Zt=Me+_e+(Nt>>>0<ke>>>0?1:0);Ir=bo,Ri=qr,bo=mn,qr=gr,mn=zn,gr=Xn,Xn=Yr+Pt|0,zn=Rt+Lt+(Xn>>>0<Yr>>>0?1:0)|0,Rt=Lr,Yr=ln,Lr=yn,ln=Ht,yn=nn,Ht=Wt,Wt=Pt+Nt|0,nn=Lt+Zt+(Wt>>>0<Pt>>>0?1:0)|0}Se=W.low=Se+Wt,W.high=Te+nn+(Se>>>0<Wt>>>0?1:0),Ue=O.low=Ue+Ht,O.high=Ne+yn+(Ue>>>0<Ht>>>0?1:0),St=V.low=St+ln,V.high=Ve+Lr+(St>>>0<ln>>>0?1:0),Ot=Q.low=Ot+Yr,Q.high=kt+Rt+(Ot>>>0<Yr>>>0?1:0),We=ue.low=We+Xn,ue.high=on+zn+(We>>>0<Xn>>>0?1:0),ft=fe.low=ft+gr,fe.high=bt+mn+(ft>>>0<gr>>>0?1:0),Je=we.low=Je+qr,we.high=je+bo+(Je>>>0<qr>>>0?1:0),tt=Ce.low=tt+Ri,Ce.high=et+Ir+(tt>>>0<Ri>>>0?1:0)},_doFinalize:function(){var q=this._data,K=q.words,Y=this._nDataBytes*8,W=q.sigBytes*8;K[W>>>5]|=128<<24-W%32,K[(W+128>>>10<<5)+30]=Math.floor(Y/4294967296),K[(W+128>>>10<<5)+31]=Y,q.sigBytes=K.length*4,this._process();var O=this._hash.toX32();return O},clone:function(){var q=x.clone.call(this);return q._hash=this._hash.clone(),q},blockSize:1024/32});h.SHA512=x._createHelper(Z),h.HmacSHA512=x._createHmacHelper(Z)}(),l.SHA512})}(Ey)),Ey.exports}var Ty={exports:{}},wT;function V6(){return wT||(wT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Hm(),H4())})($t,function(l){return function(){var h=l,m=h.x64,x=m.Word,b=m.WordArray,s=h.algo,C=s.SHA512,k=s.SHA384=C.extend({_doReset:function(){this._hash=new b.init([new x.init(3418070365,3238371032),new x.init(1654270250,914150663),new x.init(2438529370,812702999),new x.init(355462360,4144912697),new x.init(1731405415,4290775857),new x.init(2394180231,1750603025),new x.init(3675008525,1694076839),new x.init(1203062813,3204075428)])},_doFinalize:function(){var B=C._doFinalize.call(this);return B.sigBytes-=16,B}});h.SHA384=C._createHelper(k),h.HmacSHA384=C._createHmacHelper(k)}(),l.SHA384})}(Ty)),Ty.exports}var Sy={exports:{}},bT;function G6(){return bT||(bT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Hm())})($t,function(l){return function(h){var m=l,x=m.lib,b=x.WordArray,s=x.Hasher,C=m.x64,k=C.Word,B=m.algo,U=[],F=[],Z=[];(function(){for(var Y=1,W=0,O=0;O<24;O++){U[Y+5*W]=(O+1)*(O+2)/2%64;var V=W%5,Q=(2*Y+3*W)%5;Y=V,W=Q}for(var Y=0;Y<5;Y++)for(var W=0;W<5;W++)F[Y+5*W]=W+(2*Y+3*W)%5*5;for(var ue=1,fe=0;fe<24;fe++){for(var we=0,Ce=0,Te=0;Te<7;Te++){if(ue&1){var Se=(1<<Te)-1;Se<32?Ce^=1<<Se:we^=1<<Se-32}ue&128?ue=ue<<1^113:ue<<=1}Z[fe]=k.create(we,Ce)}})();var q=[];(function(){for(var Y=0;Y<25;Y++)q[Y]=k.create()})();var K=B.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var Y=this._state=[],W=0;W<25;W++)Y[W]=new k.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(Y,W){for(var O=this._state,V=this.blockSize/2,Q=0;Q<V;Q++){var ue=Y[W+2*Q],fe=Y[W+2*Q+1];ue=(ue<<8|ue>>>24)&16711935|(ue<<24|ue>>>8)&4278255360,fe=(fe<<8|fe>>>24)&16711935|(fe<<24|fe>>>8)&4278255360;var we=O[Q];we.high^=fe,we.low^=ue}for(var Ce=0;Ce<24;Ce++){for(var Te=0;Te<5;Te++){for(var Se=0,Ne=0,Ue=0;Ue<5;Ue++){var we=O[Te+5*Ue];Se^=we.high,Ne^=we.low}var Ve=q[Te];Ve.high=Se,Ve.low=Ne}for(var Te=0;Te<5;Te++)for(var St=q[(Te+4)%5],kt=q[(Te+1)%5],Ot=kt.high,on=kt.low,Se=St.high^(Ot<<1|on>>>31),Ne=St.low^(on<<1|Ot>>>31),Ue=0;Ue<5;Ue++){var we=O[Te+5*Ue];we.high^=Se,we.low^=Ne}for(var We=1;We<25;We++){var Se,Ne,we=O[We],bt=we.high,ft=we.low,je=U[We];je<32?(Se=bt<<je|ft>>>32-je,Ne=ft<<je|bt>>>32-je):(Se=ft<<je-32|bt>>>64-je,Ne=bt<<je-32|ft>>>64-je);var Je=q[F[We]];Je.high=Se,Je.low=Ne}var et=q[0],tt=O[0];et.high=tt.high,et.low=tt.low;for(var Te=0;Te<5;Te++)for(var Ue=0;Ue<5;Ue++){var We=Te+5*Ue,we=O[We],nn=q[We],Wt=q[(Te+1)%5+5*Ue],yn=q[(Te+2)%5+5*Ue];we.high=nn.high^~Wt.high&yn.high,we.low=nn.low^~Wt.low&yn.low}var we=O[0],Ht=Z[Ce];we.high^=Ht.high,we.low^=Ht.low}},_doFinalize:function(){var Y=this._data,W=Y.words;this._nDataBytes*8;var O=Y.sigBytes*8,V=this.blockSize*32;W[O>>>5]|=1<<24-O%32,W[(h.ceil((O+1)/V)*V>>>5)-1]|=128,Y.sigBytes=W.length*4,this._process();for(var Q=this._state,ue=this.cfg.outputLength/8,fe=ue/8,we=[],Ce=0;Ce<fe;Ce++){var Te=Q[Ce],Se=Te.high,Ne=Te.low;Se=(Se<<8|Se>>>24)&16711935|(Se<<24|Se>>>8)&4278255360,Ne=(Ne<<8|Ne>>>24)&16711935|(Ne<<24|Ne>>>8)&4278255360,we.push(Ne),we.push(Se)}return new b.init(we,ue)},clone:function(){for(var Y=s.clone.call(this),W=Y._state=this._state.slice(0),O=0;O<25;O++)W[O]=W[O].clone();return Y}});m.SHA3=s._createHelper(K),m.HmacSHA3=s._createHmacHelper(K)}(Math),l.SHA3})}(Sy)),Sy.exports}var Cy={exports:{}},ET;function q6(){return ET||(ET=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(h){var m=l,x=m.lib,b=x.WordArray,s=x.Hasher,C=m.algo,k=b.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),B=b.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),U=b.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),F=b.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),Z=b.create([0,1518500249,1859775393,2400959708,2840853838]),q=b.create([1352829926,1548603684,1836072691,2053994217,0]),K=C.RIPEMD160=s.extend({_doReset:function(){this._hash=b.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(fe,we){for(var Ce=0;Ce<16;Ce++){var Te=we+Ce,Se=fe[Te];fe[Te]=(Se<<8|Se>>>24)&16711935|(Se<<24|Se>>>8)&4278255360}var Ne=this._hash.words,Ue=Z.words,Ve=q.words,St=k.words,kt=B.words,Ot=U.words,on=F.words,We,bt,ft,je,Je,et,tt,nn,Wt,yn;et=We=Ne[0],tt=bt=Ne[1],nn=ft=Ne[2],Wt=je=Ne[3],yn=Je=Ne[4];for(var Ht,Ce=0;Ce<80;Ce+=1)Ht=We+fe[we+St[Ce]]|0,Ce<16?Ht+=Y(bt,ft,je)+Ue[0]:Ce<32?Ht+=W(bt,ft,je)+Ue[1]:Ce<48?Ht+=O(bt,ft,je)+Ue[2]:Ce<64?Ht+=V(bt,ft,je)+Ue[3]:Ht+=Q(bt,ft,je)+Ue[4],Ht=Ht|0,Ht=ue(Ht,Ot[Ce]),Ht=Ht+Je|0,We=Je,Je=je,je=ue(ft,10),ft=bt,bt=Ht,Ht=et+fe[we+kt[Ce]]|0,Ce<16?Ht+=Q(tt,nn,Wt)+Ve[0]:Ce<32?Ht+=V(tt,nn,Wt)+Ve[1]:Ce<48?Ht+=O(tt,nn,Wt)+Ve[2]:Ce<64?Ht+=W(tt,nn,Wt)+Ve[3]:Ht+=Y(tt,nn,Wt)+Ve[4],Ht=Ht|0,Ht=ue(Ht,on[Ce]),Ht=Ht+yn|0,et=yn,yn=Wt,Wt=ue(nn,10),nn=tt,tt=Ht;Ht=Ne[1]+ft+Wt|0,Ne[1]=Ne[2]+je+yn|0,Ne[2]=Ne[3]+Je+et|0,Ne[3]=Ne[4]+We+tt|0,Ne[4]=Ne[0]+bt+nn|0,Ne[0]=Ht},_doFinalize:function(){var fe=this._data,we=fe.words,Ce=this._nDataBytes*8,Te=fe.sigBytes*8;we[Te>>>5]|=128<<24-Te%32,we[(Te+64>>>9<<4)+14]=(Ce<<8|Ce>>>24)&16711935|(Ce<<24|Ce>>>8)&4278255360,fe.sigBytes=(we.length+1)*4,this._process();for(var Se=this._hash,Ne=Se.words,Ue=0;Ue<5;Ue++){var Ve=Ne[Ue];Ne[Ue]=(Ve<<8|Ve>>>24)&16711935|(Ve<<24|Ve>>>8)&4278255360}return Se},clone:function(){var fe=s.clone.call(this);return fe._hash=this._hash.clone(),fe}});function Y(fe,we,Ce){return fe^we^Ce}function W(fe,we,Ce){return fe&we|~fe&Ce}function O(fe,we,Ce){return(fe|~we)^Ce}function V(fe,we,Ce){return fe&Ce|we&~Ce}function Q(fe,we,Ce){return fe^(we|~Ce)}function ue(fe,we){return fe<<we|fe>>>32-we}m.RIPEMD160=s._createHelper(K),m.HmacRIPEMD160=s._createHmacHelper(K)}(),l.RIPEMD160})}(Cy)),Cy.exports}var Ay={exports:{}},TT;function _v(){return TT||(TT=1,function(t,n){(function(l,h){t.exports=h(_n())})($t,function(l){(function(){var h=l,m=h.lib,x=m.Base,b=h.enc,s=b.Utf8,C=h.algo;C.HMAC=x.extend({init:function(k,B){k=this._hasher=new k.init,typeof B=="string"&&(B=s.parse(B));var U=k.blockSize,F=U*4;B.sigBytes>F&&(B=k.finalize(B)),B.clamp();for(var Z=this._oKey=B.clone(),q=this._iKey=B.clone(),K=Z.words,Y=q.words,W=0;W<U;W++)K[W]^=1549556828,Y[W]^=909522486;Z.sigBytes=q.sigBytes=F,this.reset()},reset:function(){var k=this._hasher;k.reset(),k.update(this._iKey)},update:function(k){return this._hasher.update(k),this},finalize:function(k){var B=this._hasher,U=B.finalize(k);B.reset();var F=B.finalize(this._oKey.clone().concat(U));return F}})})()})}(Ay)),Ay.exports}var Iy={exports:{}},ST;function $6(){return ST||(ST=1,function(t,n){(function(l,h,m){t.exports=h(_n(),gv(),_v())})($t,function(l){return function(){var h=l,m=h.lib,x=m.Base,b=m.WordArray,s=h.algo,C=s.SHA256,k=s.HMAC,B=s.PBKDF2=x.extend({cfg:x.extend({keySize:128/32,hasher:C,iterations:25e4}),init:function(U){this.cfg=this.cfg.extend(U)},compute:function(U,F){for(var Z=this.cfg,q=k.create(Z.hasher,U),K=b.create(),Y=b.create([1]),W=K.words,O=Y.words,V=Z.keySize,Q=Z.iterations;W.length<V;){var ue=q.update(F).finalize(Y);q.reset();for(var fe=ue.words,we=fe.length,Ce=ue,Te=1;Te<Q;Te++){Ce=q.finalize(Ce),q.reset();for(var Se=Ce.words,Ne=0;Ne<we;Ne++)fe[Ne]^=Se[Ne]}K.concat(ue),O[0]++}return K.sigBytes=V*4,K}});h.PBKDF2=function(U,F,Z){return B.create(Z).compute(U,F)}}(),l.PBKDF2})}(Iy)),Iy.exports}var ky={exports:{}},CT;function tl(){return CT||(CT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),W4(),_v())})($t,function(l){return function(){var h=l,m=h.lib,x=m.Base,b=m.WordArray,s=h.algo,C=s.MD5,k=s.EvpKDF=x.extend({cfg:x.extend({keySize:128/32,hasher:C,iterations:1}),init:function(B){this.cfg=this.cfg.extend(B)},compute:function(B,U){for(var F,Z=this.cfg,q=Z.hasher.create(),K=b.create(),Y=K.words,W=Z.keySize,O=Z.iterations;Y.length<W;){F&&q.update(F),F=q.update(B).finalize(U),q.reset();for(var V=1;V<O;V++)F=q.finalize(F),q.reset();K.concat(F)}return K.sigBytes=W*4,K}});h.EvpKDF=function(B,U,F){return k.create(F).compute(B,U)}}(),l.EvpKDF})}(ky)),ky.exports}var My={exports:{}},AT;function Gr(){return AT||(AT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),tl())})($t,function(l){l.lib.Cipher||function(h){var m=l,x=m.lib,b=x.Base,s=x.WordArray,C=x.BufferedBlockAlgorithm,k=m.enc;k.Utf8;var B=k.Base64,U=m.algo,F=U.EvpKDF,Z=x.Cipher=C.extend({cfg:b.extend(),createEncryptor:function(Se,Ne){return this.create(this._ENC_XFORM_MODE,Se,Ne)},createDecryptor:function(Se,Ne){return this.create(this._DEC_XFORM_MODE,Se,Ne)},init:function(Se,Ne,Ue){this.cfg=this.cfg.extend(Ue),this._xformMode=Se,this._key=Ne,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(Se){return this._append(Se),this._process()},finalize:function(Se){Se&&this._append(Se);var Ne=this._doFinalize();return Ne},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Se(Ne){return typeof Ne=="string"?Te:fe}return function(Ne){return{encrypt:function(Ue,Ve,St){return Se(Ve).encrypt(Ne,Ue,Ve,St)},decrypt:function(Ue,Ve,St){return Se(Ve).decrypt(Ne,Ue,Ve,St)}}}}()});x.StreamCipher=Z.extend({_doFinalize:function(){var Se=this._process(!0);return Se},blockSize:1});var q=m.mode={},K=x.BlockCipherMode=b.extend({createEncryptor:function(Se,Ne){return this.Encryptor.create(Se,Ne)},createDecryptor:function(Se,Ne){return this.Decryptor.create(Se,Ne)},init:function(Se,Ne){this._cipher=Se,this._iv=Ne}}),Y=q.CBC=function(){var Se=K.extend();Se.Encryptor=Se.extend({processBlock:function(Ue,Ve){var St=this._cipher,kt=St.blockSize;Ne.call(this,Ue,Ve,kt),St.encryptBlock(Ue,Ve),this._prevBlock=Ue.slice(Ve,Ve+kt)}}),Se.Decryptor=Se.extend({processBlock:function(Ue,Ve){var St=this._cipher,kt=St.blockSize,Ot=Ue.slice(Ve,Ve+kt);St.decryptBlock(Ue,Ve),Ne.call(this,Ue,Ve,kt),this._prevBlock=Ot}});function Ne(Ue,Ve,St){var kt,Ot=this._iv;Ot?(kt=Ot,this._iv=h):kt=this._prevBlock;for(var on=0;on<St;on++)Ue[Ve+on]^=kt[on]}return Se}(),W=m.pad={},O=W.Pkcs7={pad:function(Se,Ne){for(var Ue=Ne*4,Ve=Ue-Se.sigBytes%Ue,St=Ve<<24|Ve<<16|Ve<<8|Ve,kt=[],Ot=0;Ot<Ve;Ot+=4)kt.push(St);var on=s.create(kt,Ve);Se.concat(on)},unpad:function(Se){var Ne=Se.words[Se.sigBytes-1>>>2]&255;Se.sigBytes-=Ne}};x.BlockCipher=Z.extend({cfg:Z.cfg.extend({mode:Y,padding:O}),reset:function(){var Se;Z.reset.call(this);var Ne=this.cfg,Ue=Ne.iv,Ve=Ne.mode;this._xformMode==this._ENC_XFORM_MODE?Se=Ve.createEncryptor:(Se=Ve.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Se?this._mode.init(this,Ue&&Ue.words):(this._mode=Se.call(Ve,this,Ue&&Ue.words),this._mode.__creator=Se)},_doProcessBlock:function(Se,Ne){this._mode.processBlock(Se,Ne)},_doFinalize:function(){var Se,Ne=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Ne.pad(this._data,this.blockSize),Se=this._process(!0)):(Se=this._process(!0),Ne.unpad(Se)),Se},blockSize:128/32});var V=x.CipherParams=b.extend({init:function(Se){this.mixIn(Se)},toString:function(Se){return(Se||this.formatter).stringify(this)}}),Q=m.format={},ue=Q.OpenSSL={stringify:function(Se){var Ne,Ue=Se.ciphertext,Ve=Se.salt;return Ve?Ne=s.create([1398893684,1701076831]).concat(Ve).concat(Ue):Ne=Ue,Ne.toString(B)},parse:function(Se){var Ne,Ue=B.parse(Se),Ve=Ue.words;return Ve[0]==1398893684&&Ve[1]==1701076831&&(Ne=s.create(Ve.slice(2,4)),Ve.splice(0,4),Ue.sigBytes-=16),V.create({ciphertext:Ue,salt:Ne})}},fe=x.SerializableCipher=b.extend({cfg:b.extend({format:ue}),encrypt:function(Se,Ne,Ue,Ve){Ve=this.cfg.extend(Ve);var St=Se.createEncryptor(Ue,Ve),kt=St.finalize(Ne),Ot=St.cfg;return V.create({ciphertext:kt,key:Ue,iv:Ot.iv,algorithm:Se,mode:Ot.mode,padding:Ot.padding,blockSize:Se.blockSize,formatter:Ve.format})},decrypt:function(Se,Ne,Ue,Ve){Ve=this.cfg.extend(Ve),Ne=this._parse(Ne,Ve.format);var St=Se.createDecryptor(Ue,Ve).finalize(Ne.ciphertext);return St},_parse:function(Se,Ne){return typeof Se=="string"?Ne.parse(Se,this):Se}}),we=m.kdf={},Ce=we.OpenSSL={execute:function(Se,Ne,Ue,Ve,St){if(Ve||(Ve=s.random(64/8)),St)var kt=F.create({keySize:Ne+Ue,hasher:St}).compute(Se,Ve);else var kt=F.create({keySize:Ne+Ue}).compute(Se,Ve);var Ot=s.create(kt.words.slice(Ne),Ue*4);return kt.sigBytes=Ne*4,V.create({key:kt,iv:Ot,salt:Ve})}},Te=x.PasswordBasedCipher=fe.extend({cfg:fe.cfg.extend({kdf:Ce}),encrypt:function(Se,Ne,Ue,Ve){Ve=this.cfg.extend(Ve);var St=Ve.kdf.execute(Ue,Se.keySize,Se.ivSize,Ve.salt,Ve.hasher);Ve.iv=St.iv;var kt=fe.encrypt.call(this,Se,Ne,St.key,Ve);return kt.mixIn(St),kt},decrypt:function(Se,Ne,Ue,Ve){Ve=this.cfg.extend(Ve),Ne=this._parse(Ne,Ve.format);var St=Ve.kdf.execute(Ue,Se.keySize,Se.ivSize,Ne.salt,Ve.hasher);Ve.iv=St.iv;var kt=fe.decrypt.call(this,Se,Ne,St.key,Ve);return kt}})}()})}(My)),My.exports}var Dy={exports:{}},IT;function W6(){return IT||(IT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.mode.CFB=function(){var h=l.lib.BlockCipherMode.extend();h.Encryptor=h.extend({processBlock:function(x,b){var s=this._cipher,C=s.blockSize;m.call(this,x,b,C,s),this._prevBlock=x.slice(b,b+C)}}),h.Decryptor=h.extend({processBlock:function(x,b){var s=this._cipher,C=s.blockSize,k=x.slice(b,b+C);m.call(this,x,b,C,s),this._prevBlock=k}});function m(x,b,s,C){var k,B=this._iv;B?(k=B.slice(0),this._iv=void 0):k=this._prevBlock,C.encryptBlock(k,0);for(var U=0;U<s;U++)x[b+U]^=k[U]}return h}(),l.mode.CFB})}(Dy)),Dy.exports}var Py={exports:{}},kT;function H6(){return kT||(kT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.mode.CTR=function(){var h=l.lib.BlockCipherMode.extend(),m=h.Encryptor=h.extend({processBlock:function(x,b){var s=this._cipher,C=s.blockSize,k=this._iv,B=this._counter;k&&(B=this._counter=k.slice(0),this._iv=void 0);var U=B.slice(0);s.encryptBlock(U,0),B[C-1]=B[C-1]+1|0;for(var F=0;F<C;F++)x[b+F]^=U[F]}});return h.Decryptor=m,h}(),l.mode.CTR})}(Py)),Py.exports}var zy={exports:{}},MT;function Z6(){return MT||(MT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return l.mode.CTRGladman=function(){var h=l.lib.BlockCipherMode.extend();function m(s){if((s>>24&255)===255){var C=s>>16&255,k=s>>8&255,B=s&255;C===255?(C=0,k===255?(k=0,B===255?B=0:++B):++k):++C,s=0,s+=C<<16,s+=k<<8,s+=B}else s+=1<<24;return s}function x(s){return(s[0]=m(s[0]))===0&&(s[1]=m(s[1])),s}var b=h.Encryptor=h.extend({processBlock:function(s,C){var k=this._cipher,B=k.blockSize,U=this._iv,F=this._counter;U&&(F=this._counter=U.slice(0),this._iv=void 0),x(F);var Z=F.slice(0);k.encryptBlock(Z,0);for(var q=0;q<B;q++)s[C+q]^=Z[q]}});return h.Decryptor=b,h}(),l.mode.CTRGladman})}(zy)),zy.exports}var By={exports:{}},DT;function X6(){return DT||(DT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.mode.OFB=function(){var h=l.lib.BlockCipherMode.extend(),m=h.Encryptor=h.extend({processBlock:function(x,b){var s=this._cipher,C=s.blockSize,k=this._iv,B=this._keystream;k&&(B=this._keystream=k.slice(0),this._iv=void 0),s.encryptBlock(B,0);for(var U=0;U<C;U++)x[b+U]^=B[U]}});return h.Decryptor=m,h}(),l.mode.OFB})}(By)),By.exports}var Ly={exports:{}},PT;function K6(){return PT||(PT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.mode.ECB=function(){var h=l.lib.BlockCipherMode.extend();return h.Encryptor=h.extend({processBlock:function(m,x){this._cipher.encryptBlock(m,x)}}),h.Decryptor=h.extend({processBlock:function(m,x){this._cipher.decryptBlock(m,x)}}),h}(),l.mode.ECB})}(Ly)),Ly.exports}var Ry={exports:{}},zT;function Y6(){return zT||(zT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.pad.AnsiX923={pad:function(h,m){var x=h.sigBytes,b=m*4,s=b-x%b,C=x+s-1;h.clamp(),h.words[C>>>2]|=s<<24-C%4*8,h.sigBytes+=s},unpad:function(h){var m=h.words[h.sigBytes-1>>>2]&255;h.sigBytes-=m}},l.pad.Ansix923})}(Ry)),Ry.exports}var Fy={exports:{}},BT;function J6(){return BT||(BT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.pad.Iso10126={pad:function(h,m){var x=m*4,b=x-h.sigBytes%x;h.concat(l.lib.WordArray.random(b-1)).concat(l.lib.WordArray.create([b<<24],1))},unpad:function(h){var m=h.words[h.sigBytes-1>>>2]&255;h.sigBytes-=m}},l.pad.Iso10126})}(Fy)),Fy.exports}var Oy={exports:{}},LT;function Q6(){return LT||(LT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.pad.Iso97971={pad:function(h,m){h.concat(l.lib.WordArray.create([2147483648],1)),l.pad.ZeroPadding.pad(h,m)},unpad:function(h){l.pad.ZeroPadding.unpad(h),h.sigBytes--}},l.pad.Iso97971})}(Oy)),Oy.exports}var Ny={exports:{}},RT;function eF(){return RT||(RT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.pad.ZeroPadding={pad:function(h,m){var x=m*4;h.clamp(),h.sigBytes+=x-(h.sigBytes%x||x)},unpad:function(h){for(var m=h.words,x=h.sigBytes-1,x=h.sigBytes-1;x>=0;x--)if(m[x>>>2]>>>24-x%4*8&255){h.sigBytes=x+1;break}}},l.pad.ZeroPadding})}(Ny)),Ny.exports}var Uy={exports:{}},FT;function tF(){return FT||(FT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return l.pad.NoPadding={pad:function(){},unpad:function(){}},l.pad.NoPadding})}(Uy)),Uy.exports}var jy={exports:{}},OT;function nF(){return OT||(OT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),Gr())})($t,function(l){return function(h){var m=l,x=m.lib,b=x.CipherParams,s=m.enc,C=s.Hex,k=m.format;k.Hex={stringify:function(B){return B.ciphertext.toString(C)},parse:function(B){var U=C.parse(B);return b.create({ciphertext:U})}}}(),l.format.Hex})}(jy)),jy.exports}var Vy={exports:{}},NT;function rF(){return NT||(NT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),cc(),uc(),tl(),Gr())})($t,function(l){return function(){var h=l,m=h.lib,x=m.BlockCipher,b=h.algo,s=[],C=[],k=[],B=[],U=[],F=[],Z=[],q=[],K=[],Y=[];(function(){for(var V=[],Q=0;Q<256;Q++)Q<128?V[Q]=Q<<1:V[Q]=Q<<1^283;for(var ue=0,fe=0,Q=0;Q<256;Q++){var we=fe^fe<<1^fe<<2^fe<<3^fe<<4;we=we>>>8^we&255^99,s[ue]=we,C[we]=ue;var Ce=V[ue],Te=V[Ce],Se=V[Te],Ne=V[we]*257^we*16843008;k[ue]=Ne<<24|Ne>>>8,B[ue]=Ne<<16|Ne>>>16,U[ue]=Ne<<8|Ne>>>24,F[ue]=Ne;var Ne=Se*16843009^Te*65537^Ce*257^ue*16843008;Z[we]=Ne<<24|Ne>>>8,q[we]=Ne<<16|Ne>>>16,K[we]=Ne<<8|Ne>>>24,Y[we]=Ne,ue?(ue=Ce^V[V[V[Se^Ce]]],fe^=V[V[fe]]):ue=fe=1}})();var W=[0,1,2,4,8,16,32,64,128,27,54],O=b.AES=x.extend({_doReset:function(){var V;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var Q=this._keyPriorReset=this._key,ue=Q.words,fe=Q.sigBytes/4,we=this._nRounds=fe+6,Ce=(we+1)*4,Te=this._keySchedule=[],Se=0;Se<Ce;Se++)Se<fe?Te[Se]=ue[Se]:(V=Te[Se-1],Se%fe?fe>6&&Se%fe==4&&(V=s[V>>>24]<<24|s[V>>>16&255]<<16|s[V>>>8&255]<<8|s[V&255]):(V=V<<8|V>>>24,V=s[V>>>24]<<24|s[V>>>16&255]<<16|s[V>>>8&255]<<8|s[V&255],V^=W[Se/fe|0]<<24),Te[Se]=Te[Se-fe]^V);for(var Ne=this._invKeySchedule=[],Ue=0;Ue<Ce;Ue++){var Se=Ce-Ue;if(Ue%4)var V=Te[Se];else var V=Te[Se-4];Ue<4||Se<=4?Ne[Ue]=V:Ne[Ue]=Z[s[V>>>24]]^q[s[V>>>16&255]]^K[s[V>>>8&255]]^Y[s[V&255]]}}},encryptBlock:function(V,Q){this._doCryptBlock(V,Q,this._keySchedule,k,B,U,F,s)},decryptBlock:function(V,Q){var ue=V[Q+1];V[Q+1]=V[Q+3],V[Q+3]=ue,this._doCryptBlock(V,Q,this._invKeySchedule,Z,q,K,Y,C);var ue=V[Q+1];V[Q+1]=V[Q+3],V[Q+3]=ue},_doCryptBlock:function(V,Q,ue,fe,we,Ce,Te,Se){for(var Ne=this._nRounds,Ue=V[Q]^ue[0],Ve=V[Q+1]^ue[1],St=V[Q+2]^ue[2],kt=V[Q+3]^ue[3],Ot=4,on=1;on<Ne;on++){var We=fe[Ue>>>24]^we[Ve>>>16&255]^Ce[St>>>8&255]^Te[kt&255]^ue[Ot++],bt=fe[Ve>>>24]^we[St>>>16&255]^Ce[kt>>>8&255]^Te[Ue&255]^ue[Ot++],ft=fe[St>>>24]^we[kt>>>16&255]^Ce[Ue>>>8&255]^Te[Ve&255]^ue[Ot++],je=fe[kt>>>24]^we[Ue>>>16&255]^Ce[Ve>>>8&255]^Te[St&255]^ue[Ot++];Ue=We,Ve=bt,St=ft,kt=je}var We=(Se[Ue>>>24]<<24|Se[Ve>>>16&255]<<16|Se[St>>>8&255]<<8|Se[kt&255])^ue[Ot++],bt=(Se[Ve>>>24]<<24|Se[St>>>16&255]<<16|Se[kt>>>8&255]<<8|Se[Ue&255])^ue[Ot++],ft=(Se[St>>>24]<<24|Se[kt>>>16&255]<<16|Se[Ue>>>8&255]<<8|Se[Ve&255])^ue[Ot++],je=(Se[kt>>>24]<<24|Se[Ue>>>16&255]<<16|Se[Ve>>>8&255]<<8|Se[St&255])^ue[Ot++];V[Q]=We,V[Q+1]=bt,V[Q+2]=ft,V[Q+3]=je},keySize:256/32});h.AES=x._createHelper(O)}(),l.AES})}(Vy)),Vy.exports}var Gy={exports:{}},UT;function iF(){return UT||(UT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),cc(),uc(),tl(),Gr())})($t,function(l){return function(){var h=l,m=h.lib,x=m.WordArray,b=m.BlockCipher,s=h.algo,C=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],k=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],B=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],U=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],F=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],Z=s.DES=b.extend({_doReset:function(){for(var W=this._key,O=W.words,V=[],Q=0;Q<56;Q++){var ue=C[Q]-1;V[Q]=O[ue>>>5]>>>31-ue%32&1}for(var fe=this._subKeys=[],we=0;we<16;we++){for(var Ce=fe[we]=[],Te=B[we],Q=0;Q<24;Q++)Ce[Q/6|0]|=V[(k[Q]-1+Te)%28]<<31-Q%6,Ce[4+(Q/6|0)]|=V[28+(k[Q+24]-1+Te)%28]<<31-Q%6;Ce[0]=Ce[0]<<1|Ce[0]>>>31;for(var Q=1;Q<7;Q++)Ce[Q]=Ce[Q]>>>(Q-1)*4+3;Ce[7]=Ce[7]<<5|Ce[7]>>>27}for(var Se=this._invSubKeys=[],Q=0;Q<16;Q++)Se[Q]=fe[15-Q]},encryptBlock:function(W,O){this._doCryptBlock(W,O,this._subKeys)},decryptBlock:function(W,O){this._doCryptBlock(W,O,this._invSubKeys)},_doCryptBlock:function(W,O,V){this._lBlock=W[O],this._rBlock=W[O+1],q.call(this,4,252645135),q.call(this,16,65535),K.call(this,2,858993459),K.call(this,8,16711935),q.call(this,1,1431655765);for(var Q=0;Q<16;Q++){for(var ue=V[Q],fe=this._lBlock,we=this._rBlock,Ce=0,Te=0;Te<8;Te++)Ce|=U[Te][((we^ue[Te])&F[Te])>>>0];this._lBlock=we,this._rBlock=fe^Ce}var Se=this._lBlock;this._lBlock=this._rBlock,this._rBlock=Se,q.call(this,1,1431655765),K.call(this,8,16711935),K.call(this,2,858993459),q.call(this,16,65535),q.call(this,4,252645135),W[O]=this._lBlock,W[O+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function q(W,O){var V=(this._lBlock>>>W^this._rBlock)&O;this._rBlock^=V,this._lBlock^=V<<W}function K(W,O){var V=(this._rBlock>>>W^this._lBlock)&O;this._lBlock^=V,this._rBlock^=V<<W}h.DES=b._createHelper(Z);var Y=s.TripleDES=b.extend({_doReset:function(){var W=this._key,O=W.words;if(O.length!==2&&O.length!==4&&O.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var V=O.slice(0,2),Q=O.length<4?O.slice(0,2):O.slice(2,4),ue=O.length<6?O.slice(0,2):O.slice(4,6);this._des1=Z.createEncryptor(x.create(V)),this._des2=Z.createEncryptor(x.create(Q)),this._des3=Z.createEncryptor(x.create(ue))},encryptBlock:function(W,O){this._des1.encryptBlock(W,O),this._des2.decryptBlock(W,O),this._des3.encryptBlock(W,O)},decryptBlock:function(W,O){this._des3.decryptBlock(W,O),this._des2.encryptBlock(W,O),this._des1.decryptBlock(W,O)},keySize:192/32,ivSize:64/32,blockSize:64/32});h.TripleDES=b._createHelper(Y)}(),l.TripleDES})}(Gy)),Gy.exports}var qy={exports:{}},jT;function oF(){return jT||(jT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),cc(),uc(),tl(),Gr())})($t,function(l){return function(){var h=l,m=h.lib,x=m.StreamCipher,b=h.algo,s=b.RC4=x.extend({_doReset:function(){for(var B=this._key,U=B.words,F=B.sigBytes,Z=this._S=[],q=0;q<256;q++)Z[q]=q;for(var q=0,K=0;q<256;q++){var Y=q%F,W=U[Y>>>2]>>>24-Y%4*8&255;K=(K+Z[q]+W)%256;var O=Z[q];Z[q]=Z[K],Z[K]=O}this._i=this._j=0},_doProcessBlock:function(B,U){B[U]^=C.call(this)},keySize:256/32,ivSize:0});function C(){for(var B=this._S,U=this._i,F=this._j,Z=0,q=0;q<4;q++){U=(U+1)%256,F=(F+B[U])%256;var K=B[U];B[U]=B[F],B[F]=K,Z|=B[(B[U]+B[F])%256]<<24-q*8}return this._i=U,this._j=F,Z}h.RC4=x._createHelper(s);var k=b.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var B=this.cfg.drop;B>0;B--)C.call(this)}});h.RC4Drop=x._createHelper(k)}(),l.RC4})}(qy)),qy.exports}var $y={exports:{}},VT;function sF(){return VT||(VT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),cc(),uc(),tl(),Gr())})($t,function(l){return function(){var h=l,m=h.lib,x=m.StreamCipher,b=h.algo,s=[],C=[],k=[],B=b.Rabbit=x.extend({_doReset:function(){for(var F=this._key.words,Z=this.cfg.iv,q=0;q<4;q++)F[q]=(F[q]<<8|F[q]>>>24)&16711935|(F[q]<<24|F[q]>>>8)&4278255360;var K=this._X=[F[0],F[3]<<16|F[2]>>>16,F[1],F[0]<<16|F[3]>>>16,F[2],F[1]<<16|F[0]>>>16,F[3],F[2]<<16|F[1]>>>16],Y=this._C=[F[2]<<16|F[2]>>>16,F[0]&4294901760|F[1]&65535,F[3]<<16|F[3]>>>16,F[1]&4294901760|F[2]&65535,F[0]<<16|F[0]>>>16,F[2]&4294901760|F[3]&65535,F[1]<<16|F[1]>>>16,F[3]&4294901760|F[0]&65535];this._b=0;for(var q=0;q<4;q++)U.call(this);for(var q=0;q<8;q++)Y[q]^=K[q+4&7];if(Z){var W=Z.words,O=W[0],V=W[1],Q=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,ue=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,fe=Q>>>16|ue&4294901760,we=ue<<16|Q&65535;Y[0]^=Q,Y[1]^=fe,Y[2]^=ue,Y[3]^=we,Y[4]^=Q,Y[5]^=fe,Y[6]^=ue,Y[7]^=we;for(var q=0;q<4;q++)U.call(this)}},_doProcessBlock:function(F,Z){var q=this._X;U.call(this),s[0]=q[0]^q[5]>>>16^q[3]<<16,s[1]=q[2]^q[7]>>>16^q[5]<<16,s[2]=q[4]^q[1]>>>16^q[7]<<16,s[3]=q[6]^q[3]>>>16^q[1]<<16;for(var K=0;K<4;K++)s[K]=(s[K]<<8|s[K]>>>24)&16711935|(s[K]<<24|s[K]>>>8)&4278255360,F[Z+K]^=s[K]},blockSize:128/32,ivSize:64/32});function U(){for(var F=this._X,Z=this._C,q=0;q<8;q++)C[q]=Z[q];Z[0]=Z[0]+1295307597+this._b|0,Z[1]=Z[1]+3545052371+(Z[0]>>>0<C[0]>>>0?1:0)|0,Z[2]=Z[2]+886263092+(Z[1]>>>0<C[1]>>>0?1:0)|0,Z[3]=Z[3]+1295307597+(Z[2]>>>0<C[2]>>>0?1:0)|0,Z[4]=Z[4]+3545052371+(Z[3]>>>0<C[3]>>>0?1:0)|0,Z[5]=Z[5]+886263092+(Z[4]>>>0<C[4]>>>0?1:0)|0,Z[6]=Z[6]+1295307597+(Z[5]>>>0<C[5]>>>0?1:0)|0,Z[7]=Z[7]+3545052371+(Z[6]>>>0<C[6]>>>0?1:0)|0,this._b=Z[7]>>>0<C[7]>>>0?1:0;for(var q=0;q<8;q++){var K=F[q]+Z[q],Y=K&65535,W=K>>>16,O=((Y*Y>>>17)+Y*W>>>15)+W*W,V=((K&4294901760)*K|0)+((K&65535)*K|0);k[q]=O^V}F[0]=k[0]+(k[7]<<16|k[7]>>>16)+(k[6]<<16|k[6]>>>16)|0,F[1]=k[1]+(k[0]<<8|k[0]>>>24)+k[7]|0,F[2]=k[2]+(k[1]<<16|k[1]>>>16)+(k[0]<<16|k[0]>>>16)|0,F[3]=k[3]+(k[2]<<8|k[2]>>>24)+k[1]|0,F[4]=k[4]+(k[3]<<16|k[3]>>>16)+(k[2]<<16|k[2]>>>16)|0,F[5]=k[5]+(k[4]<<8|k[4]>>>24)+k[3]|0,F[6]=k[6]+(k[5]<<16|k[5]>>>16)+(k[4]<<16|k[4]>>>16)|0,F[7]=k[7]+(k[6]<<8|k[6]>>>24)+k[5]|0}h.Rabbit=x._createHelper(B)}(),l.Rabbit})}($y)),$y.exports}var Wy={exports:{}},GT;function aF(){return GT||(GT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),cc(),uc(),tl(),Gr())})($t,function(l){return function(){var h=l,m=h.lib,x=m.StreamCipher,b=h.algo,s=[],C=[],k=[],B=b.RabbitLegacy=x.extend({_doReset:function(){var F=this._key.words,Z=this.cfg.iv,q=this._X=[F[0],F[3]<<16|F[2]>>>16,F[1],F[0]<<16|F[3]>>>16,F[2],F[1]<<16|F[0]>>>16,F[3],F[2]<<16|F[1]>>>16],K=this._C=[F[2]<<16|F[2]>>>16,F[0]&4294901760|F[1]&65535,F[3]<<16|F[3]>>>16,F[1]&4294901760|F[2]&65535,F[0]<<16|F[0]>>>16,F[2]&4294901760|F[3]&65535,F[1]<<16|F[1]>>>16,F[3]&4294901760|F[0]&65535];this._b=0;for(var Y=0;Y<4;Y++)U.call(this);for(var Y=0;Y<8;Y++)K[Y]^=q[Y+4&7];if(Z){var W=Z.words,O=W[0],V=W[1],Q=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,ue=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,fe=Q>>>16|ue&4294901760,we=ue<<16|Q&65535;K[0]^=Q,K[1]^=fe,K[2]^=ue,K[3]^=we,K[4]^=Q,K[5]^=fe,K[6]^=ue,K[7]^=we;for(var Y=0;Y<4;Y++)U.call(this)}},_doProcessBlock:function(F,Z){var q=this._X;U.call(this),s[0]=q[0]^q[5]>>>16^q[3]<<16,s[1]=q[2]^q[7]>>>16^q[5]<<16,s[2]=q[4]^q[1]>>>16^q[7]<<16,s[3]=q[6]^q[3]>>>16^q[1]<<16;for(var K=0;K<4;K++)s[K]=(s[K]<<8|s[K]>>>24)&16711935|(s[K]<<24|s[K]>>>8)&4278255360,F[Z+K]^=s[K]},blockSize:128/32,ivSize:64/32});function U(){for(var F=this._X,Z=this._C,q=0;q<8;q++)C[q]=Z[q];Z[0]=Z[0]+1295307597+this._b|0,Z[1]=Z[1]+3545052371+(Z[0]>>>0<C[0]>>>0?1:0)|0,Z[2]=Z[2]+886263092+(Z[1]>>>0<C[1]>>>0?1:0)|0,Z[3]=Z[3]+1295307597+(Z[2]>>>0<C[2]>>>0?1:0)|0,Z[4]=Z[4]+3545052371+(Z[3]>>>0<C[3]>>>0?1:0)|0,Z[5]=Z[5]+886263092+(Z[4]>>>0<C[4]>>>0?1:0)|0,Z[6]=Z[6]+1295307597+(Z[5]>>>0<C[5]>>>0?1:0)|0,Z[7]=Z[7]+3545052371+(Z[6]>>>0<C[6]>>>0?1:0)|0,this._b=Z[7]>>>0<C[7]>>>0?1:0;for(var q=0;q<8;q++){var K=F[q]+Z[q],Y=K&65535,W=K>>>16,O=((Y*Y>>>17)+Y*W>>>15)+W*W,V=((K&4294901760)*K|0)+((K&65535)*K|0);k[q]=O^V}F[0]=k[0]+(k[7]<<16|k[7]>>>16)+(k[6]<<16|k[6]>>>16)|0,F[1]=k[1]+(k[0]<<8|k[0]>>>24)+k[7]|0,F[2]=k[2]+(k[1]<<16|k[1]>>>16)+(k[0]<<16|k[0]>>>16)|0,F[3]=k[3]+(k[2]<<8|k[2]>>>24)+k[1]|0,F[4]=k[4]+(k[3]<<16|k[3]>>>16)+(k[2]<<16|k[2]>>>16)|0,F[5]=k[5]+(k[4]<<8|k[4]>>>24)+k[3]|0,F[6]=k[6]+(k[5]<<16|k[5]>>>16)+(k[4]<<16|k[4]>>>16)|0,F[7]=k[7]+(k[6]<<8|k[6]>>>24)+k[5]|0}h.RabbitLegacy=x._createHelper(B)}(),l.RabbitLegacy})}(Wy)),Wy.exports}var Hy={exports:{}},qT;function lF(){return qT||(qT=1,function(t,n){(function(l,h,m){t.exports=h(_n(),cc(),uc(),tl(),Gr())})($t,function(l){return function(){var h=l,m=h.lib,x=m.BlockCipher,b=h.algo;const s=16,C=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],k=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var B={pbox:[],sbox:[]};function U(Y,W){let O=W>>24&255,V=W>>16&255,Q=W>>8&255,ue=W&255,fe=Y.sbox[0][O]+Y.sbox[1][V];return fe=fe^Y.sbox[2][Q],fe=fe+Y.sbox[3][ue],fe}function F(Y,W,O){let V=W,Q=O,ue;for(let fe=0;fe<s;++fe)V=V^Y.pbox[fe],Q=U(Y,V)^Q,ue=V,V=Q,Q=ue;return ue=V,V=Q,Q=ue,Q=Q^Y.pbox[s],V=V^Y.pbox[s+1],{left:V,right:Q}}function Z(Y,W,O){let V=W,Q=O,ue;for(let fe=s+1;fe>1;--fe)V=V^Y.pbox[fe],Q=U(Y,V)^Q,ue=V,V=Q,Q=ue;return ue=V,V=Q,Q=ue,Q=Q^Y.pbox[1],V=V^Y.pbox[0],{left:V,right:Q}}function q(Y,W,O){for(let we=0;we<4;we++){Y.sbox[we]=[];for(let Ce=0;Ce<256;Ce++)Y.sbox[we][Ce]=k[we][Ce]}let V=0;for(let we=0;we<s+2;we++)Y.pbox[we]=C[we]^W[V],V++,V>=O&&(V=0);let Q=0,ue=0,fe=0;for(let we=0;we<s+2;we+=2)fe=F(Y,Q,ue),Q=fe.left,ue=fe.right,Y.pbox[we]=Q,Y.pbox[we+1]=ue;for(let we=0;we<4;we++)for(let Ce=0;Ce<256;Ce+=2)fe=F(Y,Q,ue),Q=fe.left,ue=fe.right,Y.sbox[we][Ce]=Q,Y.sbox[we][Ce+1]=ue;return!0}var K=b.Blowfish=x.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var Y=this._keyPriorReset=this._key,W=Y.words,O=Y.sigBytes/4;q(B,W,O)}},encryptBlock:function(Y,W){var O=F(B,Y[W],Y[W+1]);Y[W]=O.left,Y[W+1]=O.right},decryptBlock:function(Y,W){var O=Z(B,Y[W],Y[W+1]);Y[W]=O.left,Y[W+1]=O.right},blockSize:64/32,keySize:128/32,ivSize:64/32});h.Blowfish=x._createHelper(K)}(),l.Blowfish})}(Hy)),Hy.exports}(function(t,n){(function(l,h,m){t.exports=h(_n(),Hm(),O6(),N6(),cc(),U6(),uc(),W4(),gv(),j6(),H4(),V6(),G6(),q6(),_v(),$6(),tl(),Gr(),W6(),H6(),Z6(),X6(),K6(),Y6(),J6(),Q6(),eF(),tF(),nF(),rF(),iF(),oF(),sF(),aF(),lF())})($t,function(l){return l})})($4);var O0=$4.exports;const cF="4a143a9e-352c-4fd6-ae5b-d441fec00548",uF="80036f56-0856-4e2e-9730-d0863faca68f",hF="Q+coMcrzSPBIv2ksoBFHt6TCasWLUnYdJTWmBaizybg=",dF="tech-team@ruralinnovation.us",pF=10,fF=["tableau:views:embed"];function Zy(t){let n=t instanceof Uint8Array?new TextDecoder("utf8").decode(t):O0.enc.Base64.stringify(t);return n=n.replace(/=+$/,""),n=n.replace(/\+/g,"-"),n=n.replace(/\//g,"_"),n}function mF(t,n,l,h,m){const x={alg:"HS256",typ:"JWT",iss:h,kid:n};console.log("Encode header:",x);const b=O0.enc.Utf8.parse(JSON.stringify(x)),s=Zy(b),C={sub:t,aud:"tableau",nbf:Math.round(new Date().getTime()/1e3)-100,jti:new Date().getTime().toString(),iss:h,scp:m,exp:Math.round(new Date().getTime()/1e3)+pF*60};console.log("Encode claimSet:",C);const k=O0.enc.Utf8.parse(JSON.stringify(C)),B=Zy(k),U=s+"."+B;console.log("Encode token (encoded header + encoded claimSet):",U);const F=O0.HmacSHA256(U,l);console.log("Base64 encode signature:",F);const Z=Zy(F),q=U+"."+Z;return console.log(q),q}function $T({attach_content:t=!0,content:n,content_selector:l,content_timeout:h}){const m="tableau-viz-container";let x=!1;function b(s){if(console.log("Ready to attach content:",t,l,h),l!==null&&!x){const C=document.getElementsByClassName(m)[0];C&&C!==null&&typeof C.insertAdjacentElement=="function"&&(s!==null&&s.childNodes!==null&&s.childNodes.length>0&&setTimeout(k=>{console.log(`Will append content to ${C.className}: `,s),s.childNodes.forEach(B=>{if(B.nodeType===1){const U=B;k.insertAdjacentElement("beforeend",U)}})},53,C),x=!0)}}return xt.useEffect(()=>{l!==null&&h!==null&&setTimeout(function(){const s=typeof n=="function"?n():null;if(console.log("viz_content:",s),s!==null){const C=s==null?void 0:s.querySelector(l);console.log("viz:",C),C.token=mF(dF,uF,hF,cF,fF),new Promise((k,B)=>{console.log("About to reference @tableau/embedding-api...");const U=window.TableauEventType;U&&(C.addEventListener(U.FirstInteractive,()=>{console.log("Viz is interactive!"),k()}),C.addEventListener(U.VizLoadError,F=>{const Z=JSON.parse(F.detail.message),K=`ca-error-${JSON.parse(Z.errorMessage).result.errors[0].code}`;console.log("Error",K,Z),B(K)}))}).then(k=>{var Z;let B,U;const F=window.SheetType;F&&((Z=C.workbook.activeSheet)==null?void 0:Z.sheetType)===(F==null?void 0:F.Dashboard)?(B=C.workbook.activeSheet,U=B==null?void 0:B.worksheets.find(q=>q.name==="Replace-Name-of-Worksheet")):U=C.workbook.activeSheet,console.log("Tableau Viz Dashboard: ",B),console.log("Tableau Viz Worksheet: ",U)}),t&&C!==null?b(s):x=!0}},h+1e3)},[]),xt.createElement("div",{className:m})}const Xy="pk.eyJ1IjoicnVyYWxpbm5vIiwiYSI6ImNqeHl0cW0xODBlMm0zY2x0dXltYzRuazUifQ.zZBovoCHzLIW0wCZveEKzA",WT="/examples/cori.data.rin/rin_service_areas.geojson";function HT({app_id:t,attach_content:n=!1,content:l,content_selector:h,content_timeout:m}){var q;const x=xt.useContext(s4),[b,s]=xt.useState(!0);function C(){m&&m!==null&&setTimeout(function(){if(!b){const K=document.getElementById(t);if(K){const Y=typeof l=="function"?l():null;Y!==null&&Y.childNodes!==null&&Y.childNodes.length>0&&(console.log(`Will append content to ${t}: `,Y),setTimeout(W=>{Y.childNodes.forEach(O=>{if(O.nodeType===1){const V=O;W.insertAdjacentElement("beforeend",V)}})},53,K),s(!0))}}},m+1e3)}xt.useEffect(()=>{console.log("Viz content loaded:",b,h,m,l()),n?C():s(!0)},[]);const k=xt.useRef(null),B=xt.useMemo(()=>(K,Y,W,O)=>{const V=new mv.Popup;return O.hasOwnProperty(W)?(V.setLngLat([K,Y]),V.setText(O[W])):V.setText("Hello world!"),V},[]);let U=!1;function F(K,Y,W,O,V,Q,ue){return console.log(`Set marker (${ue[Q]+"-marker"}): `,k),xt.createElement(a4,{ref:K,longitude:Y,latitude:W,color:O,popup:V(Y,W,Q,ue),key:ue[Q]+"-marker"})}xt.useEffect(()=>{if(x&&!x.data.hasOwnProperty("placeData")&&!U){console.log("Initial place data fetch..."),console.log(WT),U=!0;const K=window.document.getElementById("info-wrapper");K!==null&&(K.style.opacity="1.0",K.style.position="absolute",K.style.background=`rgba(46, 60, 67, 0.5) url('${x.baseURL}/images/loading.gif') no-repeat fixed center`,K.style.backgroundSize="20px"),x.setData({...(x==null?void 0:x.data)||{},placeData:null}),x==null||x.apiClient.get(WT).then(Y=>{Y&&Y.hasOwnProperty("data")&&(x.setData({...x.data,placeData:Y.data.features}),U=!1,K!==null&&(K.style.opacity="0.0",K.style.pointerEvents="none",setTimeout(()=>{K.style.background="transparent"},533)))}).catch(Y=>{console.error("Error fetching data:",Y),U=!1,K!==null&&(K.style.opacity="0.0",K.style.pointerEvents="none",setTimeout(()=>{K.style.background="transparent"},533))})}},[x==null?void 0:x.data]);const Z=[];return xt.createElement(xt.Fragment,null,xt.createElement("div",{className:"slippy-map"},xt.createElement(HL,{mapboxAccessToken:Xy,initialViewState:{latitude:40,longitude:-99,pitch:45,zoom:4},style:{width:600,height:400},mapStyle:`https://api.mapbox.com/styles/v1/ruralinno/cl010e7b7001p15pe3l0306hv?access_token=${Xy}`},!!(x!=null&&x.data)&&!!((q=x==null?void 0:x.data)!=null&&q.placeData)&&x.data.placeData.length>0&&!!k&&typeof k!==void 0&&x.data.placeData.filter(K=>{const Y=K.properties.rin_community.toString();return Z.filter(W=>W===Y).length<1?(Z.push(Y),!0):!1}).map(K=>{console.log(K.properties.rin_community);const Y=typeof K.geometry.coordinates[0]=="number"?K.geometry.coordinates[0]:0,W=typeof K.geometry.coordinates[1]=="number"?K.geometry.coordinates[1]:0;return F(k,Y,W,"#16343e",B,"rin_community",K.properties)}),xt.createElement(p6,{mapboxAccessToken:Xy,position:"top-right"}),xt.createElement(XL,{position:"top-right"}),xt.createElement(ZL,{position:"top-right"}),xt.createElement(KL,{position:"bottom-left",unit:"imperial"}))),xt.createElement("div",{id:"info-wrapper",style:{pointerEvents:"none",position:"absolute",top:0,left:0,minWidth:"100vw",minHeight:"100vh",transition:"opacity 5.05s ease-in-out 0.025s",opacity:"initial",background:"transparent",backgroundSize:"20px",zIndex:100}}),!!b&&!!h&&!!m&&(n?xt.createElement($T,{attach_content:n,content:()=>l(),content_selector:h,content_timeout:m+1e3}):xt.createElement("div",null,xt.createElement($T,{attach_content:n,content:()=>l(),content_selector:h,content_timeout:m+1e3}))))}const ZT="https://cori-risi-apps.s3.amazonaws.com",XT=333;function gF(t,n){const l=document.getElementById(t)||document.createElement("div"),h=document.createElement("div");l.id=t,document.getElementById("loader")!==null&&document.getElementById("loader").remove();for(const m of l.childNodes){const x=m;m.nodeType===1&&h.appendChild(x)}if(n!==null){const m=document.querySelector(n);setTimeout(function(){console.log("Found embedded content in root:",h),m!==null&&h.appendChild(m)},XT),Vx(l).render(xt.createElement(xt.StrictMode,null,xt.createElement(qE,{baseURL:ZT},xt.createElement(HT,{app_id:t,attach_content:!0,content:()=>n!==null&&document.querySelector(n)!==null?document.querySelector(n).parentElement:h,content_selector:n,content_timeout:XT}))))}else Vx(l).render(xt.createElement(xt.StrictMode,null,xt.createElement(qE,{baseURL:ZT},xt.createElement(HT,{app_id:t,content:()=>document.createElement("div")}))))}gF("app");
